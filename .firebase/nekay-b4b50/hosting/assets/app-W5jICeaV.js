const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-Bh7PR1fh.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/Login-rrv-lTni.css","assets/Home-Cv2zI1KH.js","assets/Home-3emf26Mz.css","assets/Pomodoro-BtqM_MIq.js","assets/Pomodoro-DF3qJkzY.css","assets/Tasks-DHT4NuUR.js","assets/Tasks-B-FN4IX2.css","assets/Journal-B0rLmqSt.js","assets/Journal-DBzUvbFE.css","assets/BottomNav-BFvH7_cV.js","assets/BottomNav-D_4GV9n9.css"])))=>i.map(i=>d[i]);
var __=Object.defineProperty;var y_=(n,t,e)=>t in n?__(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Ma=(n,t,e)=>y_(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Qc(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Dt={},Wr=[],tn=()=>{},E_=()=>!1,zo=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Jc=n=>n.startsWith("onUpdate:"),te=Object.assign,Yc=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},v_=Object.prototype.hasOwnProperty,At=(n,t)=>v_.call(n,t),ht=Array.isArray,Qr=n=>Go(n)==="[object Map]",ud=n=>Go(n)==="[object Set]",ft=n=>typeof n=="function",Ht=n=>typeof n=="string",$n=n=>typeof n=="symbol",Mt=n=>n!==null&&typeof n=="object",hd=n=>(Mt(n)||ft(n))&&ft(n.then)&&ft(n.catch),fd=Object.prototype.toString,Go=n=>fd.call(n),I_=n=>Go(n).slice(8,-1),dd=n=>Go(n)==="[object Object]",Xc=n=>Ht(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,$s=Qc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ho=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},T_=/-(\w)/g,qe=Ho(n=>n.replace(T_,(t,e)=>e?e.toUpperCase():"")),w_=/\B([A-Z])/g,Kn=Ho(n=>n.replace(w_,"-$1").toLowerCase()),Wo=Ho(n=>n.charAt(0).toUpperCase()+n.slice(1)),Fa=Ho(n=>n?`on${Wo(n)}`:""),On=(n,t)=>!Object.is(n,t),so=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},pd=(n,t,e,r=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:r,value:e})},ac=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let Qu;const Qo=()=>Qu||(Qu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zc(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++){const r=n[e],s=Ht(r)?S_(r):Zc(r);if(s)for(const i in s)t[i]=s[i]}return t}else if(Ht(n)||Mt(n))return n}const b_=/;(?![^(]*\))/g,A_=/:([^]+)/,R_=/\/\*[^]*?\*\//g;function S_(n){const t={};return n.replace(R_,"").split(b_).forEach(e=>{if(e){const r=e.split(A_);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function tl(n){let t="";if(Ht(n))t=n;else if(ht(n))for(let e=0;e<n.length;e++){const r=tl(n[e]);r&&(t+=r+" ")}else if(Mt(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const P_="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",C_=Qc(P_);function md(n){return!!n||n===""}const gd=n=>!!(n&&n.__v_isRef===!0),x_=n=>Ht(n)?n:n==null?"":ht(n)||Mt(n)&&(n.toString===fd||!ft(n.toString))?gd(n)?x_(n.value):JSON.stringify(n,_d,2):String(n),_d=(n,t)=>gd(t)?_d(n,t.value):Qr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[r,s],i)=>(e[La(r,i)+" =>"]=s,e),{})}:ud(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>La(e))}:$n(t)?La(t):Mt(t)&&!ht(t)&&!dd(t)?String(t):t,La=(n,t="")=>{var e;return $n(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ye;class yd{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ye,!t&&ye&&(this.index=(ye.scopes||(ye.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=ye;try{return ye=this,t()}finally{ye=e}}}on(){ye=this}off(){ye=this.parent}stop(t){if(this._active){let e,r;for(e=0,r=this.effects.length;e<r;e++)this.effects[e].stop();for(e=0,r=this.cleanups.length;e<r;e++)this.cleanups[e]();if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Ed(n){return new yd(n)}function vd(){return ye}function V_(n,t=!1){ye&&ye.cleanups.push(n)}let kt;const Ba=new WeakSet;class Id{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ye&&ye.active&&ye.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ba.has(this)&&(Ba.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||wd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ju(this),bd(this);const t=kt,e=ze;kt=this,ze=!0;try{return this.fn()}finally{Ad(this),kt=t,ze=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)rl(t);this.deps=this.depsTail=void 0,Ju(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ba.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){cc(this)&&this.run()}get dirty(){return cc(this)}}let Td=0,Ks,zs;function wd(n,t=!1){if(n.flags|=8,t){n.next=zs,zs=n;return}n.next=Ks,Ks=n}function el(){Td++}function nl(){if(--Td>0)return;if(zs){let t=zs;for(zs=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Ks;){let t=Ks;for(Ks=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){n||(n=r)}t=e}}if(n)throw n}function bd(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ad(n){let t,e=n.depsTail,r=e;for(;r;){const s=r.prevDep;r.version===-1?(r===e&&(e=s),rl(r),D_(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=t,n.depsTail=e}function cc(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Rd(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Rd(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===si))return;n.globalVersion=si;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!cc(n)){n.flags&=-3;return}const e=kt,r=ze;kt=n,ze=!0;try{bd(n);const s=n.fn(n._value);(t.version===0||On(s,n._value))&&(n._value=s,t.version++)}catch(s){throw t.version++,s}finally{kt=e,ze=r,Ad(n),n.flags&=-3}}function rl(n,t=!1){const{dep:e,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),e.subs===n&&(e.subs=r,!r&&e.computed)){e.computed.flags&=-5;for(let i=e.computed.deps;i;i=i.nextDep)rl(i,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function D_(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let ze=!0;const Sd=[];function zn(){Sd.push(ze),ze=!1}function Gn(){const n=Sd.pop();ze=n===void 0?!0:n}function Ju(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=kt;kt=void 0;try{t()}finally{kt=e}}}let si=0;class N_{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class sl{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!kt||!ze||kt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==kt)e=this.activeLink=new N_(kt,this),kt.deps?(e.prevDep=kt.depsTail,kt.depsTail.nextDep=e,kt.depsTail=e):kt.deps=kt.depsTail=e,Pd(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const r=e.nextDep;r.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=r),e.prevDep=kt.depsTail,e.nextDep=void 0,kt.depsTail.nextDep=e,kt.depsTail=e,kt.deps===e&&(kt.deps=r)}return e}trigger(t){this.version++,si++,this.notify(t)}notify(t){el();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{nl()}}}function Pd(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)Pd(r)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const vo=new WeakMap,lr=Symbol(""),lc=Symbol(""),ii=Symbol("");function fe(n,t,e){if(ze&&kt){let r=vo.get(n);r||vo.set(n,r=new Map);let s=r.get(e);s||(r.set(e,s=new sl),s.map=r,s.key=e),s.track()}}function un(n,t,e,r,s,i){const o=vo.get(n);if(!o){si++;return}const c=l=>{l&&l.trigger()};if(el(),t==="clear")o.forEach(c);else{const l=ht(n),u=l&&Xc(e);if(l&&e==="length"){const f=Number(r);o.forEach((p,g)=>{(g==="length"||g===ii||!$n(g)&&g>=f)&&c(p)})}else switch((e!==void 0||o.has(void 0))&&c(o.get(e)),u&&c(o.get(ii)),t){case"add":l?u&&c(o.get("length")):(c(o.get(lr)),Qr(n)&&c(o.get(lc)));break;case"delete":l||(c(o.get(lr)),Qr(n)&&c(o.get(lc)));break;case"set":Qr(n)&&c(o.get(lr));break}}nl()}function k_(n,t){const e=vo.get(n);return e&&e.get(t)}function Nr(n){const t=It(n);return t===n?t:(fe(t,"iterate",ii),Be(n)?t:t.map(de))}function Jo(n){return fe(n=It(n),"iterate",ii),n}const O_={__proto__:null,[Symbol.iterator](){return Ua(this,Symbol.iterator,de)},concat(...n){return Nr(this).concat(...n.map(t=>ht(t)?Nr(t):t))},entries(){return Ua(this,"entries",n=>(n[1]=de(n[1]),n))},every(n,t){return on(this,"every",n,t,void 0,arguments)},filter(n,t){return on(this,"filter",n,t,e=>e.map(de),arguments)},find(n,t){return on(this,"find",n,t,de,arguments)},findIndex(n,t){return on(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return on(this,"findLast",n,t,de,arguments)},findLastIndex(n,t){return on(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return on(this,"forEach",n,t,void 0,arguments)},includes(...n){return ja(this,"includes",n)},indexOf(...n){return ja(this,"indexOf",n)},join(n){return Nr(this).join(n)},lastIndexOf(...n){return ja(this,"lastIndexOf",n)},map(n,t){return on(this,"map",n,t,void 0,arguments)},pop(){return xs(this,"pop")},push(...n){return xs(this,"push",n)},reduce(n,...t){return Yu(this,"reduce",n,t)},reduceRight(n,...t){return Yu(this,"reduceRight",n,t)},shift(){return xs(this,"shift")},some(n,t){return on(this,"some",n,t,void 0,arguments)},splice(...n){return xs(this,"splice",n)},toReversed(){return Nr(this).toReversed()},toSorted(n){return Nr(this).toSorted(n)},toSpliced(...n){return Nr(this).toSpliced(...n)},unshift(...n){return xs(this,"unshift",n)},values(){return Ua(this,"values",de)}};function Ua(n,t,e){const r=Jo(n),s=r[t]();return r!==n&&!Be(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=e(i.value)),i}),s}const M_=Array.prototype;function on(n,t,e,r,s,i){const o=Jo(n),c=o!==n&&!Be(n),l=o[t];if(l!==M_[t]){const p=l.apply(n,i);return c?de(p):p}let u=e;o!==n&&(c?u=function(p,g){return e.call(this,de(p),g,n)}:e.length>2&&(u=function(p,g){return e.call(this,p,g,n)}));const f=l.call(o,u,r);return c&&s?s(f):f}function Yu(n,t,e,r){const s=Jo(n);let i=e;return s!==n&&(Be(n)?e.length>3&&(i=function(o,c,l){return e.call(this,o,c,l,n)}):i=function(o,c,l){return e.call(this,o,de(c),l,n)}),s[t](i,...r)}function ja(n,t,e){const r=It(n);fe(r,"iterate",ii);const s=r[t](...e);return(s===-1||s===!1)&&al(e[0])?(e[0]=It(e[0]),r[t](...e)):s}function xs(n,t,e=[]){zn(),el();const r=It(n)[t].apply(n,e);return nl(),Gn(),r}const F_=Qc("__proto__,__v_isRef,__isVue"),Cd=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter($n));function L_(n){$n(n)||(n=String(n));const t=It(this);return fe(t,"has",n),t.hasOwnProperty(n)}class xd{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,r){const s=this._isReadonly,i=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return i;if(e==="__v_raw")return r===(s?i?W_:kd:i?Nd:Dd).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=ht(t);if(!s){let l;if(o&&(l=O_[e]))return l;if(e==="hasOwnProperty")return L_}const c=Reflect.get(t,e,qt(t)?t:r);return($n(e)?Cd.has(e):F_(e))||(s||fe(t,"get",e),i)?c:qt(c)?o&&Xc(e)?c:c.value:Mt(c)?s?Md(c):wi(c):c}}class Vd extends xd{constructor(t=!1){super(!1,t)}set(t,e,r,s){let i=t[e];if(!this._isShallow){const l=mr(i);if(!Be(r)&&!mr(r)&&(i=It(i),r=It(r)),!ht(t)&&qt(i)&&!qt(r))return l?!1:(i.value=r,!0)}const o=ht(t)&&Xc(e)?Number(e)<t.length:At(t,e),c=Reflect.set(t,e,r,qt(t)?t:s);return t===It(s)&&(o?On(r,i)&&un(t,"set",e,r):un(t,"add",e,r)),c}deleteProperty(t,e){const r=At(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&r&&un(t,"delete",e,void 0),s}has(t,e){const r=Reflect.has(t,e);return(!$n(e)||!Cd.has(e))&&fe(t,"has",e),r}ownKeys(t){return fe(t,"iterate",ht(t)?"length":lr),Reflect.ownKeys(t)}}class B_ extends xd{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const U_=new Vd,j_=new B_,q_=new Vd(!0);const uc=n=>n,Wi=n=>Reflect.getPrototypeOf(n);function $_(n,t,e){return function(...r){const s=this.__v_raw,i=It(s),o=Qr(i),c=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=s[n](...r),f=e?uc:t?hc:de;return!t&&fe(i,"iterate",l?lc:lr),{next(){const{value:p,done:g}=u.next();return g?{value:p,done:g}:{value:c?[f(p[0]),f(p[1])]:f(p),done:g}},[Symbol.iterator](){return this}}}}function Qi(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function K_(n,t){const e={get(s){const i=this.__v_raw,o=It(i),c=It(s);n||(On(s,c)&&fe(o,"get",s),fe(o,"get",c));const{has:l}=Wi(o),u=t?uc:n?hc:de;if(l.call(o,s))return u(i.get(s));if(l.call(o,c))return u(i.get(c));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&fe(It(s),"iterate",lr),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=It(i),c=It(s);return n||(On(s,c)&&fe(o,"has",s),fe(o,"has",c)),s===c?i.has(s):i.has(s)||i.has(c)},forEach(s,i){const o=this,c=o.__v_raw,l=It(c),u=t?uc:n?hc:de;return!n&&fe(l,"iterate",lr),c.forEach((f,p)=>s.call(i,u(f),u(p),o))}};return te(e,n?{add:Qi("add"),set:Qi("set"),delete:Qi("delete"),clear:Qi("clear")}:{add(s){!t&&!Be(s)&&!mr(s)&&(s=It(s));const i=It(this);return Wi(i).has.call(i,s)||(i.add(s),un(i,"add",s,s)),this},set(s,i){!t&&!Be(i)&&!mr(i)&&(i=It(i));const o=It(this),{has:c,get:l}=Wi(o);let u=c.call(o,s);u||(s=It(s),u=c.call(o,s));const f=l.call(o,s);return o.set(s,i),u?On(i,f)&&un(o,"set",s,i):un(o,"add",s,i),this},delete(s){const i=It(this),{has:o,get:c}=Wi(i);let l=o.call(i,s);l||(s=It(s),l=o.call(i,s)),c&&c.call(i,s);const u=i.delete(s);return l&&un(i,"delete",s,void 0),u},clear(){const s=It(this),i=s.size!==0,o=s.clear();return i&&un(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=$_(s,n,t)}),e}function il(n,t){const e=K_(n,t);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(At(e,s)&&s in r?e:r,s,i)}const z_={get:il(!1,!1)},G_={get:il(!1,!0)},H_={get:il(!0,!1)};const Dd=new WeakMap,Nd=new WeakMap,kd=new WeakMap,W_=new WeakMap;function Q_(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function J_(n){return n.__v_skip||!Object.isExtensible(n)?0:Q_(I_(n))}function wi(n){return mr(n)?n:ol(n,!1,U_,z_,Dd)}function Od(n){return ol(n,!1,q_,G_,Nd)}function Md(n){return ol(n,!0,j_,H_,kd)}function ol(n,t,e,r,s){if(!Mt(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const i=s.get(n);if(i)return i;const o=J_(n);if(o===0)return n;const c=new Proxy(n,o===2?r:e);return s.set(n,c),c}function dn(n){return mr(n)?dn(n.__v_raw):!!(n&&n.__v_isReactive)}function mr(n){return!!(n&&n.__v_isReadonly)}function Be(n){return!!(n&&n.__v_isShallow)}function al(n){return n?!!n.__v_raw:!1}function It(n){const t=n&&n.__v_raw;return t?It(t):n}function cl(n){return!At(n,"__v_skip")&&Object.isExtensible(n)&&pd(n,"__v_skip",!0),n}const de=n=>Mt(n)?wi(n):n,hc=n=>Mt(n)?Md(n):n;function qt(n){return n?n.__v_isRef===!0:!1}function ur(n){return Fd(n,!1)}function Y_(n){return Fd(n,!0)}function Fd(n,t){return qt(n)?n:new X_(n,t)}class X_{constructor(t,e){this.dep=new sl,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:It(t),this._value=e?t:de(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,r=this.__v_isShallow||Be(t)||mr(t);t=r?t:It(t),On(t,e)&&(this._rawValue=t,this._value=r?t:de(t),this.dep.trigger())}}function hr(n){return qt(n)?n.value:n}const Z_={get:(n,t,e)=>t==="__v_raw"?n:hr(Reflect.get(n,t,e)),set:(n,t,e,r)=>{const s=n[t];return qt(s)&&!qt(e)?(s.value=e,!0):Reflect.set(n,t,e,r)}};function Ld(n){return dn(n)?n:new Proxy(n,Z_)}function ty(n){const t=ht(n)?new Array(n.length):{};for(const e in n)t[e]=Bd(n,e);return t}class ey{constructor(t,e,r){this._object=t,this._key=e,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return k_(It(this._object),this._key)}}class ny{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function ry(n,t,e){return qt(n)?n:ft(n)?new ny(n):Mt(n)&&arguments.length>1?Bd(n,t,e):ur(n)}function Bd(n,t,e){const r=n[t];return qt(r)?r:new ey(n,t,e)}class sy{constructor(t,e,r){this.fn=t,this.setter=e,this._value=void 0,this.dep=new sl(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=si-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&kt!==this)return wd(this,!0),!0}get value(){const t=this.dep.track();return Rd(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function iy(n,t,e=!1){let r,s;return ft(n)?r=n:(r=n.get,s=n.set),new sy(r,s,e)}const Ji={},Io=new WeakMap;let nr;function oy(n,t=!1,e=nr){if(e){let r=Io.get(e);r||Io.set(e,r=[]),r.push(n)}}function ay(n,t,e=Dt){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:c,call:l}=e,u=K=>s?K:Be(K)||s===!1||s===0?hn(K,1):hn(K);let f,p,g,_,P=!1,x=!1;if(qt(n)?(p=()=>n.value,P=Be(n)):dn(n)?(p=()=>u(n),P=!0):ht(n)?(x=!0,P=n.some(K=>dn(K)||Be(K)),p=()=>n.map(K=>{if(qt(K))return K.value;if(dn(K))return u(K);if(ft(K))return l?l(K,2):K()})):ft(n)?t?p=l?()=>l(n,2):n:p=()=>{if(g){zn();try{g()}finally{Gn()}}const K=nr;nr=f;try{return l?l(n,3,[_]):n(_)}finally{nr=K}}:p=tn,t&&s){const K=p,tt=s===!0?1/0:s;p=()=>hn(K(),tt)}const N=vd(),U=()=>{f.stop(),N&&Yc(N.effects,f)};if(i&&t){const K=t;t=(...tt)=>{K(...tt),U()}}let L=x?new Array(n.length).fill(Ji):Ji;const k=K=>{if(!(!(f.flags&1)||!f.dirty&&!K))if(t){const tt=f.run();if(s||P||(x?tt.some((ct,w)=>On(ct,L[w])):On(tt,L))){g&&g();const ct=nr;nr=f;try{const w=[tt,L===Ji?void 0:x&&L[0]===Ji?[]:L,_];l?l(t,3,w):t(...w),L=tt}finally{nr=ct}}}else f.run()};return c&&c(k),f=new Id(p),f.scheduler=o?()=>o(k,!1):k,_=K=>oy(K,!1,f),g=f.onStop=()=>{const K=Io.get(f);if(K){if(l)l(K,4);else for(const tt of K)tt();Io.delete(f)}},t?r?k(!0):L=f.run():o?o(k.bind(null,!0),!0):f.run(),U.pause=f.pause.bind(f),U.resume=f.resume.bind(f),U.stop=U,U}function hn(n,t=1/0,e){if(t<=0||!Mt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,qt(n))hn(n.value,t,e);else if(ht(n))for(let r=0;r<n.length;r++)hn(n[r],t,e);else if(ud(n)||Qr(n))n.forEach(r=>{hn(r,t,e)});else if(dd(n)){for(const r in n)hn(n[r],t,e);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&hn(n[r],t,e)}return n}/**
* @vue/runtime-core v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function bi(n,t,e,r){try{return r?n(...r):n()}catch(s){Ai(s,t,e)}}function en(n,t,e,r){if(ft(n)){const s=bi(n,t,e,r);return s&&hd(s)&&s.catch(i=>{Ai(i,t,e)}),s}if(ht(n)){const s=[];for(let i=0;i<n.length;i++)s.push(en(n[i],t,e,r));return s}}function Ai(n,t,e,r=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Dt;if(t){let c=t.parent;const l=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;c;){const f=c.ec;if(f){for(let p=0;p<f.length;p++)if(f[p](n,l,u)===!1)return}c=c.parent}if(i){zn(),bi(i,null,10,[n,l,u]),Gn();return}}cy(n,e,s,r,o)}function cy(n,t,e,r=!0,s=!1){if(s)throw n;console.error(n)}const Ee=[];let Je=-1;const Jr=[];let xn=null,Br=0;const Ud=Promise.resolve();let To=null;function ll(n){const t=To||Ud;return n?t.then(this?n.bind(this):n):t}function ly(n){let t=Je+1,e=Ee.length;for(;t<e;){const r=t+e>>>1,s=Ee[r],i=oi(s);i<n||i===n&&s.flags&2?t=r+1:e=r}return t}function ul(n){if(!(n.flags&1)){const t=oi(n),e=Ee[Ee.length-1];!e||!(n.flags&2)&&t>=oi(e)?Ee.push(n):Ee.splice(ly(t),0,n),n.flags|=1,jd()}}function jd(){To||(To=Ud.then($d))}function uy(n){ht(n)?Jr.push(...n):xn&&n.id===-1?xn.splice(Br+1,0,n):n.flags&1||(Jr.push(n),n.flags|=1),jd()}function Xu(n,t,e=Je+1){for(;e<Ee.length;e++){const r=Ee[e];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Ee.splice(e,1),e--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function qd(n){if(Jr.length){const t=[...new Set(Jr)].sort((e,r)=>oi(e)-oi(r));if(Jr.length=0,xn){xn.push(...t);return}for(xn=t,Br=0;Br<xn.length;Br++){const e=xn[Br];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}xn=null,Br=0}}const oi=n=>n.id==null?n.flags&2?-1:1/0:n.id;function $d(n){try{for(Je=0;Je<Ee.length;Je++){const t=Ee[Je];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),bi(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Je<Ee.length;Je++){const t=Ee[Je];t&&(t.flags&=-2)}Je=-1,Ee.length=0,qd(),To=null,(Ee.length||Jr.length)&&$d()}}let Re=null,Kd=null;function wo(n){const t=Re;return Re=n,Kd=n&&n.type.__scopeId||null,t}function hy(n,t=Re,e){if(!t||n._n)return n;const r=(...s)=>{r._d&&ch(-1);const i=wo(t);let o;try{o=n(...s)}finally{wo(i),r._d&&ch(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function DA(n,t){if(Re===null)return n;const e=ea(Re),r=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[i,o,c,l=Dt]=t[s];i&&(ft(i)&&(i={mounted:i,updated:i}),i.deep&&hn(o),r.push({dir:i,instance:e,value:o,oldValue:void 0,arg:c,modifiers:l}))}return n}function Zn(n,t,e,r){const s=n.dirs,i=t&&t.dirs;for(let o=0;o<s.length;o++){const c=s[o];i&&(c.oldValue=i[o].value);let l=c.dir[r];l&&(zn(),en(l,e,8,[n.el,c,n,t]),Gn())}}const fy=Symbol("_vte"),dy=n=>n.__isTeleport;function hl(n,t){n.shapeFlag&6&&n.component?(n.transition=t,hl(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}/*! #__NO_SIDE_EFFECTS__ */function Yo(n,t){return ft(n)?te({name:n.name},t,{setup:n}):n}function fl(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function fc(n,t,e,r,s=!1){if(ht(n)){n.forEach((P,x)=>fc(P,t&&(ht(t)?t[x]:t),e,r,s));return}if(Gs(r)&&!s)return;const i=r.shapeFlag&4?ea(r.component):r.el,o=s?null:i,{i:c,r:l}=n,u=t&&t.r,f=c.refs===Dt?c.refs={}:c.refs,p=c.setupState,g=It(p),_=p===Dt?()=>!1:P=>At(g,P);if(u!=null&&u!==l&&(Ht(u)?(f[u]=null,_(u)&&(p[u]=null)):qt(u)&&(u.value=null)),ft(l))bi(l,c,12,[o,f]);else{const P=Ht(l),x=qt(l);if(P||x){const N=()=>{if(n.f){const U=P?_(l)?p[l]:f[l]:l.value;s?ht(U)&&Yc(U,i):ht(U)?U.includes(i)||U.push(i):P?(f[l]=[i],_(l)&&(p[l]=f[l])):(l.value=[i],n.k&&(f[n.k]=l.value))}else P?(f[l]=o,_(l)&&(p[l]=o)):x&&(l.value=o,n.k&&(f[n.k]=o))};o?(N.id=-1,Ce(N,e)):N()}}}const Zu=n=>n.nodeType===8;Qo().requestIdleCallback;Qo().cancelIdleCallback;function py(n,t){if(Zu(n)&&n.data==="["){let e=1,r=n.nextSibling;for(;r;){if(r.nodeType===1){if(t(r)===!1)break}else if(Zu(r))if(r.data==="]"){if(--e===0)break}else r.data==="["&&e++;r=r.nextSibling}}else t(n)}const Gs=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function my(n){ft(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:r,delay:s=200,hydrate:i,timeout:o,suspensible:c=!0,onError:l}=n;let u=null,f,p=0;const g=()=>(p++,u=null,_()),_=()=>{let P;return u||(P=u=t().catch(x=>{if(x=x instanceof Error?x:new Error(String(x)),l)return new Promise((N,U)=>{l(x,()=>N(g()),()=>U(x),p+1)});throw x}).then(x=>P!==u&&u?u:(x&&(x.__esModule||x[Symbol.toStringTag]==="Module")&&(x=x.default),f=x,x)))};return Yo({name:"AsyncComponentWrapper",__asyncLoader:_,__asyncHydrate(P,x,N){const U=i?()=>{const L=i(N,k=>py(P,k));L&&(x.bum||(x.bum=[])).push(L)}:N;f?U():_().then(()=>!x.isUnmounted&&U())},get __asyncResolved(){return f},setup(){const P=Zt;if(fl(P),f)return()=>qa(f,P);const x=k=>{u=null,Ai(k,P,13,!r)};if(c&&P.suspense||ts)return _().then(k=>()=>qa(k,P)).catch(k=>(x(k),()=>r?Qt(r,{error:k}):null));const N=ur(!1),U=ur(),L=ur(!!s);return s&&setTimeout(()=>{L.value=!1},s),o!=null&&setTimeout(()=>{if(!N.value&&!U.value){const k=new Error(`Async component timed out after ${o}ms.`);x(k),U.value=k}},o),_().then(()=>{N.value=!0,P.parent&&dl(P.parent.vnode)&&P.parent.update()}).catch(k=>{x(k),U.value=k}),()=>{if(N.value&&f)return qa(f,P);if(U.value&&r)return Qt(r,{error:U.value});if(e&&!L.value)return Qt(e)}}})}function qa(n,t){const{ref:e,props:r,children:s,ce:i}=t.vnode,o=Qt(n,r,s);return o.ref=e,o.ce=i,delete t.vnode.ce,o}const dl=n=>n.type.__isKeepAlive;function gy(n,t){zd(n,"a",t)}function _y(n,t){zd(n,"da",t)}function zd(n,t,e=Zt){const r=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Xo(t,r,e),e){let s=e.parent;for(;s&&s.parent;)dl(s.parent.vnode)&&yy(r,t,e,s),s=s.parent}}function yy(n,t,e,r){const s=Xo(t,n,r,!0);Gd(()=>{Yc(r[t],s)},e)}function Xo(n,t,e=Zt,r=!1){if(e){const s=e[n]||(e[n]=[]),i=t.__weh||(t.__weh=(...o)=>{zn();const c=Ri(e),l=en(t,e,n,o);return c(),Gn(),l});return r?s.unshift(i):s.push(i),i}}const yn=n=>(t,e=Zt)=>{(!ts||n==="sp")&&Xo(n,(...r)=>t(...r),e)},Ey=yn("bm"),vy=yn("m"),Iy=yn("bu"),Ty=yn("u"),wy=yn("bum"),Gd=yn("um"),by=yn("sp"),Ay=yn("rtg"),Ry=yn("rtc");function Sy(n,t=Zt){Xo("ec",n,t)}const Py="components";function Cy(n,t){return Vy(Py,n,!0,t)||n}const xy=Symbol.for("v-ndc");function Vy(n,t,e=!0,r=!1){const s=Re||Zt;if(s){const i=s.type;{const c=IE(i,!1);if(c&&(c===t||c===qe(t)||c===Wo(qe(t))))return i}const o=th(s[n]||i[n],t)||th(s.appContext[n],t);return!o&&r?i:o}}function th(n,t){return n&&(n[t]||n[qe(t)]||n[Wo(qe(t))])}function NA(n,t,e,r){let s;const i=e,o=ht(n);if(o||Ht(n)){const c=o&&dn(n);let l=!1;c&&(l=!Be(n),n=Jo(n)),s=new Array(n.length);for(let u=0,f=n.length;u<f;u++)s[u]=t(l?de(n[u]):n[u],u,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let c=0;c<n;c++)s[c]=t(c+1,c,void 0,i)}else if(Mt(n))if(n[Symbol.iterator])s=Array.from(n,(c,l)=>t(c,l,void 0,i));else{const c=Object.keys(n);s=new Array(c.length);for(let l=0,u=c.length;l<u;l++){const f=c[l];s[l]=t(n[f],f,l,i)}}else s=[];return s}const dc=n=>n?dp(n)?ea(n):dc(n.parent):null,Hs=te(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>dc(n.parent),$root:n=>dc(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>pl(n),$forceUpdate:n=>n.f||(n.f=()=>{ul(n.update)}),$nextTick:n=>n.n||(n.n=ll.bind(n.proxy)),$watch:n=>Zy.bind(n)}),$a=(n,t)=>n!==Dt&&!n.__isScriptSetup&&At(n,t),Dy={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:r,data:s,props:i,accessCache:o,type:c,appContext:l}=n;let u;if(t[0]!=="$"){const _=o[t];if(_!==void 0)switch(_){case 1:return r[t];case 2:return s[t];case 4:return e[t];case 3:return i[t]}else{if($a(r,t))return o[t]=1,r[t];if(s!==Dt&&At(s,t))return o[t]=2,s[t];if((u=n.propsOptions[0])&&At(u,t))return o[t]=3,i[t];if(e!==Dt&&At(e,t))return o[t]=4,e[t];pc&&(o[t]=0)}}const f=Hs[t];let p,g;if(f)return t==="$attrs"&&fe(n.attrs,"get",""),f(n);if((p=c.__cssModules)&&(p=p[t]))return p;if(e!==Dt&&At(e,t))return o[t]=4,e[t];if(g=l.config.globalProperties,At(g,t))return g[t]},set({_:n},t,e){const{data:r,setupState:s,ctx:i}=n;return $a(s,t)?(s[t]=e,!0):r!==Dt&&At(r,t)?(r[t]=e,!0):At(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(i[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:r,appContext:s,propsOptions:i}},o){let c;return!!e[o]||n!==Dt&&At(n,o)||$a(t,o)||(c=i[0])&&At(c,o)||At(r,o)||At(Hs,o)||At(s.config.globalProperties,o)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:At(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function eh(n){return ht(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let pc=!0;function Ny(n){const t=pl(n),e=n.proxy,r=n.ctx;pc=!1,t.beforeCreate&&nh(t.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:c,provide:l,inject:u,created:f,beforeMount:p,mounted:g,beforeUpdate:_,updated:P,activated:x,deactivated:N,beforeDestroy:U,beforeUnmount:L,destroyed:k,unmounted:K,render:tt,renderTracked:ct,renderTriggered:w,errorCaptured:y,serverPrefetch:v,expose:b,inheritAttrs:A,components:R,directives:T,filters:ee}=t;if(u&&ky(u,r,null),o)for(const ut in o){const gt=o[ut];ft(gt)&&(r[ut]=gt.bind(e))}if(s){const ut=s.call(e,e);Mt(ut)&&(n.data=wi(ut))}if(pc=!0,i)for(const ut in i){const gt=i[ut],Se=ft(gt)?gt.bind(e,e):ft(gt.get)?gt.get.bind(e,e):tn,$e=!ft(gt)&&ft(gt.set)?gt.set.bind(e):tn,ke=Me({get:Se,set:$e});Object.defineProperty(r,ut,{enumerable:!0,configurable:!0,get:()=>ke.value,set:Bt=>ke.value=Bt})}if(c)for(const ut in c)Hd(c[ut],r,e,ut);if(l){const ut=ft(l)?l.call(e):l;Reflect.ownKeys(ut).forEach(gt=>{io(gt,ut[gt])})}f&&nh(f,n,"c");function Nt(ut,gt){ht(gt)?gt.forEach(Se=>ut(Se.bind(e))):gt&&ut(gt.bind(e))}if(Nt(Ey,p),Nt(vy,g),Nt(Iy,_),Nt(Ty,P),Nt(gy,x),Nt(_y,N),Nt(Sy,y),Nt(Ry,ct),Nt(Ay,w),Nt(wy,L),Nt(Gd,K),Nt(by,v),ht(b))if(b.length){const ut=n.exposed||(n.exposed={});b.forEach(gt=>{Object.defineProperty(ut,gt,{get:()=>e[gt],set:Se=>e[gt]=Se})})}else n.exposed||(n.exposed={});tt&&n.render===tn&&(n.render=tt),A!=null&&(n.inheritAttrs=A),R&&(n.components=R),T&&(n.directives=T),v&&fl(n)}function ky(n,t,e=tn){ht(n)&&(n=mc(n));for(const r in n){const s=n[r];let i;Mt(s)?"default"in s?i=Ue(s.from||r,s.default,!0):i=Ue(s.from||r):i=Ue(s),qt(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[r]=i}}function nh(n,t,e){en(ht(n)?n.map(r=>r.bind(t.proxy)):n.bind(t.proxy),t,e)}function Hd(n,t,e,r){let s=r.includes(".")?op(e,r):()=>e[r];if(Ht(n)){const i=t[n];ft(i)&&Ws(s,i)}else if(ft(n))Ws(s,n.bind(e));else if(Mt(n))if(ht(n))n.forEach(i=>Hd(i,t,e,r));else{const i=ft(n.handler)?n.handler.bind(e):t[n.handler];ft(i)&&Ws(s,i,n)}}function pl(n){const t=n.type,{mixins:e,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,c=i.get(t);let l;return c?l=c:!s.length&&!e&&!r?l=t:(l={},s.length&&s.forEach(u=>bo(l,u,o,!0)),bo(l,t,o)),Mt(t)&&i.set(t,l),l}function bo(n,t,e,r=!1){const{mixins:s,extends:i}=t;i&&bo(n,i,e,!0),s&&s.forEach(o=>bo(n,o,e,!0));for(const o in t)if(!(r&&o==="expose")){const c=Oy[o]||e&&e[o];n[o]=c?c(n[o],t[o]):t[o]}return n}const Oy={data:rh,props:sh,emits:sh,methods:Ls,computed:Ls,beforeCreate:_e,created:_e,beforeMount:_e,mounted:_e,beforeUpdate:_e,updated:_e,beforeDestroy:_e,beforeUnmount:_e,destroyed:_e,unmounted:_e,activated:_e,deactivated:_e,errorCaptured:_e,serverPrefetch:_e,components:Ls,directives:Ls,watch:Fy,provide:rh,inject:My};function rh(n,t){return t?n?function(){return te(ft(n)?n.call(this,this):n,ft(t)?t.call(this,this):t)}:t:n}function My(n,t){return Ls(mc(n),mc(t))}function mc(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function _e(n,t){return n?[...new Set([].concat(n,t))]:t}function Ls(n,t){return n?te(Object.create(null),n,t):t}function sh(n,t){return n?ht(n)&&ht(t)?[...new Set([...n,...t])]:te(Object.create(null),eh(n),eh(t??{})):t}function Fy(n,t){if(!n)return t;if(!t)return n;const e=te(Object.create(null),n);for(const r in t)e[r]=_e(n[r],t[r]);return e}function Wd(){return{app:null,config:{isNativeTag:E_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ly=0;function By(n,t){return function(r,s=null){ft(r)||(r=te({},r)),s!=null&&!Mt(s)&&(s=null);const i=Wd(),o=new WeakSet,c=[];let l=!1;const u=i.app={_uid:Ly++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:wE,get config(){return i.config},set config(f){},use(f,...p){return o.has(f)||(f&&ft(f.install)?(o.add(f),f.install(u,...p)):ft(f)&&(o.add(f),f(u,...p))),u},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),u},component(f,p){return p?(i.components[f]=p,u):i.components[f]},directive(f,p){return p?(i.directives[f]=p,u):i.directives[f]},mount(f,p,g){if(!l){const _=u._ceVNode||Qt(r,s);return _.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),p&&t?t(_,f):n(_,f,g),l=!0,u._container=f,f.__vue_app__=u,ea(_.component)}},onUnmount(f){c.push(f)},unmount(){l&&(en(c,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(f,p){return i.provides[f]=p,u},runWithContext(f){const p=fr;fr=u;try{return f()}finally{fr=p}}};return u}}let fr=null;function io(n,t){if(Zt){let e=Zt.provides;const r=Zt.parent&&Zt.parent.provides;r===e&&(e=Zt.provides=Object.create(r)),e[n]=t}}function Ue(n,t,e=!1){const r=Zt||Re;if(r||fr){const s=fr?fr._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&ft(t)?t.call(r&&r.proxy):t}}function Uy(){return!!(Zt||Re||fr)}const Qd={},Jd=()=>Object.create(Qd),Yd=n=>Object.getPrototypeOf(n)===Qd;function jy(n,t,e,r=!1){const s={},i=Jd();n.propsDefaults=Object.create(null),Xd(n,t,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);e?n.props=r?s:Od(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function qy(n,t,e,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,c=It(s),[l]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const f=n.vnode.dynamicProps;for(let p=0;p<f.length;p++){let g=f[p];if(Zo(n.emitsOptions,g))continue;const _=t[g];if(l)if(At(i,g))_!==i[g]&&(i[g]=_,u=!0);else{const P=qe(g);s[P]=gc(l,c,P,_,n,!1)}else _!==i[g]&&(i[g]=_,u=!0)}}}else{Xd(n,t,s,i)&&(u=!0);let f;for(const p in c)(!t||!At(t,p)&&((f=Kn(p))===p||!At(t,f)))&&(l?e&&(e[p]!==void 0||e[f]!==void 0)&&(s[p]=gc(l,c,p,void 0,n,!0)):delete s[p]);if(i!==c)for(const p in i)(!t||!At(t,p))&&(delete i[p],u=!0)}u&&un(n.attrs,"set","")}function Xd(n,t,e,r){const[s,i]=n.propsOptions;let o=!1,c;if(t)for(let l in t){if($s(l))continue;const u=t[l];let f;s&&At(s,f=qe(l))?!i||!i.includes(f)?e[f]=u:(c||(c={}))[f]=u:Zo(n.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(i){const l=It(e),u=c||Dt;for(let f=0;f<i.length;f++){const p=i[f];e[p]=gc(s,l,p,u[p],n,!At(u,p))}}return o}function gc(n,t,e,r,s,i){const o=n[e];if(o!=null){const c=At(o,"default");if(c&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ft(l)){const{propsDefaults:u}=s;if(e in u)r=u[e];else{const f=Ri(s);r=u[e]=l.call(null,t),f()}}else r=l;s.ce&&s.ce._setProp(e,r)}o[0]&&(i&&!c?r=!1:o[1]&&(r===""||r===Kn(e))&&(r=!0))}return r}const $y=new WeakMap;function Zd(n,t,e=!1){const r=e?$y:t.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},c=[];let l=!1;if(!ft(n)){const f=p=>{l=!0;const[g,_]=Zd(p,t,!0);te(o,g),_&&c.push(..._)};!e&&t.mixins.length&&t.mixins.forEach(f),n.extends&&f(n.extends),n.mixins&&n.mixins.forEach(f)}if(!i&&!l)return Mt(n)&&r.set(n,Wr),Wr;if(ht(i))for(let f=0;f<i.length;f++){const p=qe(i[f]);ih(p)&&(o[p]=Dt)}else if(i)for(const f in i){const p=qe(f);if(ih(p)){const g=i[f],_=o[p]=ht(g)||ft(g)?{type:g}:te({},g),P=_.type;let x=!1,N=!0;if(ht(P))for(let U=0;U<P.length;++U){const L=P[U],k=ft(L)&&L.name;if(k==="Boolean"){x=!0;break}else k==="String"&&(N=!1)}else x=ft(P)&&P.name==="Boolean";_[0]=x,_[1]=N,(x||At(_,"default"))&&c.push(p)}}const u=[o,c];return Mt(n)&&r.set(n,u),u}function ih(n){return n[0]!=="$"&&!$s(n)}const tp=n=>n[0]==="_"||n==="$stable",ml=n=>ht(n)?n.map(Ye):[Ye(n)],Ky=(n,t,e)=>{if(t._n)return t;const r=hy((...s)=>ml(t(...s)),e);return r._c=!1,r},ep=(n,t,e)=>{const r=n._ctx;for(const s in n){if(tp(s))continue;const i=n[s];if(ft(i))t[s]=Ky(s,i,r);else if(i!=null){const o=ml(i);t[s]=()=>o}}},np=(n,t)=>{const e=ml(t);n.slots.default=()=>e},rp=(n,t,e)=>{for(const r in t)(e||r!=="_")&&(n[r]=t[r])},zy=(n,t,e)=>{const r=n.slots=Jd();if(n.vnode.shapeFlag&32){const s=t._;s?(rp(r,t,e),e&&pd(r,"_",s,!0)):ep(t,r)}else t&&np(n,t)},Gy=(n,t,e)=>{const{vnode:r,slots:s}=n;let i=!0,o=Dt;if(r.shapeFlag&32){const c=t._;c?e&&c===1?i=!1:rp(s,t,e):(i=!t.$stable,ep(t,s)),o=t}else t&&(np(n,t),o={default:1});if(i)for(const c in s)!tp(c)&&o[c]==null&&delete s[c]},Ce=oE;function Hy(n){return Wy(n)}function Wy(n,t){const e=Qo();e.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:c,createComment:l,setText:u,setElementText:f,parentNode:p,nextSibling:g,setScopeId:_=tn,insertStaticContent:P}=n,x=(E,I,V,B=null,O=null,j=null,W=void 0,G=null,z=!!I.dynamicChildren)=>{if(E===I)return;E&&!Vs(E,I)&&(B=M(E),Bt(E,O,j,!0),E=null),I.patchFlag===-2&&(z=!1,I.dynamicChildren=null);const{type:q,ref:at,shapeFlag:J}=I;switch(q){case ta:N(E,I,V,B);break;case gr:U(E,I,V,B);break;case oo:E==null&&L(I,V,B,W);break;case ln:R(E,I,V,B,O,j,W,G,z);break;default:J&1?tt(E,I,V,B,O,j,W,G,z):J&6?T(E,I,V,B,O,j,W,G,z):(J&64||J&128)&&q.process(E,I,V,B,O,j,W,G,z,et)}at!=null&&O&&fc(at,E&&E.ref,j,I||E,!I)},N=(E,I,V,B)=>{if(E==null)r(I.el=c(I.children),V,B);else{const O=I.el=E.el;I.children!==E.children&&u(O,I.children)}},U=(E,I,V,B)=>{E==null?r(I.el=l(I.children||""),V,B):I.el=E.el},L=(E,I,V,B)=>{[E.el,E.anchor]=P(E.children,I,V,B,E.el,E.anchor)},k=({el:E,anchor:I},V,B)=>{let O;for(;E&&E!==I;)O=g(E),r(E,V,B),E=O;r(I,V,B)},K=({el:E,anchor:I})=>{let V;for(;E&&E!==I;)V=g(E),s(E),E=V;s(I)},tt=(E,I,V,B,O,j,W,G,z)=>{I.type==="svg"?W="svg":I.type==="math"&&(W="mathml"),E==null?ct(I,V,B,O,j,W,G,z):v(E,I,O,j,W,G,z)},ct=(E,I,V,B,O,j,W,G)=>{let z,q;const{props:at,shapeFlag:J,transition:st,dirs:nt}=E;if(z=E.el=o(E.type,j,at&&at.is,at),J&8?f(z,E.children):J&16&&y(E.children,z,null,B,O,Ka(E,j),W,G),nt&&Zn(E,null,B,"created"),w(z,E,E.scopeId,W,B),at){for(const bt in at)bt!=="value"&&!$s(bt)&&i(z,bt,null,at[bt],j,B);"value"in at&&i(z,"value",null,at.value,j),(q=at.onVnodeBeforeMount)&&Qe(q,B,E)}nt&&Zn(E,null,B,"beforeMount");const lt=Qy(O,st);lt&&st.beforeEnter(z),r(z,I,V),((q=at&&at.onVnodeMounted)||lt||nt)&&Ce(()=>{q&&Qe(q,B,E),lt&&st.enter(z),nt&&Zn(E,null,B,"mounted")},O)},w=(E,I,V,B,O)=>{if(V&&_(E,V),B)for(let j=0;j<B.length;j++)_(E,B[j]);if(O){let j=O.subTree;if(I===j||cp(j.type)&&(j.ssContent===I||j.ssFallback===I)){const W=O.vnode;w(E,W,W.scopeId,W.slotScopeIds,O.parent)}}},y=(E,I,V,B,O,j,W,G,z=0)=>{for(let q=z;q<E.length;q++){const at=E[q]=G?Vn(E[q]):Ye(E[q]);x(null,at,I,V,B,O,j,W,G)}},v=(E,I,V,B,O,j,W)=>{const G=I.el=E.el;let{patchFlag:z,dynamicChildren:q,dirs:at}=I;z|=E.patchFlag&16;const J=E.props||Dt,st=I.props||Dt;let nt;if(V&&tr(V,!1),(nt=st.onVnodeBeforeUpdate)&&Qe(nt,V,I,E),at&&Zn(I,E,V,"beforeUpdate"),V&&tr(V,!0),(J.innerHTML&&st.innerHTML==null||J.textContent&&st.textContent==null)&&f(G,""),q?b(E.dynamicChildren,q,G,V,B,Ka(I,O),j):W||gt(E,I,G,null,V,B,Ka(I,O),j,!1),z>0){if(z&16)A(G,J,st,V,O);else if(z&2&&J.class!==st.class&&i(G,"class",null,st.class,O),z&4&&i(G,"style",J.style,st.style,O),z&8){const lt=I.dynamicProps;for(let bt=0;bt<lt.length;bt++){const Tt=lt[bt],oe=J[Tt],Yt=st[Tt];(Yt!==oe||Tt==="value")&&i(G,Tt,oe,Yt,O,V)}}z&1&&E.children!==I.children&&f(G,I.children)}else!W&&q==null&&A(G,J,st,V,O);((nt=st.onVnodeUpdated)||at)&&Ce(()=>{nt&&Qe(nt,V,I,E),at&&Zn(I,E,V,"updated")},B)},b=(E,I,V,B,O,j,W)=>{for(let G=0;G<I.length;G++){const z=E[G],q=I[G],at=z.el&&(z.type===ln||!Vs(z,q)||z.shapeFlag&70)?p(z.el):V;x(z,q,at,null,B,O,j,W,!0)}},A=(E,I,V,B,O)=>{if(I!==V){if(I!==Dt)for(const j in I)!$s(j)&&!(j in V)&&i(E,j,I[j],null,O,B);for(const j in V){if($s(j))continue;const W=V[j],G=I[j];W!==G&&j!=="value"&&i(E,j,G,W,O,B)}"value"in V&&i(E,"value",I.value,V.value,O)}},R=(E,I,V,B,O,j,W,G,z)=>{const q=I.el=E?E.el:c(""),at=I.anchor=E?E.anchor:c("");let{patchFlag:J,dynamicChildren:st,slotScopeIds:nt}=I;nt&&(G=G?G.concat(nt):nt),E==null?(r(q,V,B),r(at,V,B),y(I.children||[],V,at,O,j,W,G,z)):J>0&&J&64&&st&&E.dynamicChildren?(b(E.dynamicChildren,st,V,O,j,W,G),(I.key!=null||O&&I===O.subTree)&&sp(E,I,!0)):gt(E,I,V,at,O,j,W,G,z)},T=(E,I,V,B,O,j,W,G,z)=>{I.slotScopeIds=G,E==null?I.shapeFlag&512?O.ctx.activate(I,V,B,W,z):ee(I,V,B,O,j,W,z):Te(E,I,z)},ee=(E,I,V,B,O,j,W)=>{const G=E.component=gE(E,B,O);if(dl(E)&&(G.ctx.renderer=et),_E(G,!1,W),G.asyncDep){if(O&&O.registerDep(G,Nt,W),!E.el){const z=G.subTree=Qt(gr);U(null,z,I,V)}}else Nt(G,E,I,V,O,j,W)},Te=(E,I,V)=>{const B=I.component=E.component;if(sE(E,I,V))if(B.asyncDep&&!B.asyncResolved){ut(B,I,V);return}else B.next=I,B.update();else I.el=E.el,B.vnode=I},Nt=(E,I,V,B,O,j,W)=>{const G=()=>{if(E.isMounted){let{next:J,bu:st,u:nt,parent:lt,vnode:bt}=E;{const ae=ip(E);if(ae){J&&(J.el=bt.el,ut(E,J,W)),ae.asyncDep.then(()=>{E.isUnmounted||G()});return}}let Tt=J,oe;tr(E,!1),J?(J.el=bt.el,ut(E,J,W)):J=bt,st&&so(st),(oe=J.props&&J.props.onVnodeBeforeUpdate)&&Qe(oe,lt,J,bt),tr(E,!0);const Yt=za(E),ne=E.subTree;E.subTree=Yt,x(ne,Yt,p(ne.el),M(ne),E,O,j),J.el=Yt.el,Tt===null&&iE(E,Yt.el),nt&&Ce(nt,O),(oe=J.props&&J.props.onVnodeUpdated)&&Ce(()=>Qe(oe,lt,J,bt),O)}else{let J;const{el:st,props:nt}=I,{bm:lt,m:bt,parent:Tt,root:oe,type:Yt}=E,ne=Gs(I);if(tr(E,!1),lt&&so(lt),!ne&&(J=nt&&nt.onVnodeBeforeMount)&&Qe(J,Tt,I),tr(E,!0),st&&xt){const ae=()=>{E.subTree=za(E),xt(st,E.subTree,E,O,null)};ne&&Yt.__asyncHydrate?Yt.__asyncHydrate(st,E,ae):ae()}else{oe.ce&&oe.ce._injectChildStyle(Yt);const ae=E.subTree=za(E);x(null,ae,V,B,E,O,j),I.el=ae.el}if(bt&&Ce(bt,O),!ne&&(J=nt&&nt.onVnodeMounted)){const ae=I;Ce(()=>Qe(J,Tt,ae),O)}(I.shapeFlag&256||Tt&&Gs(Tt.vnode)&&Tt.vnode.shapeFlag&256)&&E.a&&Ce(E.a,O),E.isMounted=!0,I=V=B=null}};E.scope.on();const z=E.effect=new Id(G);E.scope.off();const q=E.update=z.run.bind(z),at=E.job=z.runIfDirty.bind(z);at.i=E,at.id=E.uid,z.scheduler=()=>ul(at),tr(E,!0),q()},ut=(E,I,V)=>{I.component=E;const B=E.vnode.props;E.vnode=I,E.next=null,qy(E,I.props,B,V),Gy(E,I.children,V),zn(),Xu(E),Gn()},gt=(E,I,V,B,O,j,W,G,z=!1)=>{const q=E&&E.children,at=E?E.shapeFlag:0,J=I.children,{patchFlag:st,shapeFlag:nt}=I;if(st>0){if(st&128){$e(q,J,V,B,O,j,W,G,z);return}else if(st&256){Se(q,J,V,B,O,j,W,G,z);return}}nt&8?(at&16&&we(q,O,j),J!==q&&f(V,J)):at&16?nt&16?$e(q,J,V,B,O,j,W,G,z):we(q,O,j,!0):(at&8&&f(V,""),nt&16&&y(J,V,B,O,j,W,G,z))},Se=(E,I,V,B,O,j,W,G,z)=>{E=E||Wr,I=I||Wr;const q=E.length,at=I.length,J=Math.min(q,at);let st;for(st=0;st<J;st++){const nt=I[st]=z?Vn(I[st]):Ye(I[st]);x(E[st],nt,V,null,O,j,W,G,z)}q>at?we(E,O,j,!0,!1,J):y(I,V,B,O,j,W,G,z,J)},$e=(E,I,V,B,O,j,W,G,z)=>{let q=0;const at=I.length;let J=E.length-1,st=at-1;for(;q<=J&&q<=st;){const nt=E[q],lt=I[q]=z?Vn(I[q]):Ye(I[q]);if(Vs(nt,lt))x(nt,lt,V,null,O,j,W,G,z);else break;q++}for(;q<=J&&q<=st;){const nt=E[J],lt=I[st]=z?Vn(I[st]):Ye(I[st]);if(Vs(nt,lt))x(nt,lt,V,null,O,j,W,G,z);else break;J--,st--}if(q>J){if(q<=st){const nt=st+1,lt=nt<at?I[nt].el:B;for(;q<=st;)x(null,I[q]=z?Vn(I[q]):Ye(I[q]),V,lt,O,j,W,G,z),q++}}else if(q>st)for(;q<=J;)Bt(E[q],O,j,!0),q++;else{const nt=q,lt=q,bt=new Map;for(q=lt;q<=st;q++){const me=I[q]=z?Vn(I[q]):Ye(I[q]);me.key!=null&&bt.set(me.key,q)}let Tt,oe=0;const Yt=st-lt+1;let ne=!1,ae=0;const In=new Array(Yt);for(q=0;q<Yt;q++)In[q]=0;for(q=nt;q<=J;q++){const me=E[q];if(oe>=Yt){Bt(me,O,j,!0);continue}let Oe;if(me.key!=null)Oe=bt.get(me.key);else for(Tt=lt;Tt<=st;Tt++)if(In[Tt-lt]===0&&Vs(me,I[Tt])){Oe=Tt;break}Oe===void 0?Bt(me,O,j,!0):(In[Oe-lt]=q+1,Oe>=ae?ae=Oe:ne=!0,x(me,I[Oe],V,null,O,j,W,G,z),oe++)}const Sr=ne?Jy(In):Wr;for(Tt=Sr.length-1,q=Yt-1;q>=0;q--){const me=lt+q,Oe=I[me],Pr=me+1<at?I[me+1].el:B;In[q]===0?x(null,Oe,V,Pr,O,j,W,G,z):ne&&(Tt<0||q!==Sr[Tt]?ke(Oe,V,Pr,2):Tt--)}}},ke=(E,I,V,B,O=null)=>{const{el:j,type:W,transition:G,children:z,shapeFlag:q}=E;if(q&6){ke(E.component.subTree,I,V,B);return}if(q&128){E.suspense.move(I,V,B);return}if(q&64){W.move(E,I,V,et);return}if(W===ln){r(j,I,V);for(let J=0;J<z.length;J++)ke(z[J],I,V,B);r(E.anchor,I,V);return}if(W===oo){k(E,I,V);return}if(B!==2&&q&1&&G)if(B===0)G.beforeEnter(j),r(j,I,V),Ce(()=>G.enter(j),O);else{const{leave:J,delayLeave:st,afterLeave:nt}=G,lt=()=>r(j,I,V),bt=()=>{J(j,()=>{lt(),nt&&nt()})};st?st(j,lt,bt):bt()}else r(j,I,V)},Bt=(E,I,V,B=!1,O=!1)=>{const{type:j,props:W,ref:G,children:z,dynamicChildren:q,shapeFlag:at,patchFlag:J,dirs:st,cacheIndex:nt}=E;if(J===-2&&(O=!1),G!=null&&fc(G,null,V,E,!0),nt!=null&&(I.renderCache[nt]=void 0),at&256){I.ctx.deactivate(E);return}const lt=at&1&&st,bt=!Gs(E);let Tt;if(bt&&(Tt=W&&W.onVnodeBeforeUnmount)&&Qe(Tt,I,E),at&6)We(E.component,V,B);else{if(at&128){E.suspense.unmount(V,B);return}lt&&Zn(E,null,I,"beforeUnmount"),at&64?E.type.remove(E,I,V,et,B):q&&!q.hasOnce&&(j!==ln||J>0&&J&64)?we(q,I,V,!1,!0):(j===ln&&J&384||!O&&at&16)&&we(z,I,V),B&&Ut(E)}(bt&&(Tt=W&&W.onVnodeUnmounted)||lt)&&Ce(()=>{Tt&&Qe(Tt,I,E),lt&&Zn(E,null,I,"unmounted")},V)},Ut=E=>{const{type:I,el:V,anchor:B,transition:O}=E;if(I===ln){vn(V,B);return}if(I===oo){K(E);return}const j=()=>{s(V),O&&!O.persisted&&O.afterLeave&&O.afterLeave()};if(E.shapeFlag&1&&O&&!O.persisted){const{leave:W,delayLeave:G}=O,z=()=>W(V,j);G?G(E.el,j,z):z()}else j()},vn=(E,I)=>{let V;for(;E!==I;)V=g(E),s(E),E=V;s(I)},We=(E,I,V)=>{const{bum:B,scope:O,job:j,subTree:W,um:G,m:z,a:q}=E;oh(z),oh(q),B&&so(B),O.stop(),j&&(j.flags|=8,Bt(W,E,I,V)),G&&Ce(G,I),Ce(()=>{E.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},we=(E,I,V,B=!1,O=!1,j=0)=>{for(let W=j;W<E.length;W++)Bt(E[W],I,V,B,O)},M=E=>{if(E.shapeFlag&6)return M(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const I=g(E.anchor||E.el),V=I&&I[fy];return V?g(V):I};let X=!1;const Q=(E,I,V)=>{E==null?I._vnode&&Bt(I._vnode,null,null,!0):x(I._vnode||null,E,I,null,null,null,V),I._vnode=E,X||(X=!0,Xu(),qd(),X=!1)},et={p:x,um:Bt,m:ke,r:Ut,mt:ee,mc:y,pc:gt,pbc:b,n:M,o:n};let yt,xt;return{render:Q,hydrate:yt,createApp:By(Q,yt)}}function Ka({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function tr({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function Qy(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function sp(n,t,e=!1){const r=n.children,s=t.children;if(ht(r)&&ht(s))for(let i=0;i<r.length;i++){const o=r[i];let c=s[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=s[i]=Vn(s[i]),c.el=o.el),!e&&c.patchFlag!==-2&&sp(o,c)),c.type===ta&&(c.el=o.el)}}function Jy(n){const t=n.slice(),e=[0];let r,s,i,o,c;const l=n.length;for(r=0;r<l;r++){const u=n[r];if(u!==0){if(s=e[e.length-1],n[s]<u){t[r]=s,e.push(r);continue}for(i=0,o=e.length-1;i<o;)c=i+o>>1,n[e[c]]<u?i=c+1:o=c;u<n[e[i]]&&(i>0&&(t[r]=e[i-1]),e[i]=r)}}for(i=e.length,o=e[i-1];i-- >0;)e[i]=o,o=t[o];return e}function ip(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ip(t)}function oh(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const Yy=Symbol.for("v-scx"),Xy=()=>Ue(Yy);function kA(n,t){return gl(n,null,t)}function Ws(n,t,e){return gl(n,t,e)}function gl(n,t,e=Dt){const{immediate:r,deep:s,flush:i,once:o}=e,c=te({},e),l=t&&r||!t&&i!=="post";let u;if(ts){if(i==="sync"){const _=Xy();u=_.__watcherHandles||(_.__watcherHandles=[])}else if(!l){const _=()=>{};return _.stop=tn,_.resume=tn,_.pause=tn,_}}const f=Zt;c.call=(_,P,x)=>en(_,f,P,x);let p=!1;i==="post"?c.scheduler=_=>{Ce(_,f&&f.suspense)}:i!=="sync"&&(p=!0,c.scheduler=(_,P)=>{P?_():ul(_)}),c.augmentJob=_=>{t&&(_.flags|=4),p&&(_.flags|=2,f&&(_.id=f.uid,_.i=f))};const g=ay(n,t,c);return ts&&(u?u.push(g):l&&g()),g}function Zy(n,t,e){const r=this.proxy,s=Ht(n)?n.includes(".")?op(r,n):()=>r[n]:n.bind(r,r);let i;ft(t)?i=t:(i=t.handler,e=t);const o=Ri(this),c=gl(s,i.bind(r),e);return o(),c}function op(n,t){const e=t.split(".");return()=>{let r=n;for(let s=0;s<e.length&&r;s++)r=r[e[s]];return r}}const tE=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${qe(t)}Modifiers`]||n[`${Kn(t)}Modifiers`];function eE(n,t,...e){if(n.isUnmounted)return;const r=n.vnode.props||Dt;let s=e;const i=t.startsWith("update:"),o=i&&tE(r,t.slice(7));o&&(o.trim&&(s=e.map(f=>Ht(f)?f.trim():f)),o.number&&(s=e.map(ac)));let c,l=r[c=Fa(t)]||r[c=Fa(qe(t))];!l&&i&&(l=r[c=Fa(Kn(t))]),l&&en(l,n,6,s);const u=r[c+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[c])return;n.emitted[c]=!0,en(u,n,6,s)}}function ap(n,t,e=!1){const r=t.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},c=!1;if(!ft(n)){const l=u=>{const f=ap(u,t,!0);f&&(c=!0,te(o,f))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!c?(Mt(n)&&r.set(n,null),null):(ht(i)?i.forEach(l=>o[l]=null):te(o,i),Mt(n)&&r.set(n,o),o)}function Zo(n,t){return!n||!zo(t)?!1:(t=t.slice(2).replace(/Once$/,""),At(n,t[0].toLowerCase()+t.slice(1))||At(n,Kn(t))||At(n,t))}function za(n){const{type:t,vnode:e,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:c,emit:l,render:u,renderCache:f,props:p,data:g,setupState:_,ctx:P,inheritAttrs:x}=n,N=wo(n);let U,L;try{if(e.shapeFlag&4){const K=s||r,tt=K;U=Ye(u.call(tt,K,f,p,_,g,P)),L=c}else{const K=t;U=Ye(K.length>1?K(p,{attrs:c,slots:o,emit:l}):K(p,null)),L=t.props?c:nE(c)}}catch(K){Qs.length=0,Ai(K,n,1),U=Qt(gr)}let k=U;if(L&&x!==!1){const K=Object.keys(L),{shapeFlag:tt}=k;K.length&&tt&7&&(i&&K.some(Jc)&&(L=rE(L,i)),k=Zr(k,L,!1,!0))}return e.dirs&&(k=Zr(k,null,!1,!0),k.dirs=k.dirs?k.dirs.concat(e.dirs):e.dirs),e.transition&&hl(k,e.transition),U=k,wo(N),U}const nE=n=>{let t;for(const e in n)(e==="class"||e==="style"||zo(e))&&((t||(t={}))[e]=n[e]);return t},rE=(n,t)=>{const e={};for(const r in n)(!Jc(r)||!(r.slice(9)in t))&&(e[r]=n[r]);return e};function sE(n,t,e){const{props:r,children:s,component:i}=n,{props:o,children:c,patchFlag:l}=t,u=i.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return r?ah(r,o,u):!!o;if(l&8){const f=t.dynamicProps;for(let p=0;p<f.length;p++){const g=f[p];if(o[g]!==r[g]&&!Zo(u,g))return!0}}}else return(s||c)&&(!c||!c.$stable)?!0:r===o?!1:r?o?ah(r,o,u):!0:!!o;return!1}function ah(n,t,e){const r=Object.keys(t);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==n[i]&&!Zo(e,i))return!0}return!1}function iE({vnode:n,parent:t},e){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=t.vnode).el=e,t=t.parent;else break}}const cp=n=>n.__isSuspense;function oE(n,t){t&&t.pendingBranch?ht(n)?t.effects.push(...n):t.effects.push(n):uy(n)}const ln=Symbol.for("v-fgt"),ta=Symbol.for("v-txt"),gr=Symbol.for("v-cmt"),oo=Symbol.for("v-stc"),Qs=[];let xe=null;function _c(n=!1){Qs.push(xe=n?null:[])}function aE(){Qs.pop(),xe=Qs[Qs.length-1]||null}let ai=1;function ch(n){ai+=n,n<0&&xe&&(xe.hasOnce=!0)}function lp(n){return n.dynamicChildren=ai>0?xe||Wr:null,aE(),ai>0&&xe&&xe.push(n),n}function cE(n,t,e,r,s,i){return lp(fp(n,t,e,r,s,i,!0))}function up(n,t,e,r,s){return lp(Qt(n,t,e,r,s,!0))}function Ao(n){return n?n.__v_isVNode===!0:!1}function Vs(n,t){return n.type===t.type&&n.key===t.key}const hp=({key:n})=>n??null,ao=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Ht(n)||qt(n)||ft(n)?{i:Re,r:n,k:t,f:!!e}:n:null);function fp(n,t=null,e=null,r=0,s=null,i=n===ln?0:1,o=!1,c=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&hp(t),ref:t&&ao(t),scopeId:Kd,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Re};return c?(_l(l,e),i&128&&n.normalize(l)):e&&(l.shapeFlag|=Ht(e)?8:16),ai>0&&!o&&xe&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&xe.push(l),l}const Qt=lE;function lE(n,t=null,e=null,r=0,s=null,i=!1){if((!n||n===xy)&&(n=gr),Ao(n)){const c=Zr(n,t,!0);return e&&_l(c,e),ai>0&&!i&&xe&&(c.shapeFlag&6?xe[xe.indexOf(n)]=c:xe.push(c)),c.patchFlag=-2,c}if(TE(n)&&(n=n.__vccOpts),t){t=uE(t);let{class:c,style:l}=t;c&&!Ht(c)&&(t.class=tl(c)),Mt(l)&&(al(l)&&!ht(l)&&(l=te({},l)),t.style=Zc(l))}const o=Ht(n)?1:cp(n)?128:dy(n)?64:Mt(n)?4:ft(n)?2:0;return fp(n,t,e,r,s,o,i,!0)}function uE(n){return n?al(n)||Yd(n)?te({},n):n:null}function Zr(n,t,e=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:c,transition:l}=n,u=t?dE(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&hp(u),ref:t&&t.ref?e&&i?ht(i)?i.concat(ao(t)):[i,ao(t)]:ao(t):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:c,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==ln?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Zr(n.ssContent),ssFallback:n.ssFallback&&Zr(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&hl(f,l.clone(f)),f}function hE(n=" ",t=0){return Qt(ta,null,n,t)}function OA(n,t){const e=Qt(oo,null,n);return e.staticCount=t,e}function fE(n="",t=!1){return t?(_c(),up(gr,null,n)):Qt(gr,null,n)}function Ye(n){return n==null||typeof n=="boolean"?Qt(gr):ht(n)?Qt(ln,null,n.slice()):Ao(n)?Vn(n):Qt(ta,null,String(n))}function Vn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Zr(n)}function _l(n,t){let e=0;const{shapeFlag:r}=n;if(t==null)t=null;else if(ht(t))e=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),_l(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!Yd(t)?t._ctx=Re:s===3&&Re&&(Re.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else ft(t)?(t={default:t,_ctx:Re},e=32):(t=String(t),r&64?(e=16,t=[hE(t)]):e=8);n.children=t,n.shapeFlag|=e}function dE(...n){const t={};for(let e=0;e<n.length;e++){const r=n[e];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=tl([t.class,r.class]));else if(s==="style")t.style=Zc([t.style,r.style]);else if(zo(s)){const i=t[s],o=r[s];o&&i!==o&&!(ht(i)&&i.includes(o))&&(t[s]=i?[].concat(i,o):o)}else s!==""&&(t[s]=r[s])}return t}function Qe(n,t,e,r=null){en(n,t,7,[e,r])}const pE=Wd();let mE=0;function gE(n,t,e){const r=n.type,s=(t?t.appContext:n.appContext)||pE,i={uid:mE++,vnode:n,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new yd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zd(r,s),emitsOptions:ap(r,s),emit:null,emitted:null,propsDefaults:Dt,inheritAttrs:r.inheritAttrs,ctx:Dt,data:Dt,props:Dt,attrs:Dt,slots:Dt,refs:Dt,setupState:Dt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=eE.bind(null,i),n.ce&&n.ce(i),i}let Zt=null,Ro,yc;{const n=Qo(),t=(e,r)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Ro=t("__VUE_INSTANCE_SETTERS__",e=>Zt=e),yc=t("__VUE_SSR_SETTERS__",e=>ts=e)}const Ri=n=>{const t=Zt;return Ro(n),n.scope.on(),()=>{n.scope.off(),Ro(t)}},lh=()=>{Zt&&Zt.scope.off(),Ro(null)};function dp(n){return n.vnode.shapeFlag&4}let ts=!1;function _E(n,t=!1,e=!1){t&&yc(t);const{props:r,children:s}=n.vnode,i=dp(n);jy(n,r,i,t),zy(n,s,e);const o=i?yE(n,t):void 0;return t&&yc(!1),o}function yE(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,Dy);const{setup:r}=e;if(r){zn();const s=n.setupContext=r.length>1?vE(n):null,i=Ri(n),o=bi(r,n,0,[n.props,s]),c=hd(o);if(Gn(),i(),(c||n.sp)&&!Gs(n)&&fl(n),c){if(o.then(lh,lh),t)return o.then(l=>{uh(n,l,t)}).catch(l=>{Ai(l,n,0)});n.asyncDep=o}else uh(n,o,t)}else pp(n,t)}function uh(n,t,e){ft(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Mt(t)&&(n.setupState=Ld(t)),pp(n,e)}let hh;function pp(n,t,e){const r=n.type;if(!n.render){if(!t&&hh&&!r.render){const s=r.template||pl(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:c,compilerOptions:l}=r,u=te(te({isCustomElement:i,delimiters:c},o),l);r.render=hh(s,u)}}n.render=r.render||tn}{const s=Ri(n);zn();try{Ny(n)}finally{Gn(),s()}}}const EE={get(n,t){return fe(n,"get",""),n[t]}};function vE(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,EE),slots:n.slots,emit:n.emit,expose:t}}function ea(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Ld(cl(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Hs)return Hs[e](n)},has(t,e){return e in t||e in Hs}})):n.proxy}function IE(n,t=!0){return ft(n)?n.displayName||n.name:n.name||t&&n.__name}function TE(n){return ft(n)&&"__vccOpts"in n}const Me=(n,t)=>iy(n,t,ts);function mp(n,t,e){const r=arguments.length;return r===2?Mt(t)&&!ht(t)?Ao(t)?Qt(n,null,[t]):Qt(n,t):Qt(n,null,t):(r>3?e=Array.prototype.slice.call(arguments,2):r===3&&Ao(e)&&(e=[e]),Qt(n,t,e))}const wE="3.5.12";/**
* @vue/runtime-dom v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ec;const fh=typeof window<"u"&&window.trustedTypes;if(fh)try{Ec=fh.createPolicy("vue",{createHTML:n=>n})}catch{}const gp=Ec?n=>Ec.createHTML(n):n=>n,bE="http://www.w3.org/2000/svg",AE="http://www.w3.org/1998/Math/MathML",cn=typeof document<"u"?document:null,dh=cn&&cn.createElement("template"),RE={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,r)=>{const s=t==="svg"?cn.createElementNS(bE,n):t==="mathml"?cn.createElementNS(AE,n):e?cn.createElement(n,{is:e}):cn.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>cn.createTextNode(n),createComment:n=>cn.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>cn.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,r,s,i){const o=e?e.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===i||!(s=s.nextSibling)););else{dh.innerHTML=gp(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const c=dh.content;if(r==="svg"||r==="mathml"){const l=c.firstChild;for(;l.firstChild;)c.appendChild(l.firstChild);c.removeChild(l)}t.insertBefore(c,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},SE=Symbol("_vtc");function PE(n,t,e){const r=n[SE];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const ph=Symbol("_vod"),CE=Symbol("_vsh"),xE=Symbol(""),VE=/(^|;)\s*display\s*:/;function DE(n,t,e){const r=n.style,s=Ht(e);let i=!1;if(e&&!s){if(t)if(Ht(t))for(const o of t.split(";")){const c=o.slice(0,o.indexOf(":")).trim();e[c]==null&&co(r,c,"")}else for(const o in t)e[o]==null&&co(r,o,"");for(const o in e)o==="display"&&(i=!0),co(r,o,e[o])}else if(s){if(t!==e){const o=r[xE];o&&(e+=";"+o),r.cssText=e,i=VE.test(e)}}else t&&n.removeAttribute("style");ph in n&&(n[ph]=i?r.display:"",n[CE]&&(r.display="none"))}const mh=/\s*!important$/;function co(n,t,e){if(ht(e))e.forEach(r=>co(n,t,r));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const r=NE(n,t);mh.test(e)?n.setProperty(Kn(r),e.replace(mh,""),"important"):n[r]=e}}const gh=["Webkit","Moz","ms"],Ga={};function NE(n,t){const e=Ga[t];if(e)return e;let r=qe(t);if(r!=="filter"&&r in n)return Ga[t]=r;r=Wo(r);for(let s=0;s<gh.length;s++){const i=gh[s]+r;if(i in n)return Ga[t]=i}return t}const _h="http://www.w3.org/1999/xlink";function yh(n,t,e,r,s,i=C_(t)){r&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(_h,t.slice(6,t.length)):n.setAttributeNS(_h,t,e):e==null||i&&!md(e)?n.removeAttribute(t):n.setAttribute(t,i?"":$n(e)?String(e):e)}function Eh(n,t,e,r,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?gp(e):e);return}const i=n.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?n.getAttribute("value")||"":n.value,l=e==null?n.type==="checkbox"?"on":"":String(e);(c!==l||!("_value"in n))&&(n.value=l),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const c=typeof n[t];c==="boolean"?e=md(e):e==null&&c==="string"?(e="",o=!0):c==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(s||t)}function Ur(n,t,e,r){n.addEventListener(t,e,r)}function kE(n,t,e,r){n.removeEventListener(t,e,r)}const vh=Symbol("_vei");function OE(n,t,e,r,s=null){const i=n[vh]||(n[vh]={}),o=i[t];if(r&&o)o.value=r;else{const[c,l]=ME(t);if(r){const u=i[t]=BE(r,s);Ur(n,c,u,l)}else o&&(kE(n,c,o,l),i[t]=void 0)}}const Ih=/(?:Once|Passive|Capture)$/;function ME(n){let t;if(Ih.test(n)){t={};let r;for(;r=n.match(Ih);)n=n.slice(0,n.length-r[0].length),t[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Kn(n.slice(2)),t]}let Ha=0;const FE=Promise.resolve(),LE=()=>Ha||(FE.then(()=>Ha=0),Ha=Date.now());function BE(n,t){const e=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=e.attached)return;en(UE(r,e.value),t,5,[r])};return e.value=n,e.attached=LE(),e}function UE(n,t){if(ht(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const Th=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,jE=(n,t,e,r,s,i)=>{const o=s==="svg";t==="class"?PE(n,r,o):t==="style"?DE(n,e,r):zo(t)?Jc(t)||OE(n,t,e,r,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):qE(n,t,r,o))?(Eh(n,t,r),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&yh(n,t,r,o,i,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Ht(r))?Eh(n,qe(t),r,i,t):(t==="true-value"?n._trueValue=r:t==="false-value"&&(n._falseValue=r),yh(n,t,r,o))};function qE(n,t,e,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in n&&Th(t)&&ft(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Th(t)&&Ht(e)?!1:t in n}const wh=n=>{const t=n.props["onUpdate:modelValue"]||!1;return ht(t)?e=>so(t,e):t};function $E(n){n.target.composing=!0}function bh(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Wa=Symbol("_assign"),MA={created(n,{modifiers:{lazy:t,trim:e,number:r}},s){n[Wa]=wh(s);const i=r||s.props&&s.props.type==="number";Ur(n,t?"change":"input",o=>{if(o.target.composing)return;let c=n.value;e&&(c=c.trim()),i&&(c=ac(c)),n[Wa](c)}),e&&Ur(n,"change",()=>{n.value=n.value.trim()}),t||(Ur(n,"compositionstart",$E),Ur(n,"compositionend",bh),Ur(n,"change",bh))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:r,trim:s,number:i}},o){if(n[Wa]=wh(o),n.composing)return;const c=(i||n.type==="number")&&!/^0\d/.test(n.value)?ac(n.value):n.value,l=t??"";c!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&t===e||s&&n.value.trim()===l)||(n.value=l))}},KE=["ctrl","shift","alt","meta"],zE={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>KE.some(e=>n[`${e}Key`]&&!t.includes(e))},FA=(n,t)=>{const e=n._withMods||(n._withMods={}),r=t.join(".");return e[r]||(e[r]=(s,...i)=>{for(let o=0;o<t.length;o++){const c=zE[t[o]];if(c&&c(s,t))return}return n(s,...i)})},GE={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},LA=(n,t)=>{const e=n._withKeys||(n._withKeys={}),r=t.join(".");return e[r]||(e[r]=s=>{if(!("key"in s))return;const i=Kn(s.key);if(t.some(o=>o===i||GE[o]===i))return n(s)})},HE=te({patchProp:jE},RE);let Ah;function WE(){return Ah||(Ah=Hy(HE))}const QE=(...n)=>{const t=WE().createApp(...n),{mount:e}=t;return t.mount=r=>{const s=YE(r);if(!s)return;const i=t._component;!ft(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=e(s,!1,JE(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function JE(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function YE(n){return Ht(n)?document.querySelector(n):n}var XE=!1;/*!
 * pinia v2.2.6
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let _p;const na=n=>_p=n,yp=Symbol();function vc(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Js;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Js||(Js={}));function ZE(){const n=Ed(!0),t=n.run(()=>ur({}));let e=[],r=[];const s=cl({install(i){na(s),s._a=i,i.provide(yp,s),i.config.globalProperties.$pinia=s,r.forEach(o=>e.push(o)),r=[]},use(i){return!this._a&&!XE?r.push(i):e.push(i),this},_p:e,_a:null,_e:n,_s:new Map,state:t});return s}const Ep=()=>{};function Rh(n,t,e,r=Ep){n.push(t);const s=()=>{const i=n.indexOf(t);i>-1&&(n.splice(i,1),r())};return!e&&vd()&&V_(s),s}function kr(n,...t){n.slice().forEach(e=>{e(...t)})}const tv=n=>n(),Sh=Symbol(),Qa=Symbol();function Ic(n,t){n instanceof Map&&t instanceof Map?t.forEach((e,r)=>n.set(r,e)):n instanceof Set&&t instanceof Set&&t.forEach(n.add,n);for(const e in t){if(!t.hasOwnProperty(e))continue;const r=t[e],s=n[e];vc(s)&&vc(r)&&n.hasOwnProperty(e)&&!qt(r)&&!dn(r)?n[e]=Ic(s,r):n[e]=r}return n}const ev=Symbol();function nv(n){return!vc(n)||!n.hasOwnProperty(ev)}const{assign:Cn}=Object;function rv(n){return!!(qt(n)&&n.effect)}function sv(n,t,e,r){const{state:s,actions:i,getters:o}=t,c=e.state.value[n];let l;function u(){c||(e.state.value[n]=s?s():{});const f=ty(e.state.value[n]);return Cn(f,i,Object.keys(o||{}).reduce((p,g)=>(p[g]=cl(Me(()=>{na(e);const _=e._s.get(n);return o[g].call(_,_)})),p),{}))}return l=vp(n,u,t,e,r,!0),l}function vp(n,t,e={},r,s,i){let o;const c=Cn({actions:{}},e),l={deep:!0};let u,f,p=[],g=[],_;const P=r.state.value[n];!i&&!P&&(r.state.value[n]={}),ur({});let x;function N(y){let v;u=f=!1,typeof y=="function"?(y(r.state.value[n]),v={type:Js.patchFunction,storeId:n,events:_}):(Ic(r.state.value[n],y),v={type:Js.patchObject,payload:y,storeId:n,events:_});const b=x=Symbol();ll().then(()=>{x===b&&(u=!0)}),f=!0,kr(p,v,r.state.value[n])}const U=i?function(){const{state:v}=e,b=v?v():{};this.$patch(A=>{Cn(A,b)})}:Ep;function L(){o.stop(),p=[],g=[],r._s.delete(n)}const k=(y,v="")=>{if(Sh in y)return y[Qa]=v,y;const b=function(){na(r);const A=Array.from(arguments),R=[],T=[];function ee(ut){R.push(ut)}function Te(ut){T.push(ut)}kr(g,{args:A,name:b[Qa],store:tt,after:ee,onError:Te});let Nt;try{Nt=y.apply(this&&this.$id===n?this:tt,A)}catch(ut){throw kr(T,ut),ut}return Nt instanceof Promise?Nt.then(ut=>(kr(R,ut),ut)).catch(ut=>(kr(T,ut),Promise.reject(ut))):(kr(R,Nt),Nt)};return b[Sh]=!0,b[Qa]=v,b},K={_p:r,$id:n,$onAction:Rh.bind(null,g),$patch:N,$reset:U,$subscribe(y,v={}){const b=Rh(p,y,v.detached,()=>A()),A=o.run(()=>Ws(()=>r.state.value[n],R=>{(v.flush==="sync"?f:u)&&y({storeId:n,type:Js.direct,events:_},R)},Cn({},l,v)));return b},$dispose:L},tt=wi(K);r._s.set(n,tt);const w=(r._a&&r._a.runWithContext||tv)(()=>r._e.run(()=>(o=Ed()).run(()=>t({action:k}))));for(const y in w){const v=w[y];if(qt(v)&&!rv(v)||dn(v))i||(P&&nv(v)&&(qt(v)?v.value=P[y]:Ic(v,P[y])),r.state.value[n][y]=v);else if(typeof v=="function"){const b=k(v,y);w[y]=b,c.actions[y]=v}}return Cn(tt,w),Cn(It(tt),w),Object.defineProperty(tt,"$state",{get:()=>r.state.value[n],set:y=>{N(v=>{Cn(v,y)})}}),r._p.forEach(y=>{Cn(tt,o.run(()=>y({store:tt,app:r._a,pinia:r,options:c})))}),P&&i&&e.hydrate&&e.hydrate(tt.$state,P),u=!0,f=!0,tt}/*! #__NO_SIDE_EFFECTS__ */function iv(n,t,e){let r,s;const i=typeof t=="function";typeof n=="string"?(r=n,s=i?e:t):(s=n,r=n.id);function o(c,l){const u=Uy();return c=c||(u?Ue(yp,null):null),c&&na(c),c=_p,c._s.has(r)||(i?vp(r,t,s,c):sv(r,s,c)),c._s.get(r)}return o.$id=r,o}function BA(n){{const t=It(n),e={};for(const r in t){const s=t[r];(qt(s)||dn(s))&&(e[r]=ry(n,r))}return e}}const ov="modulepreload",av=function(n){return"/"+n},Ph={},jr=function(t,e,r){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(e.map(l=>{if(l=av(l),l in Ph)return;Ph[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":ov,u||(p.as="script"),p.crossOrigin="",p.href=l,c&&p.setAttribute("nonce",c),document.head.appendChild(p),u)return new Promise((g,_)=>{p.addEventListener("load",g),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const qr=typeof document<"u";function Ip(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function cv(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&Ip(n.default)}const Rt=Object.assign;function Ja(n,t){const e={};for(const r in t){const s=t[r];e[r]=He(s)?s.map(n):n(s)}return e}const Ys=()=>{},He=Array.isArray,Tp=/#/g,lv=/&/g,uv=/\//g,hv=/=/g,fv=/\?/g,wp=/\+/g,dv=/%5B/g,pv=/%5D/g,bp=/%5E/g,mv=/%60/g,Ap=/%7B/g,gv=/%7C/g,Rp=/%7D/g,_v=/%20/g;function yl(n){return encodeURI(""+n).replace(gv,"|").replace(dv,"[").replace(pv,"]")}function yv(n){return yl(n).replace(Ap,"{").replace(Rp,"}").replace(bp,"^")}function Tc(n){return yl(n).replace(wp,"%2B").replace(_v,"+").replace(Tp,"%23").replace(lv,"%26").replace(mv,"`").replace(Ap,"{").replace(Rp,"}").replace(bp,"^")}function Ev(n){return Tc(n).replace(hv,"%3D")}function vv(n){return yl(n).replace(Tp,"%23").replace(fv,"%3F")}function Iv(n){return n==null?"":vv(n).replace(uv,"%2F")}function ci(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const Tv=/\/$/,wv=n=>n.replace(Tv,"");function Ya(n,t,e="/"){let r,s={},i="",o="";const c=t.indexOf("#");let l=t.indexOf("?");return c<l&&c>=0&&(l=-1),l>-1&&(r=t.slice(0,l),i=t.slice(l+1,c>-1?c:t.length),s=n(i)),c>-1&&(r=r||t.slice(0,c),o=t.slice(c,t.length)),r=Sv(r??t,e),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:ci(o)}}function bv(n,t){const e=t.query?n(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function Ch(n,t){return!t||!n.toLowerCase().startsWith(t.toLowerCase())?n:n.slice(t.length)||"/"}function Av(n,t,e){const r=t.matched.length-1,s=e.matched.length-1;return r>-1&&r===s&&es(t.matched[r],e.matched[s])&&Sp(t.params,e.params)&&n(t.query)===n(e.query)&&t.hash===e.hash}function es(n,t){return(n.aliasOf||n)===(t.aliasOf||t)}function Sp(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(!Rv(n[e],t[e]))return!1;return!0}function Rv(n,t){return He(n)?xh(n,t):He(t)?xh(t,n):n===t}function xh(n,t){return He(t)?n.length===t.length&&n.every((e,r)=>e===t[r]):n.length===1&&n[0]===t}function Sv(n,t){if(n.startsWith("/"))return n;if(!n)return t;const e=t.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=e.length-1,o,c;for(o=0;o<r.length;o++)if(c=r[o],c!==".")if(c==="..")i>1&&i--;else break;return e.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const An={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var li;(function(n){n.pop="pop",n.push="push"})(li||(li={}));var Xs;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Xs||(Xs={}));function Pv(n){if(!n)if(qr){const t=document.querySelector("base");n=t&&t.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),wv(n)}const Cv=/^[^#]+#/;function xv(n,t){return n.replace(Cv,"#")+t}function Vv(n,t){const e=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:t.behavior,left:r.left-e.left-(t.left||0),top:r.top-e.top-(t.top||0)}}const ra=()=>({left:window.scrollX,top:window.scrollY});function Dv(n){let t;if("el"in n){const e=n.el,r=typeof e=="string"&&e.startsWith("#"),s=typeof e=="string"?r?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!s)return;t=Vv(s,n)}else t=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Vh(n,t){return(history.state?history.state.position-t:-1)+n}const wc=new Map;function Nv(n,t){wc.set(n,t)}function kv(n){const t=wc.get(n);return wc.delete(n),t}let Ov=()=>location.protocol+"//"+location.host;function Pp(n,t){const{pathname:e,search:r,hash:s}=t,i=n.indexOf("#");if(i>-1){let c=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(c);return l[0]!=="/"&&(l="/"+l),Ch(l,"")}return Ch(e,n)+r+s}function Mv(n,t,e,r){let s=[],i=[],o=null;const c=({state:g})=>{const _=Pp(n,location),P=e.value,x=t.value;let N=0;if(g){if(e.value=_,t.value=g,o&&o===P){o=null;return}N=x?g.position-x.position:0}else r(_);s.forEach(U=>{U(e.value,P,{delta:N,type:li.pop,direction:N?N>0?Xs.forward:Xs.back:Xs.unknown})})};function l(){o=e.value}function u(g){s.push(g);const _=()=>{const P=s.indexOf(g);P>-1&&s.splice(P,1)};return i.push(_),_}function f(){const{history:g}=window;g.state&&g.replaceState(Rt({},g.state,{scroll:ra()}),"")}function p(){for(const g of i)g();i=[],window.removeEventListener("popstate",c),window.removeEventListener("beforeunload",f)}return window.addEventListener("popstate",c),window.addEventListener("beforeunload",f,{passive:!0}),{pauseListeners:l,listen:u,destroy:p}}function Dh(n,t,e,r=!1,s=!1){return{back:n,current:t,forward:e,replaced:r,position:window.history.length,scroll:s?ra():null}}function Fv(n){const{history:t,location:e}=window,r={value:Pp(n,e)},s={value:t.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(l,u,f){const p=n.indexOf("#"),g=p>-1?(e.host&&document.querySelector("base")?n:n.slice(p))+l:Ov()+n+l;try{t[f?"replaceState":"pushState"](u,"",g),s.value=u}catch(_){console.error(_),e[f?"replace":"assign"](g)}}function o(l,u){const f=Rt({},t.state,Dh(s.value.back,l,s.value.forward,!0),u,{position:s.value.position});i(l,f,!0),r.value=l}function c(l,u){const f=Rt({},s.value,t.state,{forward:l,scroll:ra()});i(f.current,f,!0);const p=Rt({},Dh(r.value,l,null),{position:f.position+1},u);i(l,p,!1),r.value=l}return{location:r,state:s,push:c,replace:o}}function Lv(n){n=Pv(n);const t=Fv(n),e=Mv(n,t.state,t.location,t.replace);function r(i,o=!0){o||e.pauseListeners(),history.go(i)}const s=Rt({location:"",base:n,go:r,createHref:xv.bind(null,n)},t,e);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function Bv(n){return typeof n=="string"||n&&typeof n=="object"}function Cp(n){return typeof n=="string"||typeof n=="symbol"}const xp=Symbol("");var Nh;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Nh||(Nh={}));function ns(n,t){return Rt(new Error,{type:n,[xp]:!0},t)}function an(n,t){return n instanceof Error&&xp in n&&(t==null||!!(n.type&t))}const kh="[^/]+?",Uv={sensitive:!1,strict:!1,start:!0,end:!0},jv=/[.+*?^${}()[\]/\\]/g;function qv(n,t){const e=Rt({},Uv,t),r=[];let s=e.start?"^":"";const i=[];for(const u of n){const f=u.length?[]:[90];e.strict&&!u.length&&(s+="/");for(let p=0;p<u.length;p++){const g=u[p];let _=40+(e.sensitive?.25:0);if(g.type===0)p||(s+="/"),s+=g.value.replace(jv,"\\$&"),_+=40;else if(g.type===1){const{value:P,repeatable:x,optional:N,regexp:U}=g;i.push({name:P,repeatable:x,optional:N});const L=U||kh;if(L!==kh){_+=10;try{new RegExp(`(${L})`)}catch(K){throw new Error(`Invalid custom RegExp for param "${P}" (${L}): `+K.message)}}let k=x?`((?:${L})(?:/(?:${L}))*)`:`(${L})`;p||(k=N&&u.length<2?`(?:/${k})`:"/"+k),N&&(k+="?"),s+=k,_+=20,N&&(_+=-8),x&&(_+=-20),L===".*"&&(_+=-50)}f.push(_)}r.push(f)}if(e.strict&&e.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}e.strict||(s+="/?"),e.end?s+="$":e.strict&&(s+="(?:/|$)");const o=new RegExp(s,e.sensitive?"":"i");function c(u){const f=u.match(o),p={};if(!f)return null;for(let g=1;g<f.length;g++){const _=f[g]||"",P=i[g-1];p[P.name]=_&&P.repeatable?_.split("/"):_}return p}function l(u){let f="",p=!1;for(const g of n){(!p||!f.endsWith("/"))&&(f+="/"),p=!1;for(const _ of g)if(_.type===0)f+=_.value;else if(_.type===1){const{value:P,repeatable:x,optional:N}=_,U=P in u?u[P]:"";if(He(U)&&!x)throw new Error(`Provided param "${P}" is an array but it is not repeatable (* or + modifiers)`);const L=He(U)?U.join("/"):U;if(!L)if(N)g.length<2&&(f.endsWith("/")?f=f.slice(0,-1):p=!0);else throw new Error(`Missing required param "${P}"`);f+=L}}return f||"/"}return{re:o,score:r,keys:i,parse:c,stringify:l}}function $v(n,t){let e=0;for(;e<n.length&&e<t.length;){const r=t[e]-n[e];if(r)return r;e++}return n.length<t.length?n.length===1&&n[0]===80?-1:1:n.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Vp(n,t){let e=0;const r=n.score,s=t.score;for(;e<r.length&&e<s.length;){const i=$v(r[e],s[e]);if(i)return i;e++}if(Math.abs(s.length-r.length)===1){if(Oh(r))return 1;if(Oh(s))return-1}return s.length-r.length}function Oh(n){const t=n[n.length-1];return n.length>0&&t[t.length-1]<0}const Kv={type:0,value:""},zv=/[a-zA-Z0-9_]/;function Gv(n){if(!n)return[[]];if(n==="/")return[[Kv]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function t(_){throw new Error(`ERR (${e})/"${u}": ${_}`)}let e=0,r=e;const s=[];let i;function o(){i&&s.push(i),i=[]}let c=0,l,u="",f="";function p(){u&&(e===0?i.push({type:0,value:u}):e===1||e===2||e===3?(i.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:f,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),u="")}function g(){u+=l}for(;c<n.length;){if(l=n[c++],l==="\\"&&e!==2){r=e,e=4;continue}switch(e){case 0:l==="/"?(u&&p(),o()):l===":"?(p(),e=1):g();break;case 4:g(),e=r;break;case 1:l==="("?e=2:zv.test(l)?g():(p(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&c--);break;case 2:l===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+l:e=3:f+=l;break;case 3:p(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&c--,f="";break;default:t("Unknown state");break}}return e===2&&t(`Unfinished custom RegExp for param "${u}"`),p(),o(),s}function Hv(n,t,e){const r=qv(Gv(n.path),e),s=Rt(r,{record:n,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function Wv(n,t){const e=[],r=new Map;t=Bh({strict:!1,end:!0,sensitive:!1},t);function s(p){return r.get(p)}function i(p,g,_){const P=!_,x=Fh(p);x.aliasOf=_&&_.record;const N=Bh(t,p),U=[x];if("alias"in p){const K=typeof p.alias=="string"?[p.alias]:p.alias;for(const tt of K)U.push(Fh(Rt({},x,{components:_?_.record.components:x.components,path:tt,aliasOf:_?_.record:x})))}let L,k;for(const K of U){const{path:tt}=K;if(g&&tt[0]!=="/"){const ct=g.record.path,w=ct[ct.length-1]==="/"?"":"/";K.path=g.record.path+(tt&&w+tt)}if(L=Hv(K,g,N),_?_.alias.push(L):(k=k||L,k!==L&&k.alias.push(L),P&&p.name&&!Lh(L)&&o(p.name)),Dp(L)&&l(L),x.children){const ct=x.children;for(let w=0;w<ct.length;w++)i(ct[w],L,_&&_.children[w])}_=_||L}return k?()=>{o(k)}:Ys}function o(p){if(Cp(p)){const g=r.get(p);g&&(r.delete(p),e.splice(e.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=e.indexOf(p);g>-1&&(e.splice(g,1),p.record.name&&r.delete(p.record.name),p.children.forEach(o),p.alias.forEach(o))}}function c(){return e}function l(p){const g=Yv(p,e);e.splice(g,0,p),p.record.name&&!Lh(p)&&r.set(p.record.name,p)}function u(p,g){let _,P={},x,N;if("name"in p&&p.name){if(_=r.get(p.name),!_)throw ns(1,{location:p});N=_.record.name,P=Rt(Mh(g.params,_.keys.filter(k=>!k.optional).concat(_.parent?_.parent.keys.filter(k=>k.optional):[]).map(k=>k.name)),p.params&&Mh(p.params,_.keys.map(k=>k.name))),x=_.stringify(P)}else if(p.path!=null)x=p.path,_=e.find(k=>k.re.test(x)),_&&(P=_.parse(x),N=_.record.name);else{if(_=g.name?r.get(g.name):e.find(k=>k.re.test(g.path)),!_)throw ns(1,{location:p,currentLocation:g});N=_.record.name,P=Rt({},g.params,p.params),x=_.stringify(P)}const U=[];let L=_;for(;L;)U.unshift(L.record),L=L.parent;return{name:N,path:x,params:P,matched:U,meta:Jv(U)}}n.forEach(p=>i(p));function f(){e.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:f,getRoutes:c,getRecordMatcher:s}}function Mh(n,t){const e={};for(const r of t)r in n&&(e[r]=n[r]);return e}function Fh(n){const t={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:Qv(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Qv(n){const t={},e=n.props||!1;if("component"in n)t.default=e;else for(const r in n.components)t[r]=typeof e=="object"?e[r]:e;return t}function Lh(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function Jv(n){return n.reduce((t,e)=>Rt(t,e.meta),{})}function Bh(n,t){const e={};for(const r in n)e[r]=r in t?t[r]:n[r];return e}function Yv(n,t){let e=0,r=t.length;for(;e!==r;){const i=e+r>>1;Vp(n,t[i])<0?r=i:e=i+1}const s=Xv(n);return s&&(r=t.lastIndexOf(s,r-1)),r}function Xv(n){let t=n;for(;t=t.parent;)if(Dp(t)&&Vp(n,t)===0)return t}function Dp({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function Zv(n){const t={};if(n===""||n==="?")return t;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(wp," "),o=i.indexOf("="),c=ci(o<0?i:i.slice(0,o)),l=o<0?null:ci(i.slice(o+1));if(c in t){let u=t[c];He(u)||(u=t[c]=[u]),u.push(l)}else t[c]=l}return t}function Uh(n){let t="";for(let e in n){const r=n[e];if(e=Ev(e),r==null){r!==void 0&&(t+=(t.length?"&":"")+e);continue}(He(r)?r.map(i=>i&&Tc(i)):[r&&Tc(r)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+e,i!=null&&(t+="="+i))})}return t}function tI(n){const t={};for(const e in n){const r=n[e];r!==void 0&&(t[e]=He(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return t}const eI=Symbol(""),jh=Symbol(""),sa=Symbol(""),El=Symbol(""),bc=Symbol("");function Ds(){let n=[];function t(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function e(){n=[]}return{add:t,list:()=>n.slice(),reset:e}}function Dn(n,t,e,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((c,l)=>{const u=g=>{g===!1?l(ns(4,{from:e,to:t})):g instanceof Error?l(g):Bv(g)?l(ns(2,{from:t,to:g})):(o&&r.enterCallbacks[s]===o&&typeof g=="function"&&o.push(g),c())},f=i(()=>n.call(r&&r.instances[s],t,e,u));let p=Promise.resolve(f);n.length<3&&(p=p.then(u)),p.catch(g=>l(g))})}function Xa(n,t,e,r,s=i=>i()){const i=[];for(const o of n)for(const c in o.components){let l=o.components[c];if(!(t!=="beforeRouteEnter"&&!o.instances[c]))if(Ip(l)){const f=(l.__vccOpts||l)[t];f&&i.push(Dn(f,e,r,o,c,s))}else{let u=l();i.push(()=>u.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${c}" at "${o.path}"`);const p=cv(f)?f.default:f;o.mods[c]=f,o.components[c]=p;const _=(p.__vccOpts||p)[t];return _&&Dn(_,e,r,o,c,s)()}))}}return i}function qh(n){const t=Ue(sa),e=Ue(El),r=Me(()=>{const l=hr(n.to);return t.resolve(l)}),s=Me(()=>{const{matched:l}=r.value,{length:u}=l,f=l[u-1],p=e.matched;if(!f||!p.length)return-1;const g=p.findIndex(es.bind(null,f));if(g>-1)return g;const _=$h(l[u-2]);return u>1&&$h(f)===_&&p[p.length-1].path!==_?p.findIndex(es.bind(null,l[u-2])):g}),i=Me(()=>s.value>-1&&iI(e.params,r.value.params)),o=Me(()=>s.value>-1&&s.value===e.matched.length-1&&Sp(e.params,r.value.params));function c(l={}){return sI(l)?t[hr(n.replace)?"replace":"push"](hr(n.to)).catch(Ys):Promise.resolve()}return{route:r,href:Me(()=>r.value.href),isActive:i,isExactActive:o,navigate:c}}const nI=Yo({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:qh,setup(n,{slots:t}){const e=wi(qh(n)),{options:r}=Ue(sa),s=Me(()=>({[Kh(n.activeClass,r.linkActiveClass,"router-link-active")]:e.isActive,[Kh(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const i=t.default&&t.default(e);return n.custom?i:mp("a",{"aria-current":e.isExactActive?n.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:s.value},i)}}}),rI=nI;function sI(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const t=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return n.preventDefault&&n.preventDefault(),!0}}function iI(n,t){for(const e in t){const r=t[e],s=n[e];if(typeof r=="string"){if(r!==s)return!1}else if(!He(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function $h(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Kh=(n,t,e)=>n??t??e,oI=Yo({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:t,slots:e}){const r=Ue(bc),s=Me(()=>n.route||r.value),i=Ue(jh,0),o=Me(()=>{let u=hr(i);const{matched:f}=s.value;let p;for(;(p=f[u])&&!p.components;)u++;return u}),c=Me(()=>s.value.matched[o.value]);io(jh,Me(()=>o.value+1)),io(eI,c),io(bc,s);const l=ur();return Ws(()=>[l.value,c.value,n.name],([u,f,p],[g,_,P])=>{f&&(f.instances[p]=u,_&&_!==f&&u&&u===g&&(f.leaveGuards.size||(f.leaveGuards=_.leaveGuards),f.updateGuards.size||(f.updateGuards=_.updateGuards))),u&&f&&(!_||!es(f,_)||!g)&&(f.enterCallbacks[p]||[]).forEach(x=>x(u))},{flush:"post"}),()=>{const u=s.value,f=n.name,p=c.value,g=p&&p.components[f];if(!g)return zh(e.default,{Component:g,route:u});const _=p.props[f],P=_?_===!0?u.params:typeof _=="function"?_(u):_:null,N=mp(g,Rt({},P,t,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(p.instances[f]=null)},ref:l}));return zh(e.default,{Component:N,route:u})||N}}});function zh(n,t){if(!n)return null;const e=n(t);return e.length===1?e[0]:e}const aI=oI;function cI(n){const t=Wv(n.routes,n),e=n.parseQuery||Zv,r=n.stringifyQuery||Uh,s=n.history,i=Ds(),o=Ds(),c=Ds(),l=Y_(An);let u=An;qr&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ja.bind(null,M=>""+M),p=Ja.bind(null,Iv),g=Ja.bind(null,ci);function _(M,X){let Q,et;return Cp(M)?(Q=t.getRecordMatcher(M),et=X):et=M,t.addRoute(et,Q)}function P(M){const X=t.getRecordMatcher(M);X&&t.removeRoute(X)}function x(){return t.getRoutes().map(M=>M.record)}function N(M){return!!t.getRecordMatcher(M)}function U(M,X){if(X=Rt({},X||l.value),typeof M=="string"){const I=Ya(e,M,X.path),V=t.resolve({path:I.path},X),B=s.createHref(I.fullPath);return Rt(I,V,{params:g(V.params),hash:ci(I.hash),redirectedFrom:void 0,href:B})}let Q;if(M.path!=null)Q=Rt({},M,{path:Ya(e,M.path,X.path).path});else{const I=Rt({},M.params);for(const V in I)I[V]==null&&delete I[V];Q=Rt({},M,{params:p(I)}),X.params=p(X.params)}const et=t.resolve(Q,X),yt=M.hash||"";et.params=f(g(et.params));const xt=bv(r,Rt({},M,{hash:yv(yt),path:et.path})),E=s.createHref(xt);return Rt({fullPath:xt,hash:yt,query:r===Uh?tI(M.query):M.query||{}},et,{redirectedFrom:void 0,href:E})}function L(M){return typeof M=="string"?Ya(e,M,l.value.path):Rt({},M)}function k(M,X){if(u!==M)return ns(8,{from:X,to:M})}function K(M){return w(M)}function tt(M){return K(Rt(L(M),{replace:!0}))}function ct(M){const X=M.matched[M.matched.length-1];if(X&&X.redirect){const{redirect:Q}=X;let et=typeof Q=="function"?Q(M):Q;return typeof et=="string"&&(et=et.includes("?")||et.includes("#")?et=L(et):{path:et},et.params={}),Rt({query:M.query,hash:M.hash,params:et.path!=null?{}:M.params},et)}}function w(M,X){const Q=u=U(M),et=l.value,yt=M.state,xt=M.force,E=M.replace===!0,I=ct(Q);if(I)return w(Rt(L(I),{state:typeof I=="object"?Rt({},yt,I.state):yt,force:xt,replace:E}),X||Q);const V=Q;V.redirectedFrom=X;let B;return!xt&&Av(r,et,Q)&&(B=ns(16,{to:V,from:et}),ke(et,et,!0,!1)),(B?Promise.resolve(B):b(V,et)).catch(O=>an(O)?an(O,2)?O:$e(O):gt(O,V,et)).then(O=>{if(O){if(an(O,2))return w(Rt({replace:E},L(O.to),{state:typeof O.to=="object"?Rt({},yt,O.to.state):yt,force:xt}),X||V)}else O=R(V,et,!0,E,yt);return A(V,et,O),O})}function y(M,X){const Q=k(M,X);return Q?Promise.reject(Q):Promise.resolve()}function v(M){const X=vn.values().next().value;return X&&typeof X.runWithContext=="function"?X.runWithContext(M):M()}function b(M,X){let Q;const[et,yt,xt]=lI(M,X);Q=Xa(et.reverse(),"beforeRouteLeave",M,X);for(const I of et)I.leaveGuards.forEach(V=>{Q.push(Dn(V,M,X))});const E=y.bind(null,M,X);return Q.push(E),we(Q).then(()=>{Q=[];for(const I of i.list())Q.push(Dn(I,M,X));return Q.push(E),we(Q)}).then(()=>{Q=Xa(yt,"beforeRouteUpdate",M,X);for(const I of yt)I.updateGuards.forEach(V=>{Q.push(Dn(V,M,X))});return Q.push(E),we(Q)}).then(()=>{Q=[];for(const I of xt)if(I.beforeEnter)if(He(I.beforeEnter))for(const V of I.beforeEnter)Q.push(Dn(V,M,X));else Q.push(Dn(I.beforeEnter,M,X));return Q.push(E),we(Q)}).then(()=>(M.matched.forEach(I=>I.enterCallbacks={}),Q=Xa(xt,"beforeRouteEnter",M,X,v),Q.push(E),we(Q))).then(()=>{Q=[];for(const I of o.list())Q.push(Dn(I,M,X));return Q.push(E),we(Q)}).catch(I=>an(I,8)?I:Promise.reject(I))}function A(M,X,Q){c.list().forEach(et=>v(()=>et(M,X,Q)))}function R(M,X,Q,et,yt){const xt=k(M,X);if(xt)return xt;const E=X===An,I=qr?history.state:{};Q&&(et||E?s.replace(M.fullPath,Rt({scroll:E&&I&&I.scroll},yt)):s.push(M.fullPath,yt)),l.value=M,ke(M,X,Q,E),$e()}let T;function ee(){T||(T=s.listen((M,X,Q)=>{if(!We.listening)return;const et=U(M),yt=ct(et);if(yt){w(Rt(yt,{replace:!0}),et).catch(Ys);return}u=et;const xt=l.value;qr&&Nv(Vh(xt.fullPath,Q.delta),ra()),b(et,xt).catch(E=>an(E,12)?E:an(E,2)?(w(E.to,et).then(I=>{an(I,20)&&!Q.delta&&Q.type===li.pop&&s.go(-1,!1)}).catch(Ys),Promise.reject()):(Q.delta&&s.go(-Q.delta,!1),gt(E,et,xt))).then(E=>{E=E||R(et,xt,!1),E&&(Q.delta&&!an(E,8)?s.go(-Q.delta,!1):Q.type===li.pop&&an(E,20)&&s.go(-1,!1)),A(et,xt,E)}).catch(Ys)}))}let Te=Ds(),Nt=Ds(),ut;function gt(M,X,Q){$e(M);const et=Nt.list();return et.length?et.forEach(yt=>yt(M,X,Q)):console.error(M),Promise.reject(M)}function Se(){return ut&&l.value!==An?Promise.resolve():new Promise((M,X)=>{Te.add([M,X])})}function $e(M){return ut||(ut=!M,ee(),Te.list().forEach(([X,Q])=>M?Q(M):X()),Te.reset()),M}function ke(M,X,Q,et){const{scrollBehavior:yt}=n;if(!qr||!yt)return Promise.resolve();const xt=!Q&&kv(Vh(M.fullPath,0))||(et||!Q)&&history.state&&history.state.scroll||null;return ll().then(()=>yt(M,X,xt)).then(E=>E&&Dv(E)).catch(E=>gt(E,M,X))}const Bt=M=>s.go(M);let Ut;const vn=new Set,We={currentRoute:l,listening:!0,addRoute:_,removeRoute:P,clearRoutes:t.clearRoutes,hasRoute:N,getRoutes:x,resolve:U,options:n,push:K,replace:tt,go:Bt,back:()=>Bt(-1),forward:()=>Bt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:c.add,onError:Nt.add,isReady:Se,install(M){const X=this;M.component("RouterLink",rI),M.component("RouterView",aI),M.config.globalProperties.$router=X,Object.defineProperty(M.config.globalProperties,"$route",{enumerable:!0,get:()=>hr(l)}),qr&&!Ut&&l.value===An&&(Ut=!0,K(s.location).catch(yt=>{}));const Q={};for(const yt in An)Object.defineProperty(Q,yt,{get:()=>l.value[yt],enumerable:!0});M.provide(sa,X),M.provide(El,Od(Q)),M.provide(bc,l);const et=M.unmount;vn.add(M),M.unmount=function(){vn.delete(M),vn.size<1&&(u=An,T&&T(),T=null,l.value=An,Ut=!1,ut=!1),et()}}};function we(M){return M.reduce((X,Q)=>X.then(()=>v(Q)),Promise.resolve())}return We}function lI(n,t){const e=[],r=[],s=[],i=Math.max(t.matched.length,n.matched.length);for(let o=0;o<i;o++){const c=t.matched[o];c&&(n.matched.find(u=>es(u,c))?r.push(c):e.push(c));const l=n.matched[o];l&&(t.matched.find(u=>es(u,l))||s.push(l))}return[e,r,s]}function UA(){return Ue(sa)}function jA(n){return Ue(El)}const Np=cI({history:Lv(),routes:[{path:"/login",name:"Login",component:()=>jr(()=>import("./Login-Bh7PR1fh.js"),__vite__mapDeps([0,1,2])),meta:{hideBottomNav:!0,requiresAuth:!1}},{path:"/",component:()=>jr(()=>import("./Home-Cv2zI1KH.js"),__vite__mapDeps([3,1,4])),meta:{requiresAuth:!0}},{path:"/home",redirect:"/",meta:{requiresAuth:!0}},{path:"/pomodoro",component:()=>jr(()=>import("./Pomodoro-BtqM_MIq.js"),__vite__mapDeps([5,1,6])),meta:{requiresAuth:!0}},{path:"/tasks",component:()=>jr(()=>import("./Tasks-DHT4NuUR.js"),__vite__mapDeps([7,1,8])),meta:{requiresAuth:!0}},{path:"/journal",component:()=>jr(()=>import("./Journal-B0rLmqSt.js"),__vite__mapDeps([9,1,10])),meta:{requiresAuth:!0}}]});Np.beforeEach((n,t,e)=>{const r=localStorage.getItem("isAuthenticated")==="true";n.meta.requiresAuth&&!r?e("/login"):n.path==="/login"&&r?e("/"):e()});const uI={class:"app-container"},hI=Yo({__name:"App",setup(n){const t=my(()=>jr(()=>import("./BottomNav-BFvH7_cV.js"),__vite__mapDeps([11,1,12])));return(e,r)=>{const s=Cy("router-view");return _c(),cE("div",uI,[Qt(s),e.$route.path!=="/login"?(_c(),up(hr(t),{key:0})):fE("v-if",!0)])}}}),fI="NekayOfflineDB",dI=1,Rn={tasks:"tasks",journal:"journal",folders:"folders",syncQueue:"syncQueue"};class pI{constructor(){Ma(this,"db",null)}async init(){return new Promise((t,e)=>{const r=indexedDB.open(fI,dI);r.onerror=()=>{var i;const s={message:"Failed to initialize offline storage",details:((i=r.error)==null?void 0:i.message)||"Unknown error",code:"INDEXEDDB_INIT_ERROR"};e(s)},r.onblocked=()=>{e({message:"Database blocked - please close other tabs with this app",code:"INDEXEDDB_BLOCKED"})},r.onsuccess=()=>{this.db=r.result,console.log("IndexedDB initialized successfully"),t()},r.onupgradeneeded=s=>{const i=s.target.result;if(!i.objectStoreNames.contains(Rn.tasks)){const o=i.createObjectStore(Rn.tasks,{keyPath:"id"});o.createIndex("syncStatus","syncStatus",{unique:!1}),o.createIndex("folderId","folderId",{unique:!1})}if(!i.objectStoreNames.contains(Rn.journal)){const o=i.createObjectStore(Rn.journal,{keyPath:"id"});o.createIndex("syncStatus","syncStatus",{unique:!1}),o.createIndex("folderId","folderId",{unique:!1})}if(!i.objectStoreNames.contains(Rn.folders)){const o=i.createObjectStore(Rn.folders,{keyPath:"id"});o.createIndex("syncStatus","syncStatus",{unique:!1}),o.createIndex("type","type",{unique:!1})}i.objectStoreNames.contains(Rn.syncQueue)||i.createObjectStore(Rn.syncQueue,{keyPath:"id",autoIncrement:!0}).createIndex("timestamp","timestamp",{unique:!1})}})}async addItem(t,e){return new Promise((r,s)=>{if(!this.db){s(new Error("Database not initialized"));return}const c=this.db.transaction(t,"readwrite").objectStore(t).add({...e,syncStatus:"pending",lastModified:Date.now()});c.onsuccess=()=>r(),c.onerror=()=>s(c.error)})}async getAllItems(t){return new Promise((e,r)=>{if(!this.db){r(new Error("Database not initialized"));return}const o=this.db.transaction(t,"readonly").objectStore(t).getAll();o.onsuccess=()=>e(o.result),o.onerror=()=>r(o.error)})}async getPendingSyncItems(t){return new Promise((e,r)=>{if(!this.db){r(new Error("Database not initialized"));return}const c=this.db.transaction(t,"readonly").objectStore(t).index("syncStatus").getAll("pending");c.onsuccess=()=>e(c.result),c.onerror=()=>r(c.error)})}async updateSyncStatus(t,e,r){return new Promise((s,i)=>{if(!this.db){i(new Error("Database not initialized"));return}const c=this.db.transaction(t,"readwrite").objectStore(t),l=c.get(e);l.onsuccess=()=>{const u=l.result;u&&(u.syncStatus=r,u.lastModified=Date.now(),c.put(u),s())},l.onerror=()=>i(l.error)})}async deleteItem(t,e){return new Promise((r,s)=>{if(!this.db){s(new Error("Database not initialized"));return}const c=this.db.transaction(t,"readwrite").objectStore(t).delete(e);c.onsuccess=()=>r(),c.onerror=()=>s(c.error)})}async updateItem(t,e){return new Promise((r,s)=>{if(!this.db){s(new Error("Database not initialized"));return}const c=this.db.transaction(t,"readwrite").objectStore(t).put({...e,syncStatus:"pending",lastModified:Date.now()});c.onsuccess=()=>r(),c.onerror=()=>s(c.error)})}}const be=new pI;function mI(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(n=>{console.log("ServiceWorker registration successful:",n.scope)}).catch(n=>{console.error("ServiceWorker registration failed:",n)})})}var Gh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},gI=function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[e++],o=n[e++],c=n[e++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return t.join("")},Op={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,l=s+2<n.length,u=l?n[s+2]:0,f=i>>2,p=(i&3)<<4|c>>4;let g=(c&15)<<2|u>>6,_=u&63;l||(_=64,o||(g=64)),r.push(e[f],e[p],e[g],e[_])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(kp(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):gI(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const u=s<n.length?e[n.charAt(s)]:64;++s;const p=s<n.length?e[n.charAt(s)]:64;if(++s,i==null||c==null||u==null||p==null)throw new _I;const g=i<<2|c>>4;if(r.push(g),u!==64){const _=c<<4&240|u>>2;if(r.push(_),p!==64){const P=u<<6&192|p;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class _I extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yI=function(n){const t=kp(n);return Op.encodeByteArray(t,!0)},So=function(n){return yI(n).replace(/\./g,"")},EI=function(n){try{return Op.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=()=>vI().__FIREBASE_DEFAULTS__,TI=()=>{if(typeof process>"u"||typeof Gh>"u")return;const n=Gh.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&EI(n[1]);return t&&JSON.parse(t)},vl=()=>{try{return II()||TI()||wI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bI=n=>{var t,e;return(e=(t=vl())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},AI=n=>{const t=bI(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},Mp=()=>{var n;return(n=vl())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[So(JSON.stringify(e)),So(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PI(){var n;const t=(n=vl())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Fp(){return!PI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lp(){try{return typeof indexedDB=="object"}catch{return!1}}function CI(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="FirebaseError";class fs extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=xI,Object.setPrototypeOf(this,fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bp.prototype.create)}}class Bp{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?VI(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new fs(s,c,r)}}function VI(n,t){return n.replace(DI,(e,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const DI=/\{\$([^}]+)}/g;function Co(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(Hh(i)&&Hh(o)){if(!Co(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function Hh(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(n){return n&&n._delegate?n._delegate:n}class hi{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new RI;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(OI(t))try{this.getOrInitializeService({instanceIdentifier:rr})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=rr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=rr){return this.instances.has(t)}getOptions(t=rr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:kI(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=rr){return this.component?this.component.multipleInstances?t:rr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kI(n){return n===rr?void 0:n}function OI(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new NI(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vt||(vt={}));const FI={debug:vt.DEBUG,verbose:vt.VERBOSE,info:vt.INFO,warn:vt.WARN,error:vt.ERROR,silent:vt.SILENT},LI=vt.INFO,BI={[vt.DEBUG]:"log",[vt.VERBOSE]:"log",[vt.INFO]:"info",[vt.WARN]:"warn",[vt.ERROR]:"error"},UI=(n,t,...e)=>{if(t<n.logLevel)return;const r=new Date().toISOString(),s=BI[t];if(s)console[s](`[${r}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Up{constructor(t){this.name=t,this._logLevel=LI,this._logHandler=UI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in vt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?FI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,vt.DEBUG,...t),this._logHandler(this,vt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,vt.VERBOSE,...t),this._logHandler(this,vt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,vt.INFO,...t),this._logHandler(this,vt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,vt.WARN,...t),this._logHandler(this,vt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,vt.ERROR,...t),this._logHandler(this,vt.ERROR,...t)}}const jI=(n,t)=>t.some(e=>n instanceof e);let Wh,Qh;function qI(){return Wh||(Wh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $I(){return Qh||(Qh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jp=new WeakMap,Ac=new WeakMap,qp=new WeakMap,Za=new WeakMap,Il=new WeakMap;function KI(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Mn(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&jp.set(e,n)}).catch(()=>{}),Il.set(t,n),t}function zI(n){if(Ac.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Ac.set(n,t)}let Rc={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Ac.get(n);if(t==="objectStoreNames")return n.objectStoreNames||qp.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Mn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function GI(n){Rc=n(Rc)}function HI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=n.call(tc(this),t,...e);return qp.set(r,t.sort?t.sort():[t]),Mn(r)}:$I().includes(n)?function(...t){return n.apply(tc(this),t),Mn(jp.get(this))}:function(...t){return Mn(n.apply(tc(this),t))}}function WI(n){return typeof n=="function"?HI(n):(n instanceof IDBTransaction&&zI(n),jI(n,qI())?new Proxy(n,Rc):n)}function Mn(n){if(n instanceof IDBRequest)return KI(n);if(Za.has(n))return Za.get(n);const t=WI(n);return t!==n&&(Za.set(n,t),Il.set(t,n)),t}const tc=n=>Il.get(n);function QI(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Mn(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Mn(o.result),l.oldVersion,l.newVersion,Mn(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}const JI=["get","getKey","getAll","getAllKeys","count"],YI=["put","add","delete","clear"],ec=new Map;function Jh(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(ec.get(t))return ec.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=YI.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(s||JI.includes(e)))return;const i=async function(o,...c){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(c.shift())),(await Promise.all([u[e](...c),s&&l.done]))[0]};return ec.set(t,i),i}GI(n=>({...n,get:(t,e,r)=>Jh(t,e)||n.get(t,e,r),has:(t,e)=>!!Jh(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(ZI(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function ZI(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Sc="@firebase/app",Yh="0.10.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new Up("@firebase/app"),tT="@firebase/app-compat",eT="@firebase/analytics-compat",nT="@firebase/analytics",rT="@firebase/app-check-compat",sT="@firebase/app-check",iT="@firebase/auth",oT="@firebase/auth-compat",aT="@firebase/database",cT="@firebase/data-connect",lT="@firebase/database-compat",uT="@firebase/functions",hT="@firebase/functions-compat",fT="@firebase/installations",dT="@firebase/installations-compat",pT="@firebase/messaging",mT="@firebase/messaging-compat",gT="@firebase/performance",_T="@firebase/performance-compat",yT="@firebase/remote-config",ET="@firebase/remote-config-compat",vT="@firebase/storage",IT="@firebase/storage-compat",TT="@firebase/firestore",wT="@firebase/vertexai",bT="@firebase/firestore-compat",AT="firebase",RT="11.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc="[DEFAULT]",ST={[Sc]:"fire-core",[tT]:"fire-core-compat",[nT]:"fire-analytics",[eT]:"fire-analytics-compat",[sT]:"fire-app-check",[rT]:"fire-app-check-compat",[iT]:"fire-auth",[oT]:"fire-auth-compat",[aT]:"fire-rtdb",[cT]:"fire-data-connect",[lT]:"fire-rtdb-compat",[uT]:"fire-fn",[hT]:"fire-fn-compat",[fT]:"fire-iid",[dT]:"fire-iid-compat",[pT]:"fire-fcm",[mT]:"fire-fcm-compat",[gT]:"fire-perf",[_T]:"fire-perf-compat",[yT]:"fire-rc",[ET]:"fire-rc-compat",[vT]:"fire-gcs",[IT]:"fire-gcs-compat",[TT]:"fire-fst",[bT]:"fire-fst-compat",[wT]:"fire-vertex","fire-js":"fire-js",[AT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new Map,PT=new Map,Cc=new Map;function Xh(n,t){try{n.container.addComponent(t)}catch(e){mn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Vo(n){const t=n.name;if(Cc.has(t))return mn.debug(`There were multiple attempts to register component ${t}.`),!1;Cc.set(t,n);for(const e of xo.values())Xh(e,n);for(const e of PT.values())Xh(e,n);return!0}function $p(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fn=new Bp("app","Firebase",CT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Fn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=RT;function Kp(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Pc,automaticDataCollectionEnabled:!1},t),s=r.name;if(typeof s!="string"||!s)throw Fn.create("bad-app-name",{appName:String(s)});if(e||(e=Mp()),!e)throw Fn.create("no-options");const i=xo.get(s);if(i){if(Co(e,i.options)&&Co(r,i.config))return i;throw Fn.create("duplicate-app",{appName:s})}const o=new MI(s);for(const l of Cc.values())o.addComponent(l);const c=new xT(e,r,o);return xo.set(s,c),c}function DT(n=Pc){const t=xo.get(n);if(!t&&n===Pc&&Mp())return Kp();if(!t)throw Fn.create("no-app",{appName:n});return t}function Yr(n,t,e){var r;let s=(r=ST[n])!==null&&r!==void 0?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),mn.warn(c.join(" "));return}Vo(new hi(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="firebase-heartbeat-database",kT=1,fi="firebase-heartbeat-store";let nc=null;function zp(){return nc||(nc=QI(NT,kT,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(fi)}catch(e){console.warn(e)}}}}).catch(n=>{throw Fn.create("idb-open",{originalErrorMessage:n.message})})),nc}async function OT(n){try{const e=(await zp()).transaction(fi),r=await e.objectStore(fi).get(Gp(n));return await e.done,r}catch(t){if(t instanceof fs)mn.warn(t.message);else{const e=Fn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});mn.warn(e.message)}}}async function Zh(n,t){try{const r=(await zp()).transaction(fi,"readwrite");await r.objectStore(fi).put(t,Gp(n)),await r.done}catch(e){if(e instanceof fs)mn.warn(e.message);else{const r=Fn.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});mn.warn(r.message)}}}function Gp(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=1024,FT=30*24*60*60*1e3;class LT{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new UT(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,e;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tf();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=FT}),this._storage.overwrite(this._heartbeatsCache))}catch(r){mn.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=tf(),{heartbeatsToSend:r,unsentEntries:s}=BT(this._heartbeatsCache.heartbeats),i=So(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return mn.warn(e),""}}}function tf(){return new Date().toISOString().substring(0,10)}function BT(n,t=MT){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ef(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),ef(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class UT{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lp()?CI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await OT(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Zh(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Zh(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function ef(n){return So(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n){Vo(new hi("platform-logger",t=>new XI(t),"PRIVATE")),Vo(new hi("heartbeat",t=>new LT(t),"PRIVATE")),Yr(Sc,Yh,n),Yr(Sc,Yh,"esm2017"),Yr("fire-js","")}jT("");var nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dr,Hp;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(w,y){function v(){}v.prototype=y.prototype,w.D=y.prototype,w.prototype=new v,w.prototype.constructor=w,w.C=function(b,A,R){for(var T=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)T[ee-2]=arguments[ee];return y.prototype[A].apply(b,T)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,e),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,y,v){v||(v=0);var b=Array(16);if(typeof y=="string")for(var A=0;16>A;++A)b[A]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(A=0;16>A;++A)b[A]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=w.g[0],v=w.g[1],A=w.g[2];var R=w.g[3],T=y+(R^v&(A^R))+b[0]+3614090360&4294967295;y=v+(T<<7&4294967295|T>>>25),T=R+(A^y&(v^A))+b[1]+3905402710&4294967295,R=y+(T<<12&4294967295|T>>>20),T=A+(v^R&(y^v))+b[2]+606105819&4294967295,A=R+(T<<17&4294967295|T>>>15),T=v+(y^A&(R^y))+b[3]+3250441966&4294967295,v=A+(T<<22&4294967295|T>>>10),T=y+(R^v&(A^R))+b[4]+4118548399&4294967295,y=v+(T<<7&4294967295|T>>>25),T=R+(A^y&(v^A))+b[5]+1200080426&4294967295,R=y+(T<<12&4294967295|T>>>20),T=A+(v^R&(y^v))+b[6]+2821735955&4294967295,A=R+(T<<17&4294967295|T>>>15),T=v+(y^A&(R^y))+b[7]+4249261313&4294967295,v=A+(T<<22&4294967295|T>>>10),T=y+(R^v&(A^R))+b[8]+1770035416&4294967295,y=v+(T<<7&4294967295|T>>>25),T=R+(A^y&(v^A))+b[9]+2336552879&4294967295,R=y+(T<<12&4294967295|T>>>20),T=A+(v^R&(y^v))+b[10]+4294925233&4294967295,A=R+(T<<17&4294967295|T>>>15),T=v+(y^A&(R^y))+b[11]+2304563134&4294967295,v=A+(T<<22&4294967295|T>>>10),T=y+(R^v&(A^R))+b[12]+1804603682&4294967295,y=v+(T<<7&4294967295|T>>>25),T=R+(A^y&(v^A))+b[13]+4254626195&4294967295,R=y+(T<<12&4294967295|T>>>20),T=A+(v^R&(y^v))+b[14]+2792965006&4294967295,A=R+(T<<17&4294967295|T>>>15),T=v+(y^A&(R^y))+b[15]+1236535329&4294967295,v=A+(T<<22&4294967295|T>>>10),T=y+(A^R&(v^A))+b[1]+4129170786&4294967295,y=v+(T<<5&4294967295|T>>>27),T=R+(v^A&(y^v))+b[6]+3225465664&4294967295,R=y+(T<<9&4294967295|T>>>23),T=A+(y^v&(R^y))+b[11]+643717713&4294967295,A=R+(T<<14&4294967295|T>>>18),T=v+(R^y&(A^R))+b[0]+3921069994&4294967295,v=A+(T<<20&4294967295|T>>>12),T=y+(A^R&(v^A))+b[5]+3593408605&4294967295,y=v+(T<<5&4294967295|T>>>27),T=R+(v^A&(y^v))+b[10]+38016083&4294967295,R=y+(T<<9&4294967295|T>>>23),T=A+(y^v&(R^y))+b[15]+3634488961&4294967295,A=R+(T<<14&4294967295|T>>>18),T=v+(R^y&(A^R))+b[4]+3889429448&4294967295,v=A+(T<<20&4294967295|T>>>12),T=y+(A^R&(v^A))+b[9]+568446438&4294967295,y=v+(T<<5&4294967295|T>>>27),T=R+(v^A&(y^v))+b[14]+3275163606&4294967295,R=y+(T<<9&4294967295|T>>>23),T=A+(y^v&(R^y))+b[3]+4107603335&4294967295,A=R+(T<<14&4294967295|T>>>18),T=v+(R^y&(A^R))+b[8]+1163531501&4294967295,v=A+(T<<20&4294967295|T>>>12),T=y+(A^R&(v^A))+b[13]+2850285829&4294967295,y=v+(T<<5&4294967295|T>>>27),T=R+(v^A&(y^v))+b[2]+4243563512&4294967295,R=y+(T<<9&4294967295|T>>>23),T=A+(y^v&(R^y))+b[7]+1735328473&4294967295,A=R+(T<<14&4294967295|T>>>18),T=v+(R^y&(A^R))+b[12]+2368359562&4294967295,v=A+(T<<20&4294967295|T>>>12),T=y+(v^A^R)+b[5]+4294588738&4294967295,y=v+(T<<4&4294967295|T>>>28),T=R+(y^v^A)+b[8]+2272392833&4294967295,R=y+(T<<11&4294967295|T>>>21),T=A+(R^y^v)+b[11]+1839030562&4294967295,A=R+(T<<16&4294967295|T>>>16),T=v+(A^R^y)+b[14]+4259657740&4294967295,v=A+(T<<23&4294967295|T>>>9),T=y+(v^A^R)+b[1]+2763975236&4294967295,y=v+(T<<4&4294967295|T>>>28),T=R+(y^v^A)+b[4]+1272893353&4294967295,R=y+(T<<11&4294967295|T>>>21),T=A+(R^y^v)+b[7]+4139469664&4294967295,A=R+(T<<16&4294967295|T>>>16),T=v+(A^R^y)+b[10]+3200236656&4294967295,v=A+(T<<23&4294967295|T>>>9),T=y+(v^A^R)+b[13]+681279174&4294967295,y=v+(T<<4&4294967295|T>>>28),T=R+(y^v^A)+b[0]+3936430074&4294967295,R=y+(T<<11&4294967295|T>>>21),T=A+(R^y^v)+b[3]+3572445317&4294967295,A=R+(T<<16&4294967295|T>>>16),T=v+(A^R^y)+b[6]+76029189&4294967295,v=A+(T<<23&4294967295|T>>>9),T=y+(v^A^R)+b[9]+3654602809&4294967295,y=v+(T<<4&4294967295|T>>>28),T=R+(y^v^A)+b[12]+3873151461&4294967295,R=y+(T<<11&4294967295|T>>>21),T=A+(R^y^v)+b[15]+530742520&4294967295,A=R+(T<<16&4294967295|T>>>16),T=v+(A^R^y)+b[2]+3299628645&4294967295,v=A+(T<<23&4294967295|T>>>9),T=y+(A^(v|~R))+b[0]+4096336452&4294967295,y=v+(T<<6&4294967295|T>>>26),T=R+(v^(y|~A))+b[7]+1126891415&4294967295,R=y+(T<<10&4294967295|T>>>22),T=A+(y^(R|~v))+b[14]+2878612391&4294967295,A=R+(T<<15&4294967295|T>>>17),T=v+(R^(A|~y))+b[5]+4237533241&4294967295,v=A+(T<<21&4294967295|T>>>11),T=y+(A^(v|~R))+b[12]+1700485571&4294967295,y=v+(T<<6&4294967295|T>>>26),T=R+(v^(y|~A))+b[3]+2399980690&4294967295,R=y+(T<<10&4294967295|T>>>22),T=A+(y^(R|~v))+b[10]+4293915773&4294967295,A=R+(T<<15&4294967295|T>>>17),T=v+(R^(A|~y))+b[1]+2240044497&4294967295,v=A+(T<<21&4294967295|T>>>11),T=y+(A^(v|~R))+b[8]+1873313359&4294967295,y=v+(T<<6&4294967295|T>>>26),T=R+(v^(y|~A))+b[15]+4264355552&4294967295,R=y+(T<<10&4294967295|T>>>22),T=A+(y^(R|~v))+b[6]+2734768916&4294967295,A=R+(T<<15&4294967295|T>>>17),T=v+(R^(A|~y))+b[13]+1309151649&4294967295,v=A+(T<<21&4294967295|T>>>11),T=y+(A^(v|~R))+b[4]+4149444226&4294967295,y=v+(T<<6&4294967295|T>>>26),T=R+(v^(y|~A))+b[11]+3174756917&4294967295,R=y+(T<<10&4294967295|T>>>22),T=A+(y^(R|~v))+b[2]+718787259&4294967295,A=R+(T<<15&4294967295|T>>>17),T=v+(R^(A|~y))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+y&4294967295,w.g[1]=w.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,w.g[2]=w.g[2]+A&4294967295,w.g[3]=w.g[3]+R&4294967295}r.prototype.u=function(w,y){y===void 0&&(y=w.length);for(var v=y-this.blockSize,b=this.B,A=this.h,R=0;R<y;){if(A==0)for(;R<=v;)s(this,w,R),R+=this.blockSize;if(typeof w=="string"){for(;R<y;)if(b[A++]=w.charCodeAt(R++),A==this.blockSize){s(this,b),A=0;break}}else for(;R<y;)if(b[A++]=w[R++],A==this.blockSize){s(this,b),A=0;break}}this.h=A,this.o+=y},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var y=1;y<w.length-8;++y)w[y]=0;var v=8*this.o;for(y=w.length-8;y<w.length;++y)w[y]=v&255,v/=256;for(this.u(w),w=Array(16),y=v=0;4>y;++y)for(var b=0;32>b;b+=8)w[v++]=this.g[y]>>>b&255;return w};function i(w,y){var v=c;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=y(w)}function o(w,y){this.h=y;for(var v=[],b=!0,A=w.length-1;0<=A;A--){var R=w[A]|0;b&&R==y||(v[A]=R,b=!1)}this.g=v}var c={};function l(w){return-128<=w&&128>w?i(w,function(y){return new o([y|0],0>y?-1:0)}):new o([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return p;if(0>w)return N(u(-w));for(var y=[],v=1,b=0;w>=v;b++)y[b]=w/v|0,v*=4294967296;return new o(y,0)}function f(w,y){if(w.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(w.charAt(0)=="-")return N(f(w.substring(1),y));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=u(Math.pow(y,8)),b=p,A=0;A<w.length;A+=8){var R=Math.min(8,w.length-A),T=parseInt(w.substring(A,A+R),y);8>R?(R=u(Math.pow(y,R)),b=b.j(R).add(u(T))):(b=b.j(v),b=b.add(u(T)))}return b}var p=l(0),g=l(1),_=l(16777216);n=o.prototype,n.m=function(){if(x(this))return-N(this).m();for(var w=0,y=1,v=0;v<this.g.length;v++){var b=this.i(v);w+=(0<=b?b:4294967296+b)*y,y*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(P(this))return"0";if(x(this))return"-"+N(this).toString(w);for(var y=u(Math.pow(w,6)),v=this,b="";;){var A=K(v,y).g;v=U(v,A.j(y));var R=((0<v.g.length?v.g[0]:v.h)>>>0).toString(w);if(v=A,P(v))return R+b;for(;6>R.length;)R="0"+R;b=R+b}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function P(w){if(w.h!=0)return!1;for(var y=0;y<w.g.length;y++)if(w.g[y]!=0)return!1;return!0}function x(w){return w.h==-1}n.l=function(w){return w=U(this,w),x(w)?-1:P(w)?0:1};function N(w){for(var y=w.g.length,v=[],b=0;b<y;b++)v[b]=~w.g[b];return new o(v,~w.h).add(g)}n.abs=function(){return x(this)?N(this):this},n.add=function(w){for(var y=Math.max(this.g.length,w.g.length),v=[],b=0,A=0;A<=y;A++){var R=b+(this.i(A)&65535)+(w.i(A)&65535),T=(R>>>16)+(this.i(A)>>>16)+(w.i(A)>>>16);b=T>>>16,R&=65535,T&=65535,v[A]=T<<16|R}return new o(v,v[v.length-1]&-2147483648?-1:0)};function U(w,y){return w.add(N(y))}n.j=function(w){if(P(this)||P(w))return p;if(x(this))return x(w)?N(this).j(N(w)):N(N(this).j(w));if(x(w))return N(this.j(N(w)));if(0>this.l(_)&&0>w.l(_))return u(this.m()*w.m());for(var y=this.g.length+w.g.length,v=[],b=0;b<2*y;b++)v[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<w.g.length;A++){var R=this.i(b)>>>16,T=this.i(b)&65535,ee=w.i(A)>>>16,Te=w.i(A)&65535;v[2*b+2*A]+=T*Te,L(v,2*b+2*A),v[2*b+2*A+1]+=R*Te,L(v,2*b+2*A+1),v[2*b+2*A+1]+=T*ee,L(v,2*b+2*A+1),v[2*b+2*A+2]+=R*ee,L(v,2*b+2*A+2)}for(b=0;b<y;b++)v[b]=v[2*b+1]<<16|v[2*b];for(b=y;b<2*y;b++)v[b]=0;return new o(v,0)};function L(w,y){for(;(w[y]&65535)!=w[y];)w[y+1]+=w[y]>>>16,w[y]&=65535,y++}function k(w,y){this.g=w,this.h=y}function K(w,y){if(P(y))throw Error("division by zero");if(P(w))return new k(p,p);if(x(w))return y=K(N(w),y),new k(N(y.g),N(y.h));if(x(y))return y=K(w,N(y)),new k(N(y.g),y.h);if(30<w.g.length){if(x(w)||x(y))throw Error("slowDivide_ only works with positive integers.");for(var v=g,b=y;0>=b.l(w);)v=tt(v),b=tt(b);var A=ct(v,1),R=ct(b,1);for(b=ct(b,2),v=ct(v,2);!P(b);){var T=R.add(b);0>=T.l(w)&&(A=A.add(v),R=T),b=ct(b,1),v=ct(v,1)}return y=U(w,A.j(y)),new k(A,y)}for(A=p;0<=w.l(y);){for(v=Math.max(1,Math.floor(w.m()/y.m())),b=Math.ceil(Math.log(v)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),R=u(v),T=R.j(y);x(T)||0<T.l(w);)v-=b,R=u(v),T=R.j(y);P(R)&&(R=g),A=A.add(R),w=U(w,T)}return new k(A,w)}n.A=function(w){return K(this,w).h},n.and=function(w){for(var y=Math.max(this.g.length,w.g.length),v=[],b=0;b<y;b++)v[b]=this.i(b)&w.i(b);return new o(v,this.h&w.h)},n.or=function(w){for(var y=Math.max(this.g.length,w.g.length),v=[],b=0;b<y;b++)v[b]=this.i(b)|w.i(b);return new o(v,this.h|w.h)},n.xor=function(w){for(var y=Math.max(this.g.length,w.g.length),v=[],b=0;b<y;b++)v[b]=this.i(b)^w.i(b);return new o(v,this.h^w.h)};function tt(w){for(var y=w.g.length+1,v=[],b=0;b<y;b++)v[b]=w.i(b)<<1|w.i(b-1)>>>31;return new o(v,w.h)}function ct(w,y){var v=y>>5;y%=32;for(var b=w.g.length-v,A=[],R=0;R<b;R++)A[R]=0<y?w.i(R+v)>>>y|w.i(R+v+1)<<32-y:w.i(R+v);return new o(A,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Hp=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,dr=o}).apply(typeof nf<"u"?nf:typeof self<"u"?self:typeof window<"u"?window:{});var Yi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wp,Bs,Qp,lo,xc,Jp,Yp,Xp;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function e(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yi=="object"&&Yi];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=e(this);function s(a,h){if(h)t:{var d=r;a=a.split(".");for(var m=0;m<a.length-1;m++){var C=a[m];if(!(C in d))break t;d=d[C]}a=a[a.length-1],m=d[a],h=h(m),h!=m&&h!=null&&t(d,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var d=0,m=!1,C={next:function(){if(!m&&d<a.length){var D=d++;return{value:h(D,a[D]),done:!1}}return m=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,d){return d})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function l(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,m),a.apply(h,C)}}return function(){return a.apply(h,arguments)}}function g(a,h,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function _(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function P(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,C,D){for(var H=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)H[Vt-2]=arguments[Vt];return h.prototype[C].apply(m,H)}}function x(a){const h=a.length;if(0<h){const d=Array(h);for(let m=0;m<h;m++)d[m]=a[m];return d}return[]}function N(a,h){for(let d=1;d<arguments.length;d++){const m=arguments[d];if(l(m)){const C=a.length||0,D=m.length||0;a.length=C+D;for(let H=0;H<D;H++)a[C+H]=m[H]}else a.push(m)}}class U{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function L(a){return/^[\s\xa0]*$/.test(a)}function k(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function K(a){return K[" "](a),a}K[" "]=function(){};var tt=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function ct(a,h,d){for(const m in a)h.call(d,a[m],m,a)}function w(a,h){for(const d in a)h.call(void 0,a[d],d,a)}function y(a){const h={};for(const d in a)h[d]=a[d];return h}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(a,h){let d,m;for(let C=1;C<arguments.length;C++){m=arguments[C];for(d in m)a[d]=m[d];for(let D=0;D<v.length;D++)d=v[D],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function A(a){var h=1;a=a.split(":");const d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function R(a){c.setTimeout(()=>{throw a},0)}function T(){var a=Se;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class ee{constructor(){this.h=this.g=null}add(h,d){const m=Te.get();m.set(h,d),this.h?this.h.next=m:this.g=m,this.h=m}}var Te=new U(()=>new Nt,a=>a.reset());class Nt{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let ut,gt=!1,Se=new ee,$e=()=>{const a=c.Promise.resolve(void 0);ut=()=>{a.then(ke)}};var ke=()=>{for(var a;a=T();){try{a.h.call(a.g)}catch(d){R(d)}var h=Te;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}gt=!1};function Bt(){this.s=this.s,this.C=this.C}Bt.prototype.s=!1,Bt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Bt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ut(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Ut.prototype.h=function(){this.defaultPrevented=!0};var vn=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const d=()=>{};c.addEventListener("test",d,h),c.removeEventListener("test",d,h)}catch{}return a}();function We(a,h){if(Ut.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(tt){t:{try{K(h.nodeName);var C=!0;break t}catch{}C=!1}C||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:we[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&We.aa.h.call(this)}}P(We,Ut);var we={2:"touch",3:"pen",4:"mouse"};We.prototype.h=function(){We.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),X=0;function Q(a,h,d,m,C){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!m,this.ha=C,this.key=++X,this.da=this.fa=!1}function et(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function yt(a){this.src=a,this.g={},this.h=0}yt.prototype.add=function(a,h,d,m,C){var D=a.toString();a=this.g[D],a||(a=this.g[D]=[],this.h++);var H=E(a,h,m,C);return-1<H?(h=a[H],d||(h.fa=!1)):(h=new Q(h,this.src,D,!!m,C),h.fa=d,a.push(h)),h};function xt(a,h){var d=h.type;if(d in a.g){var m=a.g[d],C=Array.prototype.indexOf.call(m,h,void 0),D;(D=0<=C)&&Array.prototype.splice.call(m,C,1),D&&(et(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function E(a,h,d,m){for(var C=0;C<a.length;++C){var D=a[C];if(!D.da&&D.listener==h&&D.capture==!!d&&D.ha==m)return C}return-1}var I="closure_lm_"+(1e6*Math.random()|0),V={};function B(a,h,d,m,C){if(Array.isArray(h)){for(var D=0;D<h.length;D++)B(a,h[D],d,m,C);return null}return d=st(d),a&&a[M]?a.K(h,d,u(m)?!!m.capture:!!m,C):O(a,h,d,!1,m,C)}function O(a,h,d,m,C,D){if(!h)throw Error("Invalid event type");var H=u(C)?!!C.capture:!!C,Vt=at(a);if(Vt||(a[I]=Vt=new yt(a)),d=Vt.add(h,d,m,H,D),d.proxy)return d;if(m=j(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)vn||(C=H),C===void 0&&(C=!1),a.addEventListener(h.toString(),m,C);else if(a.attachEvent)a.attachEvent(z(h.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function j(){function a(d){return h.call(a.src,a.listener,d)}const h=q;return a}function W(a,h,d,m,C){if(Array.isArray(h))for(var D=0;D<h.length;D++)W(a,h[D],d,m,C);else m=u(m)?!!m.capture:!!m,d=st(d),a&&a[M]?(a=a.i,h=String(h).toString(),h in a.g&&(D=a.g[h],d=E(D,d,m,C),-1<d&&(et(D[d]),Array.prototype.splice.call(D,d,1),D.length==0&&(delete a.g[h],a.h--)))):a&&(a=at(a))&&(h=a.g[h.toString()],a=-1,h&&(a=E(h,d,m,C)),(d=-1<a?h[a]:null)&&G(d))}function G(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[M])xt(h.i,a);else{var d=a.type,m=a.proxy;h.removeEventListener?h.removeEventListener(d,m,a.capture):h.detachEvent?h.detachEvent(z(d),m):h.addListener&&h.removeListener&&h.removeListener(m),(d=at(h))?(xt(d,a),d.h==0&&(d.src=null,h[I]=null)):et(a)}}}function z(a){return a in V?V[a]:V[a]="on"+a}function q(a,h){if(a.da)a=!0;else{h=new We(h,this);var d=a.listener,m=a.ha||a.src;a.fa&&G(a),a=d.call(m,h)}return a}function at(a){return a=a[I],a instanceof yt?a:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function st(a){return typeof a=="function"?a:(a[J]||(a[J]=function(h){return a.handleEvent(h)}),a[J])}function nt(){Bt.call(this),this.i=new yt(this),this.M=this,this.F=null}P(nt,Bt),nt.prototype[M]=!0,nt.prototype.removeEventListener=function(a,h,d,m){W(this,a,h,d,m)};function lt(a,h){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=h.type||h,typeof h=="string")h=new Ut(h,a);else if(h instanceof Ut)h.target=h.target||a;else{var C=h;h=new Ut(m,a),b(h,C)}if(C=!0,d)for(var D=d.length-1;0<=D;D--){var H=h.g=d[D];C=bt(H,m,!0,h)&&C}if(H=h.g=a,C=bt(H,m,!0,h)&&C,C=bt(H,m,!1,h)&&C,d)for(D=0;D<d.length;D++)H=h.g=d[D],C=bt(H,m,!1,h)&&C}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],m=0;m<d.length;m++)et(d[m]);delete a.g[h],a.h--}}this.F=null},nt.prototype.K=function(a,h,d,m){return this.i.add(String(a),h,!1,d,m)},nt.prototype.L=function(a,h,d,m){return this.i.add(String(a),h,!0,d,m)};function bt(a,h,d,m){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var C=!0,D=0;D<h.length;++D){var H=h[D];if(H&&!H.da&&H.capture==d){var Vt=H.listener,re=H.ha||H.src;H.fa&&xt(a.i,H),C=Vt.call(re,m)!==!1&&C}}return C&&!m.defaultPrevented}function Tt(a,h,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(a,h||0)}function oe(a){a.g=Tt(()=>{a.g=null,a.i&&(a.i=!1,oe(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Yt extends Bt{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(a){Bt.call(this),this.h=a,this.g={}}P(ne,Bt);var ae=[];function In(a){ct(a.g,function(h,d){this.g.hasOwnProperty(d)&&G(h)},a),a.g={}}ne.prototype.N=function(){ne.aa.N.call(this),In(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Sr=c.JSON.stringify,me=c.JSON.parse,Oe=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function Pr(){}Pr.prototype.h=null;function su(a){return a.h||(a.h=a.i())}function iu(){}var ys={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ta(){Ut.call(this,"d")}P(Ta,Ut);function wa(){Ut.call(this,"c")}P(wa,Ut);var Qn={},ou=null;function Ni(){return ou=ou||new nt}Qn.La="serverreachability";function au(a){Ut.call(this,Qn.La,a)}P(au,Ut);function Es(a){const h=Ni();lt(h,new au(h))}Qn.STAT_EVENT="statevent";function cu(a,h){Ut.call(this,Qn.STAT_EVENT,a),this.stat=h}P(cu,Ut);function ge(a){const h=Ni();lt(h,new cu(h,a))}Qn.Ma="timingevent";function lu(a,h){Ut.call(this,Qn.Ma,a),this.size=h}P(lu,Ut);function vs(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},h)}function Is(){this.g=!0}Is.prototype.xa=function(){this.g=!1};function Wg(a,h,d,m,C,D){a.info(function(){if(a.g)if(D)for(var H="",Vt=D.split("&"),re=0;re<Vt.length;re++){var wt=Vt[re].split("=");if(1<wt.length){var ce=wt[0];wt=wt[1];var le=ce.split("_");H=2<=le.length&&le[1]=="type"?H+(ce+"="+wt+"&"):H+(ce+"=redacted&")}}else H=null;else H=D;return"XMLHTTP REQ ("+m+") [attempt "+C+"]: "+h+`
`+d+`
`+H})}function Qg(a,h,d,m,C,D,H){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+C+"]: "+h+`
`+d+`
`+D+" "+H})}function Cr(a,h,d,m){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Yg(a,d)+(m?" "+m:"")})}function Jg(a,h){a.info(function(){return"TIMEOUT: "+h})}Is.prototype.info=function(){};function Yg(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var C=m[1];if(Array.isArray(C)&&!(1>C.length)){var D=C[0];if(D!="noop"&&D!="stop"&&D!="close")for(var H=1;H<C.length;H++)C[H]=""}}}}return Sr(d)}catch{return h}}var ki={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},uu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ba;function Oi(){}P(Oi,Pr),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},ba=new Oi;function Tn(a,h,d,m){this.j=a,this.i=h,this.l=d,this.R=m||1,this.U=new ne(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hu}function hu(){this.i=null,this.g="",this.h=!1}var fu={},Aa={};function Ra(a,h,d){a.L=1,a.v=Bi(rn(h)),a.m=d,a.P=!0,du(a,null)}function du(a,h){a.F=Date.now(),Mi(a),a.A=rn(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),Su(d.i,"t",m),a.C=0,d=a.j.J,a.h=new hu,a.g=zu(a.j,d?h:null,!a.m),0<a.O&&(a.M=new Yt(g(a.Y,a,a.g),a.O)),h=a.U,d=a.g,m=a.ca;var C="readystatechange";Array.isArray(C)||(C&&(ae[0]=C.toString()),C=ae);for(var D=0;D<C.length;D++){var H=B(d,C[D],m||h.handleEvent,!1,h.h||h);if(!H)break;h.g[H.key]=H}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Es(),Wg(a.i,a.u,a.A,a.l,a.R,a.m)}Tn.prototype.ca=function(a){a=a.target;const h=this.M;h&&sn(a)==3?h.j():this.Y(a)},Tn.prototype.Y=function(a){try{if(a==this.g)t:{const le=sn(this.g);var h=this.g.Ba();const Dr=this.g.Z();if(!(3>le)&&(le!=3||this.g&&(this.h.h||this.g.oa()||ku(this.g)))){this.J||le!=4||h==7||(h==8||0>=Dr?Es(3):Es(2)),Sa(this);var d=this.g.Z();this.X=d;e:if(pu(this)){var m=ku(this.g);a="";var C=m.length,D=sn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jn(this),Ts(this);var H="";break e}this.h.i=new c.TextDecoder}for(h=0;h<C;h++)this.h.h=!0,a+=this.h.i.decode(m[h],{stream:!(D&&h==C-1)});m.length=0,this.h.g+=a,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=d==200,Qg(this.i,this.u,this.A,this.l,this.R,le,d),this.o){if(this.T&&!this.K){e:{if(this.g){var Vt,re=this.g;if((Vt=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(Vt)){var wt=Vt;break e}}wt=null}if(d=wt)Cr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pa(this,d);else{this.o=!1,this.s=3,ge(12),Jn(this),Ts(this);break t}}if(this.P){d=!0;let Ke;for(;!this.J&&this.C<H.length;)if(Ke=Xg(this,H),Ke==Aa){le==4&&(this.s=4,ge(14),d=!1),Cr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ke==fu){this.s=4,ge(15),Cr(this.i,this.l,H,"[Invalid Chunk]"),d=!1;break}else Cr(this.i,this.l,Ke,null),Pa(this,Ke);if(pu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),le!=4||H.length!=0||this.h.h||(this.s=1,ge(16),d=!1),this.o=this.o&&d,!d)Cr(this.i,this.l,H,"[Invalid Chunked Response]"),Jn(this),Ts(this);else if(0<H.length&&!this.W){this.W=!0;var ce=this.j;ce.g==this&&ce.ba&&!ce.M&&(ce.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),ka(ce),ce.M=!0,ge(11))}}else Cr(this.i,this.l,H,null),Pa(this,H);le==4&&Jn(this),this.o&&!this.J&&(le==4?ju(this.j,this):(this.o=!1,Mi(this)))}else m_(this.g),d==400&&0<H.indexOf("Unknown SID")?(this.s=3,ge(12)):(this.s=0,ge(13)),Jn(this),Ts(this)}}}catch{}finally{}};function pu(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Xg(a,h){var d=a.C,m=h.indexOf(`
`,d);return m==-1?Aa:(d=Number(h.substring(d,m)),isNaN(d)?fu:(m+=1,m+d>h.length?Aa:(h=h.slice(m,m+d),a.C=m+d,h)))}Tn.prototype.cancel=function(){this.J=!0,Jn(this)};function Mi(a){a.S=Date.now()+a.I,mu(a,a.I)}function mu(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=vs(g(a.ba,a),h)}function Sa(a){a.B&&(c.clearTimeout(a.B),a.B=null)}Tn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Jg(this.i,this.A),this.L!=2&&(Es(),ge(17)),Jn(this),this.s=2,Ts(this)):mu(this,this.S-a)};function Ts(a){a.j.G==0||a.J||ju(a.j,a)}function Jn(a){Sa(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,In(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Pa(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Ca(d.h,a))){if(!a.K&&Ca(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var C=m;if(C[0]==0){t:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)zi(d),$i(d);else break t;Na(d),ge(18)}}else d.za=C[1],0<d.za-d.T&&37500>C[2]&&d.F&&d.v==0&&!d.C&&(d.C=vs(g(d.Za,d),6e3));if(1>=yu(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Xn(d,11)}else if((a.K||d.g==a)&&zi(d),!L(h))for(C=d.Da.g.parse(h),h=0;h<C.length;h++){let wt=C[h];if(d.T=wt[0],wt=wt[1],d.G==2)if(wt[0]=="c"){d.K=wt[1],d.ia=wt[2];const ce=wt[3];ce!=null&&(d.la=ce,d.j.info("VER="+d.la));const le=wt[4];le!=null&&(d.Aa=le,d.j.info("SVER="+d.Aa));const Dr=wt[5];Dr!=null&&typeof Dr=="number"&&0<Dr&&(m=1.5*Dr,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;const Ke=a.g;if(Ke){const Hi=Ke.g?Ke.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hi){var D=m.h;D.g||Hi.indexOf("spdy")==-1&&Hi.indexOf("quic")==-1&&Hi.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(xa(D,D.h),D.h=null))}if(m.D){const Oa=Ke.g?Ke.g.getResponseHeader("X-HTTP-Session-Id"):null;Oa&&(m.ya=Oa,Ot(m.I,m.D,Oa))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var H=a;if(m.qa=Ku(m,m.J?m.ia:null,m.W),H.K){Eu(m.h,H);var Vt=H,re=m.L;re&&(Vt.I=re),Vt.B&&(Sa(Vt),Mi(Vt)),m.g=H}else Bu(m);0<d.i.length&&Ki(d)}else wt[0]!="stop"&&wt[0]!="close"||Xn(d,7);else d.G==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?Xn(d,7):Da(d):wt[0]!="noop"&&d.l&&d.l.ta(wt),d.v=0)}}Es(4)}catch{}}var Zg=class{constructor(a,h){this.g=a,this.map=h}};function gu(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _u(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function yu(a){return a.h?1:a.g?a.g.size:0}function Ca(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function xa(a,h){a.g?a.g.add(h):a.h=h}function Eu(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}gu.prototype.cancel=function(){if(this.i=vu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function vu(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const d of a.g.values())h=h.concat(d.D);return h}return x(a.i)}function t_(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var h=[],d=a.length,m=0;m<d;m++)h.push(a[m]);return h}h=[],d=0;for(m in a)h[d++]=a[m];return h}function e_(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(const m in a)h[d++]=m;return h}}}function Iu(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=e_(a),m=t_(a),C=m.length,D=0;D<C;D++)h.call(void 0,m[D],d&&d[D],a)}var Tu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function n_(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),C=null;if(0<=m){var D=a[d].substring(0,m);C=a[d].substring(m+1)}else D=a[d];h(D,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Yn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Yn){this.h=a.h,Fi(this,a.j),this.o=a.o,this.g=a.g,Li(this,a.s),this.l=a.l;var h=a.i,d=new As;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),wu(this,d),this.m=a.m}else a&&(h=String(a).match(Tu))?(this.h=!1,Fi(this,h[1]||"",!0),this.o=ws(h[2]||""),this.g=ws(h[3]||"",!0),Li(this,h[4]),this.l=ws(h[5]||"",!0),wu(this,h[6]||"",!0),this.m=ws(h[7]||"")):(this.h=!1,this.i=new As(null,this.h))}Yn.prototype.toString=function(){var a=[],h=this.j;h&&a.push(bs(h,bu,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(bs(h,bu,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(bs(d,d.charAt(0)=="/"?i_:s_,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",bs(d,a_)),a.join("")};function rn(a){return new Yn(a)}function Fi(a,h,d){a.j=d?ws(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Li(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function wu(a,h,d){h instanceof As?(a.i=h,c_(a.i,a.h)):(d||(h=bs(h,o_)),a.i=new As(h,a.h))}function Ot(a,h,d){a.i.set(h,d)}function Bi(a){return Ot(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function ws(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function bs(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,r_),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function r_(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var bu=/[#\/\?@]/g,s_=/[#\?:]/g,i_=/[#\?]/g,o_=/[#\?@]/g,a_=/#/g;function As(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function wn(a){a.g||(a.g=new Map,a.h=0,a.i&&n_(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}n=As.prototype,n.add=function(a,h){wn(this),this.i=null,a=xr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function Au(a,h){wn(a),h=xr(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Ru(a,h){return wn(a),h=xr(a,h),a.g.has(h)}n.forEach=function(a,h){wn(this),this.g.forEach(function(d,m){d.forEach(function(C){a.call(h,C,m,this)},this)},this)},n.na=function(){wn(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let m=0;m<h.length;m++){const C=a[m];for(let D=0;D<C.length;D++)d.push(h[m])}return d},n.V=function(a){wn(this);let h=[];if(typeof a=="string")Ru(this,a)&&(h=h.concat(this.g.get(xr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},n.set=function(a,h){return wn(this),this.i=null,a=xr(this,a),Ru(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Su(a,h,d){Au(a,h),0<d.length&&(a.i=null,a.g.set(xr(a,h),x(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var m=h[d];const D=encodeURIComponent(String(m)),H=this.V(m);for(m=0;m<H.length;m++){var C=D;H[m]!==""&&(C+="="+encodeURIComponent(String(H[m]))),a.push(C)}}return this.i=a.join("&")};function xr(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function c_(a,h){h&&!a.j&&(wn(a),a.i=null,a.g.forEach(function(d,m){var C=m.toLowerCase();m!=C&&(Au(this,m),Su(this,C,d))},a)),a.j=h}function l_(a,h){const d=new Is;if(c.Image){const m=new Image;m.onload=_(bn,d,"TestLoadImage: loaded",!0,h,m),m.onerror=_(bn,d,"TestLoadImage: error",!1,h,m),m.onabort=_(bn,d,"TestLoadImage: abort",!1,h,m),m.ontimeout=_(bn,d,"TestLoadImage: timeout",!1,h,m),c.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else h(!1)}function u_(a,h){const d=new Is,m=new AbortController,C=setTimeout(()=>{m.abort(),bn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:m.signal}).then(D=>{clearTimeout(C),D.ok?bn(d,"TestPingServer: ok",!0,h):bn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(C),bn(d,"TestPingServer: error",!1,h)})}function bn(a,h,d,m,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),m(d)}catch{}}function h_(){this.g=new Oe}function f_(a,h,d){const m=d||"";try{Iu(a,function(C,D){let H=C;u(C)&&(H=Sr(C)),h.push(m+D+"="+encodeURIComponent(H))})}catch(C){throw h.push(m+"type="+encodeURIComponent("_badmap")),C}}function Ui(a){this.l=a.Ub||null,this.j=a.eb||!1}P(Ui,Pr),Ui.prototype.g=function(){return new ji(this.l,this.j)},Ui.prototype.i=function(a){return function(){return a}}({});function ji(a,h){nt.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(ji,nt),n=ji.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Ss(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Rs(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ss(this)),this.g&&(this.readyState=3,Ss(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pu(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Pu(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Rs(this):Ss(this),this.readyState==3&&Pu(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Rs(this))},n.Qa=function(a){this.g&&(this.response=a,Rs(this))},n.ga=function(){this.g&&Rs(this)};function Rs(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ss(a)}n.setRequestHeader=function(a,h){this.u.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function Ss(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ji.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Cu(a){let h="";return ct(a,function(d,m){h+=m,h+=":",h+=d,h+=`\r
`}),h}function Va(a,h,d){t:{for(m in d){var m=!1;break t}m=!0}m||(d=Cu(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):Ot(a,h,d))}function Kt(a){nt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(Kt,nt);var d_=/^https?$/i,p_=["POST","PUT"];n=Kt.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,h,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ba.g(),this.v=this.o?su(this.o):su(ba),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(D){xu(this,D);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var C in m)d.set(C,m[C]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(const D of m.keys())d.set(D,m.get(D));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(D=>D.toLowerCase()=="content-type"),C=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(p_,h,void 0))||m||C||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,H]of d)this.g.setRequestHeader(D,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nu(this),this.u=!0,this.g.send(a),this.u=!1}catch(D){xu(this,D)}};function xu(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,Vu(a),qi(a)}function Vu(a){a.A||(a.A=!0,lt(a,"complete"),lt(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,lt(this,"complete"),lt(this,"abort"),qi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qi(this,!0)),Kt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Du(this):this.bb())},n.bb=function(){Du(this)};function Du(a){if(a.h&&typeof o<"u"&&(!a.v[1]||sn(a)!=4||a.Z()!=2)){if(a.u&&sn(a)==4)Tt(a.Ea,0,a);else if(lt(a,"readystatechange"),sn(a)==4){a.h=!1;try{const H=a.Z();t:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break t;default:h=!1}var d;if(!(d=h)){var m;if(m=H===0){var C=String(a.D).match(Tu)[1]||null;!C&&c.self&&c.self.location&&(C=c.self.location.protocol.slice(0,-1)),m=!d_.test(C?C.toLowerCase():"")}d=m}if(d)lt(a,"complete"),lt(a,"success");else{a.m=6;try{var D=2<sn(a)?a.g.statusText:""}catch{D=""}a.l=D+" ["+a.Z()+"]",Vu(a)}}finally{qi(a)}}}}function qi(a,h){if(a.g){Nu(a);const d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||lt(a,"ready");try{d.onreadystatechange=m}catch{}}}function Nu(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function sn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<sn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),me(h)}};function ku(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function m_(a){const h={};a=(a.g&&2<=sn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(L(a[m]))continue;var d=A(a[m]);const C=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const D=h[C]||[];h[C]=D,D.push(d)}w(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ps(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function Ou(a){this.Aa=0,this.i=[],this.j=new Is,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ps("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ps("baseRetryDelayMs",5e3,a),this.cb=Ps("retryDelaySeedMs",1e4,a),this.Wa=Ps("forwardChannelMaxRetries",2,a),this.wa=Ps("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new gu(a&&a.concurrentRequestLimit),this.Da=new h_,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ou.prototype,n.la=8,n.G=1,n.connect=function(a,h,d,m){ge(0),this.W=a,this.H=h||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=Ku(this,null,this.W),Ki(this)};function Da(a){if(Mu(a),a.G==3){var h=a.U++,d=rn(a.I);if(Ot(d,"SID",a.K),Ot(d,"RID",h),Ot(d,"TYPE","terminate"),Cs(a,d),h=new Tn(a,a.j,h),h.L=2,h.v=Bi(rn(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=h.v,d=!0),d||(h.g=zu(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Mi(h)}$u(a)}function $i(a){a.g&&(ka(a),a.g.cancel(),a.g=null)}function Mu(a){$i(a),a.u&&(c.clearTimeout(a.u),a.u=null),zi(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function Ki(a){if(!_u(a.h)&&!a.s){a.s=!0;var h=a.Ga;ut||$e(),gt||(ut(),gt=!0),Se.add(h,a),a.B=0}}function g_(a,h){return yu(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=vs(g(a.Ga,a,h),qu(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const C=new Tn(this,this.j,a);let D=this.o;if(this.S&&(D?(D=y(D),b(D,this.S)):D=this.S),this.m!==null||this.O||(C.H=D,D=null),this.P)t:{for(var h=0,d=0;d<this.i.length;d++){e:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break e}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=d;break t}if(h===4096||d===this.i.length-1){h=d+1;break t}}h=1e3}else h=1e3;h=Lu(this,C,h),d=rn(this.I),Ot(d,"RID",a),Ot(d,"CVER",22),this.D&&Ot(d,"X-HTTP-Session-Id",this.D),Cs(this,d),D&&(this.O?h="headers="+encodeURIComponent(String(Cu(D)))+"&"+h:this.m&&Va(d,this.m,D)),xa(this.h,C),this.Ua&&Ot(d,"TYPE","init"),this.P?(Ot(d,"$req",h),Ot(d,"SID","null"),C.T=!0,Ra(C,d,null)):Ra(C,d,h),this.G=2}}else this.G==3&&(a?Fu(this,a):this.i.length==0||_u(this.h)||Fu(this))};function Fu(a,h){var d;h?d=h.l:d=a.U++;const m=rn(a.I);Ot(m,"SID",a.K),Ot(m,"RID",d),Ot(m,"AID",a.T),Cs(a,m),a.m&&a.o&&Va(m,a.m,a.o),d=new Tn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Lu(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),xa(a.h,d),Ra(d,m,h)}function Cs(a,h){a.H&&ct(a.H,function(d,m){Ot(h,m,d)}),a.l&&Iu({},function(d,m){Ot(h,m,d)})}function Lu(a,h,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;t:{var C=a.i;let D=-1;for(;;){const H=["count="+d];D==-1?0<d?(D=C[0].g,H.push("ofs="+D)):D=0:H.push("ofs="+D);let Vt=!0;for(let re=0;re<d;re++){let wt=C[re].g;const ce=C[re].map;if(wt-=D,0>wt)D=Math.max(0,C[re].g-100),Vt=!1;else try{f_(ce,H,"req"+wt+"_")}catch{m&&m(ce)}}if(Vt){m=H.join("&");break t}}}return a=a.i.splice(0,d),h.D=a,m}function Bu(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;ut||$e(),gt||(ut(),gt=!0),Se.add(h,a),a.v=0}}function Na(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=vs(g(a.Fa,a),qu(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Uu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=vs(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ge(10),$i(this),Uu(this))};function ka(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Uu(a){a.g=new Tn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=rn(a.qa);Ot(h,"RID","rpc"),Ot(h,"SID",a.K),Ot(h,"AID",a.T),Ot(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Ot(h,"TO",a.ja),Ot(h,"TYPE","xmlhttp"),Cs(a,h),a.m&&a.o&&Va(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Bi(rn(h)),d.m=null,d.P=!0,du(d,a)}n.Za=function(){this.C!=null&&(this.C=null,$i(this),Na(this),ge(19))};function zi(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function ju(a,h){var d=null;if(a.g==h){zi(a),ka(a),a.g=null;var m=2}else if(Ca(a.h,h))d=h.D,Eu(a.h,h),m=1;else return;if(a.G!=0){if(h.o)if(m==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var C=a.B;m=Ni(),lt(m,new lu(m,d)),Ki(a)}else Bu(a);else if(C=h.s,C==3||C==0&&0<h.X||!(m==1&&g_(a,h)||m==2&&Na(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),C){case 1:Xn(a,5);break;case 4:Xn(a,10);break;case 3:Xn(a,6);break;default:Xn(a,2)}}}function qu(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function Xn(a,h){if(a.j.info("Error code "+h),h==2){var d=g(a.fb,a),m=a.Xa;const C=!m;m=new Yn(m||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Fi(m,"https"),Bi(m),C?l_(m.toString(),d):u_(m.toString(),d)}else ge(2);a.G=0,a.l&&a.l.sa(h),$u(a),Mu(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ge(2)):(this.j.info("Failed to ping google.com"),ge(1))};function $u(a){if(a.G=0,a.ka=[],a.l){const h=vu(a.h);(h.length!=0||a.i.length!=0)&&(N(a.ka,h),N(a.ka,a.i),a.h.i.length=0,x(a.i),a.i.length=0),a.l.ra()}}function Ku(a,h,d){var m=d instanceof Yn?rn(d):new Yn(d);if(m.g!="")h&&(m.g=h+"."+m.g),Li(m,m.s);else{var C=c.location;m=C.protocol,h=h?h+"."+C.hostname:C.hostname,C=+C.port;var D=new Yn(null);m&&Fi(D,m),h&&(D.g=h),C&&Li(D,C),d&&(D.l=d),m=D}return d=a.D,h=a.ya,d&&h&&Ot(m,d,h),Ot(m,"VER",a.la),Cs(a,m),m}function zu(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Kt(new Ui({eb:d})):new Kt(a.pa),h.Ha(a.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}n=Gu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Gi(){}Gi.prototype.g=function(a,h){return new Pe(a,h)};function Pe(a,h){nt.call(this),this.g=new Ou(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!L(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!L(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Vr(this)}P(Pe,nt),Pe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pe.prototype.close=function(){Da(this.g)},Pe.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=Sr(a),a=d);h.i.push(new Zg(h.Ya++,a)),h.G==3&&Ki(h)},Pe.prototype.N=function(){this.g.l=null,delete this.j,Da(this.g),delete this.g,Pe.aa.N.call(this)};function Hu(a){Ta.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){t:{for(const d in h){a=d;break t}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}P(Hu,Ta);function Wu(){wa.call(this),this.status=1}P(Wu,wa);function Vr(a){this.g=a}P(Vr,Gu),Vr.prototype.ua=function(){lt(this.g,"a")},Vr.prototype.ta=function(a){lt(this.g,new Hu(a))},Vr.prototype.sa=function(a){lt(this.g,new Wu)},Vr.prototype.ra=function(){lt(this.g,"b")},Gi.prototype.createWebChannel=Gi.prototype.g,Pe.prototype.send=Pe.prototype.o,Pe.prototype.open=Pe.prototype.m,Pe.prototype.close=Pe.prototype.close,Xp=function(){return new Gi},Yp=function(){return Ni()},Jp=Qn,xc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ki.NO_ERROR=0,ki.TIMEOUT=8,ki.HTTP_ERROR=6,lo=ki,uu.COMPLETE="complete",Qp=uu,iu.EventType=ys,ys.OPEN="a",ys.CLOSE="b",ys.ERROR="c",ys.MESSAGE="d",nt.prototype.listen=nt.prototype.K,Bs=iu,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,Wp=Kt}).apply(typeof Yi<"u"?Yi:typeof self<"u"?self:typeof window<"u"?window:{});const rf="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}se.UNAUTHENTICATED=new se(null),se.GOOGLE_CREDENTIALS=new se("google-credentials-uid"),se.FIRST_PARTY=new se("first-party-uid"),se.MOCK_USER=new se("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ds="11.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r=new Up("@firebase/firestore");function $r(){return _r.logLevel}function $(n,...t){if(_r.logLevel<=vt.DEBUG){const e=t.map(Tl);_r.debug(`Firestore (${ds}): ${n}`,...e)}}function ve(n,...t){if(_r.logLevel<=vt.ERROR){const e=t.map(Tl);_r.error(`Firestore (${ds}): ${n}`,...e)}}function yr(n,...t){if(_r.logLevel<=vt.WARN){const e=t.map(Tl);_r.warn(`Firestore (${ds}): ${n}`,...e)}}function Tl(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(n="Unexpected state"){const t=`FIRESTORE (${ds}) INTERNAL ASSERTION FAILED: `+n;throw ve(t),new Error(t)}function it(n,t){n||rt()}function dt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends fs{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class qT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(se.UNAUTHENTICATED))}shutdown(){}}class $T{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class KT{constructor(t){this.t=t,this.currentUser=se.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){it(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,e(l)):Promise.resolve();let i=new pn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new pn,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},c=l=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new pn)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(it(typeof r.accessToken=="string"),new Zp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return it(t===null||typeof t=="string"),new se(t)}}class zT{constructor(t,e,r){this.l=t,this.h=e,this.P=r,this.type="FirstParty",this.user=se.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class GT{constructor(t,e,r){this.l=t,this.h=e,this.P=r}getToken(){return Promise.resolve(new zT(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(se.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class HT{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class WT{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){it(this.o===void 0);const r=i=>{i.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,$("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(it(typeof e.token=="string"),this.R=e.token,new HT(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=QT(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function pt(n,t){return n<t?-1:n>t?1:0}function rs(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}function em(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return $t.fromMillis(Date.now())}static fromDate(t){return $t.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new $t(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?pt(this.nanoseconds,t.nanoseconds):pt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ot(t)}static min(){return new ot(new $t(0,0))}static max(){return new ot(new $t(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(t,e,r){e===void 0?e=0:e>t.length&&rt(),r===void 0?r=t.length-e:r>t.length-e&&rt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return di.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof di?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class St extends di{construct(t,e,r){return new St(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Z(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new St(e)}static emptyPath(){return new St([])}}const JT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jt extends di{construct(t,e,r){return new jt(t,e,r)}static isValidIdentifier(t){return JT.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new jt(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Z(F.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if(c==="\\"){if(s+1===t.length)throw new Z(F.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Z(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Z(F.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new jt(e)}static emptyPath(){return new jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(t){this.path=t}static fromPath(t){return new Y(St.fromString(t))}static fromName(t){return new Y(St.fromString(t).popFirst(5))}static empty(){return new Y(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&St.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return St.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Y(new St(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(t,e,r,s){this.indexId=t,this.collectionGroup=e,this.fields=r,this.indexState=s}}function Vc(n){return n.fields.find(t=>t.kind===2)}function sr(n){return n.fields.filter(t=>t.kind!==2)}Do.UNKNOWN_ID=-1;class uo{constructor(t,e){this.fieldPath=t,this.kind=e}}class pi{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new pi(0,Ne.min())}}function YT(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ot.fromTimestamp(r===1e9?new $t(e+1,0):new $t(e,r));return new Ne(s,Y.empty(),t)}function nm(n){return new Ne(n.readTime,n.key,-1)}class Ne{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Ne(ot.min(),Y.empty(),-1)}static max(){return new Ne(ot.max(),Y.empty(),-1)}}function wl(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=Y.comparator(n.documentKey,t.documentKey),e!==0?e:pt(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function br(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==rm)throw n;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&rt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new S((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof S?e:S.resolve(e)}catch(e){return S.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):S.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):S.reject(e)}static resolve(t){return new S((e,r)=>{e(t)})}static reject(t){return new S((e,r)=>{r(t)})}static waitFor(t){return new S((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},l=>r(l))}),o=!0,i===s&&e()})}static or(t){let e=S.resolve(!1);for(const r of t)e=e.next(s=>s?S.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new S((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let l=0;l<i;l++){const u=l;e(t[u]).next(f=>{o[u]=f,++c,c===i&&r(o)},f=>s(f))}})}static doWhile(t,e){return new S((r,s)=>{const i=()=>{t()===!0?e().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new pn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Zs(t,e.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=bl(r.target.error);this.V.reject(new Zs(t,s))}}static open(t,e,r,s){try{return new ia(e,t.transaction(s,r))}catch(i){throw new Zs(e,i)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||($("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const e=this.transaction.objectStore(t);return new ZT(e)}}class Ln{constructor(t,e,r){this.name=t,this.version=e,this.p=r,Ln.S(Po())===12.2&&ve("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return $("SimpleDb","Removing database:",t),ir(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!Lp())return!1;if(Ln.v())return!0;const t=Po(),e=Ln.S(t),r=0<e&&e<10,s=im(t),i=0<s&&s<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||i)}static v(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.C)==="YES"}static F(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(t){return this.db||($("SimpleDb","Opening database:",this.name),this.db=await new Promise((e,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;e(o)},s.onblocked=()=>{r(new Zs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Z(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Z(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Zs(t,o))},s.onupgradeneeded=i=>{$("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{$("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(t){this.N=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,r,s){const i=e==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(t);const c=ia.open(this.db,t,i?"readonly":"readwrite",r),l=s(c).next(u=>(c.g(),u)).catch(u=>(c.abort(u),S.reject(u))).toPromise();return l.catch(()=>{}),await c.m,l}catch(c){const l=c,u=l.name!=="FirebaseError"&&o<3;if($("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function im(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}class XT{constructor(t){this.B=t,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(t){this.B=t}done(){this.k=!0}$(t){this.q=t}delete(){return ir(this.B.delete())}}class Zs extends Z{constructor(t,e){super(F.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Hn(n){return n.name==="IndexedDbTransactionError"}class ZT{constructor(t){this.store=t}put(t,e){let r;return e!==void 0?($("SimpleDb","PUT",this.store.name,t,e),r=this.store.put(e,t)):($("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),ir(r)}add(t){return $("SimpleDb","ADD",this.store.name,t,t),ir(this.store.add(t))}get(t){return ir(this.store.get(t)).next(e=>(e===void 0&&(e=null),$("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return $("SimpleDb","DELETE",this.store.name,t),ir(this.store.delete(t))}count(){return $("SimpleDb","COUNT",this.store.name),ir(this.store.count())}U(t,e){const r=this.options(t,e),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new S((o,c)=>{i.onerror=l=>{c(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(c,l)=>{o.push(l)}).next(()=>o)}}G(t,e){const r=this.store.getAll(t,e===null?void 0:e);return new S((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(t,e){$("SimpleDb","DELETE ALL",this.store.name);const r=this.options(t,e);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,c)=>c.delete())}J(t,e){let r;e?r=t:(r={},e=t);const s=this.cursor(r);return this.W(s,e)}Y(t){const e=this.cursor({});return new S((r,s)=>{e.onerror=i=>{const o=bl(i.target.error);s(o)},e.onsuccess=i=>{const o=i.target.result;o?t(o.primaryKey,o.value).next(c=>{c?o.continue():r()}):r()}})}W(t,e){const r=[];return new S((s,i)=>{t.onerror=o=>{i(o.target.error)},t.onsuccess=o=>{const c=o.target.result;if(!c)return void s();const l=new XT(c),u=e(c.primaryKey,c.value,l);if(u instanceof S){const f=u.catch(p=>(l.done(),S.reject(p)));r.push(f)}l.isDone?s():l.K===null?c.continue():c.continue(l.K)}}).next(()=>S.waitFor(r))}options(t,e){let r;return t!==void 0&&(typeof t=="string"?r=t:e=t),{index:r,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const r=this.store.index(t.index);return t.H?r.openKeyCursor(t.range,e):r.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function ir(n){return new S((t,e)=>{n.onsuccess=r=>{const s=r.target.result;t(s)},n.onerror=r=>{const s=bl(r.target.error);e(s)}})}let sf=!1;function bl(n){const t=Ln.S(Po());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const r=new Z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return sf||(sf=!0,setTimeout(()=>{throw r},0)),r}}return n}class tw{constructor(t,e){this.asyncQueue=t,this.Z=e,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(t){$("IndexBackfiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,async()=>{this.task=null;try{$("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Hn(e)?$("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await br(e)}await this.X(6e4)})}}class ew{constructor(t,e){this.localStore=t,this.persistence=e}async ee(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",e=>this.te(e,t))}te(t,e){const r=new Set;let s=e,i=!0;return S.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(o=>{if(o!==null&&!r.has(o))return $("IndexBackfiller",`Processing collection: ${o}`),this.ne(t,o,s).next(c=>{s-=c,r.add(o)});i=!1})).next(()=>e-s)}ne(t,e,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(s=>this.localStore.localDocuments.getNextDocuments(t,e,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(t,o).next(()=>this.re(s,i)).next(c=>($("IndexBackfiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(t,e,c))).next(()=>o.size)}))}re(t,e){let r=t;return e.changes.forEach((s,i)=>{const o=nm(i);wl(o,r)>0&&(r=o)}),new Ne(r.readTime,r.documentKey,Math.max(e.batchId,t.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ie(r),this.se=r=>e.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}Fe.oe=-1;function oa(n){return n==null}function mi(n){return n===0&&1/n==-1/0}function nw(n){return typeof n=="number"&&Number.isInteger(n)&&!mi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=of(t)),t=rw(n.get(e),t);return of(t)}function rw(n,t){let e=t;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}function of(n){return n+""}function Xe(n){const t=n.length;if(it(t>=2),t===2)return it(n.charAt(0)===""&&n.charAt(1)===""),St.emptyPath();const e=t-2,r=[];let s="";for(let i=0;i<t;){const o=n.indexOf("",i);switch((o<0||o>e)&&rt(),n.charAt(o+1)){case"":const c=n.substring(i,o);let l;s.length===0?l=c:(s+=c,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:rt()}i=o+2}return new St(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(n,t){return[n,pe(t)]}function om(n,t,e){return[n,pe(t),e]}const sw={},iw=["prefixPath","collectionGroup","readTime","documentId"],ow=["prefixPath","collectionGroup","documentId"],aw=["collectionGroup","readTime","prefixPath","documentId"],cw=["canonicalId","targetId"],lw=["targetId","path"],uw=["path","targetId"],hw=["collectionId","parent"],fw=["indexId","uid"],dw=["uid","sequenceNumber"],pw=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],mw=["indexId","uid","orderedDocumentKey"],gw=["userId","collectionPath","documentId"],_w=["userId","collectionPath","largestBatchId"],yw=["userId","collectionGroup","largestBatchId"],am=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ew=[...am,"documentOverlays"],cm=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],lm=cm,Al=[...lm,"indexConfiguration","indexState","indexEntries"],vw=Al,Iw=[...Al,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc extends sm{constructor(t,e){super(),this._e=t,this.currentSequenceNumber=e}}function Jt(n,t){const e=dt(n);return Ln.F(e._e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Ar(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function um(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t,e){this.comparator=t,this.root=e||ie.EMPTY}insert(t,e){return new Lt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ie.BLACK,null,null))}remove(t){return new Lt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ie.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Xi(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Xi(this.root,t,this.comparator,!1)}getReverseIterator(){return new Xi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Xi(this.root,t,this.comparator,!0)}}class Xi{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ie{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??ie.RED,this.left=s??ie.EMPTY,this.right=i??ie.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new ie(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):i===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ie.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return ie.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ie.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ie.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rt();const t=this.left.check();if(t!==this.right.check())throw rt();return t+(this.isRed()?0:1)}}ie.EMPTY=null,ie.RED=!0,ie.BLACK=!1;ie.EMPTY=new class{constructor(){this.size=0}get key(){throw rt()}get value(){throw rt()}get color(){throw rt()}get left(){throw rt()}get right(){throw rt()}copy(t,e,r,s,i){return this}insert(t,e,r){return new ie(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(t){this.comparator=t,this.data=new Lt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new lf(this.data.getIterator())}getIteratorFrom(t){return new lf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof Ct)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Ct(this.comparator);return e.data=t,e}}class lf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Or(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(t){this.fields=t,t.sort(jt.comparator)}static empty(){return new Le([])}unionWith(t){let e=new Ct(jt.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Le(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return rs(this.fields,t.fields,(e,r)=>e.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new hm("Invalid base64 string: "+i):i}}(t);return new Wt(e)}static fromUint8Array(t){const e=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(t);return new Wt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const r=new Uint8Array(e.length);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return pt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const Tw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gn(n){if(it(!!n),typeof n=="string"){let t=0;const e=Tw.exec(n);if(it(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ft(n.seconds),nanos:Ft(n.nanos)}}function Ft(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _n(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function aa(n){const t=n.mapValue.fields.__previous_value__;return Rl(t)?aa(t):t}function gi(n){const t=gn(n.mapValue.fields.__local_write_time__.timestampValue);return new $t(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(t,e,r,s,i,o,c,l,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=u}}class Er{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Er("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Er&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},fo={nullValue:"NULL_VALUE"};function Un(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rl(n)?4:fm(n)?9007199254740991:ca(n)?10:11:rt()}function nn(n,t){if(n===t)return!0;const e=Un(n);if(e!==Un(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return gi(n).isEqual(gi(t));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=gn(s.timestampValue),c=gn(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(s,i){return _n(s.bytesValue).isEqual(_n(i.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(s,i){return Ft(s.geoPointValue.latitude)===Ft(i.geoPointValue.latitude)&&Ft(s.geoPointValue.longitude)===Ft(i.geoPointValue.longitude)}(n,t);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ft(s.integerValue)===Ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ft(s.doubleValue),c=Ft(i.doubleValue);return o===c?mi(o)===mi(c):isNaN(o)&&isNaN(c)}return!1}(n,t);case 9:return rs(n.arrayValue.values||[],t.arrayValue.values||[],nn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(cf(o)!==cf(c))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!nn(o[l],c[l])))return!1;return!0}(n,t);default:return rt()}}function _i(n,t){return(n.values||[]).find(e=>nn(e,t))!==void 0}function jn(n,t){if(n===t)return 0;const e=Un(n),r=Un(t);if(e!==r)return pt(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return pt(n.booleanValue,t.booleanValue);case 2:return function(i,o){const c=Ft(i.integerValue||i.doubleValue),l=Ft(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,t);case 3:return uf(n.timestampValue,t.timestampValue);case 4:return uf(gi(n),gi(t));case 5:return pt(n.stringValue,t.stringValue);case 6:return function(i,o){const c=_n(i),l=_n(o);return c.compareTo(l)}(n.bytesValue,t.bytesValue);case 7:return function(i,o){const c=i.split("/"),l=o.split("/");for(let u=0;u<c.length&&u<l.length;u++){const f=pt(c[u],l[u]);if(f!==0)return f}return pt(c.length,l.length)}(n.referenceValue,t.referenceValue);case 8:return function(i,o){const c=pt(Ft(i.latitude),Ft(o.latitude));return c!==0?c:pt(Ft(i.longitude),Ft(o.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return hf(n.arrayValue,t.arrayValue);case 10:return function(i,o){var c,l,u,f;const p=i.fields||{},g=o.fields||{},_=(c=p.value)===null||c===void 0?void 0:c.arrayValue,P=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=pt(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((f=P==null?void 0:P.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:hf(_,P)}(n.mapValue,t.mapValue);case 11:return function(i,o){if(i===kn.mapValue&&o===kn.mapValue)return 0;if(i===kn.mapValue)return 1;if(o===kn.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=pt(l[p],f[p]);if(g!==0)return g;const _=jn(c[l[p]],u[f[p]]);if(_!==0)return _}return pt(l.length,f.length)}(n.mapValue,t.mapValue);default:throw rt()}}function uf(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return pt(n,t);const e=gn(n),r=gn(t),s=pt(e.seconds,r.seconds);return s!==0?s:pt(e.nanos,r.nanos)}function hf(n,t){const e=n.values||[],r=t.values||[];for(let s=0;s<e.length&&s<r.length;++s){const i=jn(e[s],r[s]);if(i)return i}return pt(e.length,r.length)}function ss(n){return Nc(n)}function Nc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const r=gn(e);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return _n(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return Y.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let r="[",s=!0;for(const i of e.values||[])s?s=!1:r+=",",r+=Nc(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(e){const r=Object.keys(e.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Nc(e.fields[o])}`;return s+"}"}(n.mapValue):rt()}function po(n){switch(Un(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=aa(n);return t?16+po(t):16;case 5:return 2*n.stringValue.length;case 6:return _n(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+po(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ar(r.fields,(i,o)=>{s+=i.length+po(o)}),s}(n.mapValue);default:throw rt()}}function Sl(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function kc(n){return!!n&&"integerValue"in n}function yi(n){return!!n&&"arrayValue"in n}function ff(n){return!!n&&"nullValue"in n}function df(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mo(n){return!!n&&"mapValue"in n}function ca(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="__vector__"}function ti(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Ar(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=ti(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ti(n.arrayValue.values[e]);return t}return Object.assign({},n)}function fm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const dm={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function bw(n){return"nullValue"in n?fo:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Sl(Er.empty(),Y.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ca(n)?dm:{mapValue:{}}:rt()}function Aw(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Sl(Er.empty(),Y.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?dm:"mapValue"in n?ca(n)?{mapValue:{}}:kn:rt()}function pf(n,t){const e=jn(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function mf(n,t){const e=jn(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(t){this.value=t}static empty(){return new Ae({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!mo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ti(e)}setAll(t){let e=jt.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const l=this.getFieldsMap(e);this.applyChanges(l,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=ti(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());mo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return nn(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];mo(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){Ar(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new Ae(ti(this.value))}}function pm(n){const t=[];return Ar(n.fields,(e,r)=>{const s=new jt([e]);if(mo(r)){const i=pm(r.mapValue).fields;if(i.length===0)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Le(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(t,e,r,s,i,o,c){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(t){return new zt(t,0,ot.min(),ot.min(),ot.min(),Ae.empty(),0)}static newFoundDocument(t,e,r,s){return new zt(t,1,e,ot.min(),r,s,0)}static newNoDocument(t,e){return new zt(t,2,e,ot.min(),ot.min(),Ae.empty(),0)}static newUnknownDocument(t,e){return new zt(t,3,e,ot.min(),ot.min(),Ae.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ae.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ae.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof zt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(t,e){this.position=t,this.inclusive=e}}function gf(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),e.key):r=jn(o,e.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function _f(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!nn(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(t,e="asc"){this.field=t,this.dir=e}}function Rw(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{}class _t extends mm{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new Sw(t,e,r):e==="array-contains"?new xw(t,r):e==="in"?new Im(t,r):e==="not-in"?new Vw(t,r):e==="array-contains-any"?new Dw(t,r):new _t(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new Pw(t,r):new Cw(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(jn(e,this.value)):e!==null&&Un(this.value)===Un(e)&&this.matchesComparison(jn(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return rt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pt extends mm{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new Pt(t,e)}matches(t){return os(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function os(n){return n.op==="and"}function Oc(n){return n.op==="or"}function Pl(n){return gm(n)&&os(n)}function gm(n){for(const t of n.filters)if(t instanceof Pt)return!1;return!0}function Mc(n){if(n instanceof _t)return n.field.canonicalString()+n.op.toString()+ss(n.value);if(Pl(n))return n.filters.map(t=>Mc(t)).join(",");{const t=n.filters.map(e=>Mc(e)).join(",");return`${n.op}(${t})`}}function _m(n,t){return n instanceof _t?function(r,s){return s instanceof _t&&r.op===s.op&&r.field.isEqual(s.field)&&nn(r.value,s.value)}(n,t):n instanceof Pt?function(r,s){return s instanceof Pt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&_m(o,s.filters[c]),!0):!1}(n,t):void rt()}function ym(n,t){const e=n.filters.concat(t);return Pt.create(e,n.op)}function Em(n){return n instanceof _t?function(e){return`${e.field.canonicalString()} ${e.op} ${ss(e.value)}`}(n):n instanceof Pt?function(e){return e.op.toString()+" {"+e.getFilters().map(Em).join(" ,")+"}"}(n):"Filter"}class Sw extends _t{constructor(t,e,r){super(t,e,r),this.key=Y.fromName(r.referenceValue)}matches(t){const e=Y.comparator(t.key,this.key);return this.matchesComparison(e)}}class Pw extends _t{constructor(t,e){super(t,"in",e),this.keys=vm("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Cw extends _t{constructor(t,e){super(t,"not-in",e),this.keys=vm("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function vm(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(r=>Y.fromName(r.referenceValue))}class xw extends _t{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return yi(e)&&_i(e.arrayValue,this.value)}}class Im extends _t{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&_i(this.value.arrayValue,e)}}class Vw extends _t{constructor(t,e){super(t,"not-in",e)}matches(t){if(_i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!_i(this.value.arrayValue,e)}}class Dw extends _t{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!yi(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>_i(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}}function Fc(n,t=null,e=[],r=[],s=null,i=null,o=null){return new Nw(n,t,e,r,s,i,o)}function vr(n){const t=dt(n);if(t.ue===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>Mc(r)).join(","),e+="|ob:",e+=t.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),oa(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>ss(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>ss(r)).join(",")),t.ue=e}return t.ue}function Si(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!Rw(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!_m(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!_f(n.startAt,t.startAt)&&_f(n.endAt,t.endAt)}function ko(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Oo(n,t){return n.filters.filter(e=>e instanceof _t&&e.field.isEqual(t))}function yf(n,t,e){let r=fo,s=!0;for(const i of Oo(n,t)){let o=fo,c=!0;switch(i.op){case"<":case"<=":o=bw(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,c=!1;break;case"!=":case"not-in":o=fo}pf({value:r,inclusive:s},{value:o,inclusive:c})<0&&(r=o,s=c)}if(e!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(t)){const o=e.position[i];pf({value:r,inclusive:s},{value:o,inclusive:e.inclusive})<0&&(r=o,s=e.inclusive);break}}return{value:r,inclusive:s}}function Ef(n,t,e){let r=kn,s=!0;for(const i of Oo(n,t)){let o=kn,c=!0;switch(i.op){case">=":case">":o=Aw(i.value),c=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,c=!1;break;case"!=":case"not-in":o=kn}mf({value:r,inclusive:s},{value:o,inclusive:c})>0&&(r=o,s=c)}if(e!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(t)){const o=e.position[i];mf({value:r,inclusive:s},{value:o,inclusive:e.inclusive})>0&&(r=o,s=e.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,l=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kw(n,t,e,r,s,i,o,c){return new la(n,t,e,r,s,i,o,c)}function Cl(n){return new la(n)}function vf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ow(n){return n.collectionGroup!==null}function ei(n){const t=dt(n);if(t.ce===null){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ct(jt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(t).forEach(i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new No(i,r))}),e.has(jt.keyField().canonicalString())||t.ce.push(new No(jt.keyField(),r))}return t.ce}function je(n){const t=dt(n);return t.le||(t.le=Mw(t,ei(n))),t.le}function Mw(n,t){if(n.limitType==="F")return Fc(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new No(s.field,i)});const e=n.endAt?new is(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new is(n.startAt.position,n.startAt.inclusive):null;return Fc(n.path,n.collectionGroup,t,n.filters,n.limit,e,r)}}function Lc(n,t,e){return new la(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function ua(n,t){return Si(je(n),je(t))&&n.limitType===t.limitType}function Tm(n){return`${vr(je(n))}|lt:${n.limitType}`}function Kr(n){return`Query(target=${function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map(s=>Em(s)).join(", ")}]`),oa(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(s=>ss(s)).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(s=>ss(s)).join(",")),`Target(${r})`}(je(n))}; limitType=${n.limitType})`}function Pi(n,t){return t.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,t)&&function(r,s){for(const i of ei(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,t)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,t)&&function(r,s){return!(r.startAt&&!function(o,c,l){const u=gf(o,c,l);return o.inclusive?u<=0:u<0}(r.startAt,ei(r),s)||r.endAt&&!function(o,c,l){const u=gf(o,c,l);return o.inclusive?u>=0:u>0}(r.endAt,ei(r),s))}(n,t)}function Fw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wm(n){return(t,e)=>{let r=!1;for(const s of ei(n)){const i=Lw(s,t,e);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Lw(n,t,e){const r=n.field.isKeyField()?Y.comparator(t.key,e.key):function(i,o,c){const l=o.data.field(i),u=c.data.field(i);return l!==null&&u!==null?jn(l,u):rt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return rt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,t))return i}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Ar(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return um(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw=new Lt(Y.comparator);function Ve(){return Bw}const bm=new Lt(Y.comparator);function Us(...n){let t=bm;for(const e of n)t=t.insert(e.key,e);return t}function Am(n){let t=bm;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function Ze(){return ni()}function Rm(){return ni()}function ni(){return new En(n=>n.toString(),(n,t)=>n.isEqual(t))}const Uw=new Lt(Y.comparator),jw=new Ct(Y.comparator);function mt(...n){let t=jw;for(const e of n)t=t.add(e);return t}const qw=new Ct(pt);function $w(){return qw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mi(t)?"-0":t}}function Sm(n){return{integerValue:""+n}}function Kw(n,t){return nw(t)?Sm(t):xl(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(){this._=void 0}}function zw(n,t,e){return n instanceof Ei?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rl(i)&&(i=aa(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(e,t):n instanceof as?Cm(n,t):n instanceof cs?xm(n,t):function(s,i){const o=Pm(s,i),c=If(o)+If(s.Pe);return kc(o)&&kc(s.Pe)?Sm(c):xl(s.serializer,c)}(n,t)}function Gw(n,t,e){return n instanceof as?Cm(n,t):n instanceof cs?xm(n,t):e}function Pm(n,t){return n instanceof vi?function(r){return kc(r)||function(i){return!!i&&"doubleValue"in i}(r)}(t)?t:{integerValue:0}:null}class Ei extends ha{}class as extends ha{constructor(t){super(),this.elements=t}}function Cm(n,t){const e=Vm(t);for(const r of n.elements)e.some(s=>nn(s,r))||e.push(r);return{arrayValue:{values:e}}}class cs extends ha{constructor(t){super(),this.elements=t}}function xm(n,t){let e=Vm(t);for(const r of n.elements)e=e.filter(s=>!nn(s,r));return{arrayValue:{values:e}}}class vi extends ha{constructor(t,e){super(),this.serializer=t,this.Pe=e}}function If(n){return Ft(n.integerValue||n.doubleValue)}function Vm(n){return yi(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(t,e){this.field=t,this.transform=e}}function Ww(n,t){return n.field.isEqual(t.field)&&function(r,s){return r instanceof as&&s instanceof as||r instanceof cs&&s instanceof cs?rs(r.elements,s.elements,nn):r instanceof vi&&s instanceof vi?nn(r.Pe,s.Pe):r instanceof Ei&&s instanceof Ei}(n.transform,t.transform)}class Qw{constructor(t,e){this.version=t,this.transformResults=e}}class De{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new De}static exists(t){return new De(void 0,t)}static updateTime(t){return new De(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function go(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class fa{}function Dm(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Vl(n.key,De.none()):new ps(n.key,n.data,De.none());{const e=n.data,r=Ae.empty();let s=new Ct(jt.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);o===null&&i.length>1&&(i=i.popLast(),o=e.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Wn(n.key,r,new Le(s.toArray()),De.none())}}function Jw(n,t,e){n instanceof ps?function(s,i,o){const c=s.value.clone(),l=wf(s.fieldTransforms,i,o.transformResults);c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,t,e):n instanceof Wn?function(s,i,o){if(!go(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=wf(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Nm(s)),l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,t,e):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,e)}function ri(n,t,e,r){return n instanceof ps?function(i,o,c,l){if(!go(i.precondition,o))return c;const u=i.value.clone(),f=bf(i.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof Wn?function(i,o,c,l){if(!go(i.precondition,o))return c;const u=bf(i.fieldTransforms,l,o),f=o.data;return f.setAll(Nm(i)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(n,t,e,r):function(i,o,c){return go(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,t,e)}function Yw(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=Pm(r.transform,s||null);i!=null&&(e===null&&(e=Ae.empty()),e.set(r.field,i))}return e||null}function Tf(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&rs(r,s,(i,o)=>Ww(i,o))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class ps extends fa{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Wn extends fa{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Nm(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function wf(n,t,e){const r=new Map;it(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,Gw(o,c,e[s]))}return r}function bf(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,zw(i,o,t))}return r}class Vl extends fa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class km extends fa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&Jw(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=ri(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=ri(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=Rm();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const l=Dm(o,c);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ot.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),mt())}isEqual(t){return this.batchId===t.batchId&&rs(this.mutations,t.mutations,(e,r)=>Tf(e,r))&&rs(this.baseMutations,t.baseMutations,(e,r)=>Tf(e,r))}}class Nl{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){it(t.mutations.length===r.length);let s=function(){return Uw}();const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Nl(t,e,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,Et;function Zw(n){switch(n){default:return rt();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function Om(n){if(n===void 0)return ve("GRPC error has no .code"),F.UNKNOWN;switch(n){case Gt.OK:return F.OK;case Gt.CANCELLED:return F.CANCELLED;case Gt.UNKNOWN:return F.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return F.INTERNAL;case Gt.UNAVAILABLE:return F.UNAVAILABLE;case Gt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Gt.NOT_FOUND:return F.NOT_FOUND;case Gt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Gt.ABORTED:return F.ABORTED;case Gt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Gt.DATA_LOSS:return F.DATA_LOSS;default:return rt()}}(Et=Gt||(Gt={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=new dr([4294967295,4294967295],0);function Af(n){const t=tb().encode(n),e=new Hp;return e.update(t),new Uint8Array(e.digest())}function Rf(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new dr([e,r],0),new dr([s,i],0)]}class Ol{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new js(`Invalid padding: ${e}`);if(r<0)throw new js(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new js(`Invalid hash count: ${r}`);if(t.length===0&&e!==0)throw new js(`Invalid padding when bitmap length is 0: ${e}`);this.Ie=8*t.length-e,this.Te=dr.fromNumber(this.Ie)}Ee(t,e,r){let s=t.add(e.multiply(dr.fromNumber(r)));return s.compare(eb)===1&&(s=new dr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const e=Af(t),[r,s]=Rf(e);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(t,e,r){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),o=new Ol(i,s,e);return r.forEach(c=>o.insert(c)),o}insert(t){if(this.Ie===0)return;const e=Af(t),[r,s]=Rf(e);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class js extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Ci.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new da(ot.min(),s,new Lt(pt),Ve(),mt())}}class Ci{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Ci(r,e,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(t,e,r,s){this.Re=t,this.removedTargetIds=e,this.key=r,this.Ve=s}}class Mm{constructor(t,e){this.targetId=t,this.me=e}}class Fm{constructor(t,e,r=Wt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class Sf{constructor(){this.fe=0,this.ge=Cf(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=mt(),e=mt(),r=mt();return this.ge.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:rt()}}),new Ci(this.pe,this.ye,t,e,r)}Ce(){this.we=!1,this.ge=Cf()}Fe(t,e){this.we=!0,this.ge=this.ge.insert(t,e)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,it(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class nb{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ve(),this.qe=Pf(),this.Qe=new Lt(pt)}Ke(t){for(const e of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(e,t.Ve):this.Ue(e,t.key,t.Ve);for(const e of t.removedTargetIds)this.Ue(e,t.key,t.Ve)}We(t){this.forEachTarget(t,e=>{const r=this.Ge(e);switch(t.state){case 0:this.ze(e)&&r.De(t.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(t.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(e);break;case 3:this.ze(e)&&(r.Ne(),r.De(t.resumeToken));break;case 4:this.ze(e)&&(this.je(e),r.De(t.resumeToken));break;default:rt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Be.forEach((r,s)=>{this.ze(s)&&e(s)})}He(t){const e=t.targetId,r=t.me.count,s=this.Je(e);if(s){const i=s.target;if(ko(i))if(r===0){const o=new Y(i.path);this.Ue(e,o,zt.newNoDocument(o,ot.min()))}else it(r===1);else{const o=this.Ye(e);if(o!==r){const c=this.Ze(t),l=c?this.Xe(c,t,o):1;if(l!==0){this.je(e);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(e,u)}}}}}Ze(t){const e=t.me.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=e;let o,c;try{o=_n(r).toUint8Array()}catch(l){if(l instanceof hm)return yr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Ol(o,s,i)}catch(l){return yr(l instanceof js?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(t,e,r){return e.me.count===r-this.nt(t,e.targetId)?0:2}nt(t,e){const r=this.Le.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.mightContain(c)||(this.Ue(e,i,null),s++)}),s}rt(t){const e=new Map;this.Be.forEach((i,o)=>{const c=this.Je(o);if(c){if(i.current&&ko(c.target)){const l=new Y(c.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,zt.newNoDocument(l,t))}i.be&&(e.set(o,i.ve()),i.Ce())}});let r=mt();this.qe.forEach((i,o)=>{let c=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(t));const s=new da(t,e,this.Qe,this.ke,r);return this.ke=Ve(),this.qe=Pf(),this.Qe=new Lt(pt),s}$e(t,e){if(!this.ze(t))return;const r=this.it(t,e.key)?2:0;this.Ge(t).Fe(e.key,r),this.ke=this.ke.insert(e.key,e),this.qe=this.qe.insert(e.key,this.st(e.key).add(t))}Ue(t,e,r){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,e)?s.Fe(e,1):s.Me(e),this.qe=this.qe.insert(e,this.st(e).delete(t)),r&&(this.ke=this.ke.insert(e,r))}removeTarget(t){this.Be.delete(t)}Ye(t){const e=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let e=this.Be.get(t);return e||(e=new Sf,this.Be.set(t,e)),e}st(t){let e=this.qe.get(t);return e||(e=new Ct(pt),this.qe=this.qe.insert(t,e)),e}ze(t){const e=this.Je(t)!==null;return e||$("WatchChangeAggregator","Detected inactive target",t),e}Je(t){const e=this.Be.get(t);return e&&e.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new Sf),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.Ue(t,e,null)})}it(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Pf(){return new Lt(Y.comparator)}function Cf(){return new Lt(Y.comparator)}const rb={asc:"ASCENDING",desc:"DESCENDING"},sb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ib={and:"AND",or:"OR"};class ob{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Bc(n,t){return n.useProto3Json||oa(t)?t:{value:t}}function ls(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Lm(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function ab(n,t){return ls(n,t.toTimestamp())}function Ie(n){return it(!!n),ot.fromTimestamp(function(e){const r=gn(e);return new $t(r.seconds,r.nanos)}(n))}function Ml(n,t){return Uc(n,t).canonicalString()}function Uc(n,t){const e=function(s){return new St(["projects",s.projectId,"databases",s.database])}(n).child("documents");return t===void 0?e:e.child(t)}function Bm(n){const t=St.fromString(n);return it(Wm(t)),t}function Mo(n,t){return Ml(n.databaseId,t.path)}function pr(n,t){const e=Bm(t);if(e.get(1)!==n.databaseId.projectId)throw new Z(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Z(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new Y(qm(e))}function Um(n,t){return Ml(n.databaseId,t)}function jm(n){const t=Bm(n);return t.length===4?St.emptyPath():qm(t)}function jc(n){return new St(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function qm(n){return it(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function xf(n,t,e){return{name:Mo(n,t),fields:e.value.mapValue.fields}}function cb(n,t,e){const r=pr(n,t.name),s=Ie(t.updateTime),i=t.createTime?Ie(t.createTime):ot.min(),o=new Ae({mapValue:{fields:t.fields}}),c=zt.newFoundDocument(r,s,i,o);return e&&c.setHasCommittedMutations(),e?c.setHasCommittedMutations():c}function lb(n,t){let e;if("targetChange"in t){t.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:rt()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(u,f){return u.useProto3Json?(it(f===void 0||typeof f=="string"),Wt.fromBase64String(f||"")):(it(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Wt.fromUint8Array(f||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const f=u.code===void 0?F.UNKNOWN:Om(u.code);return new Z(f,u.message||"")}(o);e=new Fm(r,s,i,c||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=pr(n,r.document.name),i=Ie(r.document.updateTime),o=r.document.createTime?Ie(r.document.createTime):ot.min(),c=new Ae({mapValue:{fields:r.document.fields}}),l=zt.newFoundDocument(s,i,o,c),u=r.targetIds||[],f=r.removedTargetIds||[];e=new _o(u,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=pr(n,r.document),i=r.readTime?Ie(r.readTime):ot.min(),o=zt.newNoDocument(s,i),c=r.removedTargetIds||[];e=new _o([],c,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=pr(n,r.document),i=r.removedTargetIds||[];e=new _o([],i,s,null)}else{if(!("filter"in t))return rt();{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Xw(s,i),c=r.targetId;e=new Mm(c,o)}}return e}function Fo(n,t){let e;if(t instanceof ps)e={update:xf(n,t.key,t.value)};else if(t instanceof Vl)e={delete:Mo(n,t.key)};else if(t instanceof Wn)e={update:xf(n,t.key,t.data),updateMask:mb(t.fieldMask)};else{if(!(t instanceof km))return rt();e={verify:Mo(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Ei)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof as)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof cs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof vi)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw rt()}(0,r))),t.precondition.isNone||(e.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:ab(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:rt()}(n,t.precondition)),e}function qc(n,t){const e=t.currentDocument?function(i){return i.updateTime!==void 0?De.updateTime(Ie(i.updateTime)):i.exists!==void 0?De.exists(i.exists):De.none()}(t.currentDocument):De.none(),r=t.updateTransforms?t.updateTransforms.map(s=>function(o,c){let l=null;if("setToServerValue"in c)it(c.setToServerValue==="REQUEST_TIME"),l=new Ei;else if("appendMissingElements"in c){const f=c.appendMissingElements.values||[];l=new as(f)}else if("removeAllFromArray"in c){const f=c.removeAllFromArray.values||[];l=new cs(f)}else"increment"in c?l=new vi(o,c.increment):rt();const u=jt.fromServerFormat(c.fieldPath);return new Hw(u,l)}(n,s)):[];if(t.update){t.update.name;const s=pr(n,t.update.name),i=new Ae({mapValue:{fields:t.update.fields}});if(t.updateMask){const o=function(l){const u=l.fieldPaths||[];return new Le(u.map(f=>jt.fromServerFormat(f)))}(t.updateMask);return new Wn(s,i,o,e,r)}return new ps(s,i,e,r)}if(t.delete){const s=pr(n,t.delete);return new Vl(s,e)}if(t.verify){const s=pr(n,t.verify);return new km(s,e)}return rt()}function ub(n,t){return n&&n.length>0?(it(t!==void 0),n.map(e=>function(s,i){let o=s.updateTime?Ie(s.updateTime):Ie(i);return o.isEqual(ot.min())&&(o=Ie(i)),new Qw(o,s.transformResults||[])}(e,t))):[]}function $m(n,t){return{documents:[Um(n,t.path)]}}function Km(n,t){const e={structuredQuery:{}},r=t.path;let s;t.collectionGroup!==null?(s=r,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),e.structuredQuery.from=[{collectionId:r.lastSegment()}]),e.parent=Um(n,s);const i=function(u){if(u.length!==0)return Hm(Pt.create(u,"and"))}(t.filters);i&&(e.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:zr(g.field),direction:fb(g.dir)}}(f))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const c=Bc(n,t.limit);return c!==null&&(e.structuredQuery.limit=c),t.startAt&&(e.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(t.endAt)),{_t:e,parent:s}}function zm(n){let t=jm(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){it(r===1);const f=e.from[0];f.allDescendants?s=f.collectionId:t=t.child(f.collectionId)}let i=[];e.where&&(i=function(p){const g=Gm(p);return g instanceof Pt&&Pl(g)?g.getFilters():[g]}(e.where));let o=[];e.orderBy&&(o=function(p){return p.map(g=>function(P){return new No(Gr(P.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(g))}(e.orderBy));let c=null;e.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,oa(g)?null:g}(e.limit));let l=null;e.startAt&&(l=function(p){const g=!!p.before,_=p.values||[];return new is(_,g)}(e.startAt));let u=null;return e.endAt&&(u=function(p){const g=!p.before,_=p.values||[];return new is(_,g)}(e.endAt)),kw(t,s,o,i,c,"F",l,u)}function hb(n,t){const e=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function Gm(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=Gr(e.unaryFilter.field);return _t.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Gr(e.unaryFilter.field);return _t.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gr(e.unaryFilter.field);return _t.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Gr(e.unaryFilter.field);return _t.create(o,"!=",{nullValue:"NULL_VALUE"});default:return rt()}}(n):n.fieldFilter!==void 0?function(e){return _t.create(Gr(e.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rt()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Pt.create(e.compositeFilter.filters.map(r=>Gm(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return rt()}}(e.compositeFilter.op))}(n):rt()}function fb(n){return rb[n]}function db(n){return sb[n]}function pb(n){return ib[n]}function zr(n){return{fieldPath:n.canonicalString()}}function Gr(n){return jt.fromServerFormat(n.fieldPath)}function Hm(n){return n instanceof _t?function(e){if(e.op==="=="){if(df(e.value))return{unaryFilter:{field:zr(e.field),op:"IS_NAN"}};if(ff(e.value))return{unaryFilter:{field:zr(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(df(e.value))return{unaryFilter:{field:zr(e.field),op:"IS_NOT_NAN"}};if(ff(e.value))return{unaryFilter:{field:zr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zr(e.field),op:db(e.op),value:e.value}}}(n):n instanceof Pt?function(e){const r=e.getFilters().map(s=>Hm(s));return r.length===1?r[0]:{compositeFilter:{op:pb(e.op),filters:r}}}(n):rt()}function mb(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Wm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t,e,r,s,i=ot.min(),o=ot.min(),c=Wt.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(t){return new fn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new fn(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new fn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new fn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(t){this.ct=t}}function gb(n,t){let e;if(t.document)e=cb(n.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const r=Y.fromSegments(t.noDocument.path),s=Tr(t.noDocument.readTime);e=zt.newNoDocument(r,s),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return rt();{const r=Y.fromSegments(t.unknownDocument.path),s=Tr(t.unknownDocument.version);e=zt.newUnknownDocument(r,s)}}return t.readTime&&e.setReadTime(function(s){const i=new $t(s[0],s[1]);return ot.fromTimestamp(i)}(t.readTime)),e}function Vf(n,t){const e=t.key,r={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:Lo(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(i,o){return{name:Mo(i,o.key),fields:o.data.value.mapValue.fields,updateTime:ls(i,o.version.toTimestamp()),createTime:ls(i,o.createTime.toTimestamp())}}(n.ct,t);else if(t.isNoDocument())r.noDocument={path:e.path.toArray(),readTime:Ir(t.version)};else{if(!t.isUnknownDocument())return rt();r.unknownDocument={path:e.path.toArray(),version:Ir(t.version)}}return r}function Lo(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function Ir(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Tr(n){const t=new $t(n.seconds,n.nanoseconds);return ot.fromTimestamp(t)}function or(n,t){const e=(t.baseMutations||[]).map(i=>qc(n.ct,i));for(let i=0;i<t.mutations.length-1;++i){const o=t.mutations[i];if(i+1<t.mutations.length&&t.mutations[i+1].transform!==void 0){const c=t.mutations[i+1];o.updateTransforms=c.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map(i=>qc(n.ct,i)),s=$t.fromMillis(t.localWriteTimeMs);return new Dl(t.batchId,s,e,r)}function qs(n){const t=Tr(n.readTime),e=n.lastLimboFreeSnapshotVersion!==void 0?Tr(n.lastLimboFreeSnapshotVersion):ot.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return it(i.documents.length===1),je(Cl(jm(i.documents[0])))}(n.query):function(i){return je(zm(i))}(n.query),new fn(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,Wt.fromBase64String(n.resumeToken))}function Jm(n,t){const e=Ir(t.snapshotVersion),r=Ir(t.lastLimboFreeSnapshotVersion);let s;s=ko(t.target)?$m(n.ct,t.target):Km(n.ct,t.target)._t;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:vr(t.target),readTime:e,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Ym(n){const t=zm({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Lc(t,t.limit,"L"):t}function rc(n,t){return new kl(t.largestBatchId,qc(n.ct,t.overlayMutation))}function Df(n,t){const e=t.path.lastSegment();return[n,pe(t.path.popLast()),e]}function Nf(n,t,e,r){return{indexId:n,uid:t,sequenceNumber:e,readTime:Ir(r.readTime),documentKey:pe(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{getBundleMetadata(t,e){return kf(t).get(e).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Tr(i.createTime),version:i.version}}(r)})}saveBundleMetadata(t,e){return kf(t).put(function(s){return{bundleId:s.id,createTime:Ir(Ie(s.createTime)),version:s.version}}(e))}getNamedQuery(t,e){return Of(t).get(e).next(r=>{if(r)return function(i){return{name:i.name,query:Ym(i.bundledQuery),readTime:Tr(i.readTime)}}(r)})}saveNamedQuery(t,e){return Of(t).put(function(s){return{name:s.name,readTime:Ir(Ie(s.readTime)),bundledQuery:s.bundledQuery}}(e))}}function kf(n){return Jt(n,"bundles")}function Of(n){return Jt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(t,e){this.serializer=t,this.userId=e}static lt(t,e){const r=e.uid||"";return new pa(t,r)}getOverlay(t,e){return Ns(t).get(Df(this.userId,e)).next(r=>r?rc(this.serializer,r):null)}getOverlays(t,e){const r=Ze();return S.forEach(e,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){const s=[];return r.forEach((i,o)=>{const c=new kl(e,o);s.push(this.ht(t,c))}),S.waitFor(s)}removeOverlaysForBatchId(t,e,r){const s=new Set;e.forEach(o=>s.add(pe(o.getCollectionPath())));const i=[];return s.forEach(o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Ns(t).j("collectionPathOverlayIndex",c))}),S.waitFor(i)}getOverlaysForCollection(t,e,r){const s=Ze(),i=pe(e),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ns(t).U("collectionPathOverlayIndex",o).next(c=>{for(const l of c){const u=rc(this.serializer,l);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(t,e,r,s){const i=Ze();let o;const c=IDBKeyRange.bound([this.userId,e,r],[this.userId,e,Number.POSITIVE_INFINITY],!0);return Ns(t).J({index:"collectionGroupOverlayIndex",range:c},(l,u,f)=>{const p=rc(this.serializer,u);i.size()<s||p.largestBatchId===o?(i.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>i)}ht(t,e){return Ns(t).put(function(s,i,o){const[c,l,u]=Df(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Fo(s.ct,o.mutation)}}(this.serializer,this.userId,e))}}function Ns(n){return Jt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{Pt(t){return Jt(t,"globals")}getSessionToken(t){return this.Pt(t).get("sessionToken").next(e=>{const r=e==null?void 0:e.value;return r?Wt.fromUint8Array(r):Wt.EMPTY_BYTE_STRING})}setSessionToken(t,e){return this.Pt(t).put({name:"sessionToken",value:e.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){}It(t,e){this.Tt(t,e),e.Et()}Tt(t,e){if("nullValue"in t)this.dt(e,5);else if("booleanValue"in t)this.dt(e,10),e.At(t.booleanValue?1:0);else if("integerValue"in t)this.dt(e,15),e.At(Ft(t.integerValue));else if("doubleValue"in t){const r=Ft(t.doubleValue);isNaN(r)?this.dt(e,13):(this.dt(e,15),mi(r)?e.At(0):e.At(r))}else if("timestampValue"in t){let r=t.timestampValue;this.dt(e,20),typeof r=="string"&&(r=gn(r)),e.Rt(`${r.seconds||""}`),e.At(r.nanos||0)}else if("stringValue"in t)this.Vt(t.stringValue,e),this.ft(e);else if("bytesValue"in t)this.dt(e,30),e.gt(_n(t.bytesValue)),this.ft(e);else if("referenceValue"in t)this.yt(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.dt(e,45),e.At(r.latitude||0),e.At(r.longitude||0)}else"mapValue"in t?fm(t)?this.dt(e,Number.MAX_SAFE_INTEGER):ca(t)?this.wt(t.mapValue,e):(this.St(t.mapValue,e),this.ft(e)):"arrayValue"in t?(this.bt(t.arrayValue,e),this.ft(e)):rt()}Vt(t,e){this.dt(e,25),this.Dt(t,e)}Dt(t,e){e.Rt(t)}St(t,e){const r=t.fields||{};this.dt(e,55);for(const s of Object.keys(r))this.Vt(s,e),this.Tt(r[s],e)}wt(t,e){var r,s;const i=t.fields||{};this.dt(e,53);const o="value",c=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(e,15),e.At(Ft(c)),this.Vt(o,e),this.Tt(i[o],e)}bt(t,e){const r=t.values||[];this.dt(e,50);for(const s of r)this.Tt(s,e)}yt(t,e){this.dt(e,37),Y.fromName(t).path.forEach(r=>{this.dt(e,60),this.Dt(r,e)})}dt(t,e){t.At(e)}ft(t){t.At(2)}}ar.vt=new ar;function Eb(n){if(n===0)return 8;let t=0;return!(n>>4)&&(t+=4,n<<=4),!(n>>6)&&(t+=2,n<<=2),!(n>>7)&&(t+=1),t}function Mf(n){const t=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Eb(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(t/8)}class vb{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(t){const e=t[Symbol.iterator]();let r=e.next();for(;!r.done;)this.Ft(r.value),r=e.next();this.Mt()}xt(t){const e=t[Symbol.iterator]();let r=e.next();for(;!r.done;)this.Ot(r.value),r=e.next();this.Nt()}Lt(t){for(const e of t){const r=e.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(e<"\uD800"||"\uDBFF"<e)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=e.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(t){for(const e of t){const r=e.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(e<"\uD800"||"\uDBFF"<e)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=e.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(t){const e=this.qt(t),r=Mf(e);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=e.length-r;s<e.length;++s)this.buffer[this.position++]=255&e[s]}Kt(t){const e=this.qt(t),r=Mf(e);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=e.length-r;s<e.length;++s)this.buffer[this.position++]=~(255&e[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(t){this.Qt(t.length),this.buffer.set(t,this.position),this.position+=t.length}zt(){return this.buffer.slice(0,this.position)}qt(t){const e=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(t),r=(128&e[0])!=0;e[0]^=r?255:128;for(let s=1;s<e.length;++s)e[s]^=r?255:0;return e}Ft(t){const e=255&t;e===0?(this.Ut(0),this.Ut(255)):e===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ot(t){const e=255&t;e===0?(this.Gt(0),this.Gt(255)):e===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(t){this.Qt(1),this.buffer[this.position++]=t}Gt(t){this.Qt(1),this.buffer[this.position++]=~t}Qt(t){const e=t+this.position;if(e<=this.buffer.length)return;let r=2*this.buffer.length;r<e&&(r=e);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Ib{constructor(t){this.jt=t}gt(t){this.jt.Ct(t)}Rt(t){this.jt.Lt(t)}At(t){this.jt.kt(t)}Et(){this.jt.$t()}}class Tb{constructor(t){this.jt=t}gt(t){this.jt.xt(t)}Rt(t){this.jt.Bt(t)}At(t){this.jt.Kt(t)}Et(){this.jt.Wt()}}class ks{constructor(){this.jt=new vb,this.Ht=new Ib(this.jt),this.Jt=new Tb(this.jt)}seed(t){this.jt.seed(t)}Yt(t){return t===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(t,e,r,s){this.indexId=t,this.documentKey=e,this.arrayValue=r,this.directionalValue=s}Zt(){const t=this.directionalValue.length,e=t===0||this.directionalValue[t-1]===255?t+1:t,r=new Uint8Array(e);return r.set(this.directionalValue,0),e!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new cr(this.indexId,this.documentKey,this.arrayValue,r)}}function Sn(n,t){let e=n.indexId-t.indexId;return e!==0?e:(e=Ff(n.arrayValue,t.arrayValue),e!==0?e:(e=Ff(n.directionalValue,t.directionalValue),e!==0?e:Y.comparator(n.documentKey,t.documentKey)))}function Ff(n,t){for(let e=0;e<n.length&&e<t.length;++e){const r=n[e]-t[e];if(r!==0)return r}return n.length-t.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(t){this.Xt=new Ct((e,r)=>jt.comparator(e.field,r.field)),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.en=t.orderBy,this.tn=[];for(const e of t.filters){const r=e;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(t){if(it(t.collectionGroup===this.collectionId),this.nn)return!1;const e=Vc(t);if(e!==void 0&&!this.sn(e))return!1;const r=sr(t);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const c=this.Xt.getIterator().getNext();if(!s.has(c.field.canonicalString())){const l=r[i];if(!this.on(c,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const c=r[i];if(o>=this.en.length||!this._n(this.en[o++],c))return!1}return!0}an(){if(this.nn)return null;let t=new Ct(jt.comparator);const e=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")e.push(new uo(r.field,2));else{if(t.has(r.field))continue;t=t.add(r.field),e.push(new uo(r.field,0))}for(const r of this.en)r.field.isKeyField()||t.has(r.field)||(t=t.add(r.field),e.push(new uo(r.field,r.dir==="asc"?0:1)));return new Do(Do.UNKNOWN_ID,this.collectionId,e,pi.empty())}sn(t){for(const e of this.tn)if(this.on(e,t))return!0;return!1}on(t,e){if(t===void 0||!t.field.isEqual(e.fieldPath))return!1;const r=t.op==="array-contains"||t.op==="array-contains-any";return e.kind===2===r}_n(t,e){return!!t.field.isEqual(e.fieldPath)&&(e.kind===0&&t.dir==="asc"||e.kind===1&&t.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(n){var t,e;if(it(n instanceof _t||n instanceof Pt),n instanceof _t){if(n instanceof Im){const s=((e=(t=n.value.arrayValue)===null||t===void 0?void 0:t.values)===null||e===void 0?void 0:e.map(i=>_t.create(n.field,"==",i)))||[];return Pt.create(s,"or")}return n}const r=n.filters.map(s=>Xm(s));return Pt.create(r,n.op)}function wb(n){if(n.getFilters().length===0)return[];const t=zc(Xm(n));return it(Zm(t)),$c(t)||Kc(t)?[t]:t.getFilters()}function $c(n){return n instanceof _t}function Kc(n){return n instanceof Pt&&Pl(n)}function Zm(n){return $c(n)||Kc(n)||function(e){if(e instanceof Pt&&Oc(e)){for(const r of e.getFilters())if(!$c(r)&&!Kc(r))return!1;return!0}return!1}(n)}function zc(n){if(it(n instanceof _t||n instanceof Pt),n instanceof _t)return n;if(n.filters.length===1)return zc(n.filters[0]);const t=n.filters.map(r=>zc(r));let e=Pt.create(t,n.op);return e=Bo(e),Zm(e)?e:(it(e instanceof Pt),it(os(e)),it(e.filters.length>1),e.filters.reduce((r,s)=>Fl(r,s)))}function Fl(n,t){let e;return it(n instanceof _t||n instanceof Pt),it(t instanceof _t||t instanceof Pt),e=n instanceof _t?t instanceof _t?function(s,i){return Pt.create([s,i],"and")}(n,t):Bf(n,t):t instanceof _t?Bf(t,n):function(s,i){if(it(s.filters.length>0&&i.filters.length>0),os(s)&&os(i))return ym(s,i.getFilters());const o=Oc(s)?s:i,c=Oc(s)?i:s,l=o.filters.map(u=>Fl(u,c));return Pt.create(l,"or")}(n,t),Bo(e)}function Bf(n,t){if(os(t))return ym(t,n.getFilters());{const e=t.filters.map(r=>Fl(n,r));return Pt.create(e,"or")}}function Bo(n){if(it(n instanceof _t||n instanceof Pt),n instanceof _t)return n;const t=n.getFilters();if(t.length===1)return Bo(t[0]);if(gm(n))return n;const e=t.map(s=>Bo(s)),r=[];return e.forEach(s=>{s instanceof _t?r.push(s):s instanceof Pt&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Pt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.un=new Ll}addToCollectionParentIndex(t,e){return this.un.add(e),S.resolve()}getCollectionParents(t,e){return S.resolve(this.un.getEntries(e))}addFieldIndex(t,e){return S.resolve()}deleteFieldIndex(t,e){return S.resolve()}deleteAllFieldIndexes(t){return S.resolve()}createTargetIndexes(t,e){return S.resolve()}getDocumentsMatchingTarget(t,e){return S.resolve(null)}getIndexType(t,e){return S.resolve(0)}getFieldIndexes(t,e){return S.resolve([])}getNextCollectionGroupToUpdate(t){return S.resolve(null)}getMinOffset(t,e){return S.resolve(Ne.min())}getMinOffsetFromCollectionGroup(t,e){return S.resolve(Ne.min())}updateCollectionGroup(t,e,r){return S.resolve()}updateIndexEntries(t,e){return S.resolve()}}class Ll{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new Ct(St.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new Ct(St.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=new Uint8Array(0);class Ab{constructor(t,e){this.databaseId=e,this.cn=new Ll,this.ln=new En(r=>vr(r),(r,s)=>Si(r,s)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.cn.has(e)){const r=e.lastSegment(),s=e.popLast();t.addOnCommittedListener(()=>{this.cn.add(e)});const i={collectionId:r,parent:pe(s)};return Uf(t).put(i)}return S.resolve()}getCollectionParents(t,e){const r=[],s=IDBKeyRange.bound([e,""],[em(e),""],!1,!0);return Uf(t).U(s).next(i=>{for(const o of i){if(o.collectionId!==e)break;r.push(Xe(o.parent))}return r})}addFieldIndex(t,e){const r=Os(t),s=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(e);delete s.indexId;const i=r.add(s);if(e.indexState){const o=Fr(t);return i.next(c=>{o.put(Nf(c,this.uid,e.indexState.sequenceNumber,e.indexState.offset))})}return i.next()}deleteFieldIndex(t,e){const r=Os(t),s=Fr(t),i=Mr(t);return r.delete(e.indexId).next(()=>s.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}deleteAllFieldIndexes(t){const e=Os(t),r=Mr(t),s=Fr(t);return e.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(t,e){return S.forEach(this.hn(e),r=>this.getIndexType(t,r).next(s=>{if(s===0||s===1){const i=new Lf(r).an();if(i!=null)return this.addFieldIndex(t,i)}}))}getDocumentsMatchingTarget(t,e){const r=Mr(t);let s=!0;const i=new Map;return S.forEach(this.hn(e),o=>this.Pn(t,o).next(c=>{s&&(s=!!c),i.set(o,c)})).next(()=>{if(s){let o=mt();const c=[];return S.forEach(i,(l,u)=>{$("IndexedDbIndexManager",`Using index ${function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map(K=>`${K.fieldPath}:${K.kind}`).join(",")}`}(l)} to execute ${vr(e)}`);const f=function(k,K){const tt=Vc(K);if(tt===void 0)return null;for(const ct of Oo(k,tt.fieldPath))switch(ct.op){case"array-contains-any":return ct.value.arrayValue.values||[];case"array-contains":return[ct.value]}return null}(u,l),p=function(k,K){const tt=new Map;for(const ct of sr(K))for(const w of Oo(k,ct.fieldPath))switch(w.op){case"==":case"in":tt.set(ct.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return tt.set(ct.fieldPath.canonicalString(),w.value),Array.from(tt.values())}return null}(u,l),g=function(k,K){const tt=[];let ct=!0;for(const w of sr(K)){const y=w.kind===0?yf(k,w.fieldPath,k.startAt):Ef(k,w.fieldPath,k.startAt);tt.push(y.value),ct&&(ct=y.inclusive)}return new is(tt,ct)}(u,l),_=function(k,K){const tt=[];let ct=!0;for(const w of sr(K)){const y=w.kind===0?Ef(k,w.fieldPath,k.endAt):yf(k,w.fieldPath,k.endAt);tt.push(y.value),ct&&(ct=y.inclusive)}return new is(tt,ct)}(u,l),P=this.In(l,u,g),x=this.In(l,u,_),N=this.Tn(l,u,p),U=this.En(l.indexId,f,P,g.inclusive,x,_.inclusive,N);return S.forEach(U,L=>r.G(L,e.limit).next(k=>{k.forEach(K=>{const tt=Y.fromSegments(K.documentKey);o.has(tt)||(o=o.add(tt),c.push(tt))})}))}).next(()=>c)}return S.resolve(null)})}hn(t){let e=this.ln.get(t);return e||(t.filters.length===0?e=[t]:e=wb(Pt.create(t.filters,"and")).map(r=>Fc(t.path,t.collectionGroup,t.orderBy,r.getFilters(),t.limit,t.startAt,t.endAt)),this.ln.set(t,e),e)}En(t,e,r,s,i,o,c){const l=(e!=null?e.length:1)*Math.max(r.length,i.length),u=l/(e!=null?e.length:1),f=[];for(let p=0;p<l;++p){const g=e?this.dn(e[p/u]):Zi,_=this.An(t,g,r[p%u],s),P=this.Rn(t,g,i[p%u],o),x=c.map(N=>this.An(t,g,N,!0));f.push(...this.createRange(_,P,x))}return f}An(t,e,r,s){const i=new cr(t,Y.empty(),e,r);return s?i:i.Zt()}Rn(t,e,r,s){const i=new cr(t,Y.empty(),e,r);return s?i.Zt():i}Pn(t,e){const r=new Lf(e),s=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,s).next(i=>{let o=null;for(const c of i)r.rn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o})}getIndexType(t,e){let r=2;const s=this.hn(e);return S.forEach(s,i=>this.Pn(t,i).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ct(jt.comparator),f=!1;for(const p of l.filters)for(const g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:u=u.add(g.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(e)&&s.length>1&&r===2?1:r)}Vn(t,e){const r=new ks;for(const s of sr(t)){const i=e.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ar.vt.It(i,o)}return r.zt()}dn(t){const e=new ks;return ar.vt.It(t,e.Yt(0)),e.zt()}mn(t,e){const r=new ks;return ar.vt.It(Sl(this.databaseId,e),r.Yt(function(i){const o=sr(i);return o.length===0?0:o[o.length-1].kind}(t))),r.zt()}Tn(t,e,r){if(r===null)return[];let s=[];s.push(new ks);let i=0;for(const o of sr(t)){const c=r[i++];for(const l of s)if(this.fn(e,o.fieldPath)&&yi(c))s=this.gn(s,o,c);else{const u=l.Yt(o.kind);ar.vt.It(c,u)}}return this.pn(s)}In(t,e,r){return this.Tn(t,e,r.position)}pn(t){const e=[];for(let r=0;r<t.length;++r)e[r]=t[r].zt();return e}gn(t,e,r){const s=[...t],i=[];for(const o of r.arrayValue.values||[])for(const c of s){const l=new ks;l.seed(c.zt()),ar.vt.It(o,l.Yt(e.kind)),i.push(l)}return i}fn(t,e){return!!t.filters.find(r=>r instanceof _t&&r.field.isEqual(e)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(t,e){const r=Os(t),s=Fr(t);return(e?r.U("collectionGroupIndex",IDBKeyRange.bound(e,e)):r.U()).next(i=>{const o=[];return S.forEach(i,c=>s.get([c.indexId,this.uid]).next(l=>{o.push(function(f,p){const g=p?new pi(p.sequenceNumber,new Ne(Tr(p.readTime),new Y(Xe(p.documentKey)),p.largestBatchId)):pi.empty(),_=f.fields.map(([P,x])=>new uo(jt.fromServerFormat(P),x));return new Do(f.indexId,f.collectionGroup,_,g)}(c,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>e.length===0?null:(e.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:pt(r.collectionGroup,s.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,r){const s=Os(t),i=Fr(t);return this.yn(t).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(c=>S.forEach(c,l=>i.put(Nf(l.indexId,this.uid,o,r)))))}updateIndexEntries(t,e){const r=new Map;return S.forEach(e,(s,i)=>{const o=r.get(s.collectionGroup);return(o?S.resolve(o):this.getFieldIndexes(t,s.collectionGroup)).next(c=>(r.set(s.collectionGroup,c),S.forEach(c,l=>this.wn(t,s,l).next(u=>{const f=this.Sn(i,l);return u.isEqual(f)?S.resolve():this.bn(t,i,l,u,f)}))))})}Dn(t,e,r,s){return Mr(t).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,e.key),documentKey:e.key.path.toArray()})}vn(t,e,r,s){return Mr(t).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,e.key),e.key.path.toArray()])}wn(t,e,r){const s=Mr(t);let i=new Ct(Sn);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,e)])},(o,c)=>{i=i.add(new cr(r.indexId,e,c.arrayValue,c.directionalValue))}).next(()=>i)}Sn(t,e){let r=new Ct(Sn);const s=this.Vn(e,t);if(s==null)return r;const i=Vc(e);if(i!=null){const o=t.data.field(i.fieldPath);if(yi(o))for(const c of o.arrayValue.values||[])r=r.add(new cr(e.indexId,t.key,this.dn(c),s))}else r=r.add(new cr(e.indexId,t.key,Zi,s));return r}bn(t,e,r,s,i){$("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const o=[];return function(l,u,f,p,g){const _=l.getIterator(),P=u.getIterator();let x=Or(_),N=Or(P);for(;x||N;){let U=!1,L=!1;if(x&&N){const k=f(x,N);k<0?L=!0:k>0&&(U=!0)}else x!=null?L=!0:U=!0;U?(p(N),N=Or(P)):L?(g(x),x=Or(_)):(x=Or(_),N=Or(P))}}(s,i,Sn,c=>{o.push(this.Dn(t,e,r,c))},c=>{o.push(this.vn(t,e,r,c))}),S.waitFor(o)}yn(t){let e=1;return Fr(t).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),e=s.sequenceNumber+1}).next(()=>e)}createRange(t,e,r){r=r.sort((o,c)=>Sn(o,c)).filter((o,c,l)=>!c||Sn(o,l[c-1])!==0);const s=[];s.push(t);for(const o of r){const c=Sn(o,t),l=Sn(o,e);if(c===0)s[0]=t.Zt();else if(c>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(e);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const c=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Zi,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Zi,[]];i.push(IDBKeyRange.bound(c,l))}return i}Cn(t,e){return Sn(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(jf)}getMinOffset(t,e){return S.mapArray(this.hn(e),r=>this.Pn(t,r).next(s=>s||rt())).next(jf)}}function Uf(n){return Jt(n,"collectionParents")}function Mr(n){return Jt(n,"indexEntries")}function Os(n){return Jt(n,"indexConfiguration")}function Fr(n){return Jt(n,"indexState")}function jf(n){it(n.length!==0);let t=n[0].indexState.offset,e=t.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;wl(s,t)<0&&(t=s),e<s.largestBatchId&&(e=s.largestBatchId)}return new Ne(t.readTime,t.documentKey,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class he{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new he(t,he.DEFAULT_COLLECTION_PERCENTILE,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(n,t,e){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(e.batchId);let c=0;const l=r.J({range:o},(f,p,g)=>(c++,g.delete()));i.push(l.next(()=>{it(c===1)}));const u=[];for(const f of e.mutations){const p=om(t,f.key.path,e.batchId);i.push(s.delete(p)),u.push(f.key)}return S.waitFor(i).next(()=>u)}function Uo(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw rt();t=n.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */he.DEFAULT_COLLECTION_PERCENTILE=10,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,he.DEFAULT=new he(41943040,he.DEFAULT_COLLECTION_PERCENTILE,he.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),he.DISABLED=new he(-1,0,0);class ma{constructor(t,e,r,s){this.userId=t,this.serializer=e,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(t,e,r,s){it(t.uid!=="");const i=t.isAuthenticated()?t.uid:"";return new ma(i,e,r,s)}checkEmpty(t){let e=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pn(t).J({index:"userMutationsIndex",range:r},(s,i,o)=>{e=!1,o.done()}).next(()=>e)}addMutationBatch(t,e,r,s){const i=Hr(t),o=Pn(t);return o.add({}).next(c=>{it(typeof c=="number");const l=new Dl(c,e,r,s),u=function(_,P,x){const N=x.baseMutations.map(L=>Fo(_.ct,L)),U=x.mutations.map(L=>Fo(_.ct,L));return{userId:P,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:N,mutations:U}}(this.serializer,this.userId,l),f=[];let p=new Ct((g,_)=>pt(g.canonicalString(),_.canonicalString()));for(const g of s){const _=om(this.userId,g.key.path,c);p=p.add(g.key.path.popLast()),f.push(o.put(u)),f.push(i.put(_,sw))}return p.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(t,g))}),t.addOnCommittedListener(()=>{this.Fn[c]=l.keys()}),S.waitFor(f).next(()=>l)})}lookupMutationBatch(t,e){return Pn(t).get(e).next(r=>r?(it(r.userId===this.userId),or(this.serializer,r)):null)}Mn(t,e){return this.Fn[e]?S.resolve(this.Fn[e]):this.lookupMutationBatch(t,e).next(r=>{if(r){const s=r.keys();return this.Fn[e]=s,s}return null})}getNextMutationBatchAfterBatchId(t,e){const r=e+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Pn(t).J({index:"userMutationsIndex",range:s},(o,c,l)=>{c.userId===this.userId&&(it(c.batchId>=r),i=or(this.serializer,c)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Pn(t).J({index:"userMutationsIndex",range:e,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pn(t).U("userMutationsIndex",e).next(r=>r.map(s=>or(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(t,e){const r=ho(this.userId,e.path),s=IDBKeyRange.lowerBound(r),i=[];return Hr(t).J({range:s},(o,c,l)=>{const[u,f,p]=o,g=Xe(f);if(u===this.userId&&e.path.isEqual(g))return Pn(t).get(p).next(_=>{if(!_)throw rt();it(_.userId===this.userId),i.push(or(this.serializer,_))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new Ct(pt);const s=[];return e.forEach(i=>{const o=ho(this.userId,i.path),c=IDBKeyRange.lowerBound(o),l=Hr(t).J({range:c},(u,f,p)=>{const[g,_,P]=u,x=Xe(_);g===this.userId&&i.path.isEqual(x)?r=r.add(P):p.done()});s.push(l)}),S.waitFor(s).next(()=>this.xn(t,r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1,i=ho(this.userId,r),o=IDBKeyRange.lowerBound(i);let c=new Ct(pt);return Hr(t).J({range:o},(l,u,f)=>{const[p,g,_]=l,P=Xe(g);p===this.userId&&r.isPrefixOf(P)?P.length===s&&(c=c.add(_)):f.done()}).next(()=>this.xn(t,c))}xn(t,e){const r=[],s=[];return e.forEach(i=>{s.push(Pn(t).get(i).next(o=>{if(o===null)throw rt();it(o.userId===this.userId),r.push(or(this.serializer,o))}))}),S.waitFor(s).next(()=>r)}removeMutationBatch(t,e){return tg(t._e,this.userId,e).next(r=>(t.addOnCommittedListener(()=>{this.On(e.batchId)}),S.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(t,s))))}On(t){delete this.Fn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return S.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Hr(t).J({range:r},(i,o,c)=>{if(i[0]===this.userId){const l=Xe(i[1]);s.push(l)}else c.done()}).next(()=>{it(s.length===0)})})}containsKey(t,e){return eg(t,this.userId,e)}Nn(t){return ng(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function eg(n,t,e){const r=ho(t,e.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Hr(n).J({range:i,H:!0},(c,l,u)=>{const[f,p,g]=c;f===t&&p===s&&(o=!0),u.done()}).next(()=>o)}function Pn(n){return Jt(n,"mutations")}function Hr(n){return Jt(n,"documentMutations")}function ng(n){return Jt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new wr(0)}static kn(){return new wr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.qn(t).next(e=>{const r=new wr(e.highestTargetId);return e.highestTargetId=r.next(),this.Qn(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.qn(t).next(e=>ot.fromTimestamp(new $t(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.qn(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,r){return this.qn(t).next(s=>(s.highestListenSequenceNumber=e,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),e>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=e),this.Qn(t,s)))}addTargetData(t,e){return this.Kn(t,e).next(()=>this.qn(t).next(r=>(r.targetCount+=1,this.$n(e,r),this.Qn(t,r))))}updateTargetData(t,e){return this.Kn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>Lr(t).delete(e.targetId)).next(()=>this.qn(t)).next(r=>(it(r.targetCount>0),r.targetCount-=1,this.Qn(t,r)))}removeTargets(t,e,r){let s=0;const i=[];return Lr(t).J((o,c)=>{const l=qs(c);l.sequenceNumber<=e&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(t,l)))}).next(()=>S.waitFor(i)).next(()=>s)}forEachTarget(t,e){return Lr(t).J((r,s)=>{const i=qs(s);e(i)})}qn(t){return $f(t).get("targetGlobalKey").next(e=>(it(e!==null),e))}Qn(t,e){return $f(t).put("targetGlobalKey",e)}Kn(t,e){return Lr(t).put(Jm(this.serializer,e))}$n(t,e){let r=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,r=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,r=!0),r}getTargetCount(t){return this.qn(t).next(e=>e.targetCount)}getTargetData(t,e){const r=vr(e),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Lr(t).J({range:s,index:"queryTargetsIndex"},(o,c,l)=>{const u=qs(c);Si(e,u.target)&&(i=u,l.done())}).next(()=>i)}addMatchingKeys(t,e,r){const s=[],i=Nn(t);return e.forEach(o=>{const c=pe(o.path);s.push(i.put({targetId:r,path:c})),s.push(this.referenceDelegate.addReference(t,r,o))}),S.waitFor(s)}removeMatchingKeys(t,e,r){const s=Nn(t);return S.forEach(e,i=>{const o=pe(i.path);return S.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(t,r,i)])})}removeMatchingKeysForTargetId(t,e){const r=Nn(t),s=IDBKeyRange.bound([e],[e+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(t,e){const r=IDBKeyRange.bound([e],[e+1],!1,!0),s=Nn(t);let i=mt();return s.J({range:r,H:!0},(o,c,l)=>{const u=Xe(o[1]),f=new Y(u);i=i.add(f)}).next(()=>i)}containsKey(t,e){const r=pe(e.path),s=IDBKeyRange.bound([r],[em(r)],!1,!0);let i=0;return Nn(t).J({index:"documentTargetsIndex",H:!0,range:s},([o,c],l,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(t,e){return Lr(t).get(e).next(r=>r?qs(r):null)}}function Lr(n){return Jt(n,"targets")}function $f(n){return Jt(n,"targetGlobal")}function Nn(n){return Jt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf([n,t],[e,r]){const s=pt(n,e);return s===0?pt(t,r):s}class Sb{constructor(t){this.Un=t,this.buffer=new Ct(Kf),this.Wn=0}Gn(){return++this.Wn}zn(t){const e=[t,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();Kf(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class rg{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(t){$("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Hn(e)?$("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await br(e)}await this.Hn(3e5)})}}class Pb{constructor(t,e){this.Jn=t,this.params=e}calculateTargetCount(t,e){return this.Jn.Yn(t).next(r=>Math.floor(e/100*r))}nthSequenceNumber(t,e){if(e===0)return S.resolve(Fe.oe);const r=new Sb(e);return this.Jn.forEachTarget(t,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(t,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(t,e,r){return this.Jn.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.Jn.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(qf)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qf):this.Xn(t,e))}getCacheSize(t){return this.Jn.getCacheSize(t)}Xn(t,e){let r,s,i,o,c,l,u;const f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(t,s))).next(p=>(r=p,c=Date.now(),this.removeTargets(t,r,e))).next(p=>(i=p,l=Date.now(),this.removeOrphanedDocuments(t,r))).next(p=>(u=Date.now(),$r()<=vt.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function sg(n,t){return new Pb(n,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(t,e){this.db=t,this.garbageCollector=sg(this,e)}Yn(t){const e=this.er(t);return this.db.getTargetCache().getTargetCount(t).next(r=>e.next(s=>r+s))}er(t){let e=0;return this.Zn(t,r=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Zn(t,e){return this.tr(t,(r,s)=>e(s))}addReference(t,e,r){return to(t,r)}removeReference(t,e,r){return to(t,r)}removeTargets(t,e,r){return this.db.getTargetCache().removeTargets(t,e,r)}markPotentiallyOrphaned(t,e){return to(t,e)}nr(t,e){return function(s,i){let o=!1;return ng(s).Y(c=>eg(s,c,i).next(l=>(l&&(o=!0),S.resolve(!l)))).next(()=>o)}(t,e)}removeOrphanedDocuments(t,e){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(t,(o,c)=>{if(c<=e){const l=this.nr(t,o).next(u=>{if(!u)return i++,r.getEntry(t,o).next(()=>(r.removeEntry(o,ot.min()),Nn(t).delete(function(p){return[0,pe(p.path)]}(o))))});s.push(l)}}).next(()=>S.waitFor(s)).next(()=>r.apply(t)).next(()=>i)}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,r)}updateLimboDocument(t,e){return to(t,e)}tr(t,e){const r=Nn(t);let s,i=Fe.oe;return r.J({index:"documentTargetsIndex"},([o,c],{path:l,sequenceNumber:u})=>{o===0?(i!==Fe.oe&&e(new Y(Xe(s)),i),i=u,s=l):i=Fe.oe}).next(()=>{i!==Fe.oe&&e(new Y(Xe(s)),i)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function to(n,t){return Nn(n).put(function(r,s){return{targetId:0,path:pe(r.path),sequenceNumber:s}}(t,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(){this.changes=new En(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,zt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?S.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,r){return er(t).put(r)}removeEntry(t,e,r){return er(t).delete(function(i,o){const c=i.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Lo(o),c[c.length-1]]}(e,r))}updateMetadata(t,e){return this.getMetadata(t).next(r=>(r.byteSize+=e,this.rr(t,r)))}getEntry(t,e){let r=zt.newInvalidDocument(e);return er(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ms(e))},(s,i)=>{r=this.ir(e,i)}).next(()=>r)}sr(t,e){let r={size:0,document:zt.newInvalidDocument(e)};return er(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ms(e))},(s,i)=>{r={document:this.ir(e,i),size:Uo(i)}}).next(()=>r)}getEntries(t,e){let r=Ve();return this._r(t,e,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(t,e){let r=Ve(),s=new Lt(Y.comparator);return this._r(t,e,(i,o)=>{const c=this.ir(i,o);r=r.insert(i,c),s=s.insert(i,Uo(o))}).next(()=>({documents:r,ur:s}))}_r(t,e,r){if(e.isEmpty())return S.resolve();let s=new Ct(Hf);e.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Ms(s.first()),Ms(s.last())),o=s.getIterator();let c=o.getNext();return er(t).J({index:"documentKeyIndex",range:i},(l,u,f)=>{const p=Y.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;c&&Hf(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,u),c=o.hasNext()?o.getNext():null),c?f.$(Ms(c)):f.done()}).next(()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(t,e,r,s,i){const o=e.path,c=[o.popLast().toArray(),o.lastSegment(),Lo(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return er(t).U(IDBKeyRange.bound(c,l,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let f=Ve();for(const p of u){const g=this.ir(Y.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(Pi(e,g)||s.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(t,e,r,s){let i=Ve();const o=Gf(e,r),c=Gf(e,Ne.max());return er(t).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,c,!0)},(l,u,f)=>{const p=this.ir(Y.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(p.key,p),i.size===s&&f.done()}).next(()=>i)}newChangeBuffer(t){return new Vb(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return zf(t).get("remoteDocumentGlobalKey").next(e=>(it(!!e),e))}rr(t,e){return zf(t).put("remoteDocumentGlobalKey",e)}ir(t,e){if(e){const r=gb(this.serializer,e);if(!(r.isNoDocument()&&r.version.isEqual(ot.min())))return r}return zt.newInvalidDocument(t)}}function og(n){return new xb(n)}class Vb extends ig{constructor(t,e){super(),this.cr=t,this.trackRemovals=e,this.lr=new En(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(t){const e=[];let r=0,s=new Ct((i,o)=>pt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const c=this.lr.get(i);if(e.push(this.cr.removeEntry(t,i,c.readTime)),o.isValidDocument()){const l=Vf(this.cr.serializer,o);s=s.add(i.path.popLast());const u=Uo(l);r+=u-c.size,e.push(this.cr.addEntry(t,i,l))}else if(r-=c.size,this.trackRemovals){const l=Vf(this.cr.serializer,o.convertToNoDocument(ot.min()));e.push(this.cr.addEntry(t,i,l))}}),s.forEach(i=>{e.push(this.cr.indexManager.addToCollectionParentIndex(t,i))}),e.push(this.cr.updateMetadata(t,r)),S.waitFor(e)}getFromCache(t,e){return this.cr.sr(t,e).next(r=>(this.lr.set(e,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(t,e){return this.cr.ar(t,e).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function zf(n){return Jt(n,"remoteDocumentGlobal")}function er(n){return Jt(n,"remoteDocumentsV14")}function Ms(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Gf(n,t){const e=t.documentKey.path.toArray();return[n,Lo(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function Hf(n,t){const e=n.path.toArray(),r=t.path.toArray();let s=0;for(let i=0;i<e.length-2&&i<r.length-2;++i)if(s=pt(e[i],r[i]),s)return s;return s=pt(e.length,r.length),s||(s=pt(e[e.length-2],r[r.length-2]),s||pt(e[e.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.remoteDocumentCache.getEntry(t,e))).next(s=>(r!==null&&ri(r.mutation,s,Le.empty(),$t.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,mt()).next(()=>r))}getLocalViewOfDocuments(t,e,r=mt()){const s=Ze();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=Us();return i.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=Ze();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,mt()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=Ve();const o=ni(),c=function(){return ni()}();return e.forEach((l,u)=>{const f=r.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof Wn)?i=i.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),ri(f.mutation,u,f.mutation.getFieldMask(),$t.now())):o.set(u.key,Le.empty())}),this.recalculateAndSaveOverlays(t,i).next(l=>(l.forEach((u,f)=>o.set(u,f)),e.forEach((u,f)=>{var p;return c.set(u,new Db(f,(p=o.get(u))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(t,e){const r=ni();let s=new Lt((o,c)=>o-c),i=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(l=>{const u=e.get(l);if(u===null)return;let f=r.get(l)||Le.empty();f=c.applyToLocalView(u,f),r.set(l,f);const p=(s.get(c.batchId)||mt()).add(l);s=s.insert(c.batchId,p)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),u=l.key,f=l.value,p=Rm();f.forEach(g=>{if(!i.has(g)){const _=Dm(e.get(g),r.get(g));_!==null&&p.set(g,_),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(t,u,p))}return S.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Ow(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,s):this.getDocumentsMatchingCollectionQuery(t,e,r,s)}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):S.resolve(Ze());let c=-1,l=i;return o.next(u=>S.forEach(u,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(f)?S.resolve():this.remoteDocumentCache.getEntry(t,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(t,u,i)).next(()=>this.computeViews(t,l,u,mt())).next(f=>({batchId:c,changes:Am(f)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Y(e)).next(r=>{let s=Us();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r,s){const i=e.collectionGroup;let o=Us();return this.indexManager.getCollectionParents(t,i).next(c=>S.forEach(c,l=>{const u=function(p,g){return new la(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(e,l.child(i));return this.getDocumentsMatchingCollectionQuery(t,u,r,s).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,i,s))).next(o=>{i.forEach((l,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,zt.newInvalidDocument(f)))});let c=Us();return o.forEach((l,u)=>{const f=i.get(l);f!==void 0&&ri(f.mutation,u,Le.empty(),$t.now()),Pi(e,u)&&(c=c.insert(l,u))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,e){return S.resolve(this.hr.get(e))}saveBundleMetadata(t,e){return this.hr.set(e.id,function(s){return{id:s.id,version:s.version,createTime:Ie(s.createTime)}}(e)),S.resolve()}getNamedQuery(t,e){return S.resolve(this.Pr.get(e))}saveNamedQuery(t,e){return this.Pr.set(e.name,function(s){return{name:s.name,query:Ym(s.bundledQuery),readTime:Ie(s.readTime)}}(e)),S.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(){this.overlays=new Lt(Y.comparator),this.Ir=new Map}getOverlay(t,e){return S.resolve(this.overlays.get(e))}getOverlays(t,e){const r=Ze();return S.forEach(e,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ht(t,e,i)}),S.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),S.resolve()}getOverlaysForCollection(t,e,r){const s=Ze(),i=e.length+1,o=new Y(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const l=c.getNext().value,u=l.getKey();if(!e.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return S.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new Lt((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===e&&u.largestBatchId>r){let f=i.get(u.largestBatchId);f===null&&(f=Ze(),i=i.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const c=Ze(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>c.set(u,f)),!(c.size()>=s)););return S.resolve(c)}ht(t,e,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new kl(e,r));let i=this.Ir.get(e);i===void 0&&(i=mt(),this.Ir.set(e,i)),this.Ir.set(e,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(t){return S.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,S.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(){this.Tr=new Ct(Xt.Er),this.dr=new Ct(Xt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,e){const r=new Xt(t,e);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.Vr(new Xt(t,e))}mr(t,e){t.forEach(r=>this.removeReference(r,e))}gr(t){const e=new Y(new St([])),r=new Xt(e,t),s=new Xt(e,t+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const e=new Y(new St([])),r=new Xt(e,t),s=new Xt(e,t+1);let i=mt();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new Xt(t,0),r=this.Tr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class Xt{constructor(t,e){this.key=t,this.wr=e}static Er(t,e){return Y.comparator(t.key,e.key)||pt(t.wr,e.wr)}static Ar(t,e){return pt(t.wr,e.wr)||Y.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Sr=1,this.br=new Ct(Xt.Er)}checkEmpty(t){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Dl(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new Xt(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return S.resolve(o)}lookupMutationBatch(t,e){return S.resolve(this.Dr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,s=this.vr(r),i=s<0?0:s;return S.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Xt(e,0),s=new Xt(e,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);i.push(c)}),S.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new Ct(pt);return e.forEach(s=>{const i=new Xt(s,0),o=new Xt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],c=>{r=r.add(c.wr)})}),S.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new Xt(new Y(i),0);let c=new Ct(pt);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(c=c.add(l.wr)),!0)},o),S.resolve(this.Cr(c))}Cr(t){const e=[];return t.forEach(r=>{const s=this.Dr(r);s!==null&&e.push(s)}),e}removeMutationBatch(t,e){it(this.Fr(e.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return S.forEach(e.mutations,s=>{const i=new Xt(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=r})}On(t){}containsKey(t,e){const r=new Xt(e,0),s=this.br.firstAfterOrEqual(r);return S.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,S.resolve()}Fr(t,e){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const e=this.vr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(t){this.Mr=t,this.docs=function(){return new Lt(Y.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return S.resolve(r?r.document.mutableCopy():zt.newInvalidDocument(e))}getEntries(t,e){let r=Ve();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():zt.newInvalidDocument(s))}),S.resolve(r)}getDocumentsMatchingQuery(t,e,r,s){let i=Ve();const o=e.path,c=new Y(o.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||wl(nm(f),r)<=0||(s.has(f.key)||Pi(e,f))&&(i=i.insert(f.key,f.mutableCopy()))}return S.resolve(i)}getAllFromCollectionGroup(t,e,r,s){rt()}Or(t,e){return S.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new Lb(this)}getSize(t){return S.resolve(this.size)}}class Lb extends ig{constructor(t){super(),this.cr=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.cr.addEntry(t,s)):this.cr.removeEntry(r)}),S.waitFor(e)}getFromCache(t,e){return this.cr.getEntry(t,e)}getAllFromCache(t,e){return this.cr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(t){this.persistence=t,this.Nr=new En(e=>vr(e),Si),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Bl,this.targetCount=0,this.kr=wr.Bn()}forEachTarget(t,e){return this.Nr.forEach((r,s)=>e(s)),S.resolve()}getLastRemoteSnapshotVersion(t){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return S.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.Lr&&(this.Lr=e),S.resolve()}Kn(t){this.Nr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.kr=new wr(e),this.highestTargetId=e),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,e){return this.Kn(e),this.targetCount+=1,S.resolve()}updateTargetData(t,e){return this.Kn(e),S.resolve()}removeTargetData(t,e){return this.Nr.delete(e.target),this.Br.gr(e.targetId),this.targetCount-=1,S.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=e&&r.get(c.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),S.waitFor(i).next(()=>s)}getTargetCount(t){return S.resolve(this.targetCount)}getTargetData(t,e){const r=this.Nr.get(e)||null;return S.resolve(r)}addMatchingKeys(t,e,r){return this.Br.Rr(e,r),S.resolve()}removeMatchingKeys(t,e,r){this.Br.mr(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),S.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Br.gr(e),S.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Br.yr(e);return S.resolve(r)}containsKey(t,e){return S.resolve(this.Br.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(t,e){this.qr={},this.overlays={},this.Qr=new Fe(0),this.Kr=!1,this.Kr=!0,this.$r=new Ob,this.referenceDelegate=t(this),this.Ur=new Bb(this),this.indexManager=new bb,this.remoteDocumentCache=function(s){return new Fb(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Qm(e),this.Gr=new Nb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new kb,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.qr[t.toKey()];return r||(r=new Mb(e,this.referenceDelegate),this.qr[t.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,e,r){$("MemoryPersistence","Starting transaction:",t);const s=new Ub(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(t,e){return S.or(Object.values(this.qr).map(r=>()=>r.containsKey(t,e)))}}class Ub extends sm{constructor(t){super(),this.currentSequenceNumber=t}}class ga{constructor(t){this.persistence=t,this.Jr=new Bl,this.Yr=null}static Zr(t){return new ga(t)}get Xr(){if(this.Yr)return this.Yr;throw rt()}addReference(t,e,r){return this.Jr.addReference(r,e),this.Xr.delete(r.toString()),S.resolve()}removeReference(t,e,r){return this.Jr.removeReference(r,e),this.Xr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(t,e){return this.Xr.add(e.toString()),S.resolve()}removeTarget(t,e){this.Jr.gr(e.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}zr(){this.Yr=new Set}jr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Xr,r=>{const s=Y.fromPath(r);return this.ei(t,s).next(i=>{i||e.removeEntry(s,ot.min())})}).next(()=>(this.Yr=null,e.apply(t)))}updateLimboDocument(t,e){return this.ei(t,e).next(r=>{r?this.Xr.delete(e.toString()):this.Xr.add(e.toString())})}Wr(t){return 0}ei(t,e){return S.or([()=>S.resolve(this.Jr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Hr(t,e)])}}class jo{constructor(t,e){this.persistence=t,this.ti=new En(r=>pe(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=sg(this,e)}static Zr(t,e){return new jo(t,e)}zr(){}jr(t){return S.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}Yn(t){const e=this.er(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>e.next(s=>r+s))}er(t){let e=0;return this.Zn(t,r=>{e++}).next(()=>e)}Zn(t,e){return S.forEach(this.ti,(r,s)=>this.nr(t,r,s).next(i=>i?S.resolve():e(s)))}removeTargets(t,e,r){return this.persistence.getTargetCache().removeTargets(t,e,r)}removeOrphanedDocuments(t,e){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(t,o=>this.nr(t,o,e).next(c=>{c||(r++,i.removeEntry(o,ot.min()))})).next(()=>i.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,e){return this.ti.set(e,t.currentSequenceNumber),S.resolve()}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,e,r){return this.ti.set(r,t.currentSequenceNumber),S.resolve()}removeReference(t,e,r){return this.ti.set(r,t.currentSequenceNumber),S.resolve()}updateLimboDocument(t,e){return this.ti.set(e,t.currentSequenceNumber),S.resolve()}Wr(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=po(t.data.value)),e}nr(t,e,r){return S.or([()=>this.persistence.Hr(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.ti.get(e);return S.resolve(s!==void 0&&s>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(t){this.serializer=t}O(t,e,r,s){const i=new ia("createOrUpgrade",e);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(t),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",af,{unique:!0}),l.createObjectStore("documentMutations")}(t),Wf(t),function(l){l.createObjectStore("remoteDocuments")}(t));let o=S.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(t),Wf(t)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ot.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",f)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(f=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",af,{unique:!0});const p=u.store("mutations"),g=f.map(_=>p.put(_));return S.waitFor(g)})}(t,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(t)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(t),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(t,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(t)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:gw});u.createIndex("collectionPathOverlayIndex",_w,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",yw,{unique:!1})})(t)})),r<13&&s>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:iw});u.createIndex("documentKeyIndex",ow),u.createIndex("collectionGroupIndex",aw)}(t)).next(()=>this._i(t,i)).next(()=>t.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(t,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:fw}).createIndex("sequenceNumberIndex",dw,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:pw}).createIndex("documentKeyIndex",mw,{unique:!1})}(t))),r<16&&s>=16&&(o=o.next(()=>{e.objectStore("indexState").clear()}).next(()=>{e.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(t)})),o}ri(t){let e=0;return t.store("remoteDocuments").J((r,s)=>{e+=Uo(s)}).next(()=>{const r={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(t){const e=t.store("mutationQueues"),r=t.store("mutations");return e.U().next(s=>S.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(c=>S.forEach(c,l=>{it(l.userId===i.userId);const u=or(this.serializer,l);return tg(t,i.userId,u).next(()=>{})}))}))}ii(t){const e=t.store("targetDocuments"),r=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,c)=>{const l=new St(o),u=function(p){return[0,pe(p)]}(l);i.push(e.get(u).next(f=>f?S.resolve():(p=>e.put({targetId:0,path:pe(p),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>S.waitFor(i))})}si(t,e){t.createObjectStore("collectionParents",{keyPath:hw});const r=e.store("collectionParents"),s=new Ll,i=o=>{if(s.add(o)){const c=o.lastSegment(),l=o.popLast();return r.put({collectionId:c,parent:pe(l)})}};return e.store("remoteDocuments").J({H:!0},(o,c)=>{const l=new St(o);return i(l.popLast())}).next(()=>e.store("documentMutations").J({H:!0},([o,c,l],u)=>{const f=Xe(c);return i(f.popLast())}))}oi(t){const e=t.store("targets");return e.J((r,s)=>{const i=qs(s),o=Jm(this.serializer,i);return e.put(o)})}_i(t,e){const r=e.store("remoteDocuments"),s=[];return r.J((i,o)=>{const c=e.store("remoteDocumentsV14"),l=function(p){return p.document?new Y(St.fromString(p.document.name).popFirst(5)):p.noDocument?Y.fromSegments(p.noDocument.path):p.unknownDocument?Y.fromSegments(p.unknownDocument.path):rt()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(c.put(u))}).next(()=>S.waitFor(s))}ai(t,e){const r=e.store("mutations"),s=og(this.serializer),i=new Ul(ga.Zr,this.serializer.ct);return r.U().next(o=>{const c=new Map;return o.forEach(l=>{var u;let f=(u=c.get(l.userId))!==null&&u!==void 0?u:mt();or(this.serializer,l).keys().forEach(p=>f=f.add(p)),c.set(l.userId,f)}),S.forEach(c,(l,u)=>{const f=new se(u),p=pa.lt(this.serializer,f),g=i.getIndexManager(f),_=ma.lt(f,this.serializer,g,i.referenceDelegate);return new ag(s,_,p,g).recalculateAndSaveOverlaysForDocumentKeys(new Dc(e,Fe.oe),l).next()})})}}function Wf(n){n.createObjectStore("targetDocuments",{keyPath:lw}).createIndex("documentTargetsIndex",uw,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",cw,{unique:!0}),n.createObjectStore("targetGlobal")}const sc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class jl{constructor(t,e,r,s,i,o,c,l,u,f,p=17){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=r,this.ui=i,this.window=o,this.document=c,this.ci=u,this.li=f,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!jl.D())throw new Z(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Cb(this,s),this.Ai=e+"main",this.serializer=new Qm(l),this.Ri=new Ln(this.Ai,this.hi,new jb(this.serializer)),this.$r=new yb,this.Ur=new Rb(this.referenceDelegate,this.serializer),this.remoteDocumentCache=og(this.serializer),this.Gr=new _b,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,f===!1&&ve("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Z(F.FAILED_PRECONDITION,sc);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Ur.getHighestSequenceNumber(t))}).then(t=>{this.Qr=new Fe(t,this.ci)}).then(()=>{this.Kr=!0}).catch(t=>(this.Ri&&this.Ri.close(),Promise.reject(t)))}yi(t){return this.di=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ri.L(async e=>{e.newVersion===null&&await t()})}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>eo(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(t).next(e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(t)).next(e=>this.isPrimary&&!e?this.bi(t).next(()=>!1):!!e&&this.Di(t).next(()=>!0))).catch(t=>{if(Hn(t))return $("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return $("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.ui.enqueueRetryable(()=>this.di(t)),this.isPrimary=t})}wi(t){return Fs(t).get("owner").next(e=>S.resolve(this.vi(e)))}Ci(t){return eo(t).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const r=Jt(e,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(c=>i.indexOf(c)===-1);return S.forEach(o,c=>r.delete(c.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const e of t)this.Vi.removeItem(this.Oi(e.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(t){return!!t&&t.ownerId===this.clientId}Si(t){return this.li?S.resolve(!0):Fs(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)){if(this.vi(e)&&this.networkEnabled)return!0;if(!this.vi(e)){if(!e.allowTabSynchronization)throw new Z(F.FAILED_PRECONDITION,sc);return!1}}return!(!this.networkEnabled||!this.inForeground)||eo(t).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,c=this.networkEnabled===s.networkEnabled;if(i||o&&c)return!0}return!1})===void 0)}).next(e=>(this.isPrimary!==e&&$("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const e=new Dc(t,Fe.oe);return this.bi(e).next(()=>this.Ci(e))}),this.Ri.close(),this.qi()}xi(t,e){return t.filter(r=>this.Mi(r.updateTimeMs,e)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",t=>eo(t).U().next(e=>this.xi(e,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(t,e){return ma.lt(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new Ab(t,this.serializer.ct.databaseId)}getDocumentOverlayCache(t){return pa.lt(this.serializer,t)}getBundleCache(){return this.Gr}runTransaction(t,e,r){$("IndexedDbPersistence","Starting transaction:",t);const s=e==="readonly"?"readonly":"readwrite",i=function(l){return l===17?Iw:l===16?vw:l===15?Al:l===14?lm:l===13?cm:l===12?Ew:l===11?am:void rt()}(this.hi);let o;return this.Ri.runTransaction(t,s,i,c=>(o=new Dc(c,this.Qr?this.Qr.next():Fe.oe),e==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw ve(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Z(F.FAILED_PRECONDITION,rm);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(c=>(o.raiseOnCommittedEvent(),c))}Ki(t){return Fs(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Z(F.FAILED_PRECONDITION,sc)})}Di(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fs(t).put("owner",e)}static D(){return Ln.D()}bi(t){const e=Fs(t);return e.get("owner").next(r=>this.vi(r)?($("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):S.resolve())}Mi(t,e){const r=Date.now();return!(t<r-e)&&(!(t>r)||(ve(`Detected an update time that is in the future: ${t} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var t;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;Fp()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(t){var e;try{const r=((e=this.Vi)===null||e===void 0?void 0:e.getItem(this.Oi(t)))!==null;return $("IndexedDbPersistence",`Client '${t}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ve("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(t){ve("Failed to set zombie client id.",t)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Fs(n){return Jt(n,"owner")}function eo(n){return Jt(n,"clientMetadata")}function qb(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.$i=r,this.Ui=s}static Wi(t,e){let r=mt(),s=mt();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ql(t,e.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Fp()?8:im(Po())>0?6:4}()}initialize(t,e){this.Ji=t,this.indexManager=e,this.Gi=!0}getDocumentsMatchingQuery(t,e,r,s){const i={result:null};return this.Yi(t,e).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(t,e,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new $b;return this.Xi(t,e,o).next(c=>{if(i.result=c,this.zi)return this.es(t,e,o,c.size)})}).next(()=>i.result)}es(t,e,r,s){return r.documentReadCount<this.ji?($r()<=vt.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",Kr(e),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),S.resolve()):($r()<=vt.DEBUG&&$("QueryEngine","Query:",Kr(e),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?($r()<=vt.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",Kr(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,je(e))):S.resolve())}Yi(t,e){if(vf(e))return S.resolve(null);let r=je(e);return this.indexManager.getIndexType(t,r).next(s=>s===0?null:(e.limit!==null&&s===1&&(e=Lc(e,null,"F"),r=je(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=mt(...i);return this.Ji.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(l=>{const u=this.ts(e,c);return this.ns(e,u,o,l.readTime)?this.Yi(t,Lc(e,null,"F")):this.rs(t,u,e,l)}))})))}Zi(t,e,r,s){return vf(e)||s.isEqual(ot.min())?S.resolve(null):this.Ji.getDocuments(t,r).next(i=>{const o=this.ts(e,i);return this.ns(e,o,r,s)?S.resolve(null):($r()<=vt.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Kr(e)),this.rs(t,o,e,YT(s,-1)).next(c=>c))})}ts(t,e){let r=new Ct(wm(t));return e.forEach((s,i)=>{Pi(t,i)&&(r=r.add(i))}),r}ns(t,e,r,s){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const i=t.limitType==="F"?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(t,e,r){return $r()<=vt.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",Kr(e)),this.Ji.getDocumentsMatchingQuery(t,e,Ne.min(),r)}rs(t,e,r,s){return this.Ji.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(t,e,r,s){this.persistence=t,this.ss=e,this.serializer=s,this.os=new Lt(pt),this._s=new En(i=>vr(i),Si),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(r)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ag(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.os))}}function lg(n,t,e,r){return new Kb(n,t,e,r)}async function ug(n,t){const e=dt(n);return await e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.ls(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let l=mt();for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of i){c.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return e.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:c}))})})}function zb(n,t){const e=dt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,u,f){const p=u.batch,g=p.keys();let _=S.resolve();return g.forEach(P=>{_=_.next(()=>f.getEntry(l,P)).next(x=>{const N=u.docVersions.get(P);it(N!==null),x.version.compareTo(N)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(l,p))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let l=mt();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(l=l.add(c.batch.mutations[u].key));return l}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function hg(n){const t=dt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Gb(n,t){const e=dt(n),r=t.snapshotVersion;let s=e.os;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.cs.newChangeBuffer({trackRemovals:!0});s=e.os;const c=[];t.targetChanges.forEach((f,p)=>{const g=s.get(p);if(!g)return;c.push(e.Ur.removeMatchingKeys(i,f.removedDocuments,p).next(()=>e.Ur.addMatchingKeys(i,f.addedDocuments,p)));let _=g.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(p)!==null?_=_.withResumeToken(Wt.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,r)),s=s.insert(p,_),function(x,N,U){return x.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(g,_,f)&&c.push(e.Ur.updateTargetData(i,_))});let l=Ve(),u=mt();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(Hb(i,o,t.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!r.isEqual(ot.min())){const f=e.Ur.getLastRemoteSnapshotVersion(i).next(p=>e.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return S.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(e.os=s,i))}function Hb(n,t,e){let r=mt(),s=mt();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=Ve();return e.forEach((c,l)=>{const u=i.get(c);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(ot.min())?(t.removeEntry(c,l.readTime),o=o.insert(c,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(t.addEntry(l),o=o.insert(c,l)):$("LocalStore","Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function Wb(n,t){const e=dt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function Qb(n,t){const e=dt(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Ur.getTargetData(r,t).next(i=>i?(s=i,S.resolve(s)):e.Ur.allocateTargetId(r).next(o=>(s=new fn(t,o,"TargetPurposeListen",r.currentSequenceNumber),e.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.os=e.os.insert(r.targetId,r),e._s.set(t,r.targetId)),r})}async function Gc(n,t,e){const r=dt(n),s=r.os.get(t),i=e?"readwrite":"readwrite-primary";try{e||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Hn(o))throw o;$("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.os=r.os.remove(t),r._s.delete(s.target)}function Qf(n,t,e){const r=dt(n);let s=ot.min(),i=mt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){const p=dt(l),g=p._s.get(f);return g!==void 0?S.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(r,o,je(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,t,e?s:ot.min(),e?i:mt())).next(c=>(Jb(r,Fw(t),c),{documents:c,Ts:i})))}function Jb(n,t,e){let r=n.us.get(t)||ot.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(t,r)}class Jf{constructor(){this.activeTargetIds=$w()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class fg{constructor(){this.so=new Jf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,e,r){this.oo[t]=e}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new Jf,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){$("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){$("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no=null;function ic(){return no===null?no=function(){return 268435456+Math.round(2147483648*Math.random())}():no++,"0x"+no.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue="WebChannelConnection";class t0 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+e.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(e,r,s,i,o){const c=ic(),l=this.xo(e,r.toUriEncodedString());$("RestConnection",`Sending RPC '${e}' ${c}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(e,l,u,s).then(f=>($("RestConnection",`Received RPC '${e}' ${c}: `,f),f),f=>{throw yr("RestConnection",`RPC '${e}' ${c} failed with error: `,f,"url: ",l,"request:",s),f})}Lo(e,r,s,i,o,c){return this.Mo(e,r,s,i,o)}Oo(e,r,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ds}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),s&&s.headers.forEach((i,o)=>e[o]=i)}xo(e,r){const s=Xb[e];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,e,r,s){const i=ic();return new Promise((o,c)=>{const l=new Wp;l.setWithCredentials(!0),l.listenOnce(Qp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case lo.NO_ERROR:const f=l.getResponseJson();$(ue,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(f)),o(f);break;case lo.TIMEOUT:$(ue,`RPC '${t}' ${i} timed out`),c(new Z(F.DEADLINE_EXCEEDED,"Request time out"));break;case lo.HTTP_ERROR:const p=l.getStatus();if($(ue,`RPC '${t}' ${i} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const P=function(N){const U=N.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(U)>=0?U:F.UNKNOWN}(_.status);c(new Z(P,_.message))}else c(new Z(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Z(F.UNAVAILABLE,"Connection failed."));break;default:rt()}}finally{$(ue,`RPC '${t}' ${i} completed.`)}});const u=JSON.stringify(s);$(ue,`RPC '${t}' ${i} sending request:`,s),l.send(e,"POST",u,r,15)})}Bo(t,e,r){const s=ic(),i=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Xp(),c=Yp(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,e,r),l.encodeInitMessageHeaders=!0;const f=i.join("");$(ue,`Creating RPC '${t}' stream ${s}: ${f}`,l);const p=o.createWebChannel(f,l);let g=!1,_=!1;const P=new Zb({Io:N=>{_?$(ue,`Not sending because RPC '${t}' stream ${s} is closed:`,N):(g||($(ue,`Opening RPC '${t}' stream ${s} transport.`),p.open(),g=!0),$(ue,`RPC '${t}' stream ${s} sending:`,N),p.send(N))},To:()=>p.close()}),x=(N,U,L)=>{N.listen(U,k=>{try{L(k)}catch(K){setTimeout(()=>{throw K},0)}})};return x(p,Bs.EventType.OPEN,()=>{_||($(ue,`RPC '${t}' stream ${s} transport opened.`),P.yo())}),x(p,Bs.EventType.CLOSE,()=>{_||(_=!0,$(ue,`RPC '${t}' stream ${s} transport closed`),P.So())}),x(p,Bs.EventType.ERROR,N=>{_||(_=!0,yr(ue,`RPC '${t}' stream ${s} transport errored:`,N),P.So(new Z(F.UNAVAILABLE,"The operation could not be completed")))}),x(p,Bs.EventType.MESSAGE,N=>{var U;if(!_){const L=N.data[0];it(!!L);const k=L,K=k.error||((U=k[0])===null||U===void 0?void 0:U.error);if(K){$(ue,`RPC '${t}' stream ${s} received error:`,K);const tt=K.status;let ct=function(v){const b=Gt[v];if(b!==void 0)return Om(b)}(tt),w=K.message;ct===void 0&&(ct=F.INTERNAL,w="Unknown error status: "+tt+" with message "+K.message),_=!0,P.So(new Z(ct,w)),p.close()}else $(ue,`RPC '${t}' stream ${s} received:`,L),P.bo(L)}}),x(c,Jp.STAT_EVENT,N=>{N.stat===xc.PROXY?$(ue,`RPC '${t}' stream ${s} detected buffering proxy`):N.stat===xc.NOPROXY&&$(ue,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(){return typeof window<"u"?window:null}function yo(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(n){return new ob(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(t,e,r=1e3,s=1.5,i=6e4){this.ui=t,this.timerId=e,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const e=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,e-r);s>0&&$("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(t,e,r,s,i,o,c,l){this.ui=t,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new dg(t,e)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,e){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():e&&e.code===F.RESOURCE_EXHAUSTED?(ve(e.toString()),ve("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):e&&e.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(e)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),e=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===e&&this.P_(r,s)},r=>{t(()=>{const s=new Z(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(t,e){const r=this.h_(this.Yo);this.stream=this.T_(t,e),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return $("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return e=>{this.ui.enqueueAndForget(()=>this.Yo===t?e():($("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class n0 extends pg{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.serializer=i}T_(t,e){return this.connection.Bo("Listen",t,e)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const e=lb(this.serializer,t),r=function(i){if(!("targetChange"in i))return ot.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ot.min():o.readTime?Ie(o.readTime):ot.min()}(t);return this.listener.d_(e,r)}A_(t){const e={};e.database=jc(this.serializer),e.addTarget=function(i,o){let c;const l=o.target;if(c=ko(l)?{documents:$m(i,l)}:{query:Km(i,l)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Lm(i,o.resumeToken);const u=Bc(i,o.expectedCount);u!==null&&(c.expectedCount=u)}else if(o.snapshotVersion.compareTo(ot.min())>0){c.readTime=ls(i,o.snapshotVersion.toTimestamp());const u=Bc(i,o.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,t);const r=hb(this.serializer,t);r&&(e.labels=r),this.a_(e)}R_(t){const e={};e.database=jc(this.serializer),e.removeTarget=t,this.a_(e)}}class r0 extends pg{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,e){return this.connection.Bo("Write",t,e)}E_(t){return it(!!t.streamToken),this.lastStreamToken=t.streamToken,it(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){it(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const e=ub(t.writeResults,t.commitTime),r=Ie(t.commitTime);return this.listener.g_(r,e)}p_(){const t={};t.database=jc(this.serializer),this.a_(t)}m_(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>Fo(this.serializer,r))};this.a_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0 extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Z(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,e,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(t,Uc(e,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Z(F.UNKNOWN,i.toString())})}Lo(t,e,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(t,Uc(e,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class i0{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ve(e),this.D_=!1):$("OnlineStateTracker",e)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(t,e,r,s,i){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Rr(this)&&($("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=dt(l);u.L_.add(4),await xi(u),u.q_.set("Unknown"),u.L_.delete(4),await ya(u)}(this))})}),this.q_=new i0(r,s)}}async function ya(n){if(Rr(n))for(const t of n.B_)await t(!0)}async function xi(n){for(const t of n.B_)await t(!1)}function mg(n,t){const e=dt(n);e.N_.has(t.targetId)||(e.N_.set(t.targetId,t),Gl(e)?zl(e):ms(e).r_()&&Kl(e,t))}function $l(n,t){const e=dt(n),r=ms(e);e.N_.delete(t),r.r_()&&gg(e,t),e.N_.size===0&&(r.r_()?r.o_():Rr(e)&&e.q_.set("Unknown"))}function Kl(n,t){if(n.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ot.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}ms(n).A_(t)}function gg(n,t){n.Q_.xe(t),ms(n).R_(t)}function zl(n){n.Q_=new nb({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>n.N_.get(t)||null,tt:()=>n.datastore.serializer.databaseId}),ms(n).start(),n.q_.v_()}function Gl(n){return Rr(n)&&!ms(n).n_()&&n.N_.size>0}function Rr(n){return dt(n).L_.size===0}function _g(n){n.Q_=void 0}async function a0(n){n.q_.set("Online")}async function c0(n){n.N_.forEach((t,e)=>{Kl(n,t)})}async function l0(n,t){_g(n),Gl(n)?(n.q_.M_(t),zl(n)):n.q_.set("Unknown")}async function u0(n,t,e){if(n.q_.set("Online"),t instanceof Fm&&t.state===2&&t.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(n,t)}catch(r){$("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await qo(n,r)}else if(t instanceof _o?n.Q_.Ke(t):t instanceof Mm?n.Q_.He(t):n.Q_.We(t),!e.isEqual(ot.min()))try{const r=await hg(n.localStore);e.compareTo(r)>=0&&await function(i,o){const c=i.Q_.rt(o);return c.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=i.N_.get(u);f&&i.N_.set(u,f.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,u)=>{const f=i.N_.get(l);if(!f)return;i.N_.set(l,f.withResumeToken(Wt.EMPTY_BYTE_STRING,f.snapshotVersion)),gg(i,l);const p=new fn(f.target,l,u,f.sequenceNumber);Kl(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(n,e)}catch(r){$("RemoteStore","Failed to raise snapshot:",r),await qo(n,r)}}async function qo(n,t,e){if(!Hn(t))throw t;n.L_.add(1),await xi(n),n.q_.set("Offline"),e||(e=()=>hg(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{$("RemoteStore","Retrying IndexedDB access"),await e(),n.L_.delete(1),await ya(n)})}function yg(n,t){return t().catch(e=>qo(n,e,t))}async function Vi(n){const t=dt(n),e=qn(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;h0(t);)try{const s=await Wb(t.localStore,r);if(s===null){t.O_.length===0&&e.o_();break}r=s.batchId,f0(t,s)}catch(s){await qo(t,s)}Eg(t)&&vg(t)}function h0(n){return Rr(n)&&n.O_.length<10}function f0(n,t){n.O_.push(t);const e=qn(n);e.r_()&&e.V_&&e.m_(t.mutations)}function Eg(n){return Rr(n)&&!qn(n).n_()&&n.O_.length>0}function vg(n){qn(n).start()}async function d0(n){qn(n).p_()}async function p0(n){const t=qn(n);for(const e of n.O_)t.m_(e.mutations)}async function m0(n,t,e){const r=n.O_.shift(),s=Nl.from(r,t,e);await yg(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Vi(n)}async function g0(n,t){t&&qn(n).V_&&await async function(r,s){if(function(o){return Zw(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();qn(r).s_(),await yg(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Vi(r)}}(n,t),Eg(n)&&vg(n)}async function Xf(n,t){const e=dt(n);e.asyncQueue.verifyOperationInProgress(),$("RemoteStore","RemoteStore received new credentials");const r=Rr(e);e.L_.add(3),await xi(e),r&&e.q_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.L_.delete(3),await ya(e)}async function _0(n,t){const e=dt(n);t?(e.L_.delete(2),await ya(e)):t||(e.L_.add(2),await xi(e),e.q_.set("Unknown"))}function ms(n){return n.K_||(n.K_=function(e,r,s){const i=dt(e);return i.w_(),new n0(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:a0.bind(null,n),Ro:c0.bind(null,n),mo:l0.bind(null,n),d_:u0.bind(null,n)}),n.B_.push(async t=>{t?(n.K_.s_(),Gl(n)?zl(n):n.q_.set("Unknown")):(await n.K_.stop(),_g(n))})),n.K_}function qn(n){return n.U_||(n.U_=function(e,r,s){const i=dt(e);return i.w_(),new r0(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:d0.bind(null,n),mo:g0.bind(null,n),f_:p0.bind(null,n),g_:m0.bind(null,n)}),n.B_.push(async t=>{t?(n.U_.s_(),await Vi(n)):(await n.U_.stop(),n.O_.length>0&&($("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new Hl(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(F.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wl(n,t){if(ve("AsyncQueue",`${t}: ${n}`),Hn(n))return new Z(F.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this.comparator=t?(e,r)=>t(e,r)||Y.comparator(e.key,r.key):(e,r)=>Y.comparator(e.key,r.key),this.keyedMap=Us(),this.sortedSet=new Lt(this.comparator)}static emptySet(t){return new Xr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Xr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const r=new Xr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(){this.W_=new Lt(Y.comparator)}track(t){const e=t.doc.key,r=this.W_.get(e);r?t.type!==0&&r.type===3?this.W_=this.W_.insert(e,t):t.type===3&&r.type!==1?this.W_=this.W_.insert(e,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.W_=this.W_.insert(e,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.W_=this.W_.remove(e):t.type===1&&r.type===2?this.W_=this.W_.insert(e,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):rt():this.W_=this.W_.insert(e,t)}G_(){const t=[];return this.W_.inorderTraversal((e,r)=>{t.push(r)}),t}}class us{constructor(t,e,r,s,i,o,c,l,u){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new us(t,e,Xr.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ua(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class E0{constructor(){this.queries=td(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(e,r){const s=dt(e),i=s.queries;s.queries=td(),i.forEach((o,c)=>{for(const l of c.j_)l.onError(r)})})(this,new Z(F.ABORTED,"Firestore shutting down"))}}function td(){return new En(n=>Tm(n),ua)}async function v0(n,t){const e=dt(n);let r=3;const s=t.query;let i=e.queries.get(s);i?!i.H_()&&t.J_()&&(r=2):(i=new y0,r=t.J_()?0:1);try{switch(r){case 0:i.z_=await e.onListen(s,!0);break;case 1:i.z_=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(o){const c=Wl(o,`Initialization of query '${Kr(t.query)}' failed`);return void t.onError(c)}e.queries.set(s,i),i.j_.push(t),t.Z_(e.onlineState),i.z_&&t.X_(i.z_)&&Ql(e)}async function I0(n,t){const e=dt(n),r=t.query;let s=3;const i=e.queries.get(r);if(i){const o=i.j_.indexOf(t);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=t.J_()?0:1:!i.H_()&&t.J_()&&(s=2))}switch(s){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function T0(n,t){const e=dt(n);let r=!1;for(const s of t){const i=s.query,o=e.queries.get(i);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&Ql(e)}function w0(n,t,e){const r=dt(n),s=r.queries.get(t);if(s)for(const i of s.j_)i.onError(e);r.queries.delete(t)}function Ql(n){n.Y_.forEach(t=>{t.next()})}var Hc,ed;(ed=Hc||(Hc={})).ea="default",ed.Cache="cache";class b0{constructor(t,e,r){this.query=t,this.ta=e,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new us(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.na?this.ia(t)&&(this.ta.next(t),e=!0):this.sa(t,this.onlineState)&&(this.oa(t),e=!0),this.ra=t,e}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let e=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),e=!0),e}sa(t,e){if(!t.fromCache||!this.J_())return!0;const r=e!=="Offline";return(!this.options._a||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const e=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}oa(t){t=us.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Hc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(t){this.key=t}}class Tg{constructor(t){this.key=t}}class A0{constructor(t,e){this.query=t,this.Ta=e,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=mt(),this.mutatedKeys=mt(),this.Aa=wm(t),this.Ra=new Xr(this.Aa)}get Va(){return this.Ta}ma(t,e){const r=e?e.fa:new Zf,s=e?e.Ra:this.Ra;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((f,p)=>{const g=s.get(f),_=Pi(this.query,p)?p:null,P=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;g&&_?g.data.isEqual(_.data)?P!==x&&(r.track({type:3,doc:_}),N=!0):this.ga(g,_)||(r.track({type:2,doc:_}),N=!0,(l&&this.Aa(_,l)>0||u&&this.Aa(_,u)<0)&&(c=!0)):!g&&_?(r.track({type:0,doc:_}),N=!0):g&&!_&&(r.track({type:1,doc:g}),N=!0,(l||u)&&(c=!0)),N&&(_?(o=o.add(_),i=x?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:c,mutatedKeys:i}}ga(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r,s){const i=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const o=t.fa.G_();o.sort((f,p)=>function(_,P){const x=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt()}};return x(_)-x(P)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),s=s!=null&&s;const c=e&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new us(this.query,t.Ra,i,o,t.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Zf,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=mt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const e=[];return t.forEach(r=>{this.da.has(r)||e.push(new Tg(r))}),this.da.forEach(r=>{t.has(r)||e.push(new Ig(r))}),e}ba(t){this.Ta=t.Ts,this.da=mt();const e=this.ma(t.documents);return this.applyChanges(e,!0)}Da(){return us.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class R0{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class S0{constructor(t){this.key=t,this.va=!1}}class P0{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new En(c=>Tm(c),ua),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Y.comparator),this.Na=new Map,this.La=new Bl,this.Ba={},this.ka=new Map,this.qa=wr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function C0(n,t,e=!0){const r=Pg(n);let s;const i=r.Fa.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await wg(r,t,e,!0),s}async function x0(n,t){const e=Pg(n);await wg(e,t,!0,!1)}async function wg(n,t,e,r){const s=await Qb(n.localStore,je(t)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,e);let c;return r&&(c=await V0(n,t,i,o==="current",s.resumeToken)),n.isPrimaryClient&&e&&mg(n.remoteStore,s),c}async function V0(n,t,e,r,s){n.Ka=(p,g,_)=>async function(x,N,U,L){let k=N.view.ma(U);k.ns&&(k=await Qf(x.localStore,N.query,!1).then(({documents:w})=>N.view.ma(w,k)));const K=L&&L.targetChanges.get(N.targetId),tt=L&&L.targetMismatches.get(N.targetId)!=null,ct=N.view.applyChanges(k,x.isPrimaryClient,K,tt);return rd(x,N.targetId,ct.wa),ct.snapshot}(n,p,g,_);const i=await Qf(n.localStore,t,!0),o=new A0(t,i.Ts),c=o.ma(i.documents),l=Ci.createSynthesizedTargetChangeForCurrentChange(e,r&&n.onlineState!=="Offline",s),u=o.applyChanges(c,n.isPrimaryClient,l);rd(n,e,u.wa);const f=new R0(t,e,o);return n.Fa.set(t,f),n.Ma.has(e)?n.Ma.get(e).push(t):n.Ma.set(e,[t]),u.snapshot}async function D0(n,t,e){const r=dt(n),s=r.Fa.get(t),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!ua(o,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Gc(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),e&&$l(r.remoteStore,s.targetId),Wc(r,s.targetId)}).catch(br)):(Wc(r,s.targetId),await Gc(r.localStore,s.targetId,!0))}async function N0(n,t){const e=dt(n),r=e.Fa.get(t),s=e.Ma.get(r.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),$l(e.remoteStore,r.targetId))}async function k0(n,t,e){const r=Cg(n);try{const s=await function(o,c){const l=dt(o),u=$t.now(),f=c.reduce((_,P)=>_.add(P.key),mt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let P=Ve(),x=mt();return l.cs.getEntries(_,f).next(N=>{P=N,P.forEach((U,L)=>{L.isValidDocument()||(x=x.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,P)).next(N=>{p=N;const U=[];for(const L of c){const k=Yw(L,p.get(L.key).overlayedDocument);k!=null&&U.push(new Wn(L.key,k,pm(k.value.mapValue),De.exists(!0)))}return l.mutationQueue.addMutationBatch(_,u,U,c)}).next(N=>{g=N;const U=N.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(_,N.batchId,U)})}).then(()=>({batchId:g.batchId,changes:Am(p)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new Lt(pt)),u=u.insert(c,l),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,e),await Di(r,s.changes),await Vi(r.remoteStore)}catch(s){const i=Wl(s,"Failed to persist write");e.reject(i)}}async function bg(n,t){const e=dt(n);try{const r=await Gb(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.Na.get(i);o&&(it(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?it(o.va):s.removedDocuments.size>0&&(it(o.va),o.va=!1))}),await Di(e,r,t)}catch(r){await br(r)}}function nd(n,t,e){const r=dt(n);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const s=[];r.Fa.forEach((i,o)=>{const c=o.view.Z_(t);c.snapshot&&s.push(c.snapshot)}),function(o,c){const l=dt(o);l.onlineState=c;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(c)&&(u=!0)}),u&&Ql(l)}(r.eventManager,t),s.length&&r.Ca.d_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function O0(n,t,e){const r=dt(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.Na.get(t),i=s&&s.key;if(i){let o=new Lt(Y.comparator);o=o.insert(i,zt.newNoDocument(i,ot.min()));const c=mt().add(i),l=new da(ot.min(),new Map,new Lt(pt),o,c);await bg(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(t),Jl(r)}else await Gc(r.localStore,t,!1).then(()=>Wc(r,t,e)).catch(br)}async function M0(n,t){const e=dt(n),r=t.batch.batchId;try{const s=await zb(e.localStore,t);Rg(e,r,null),Ag(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await Di(e,s)}catch(s){await br(s)}}async function F0(n,t,e){const r=dt(n);try{const s=await function(o,c){const l=dt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,c).next(p=>(it(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(r.localStore,t);Rg(r,t,e),Ag(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await Di(r,s)}catch(s){await br(s)}}function Ag(n,t){(n.ka.get(t)||[]).forEach(e=>{e.resolve()}),n.ka.delete(t)}function Rg(n,t,e){const r=dt(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.Ba[r.currentUser.toKey()]=s}}function Wc(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.Ma.get(t))n.Fa.delete(r),e&&n.Ca.$a(r,e);n.Ma.delete(t),n.isPrimaryClient&&n.La.gr(t).forEach(r=>{n.La.containsKey(r)||Sg(n,r)})}function Sg(n,t){n.xa.delete(t.path.canonicalString());const e=n.Oa.get(t);e!==null&&($l(n.remoteStore,e),n.Oa=n.Oa.remove(t),n.Na.delete(e),Jl(n))}function rd(n,t,e){for(const r of e)r instanceof Ig?(n.La.addReference(r.key,t),L0(n,r)):r instanceof Tg?($("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,t),n.La.containsKey(r.key)||Sg(n,r.key)):rt()}function L0(n,t){const e=t.key,r=e.path.canonicalString();n.Oa.get(e)||n.xa.has(r)||($("SyncEngine","New document in limbo: "+e),n.xa.add(r),Jl(n))}function Jl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const t=n.xa.values().next().value;n.xa.delete(t);const e=new Y(St.fromString(t)),r=n.qa.next();n.Na.set(r,new S0(e)),n.Oa=n.Oa.insert(e,r),mg(n.remoteStore,new fn(je(Cl(e.path)),r,"TargetPurposeLimboResolution",Fe.oe))}}async function Di(n,t,e){const r=dt(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,l)=>{o.push(r.Ka(l,t,e).then(u=>{var f;if((u||e)&&r.isPrimaryClient){const p=u?!u.fromCache:(f=e==null?void 0:e.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){s.push(u);const p=ql.Wi(l.targetId,u);i.push(p)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,u){const f=dt(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(u,g=>S.forEach(g.$i,_=>f.persistence.referenceDelegate.addReference(p,g.targetId,_)).next(()=>S.forEach(g.Ui,_=>f.persistence.referenceDelegate.removeReference(p,g.targetId,_)))))}catch(p){if(!Hn(p))throw p;$("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const _=f.os.get(g),P=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(P);f.os=f.os.insert(g,x)}}}(r.localStore,i))}async function B0(n,t){const e=dt(n);if(!e.currentUser.isEqual(t)){$("SyncEngine","User change. New user:",t.toKey());const r=await ug(e.localStore,t);e.currentUser=t,function(i,o){i.ka.forEach(c=>{c.forEach(l=>{l.reject(new Z(F.CANCELLED,o))})}),i.ka.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Di(e,r.hs)}}function U0(n,t){const e=dt(n),r=e.Na.get(t);if(r&&r.va)return mt().add(r.key);{let s=mt();const i=e.Ma.get(t);if(!i)return s;for(const o of i){const c=e.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function Pg(n){const t=dt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=bg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=U0.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=O0.bind(null,t),t.Ca.d_=T0.bind(null,t.eventManager),t.Ca.$a=w0.bind(null,t.eventManager),t}function Cg(n){const t=dt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=M0.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=F0.bind(null,t),t}class Ii{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=_a(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,e){return null}Ha(t,e){return null}za(t){return lg(this.persistence,new cg,t.initialUser,this.serializer)}Ga(t){return new Ul(ga.Zr,this.serializer)}Wa(t){return new fg}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ii.provider={build:()=>new Ii};class j0 extends Ii{constructor(t){super(),this.cacheSizeBytes=t}ja(t,e){it(this.persistence.referenceDelegate instanceof jo);const r=this.persistence.referenceDelegate.garbageCollector;return new rg(r,t.asyncQueue,e)}Ga(t){const e=this.cacheSizeBytes!==void 0?he.withCacheSize(this.cacheSizeBytes):he.DEFAULT;return new Ul(r=>jo.Zr(r,e),this.serializer)}}class q0 extends Ii{constructor(t,e,r){super(),this.Ja=t,this.cacheSizeBytes=e,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await this.Ja.initialize(this,t),await Cg(this.Ja.syncEngine),await Vi(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(t){return lg(this.persistence,new cg,t.initialUser,this.serializer)}ja(t,e){const r=this.persistence.referenceDelegate.garbageCollector;return new rg(r,t.asyncQueue,e)}Ha(t,e){const r=new ew(e,this.persistence);return new tw(t.asyncQueue,r)}Ga(t){const e=qb(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?he.withCacheSize(this.cacheSizeBytes):he.DEFAULT;return new jl(this.synchronizeTabs,e,t.clientId,r,t.asyncQueue,e0(),yo(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(t){return new fg}}class $o{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>nd(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=B0.bind(null,this.syncEngine),await _0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new E0}()}createDatastore(t){const e=_a(t.databaseInfo.databaseId),r=function(i){return new t0(i)}(t.databaseInfo);return function(i,o,c,l){return new s0(i,o,c,l)}(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return function(r,s,i,o,c){return new o0(r,s,i,o,c)}(this.localStore,this.datastore,t.asyncQueue,e=>nd(this.syncEngine,e,0),function(){return Yf.D()?new Yf:new Yb}())}createSyncEngine(t,e){return function(s,i,o,c,l,u,f){const p=new P0(s,i,o,c,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(s){const i=dt(s);$("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await xi(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()}}$o.provider={build:()=>new $o};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):ve("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,e){setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(t,e,r,s,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=se.UNAUTHENTICATED,this.clientId=tm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{$("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>($("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=Wl(e,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function oc(n,t){n.asyncQueue.verifyOperationInProgress(),$("FirestoreClient","Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await ug(t.localStore,s),r=s)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function sd(n,t){n.asyncQueue.verifyOperationInProgress();const e=await z0(n);$("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(r=>Xf(t.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Xf(t.remoteStore,s)),n._onlineComponents=t}async function z0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){$("FirestoreClient","Using user provided OfflineComponentProvider");try{await oc(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(e))throw e;yr("Error using user provided cache. Falling back to memory cache: "+e),await oc(n,new Ii)}}else $("FirestoreClient","Using default OfflineComponentProvider"),await oc(n,new j0(void 0));return n._offlineComponents}async function xg(n){return n._onlineComponents||(n._uninitializedComponentsProvider?($("FirestoreClient","Using user provided OnlineComponentProvider"),await sd(n,n._uninitializedComponentsProvider._online)):($("FirestoreClient","Using default OnlineComponentProvider"),await sd(n,new $o))),n._onlineComponents}function G0(n){return xg(n).then(t=>t.syncEngine)}async function H0(n){const t=await xg(n),e=t.eventManager;return e.onListen=C0.bind(null,t.syncEngine),e.onUnlisten=D0.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=x0.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=N0.bind(null,t.syncEngine),e}function W0(n,t,e={}){const r=new pn;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,c,l,u){const f=new $0({next:g=>{f.Za(),o.enqueueAndForget(()=>I0(i,p)),g.fromCache&&l.source==="server"?u.reject(new Z(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new b0(c,f,{includeMetadataChanges:!0,_a:!0});return v0(i,p)}(await H0(n),n.asyncQueue,t,e,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(n,t,e){if(!e)throw new Z(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function Q0(n,t,e,r){if(t===!0&&r===!0)throw new Z(F.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function od(n){if(!Y.isDocumentKey(n))throw new Z(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ad(n){if(Y.isDocumentKey(n))throw new Z(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Yl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":rt()}function Ti(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Z(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Yl(n);throw new Z(F.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(t){var e,r;if(t.host===void 0){if(t.ssl!==void 0)throw new Z(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Z(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Q0("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vg((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ea{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Z(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cd(t),t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new qT;switch(r.type){case"firstParty":return new GT(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const r=id.get(e);r&&($("ComponentProvider","Removing Datastore"),id.delete(e),r.terminate())}(this),Promise.resolve()}}function J0(n,t,e,r={}){var s;const i=(n=Ti(n,Ea))._getSettings(),o=`${t}:${e}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&yr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let c,l;if(typeof r.mockUserToken=="string")c=r.mockUserToken,l=se.MOCK_USER;else{c=SI(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Z(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new se(u)}n._authCredentials=new $T(new Zp(c,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new va(this.firestore,t,this._query)}}class Ge{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ge(this.firestore,t,this._key)}}class Bn extends va{constructor(t,e,r){super(t,e,Cl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ge(this.firestore,null,new Y(t))}withConverter(t){return new Bn(this.firestore,t,this._path)}}function gs(n,t,...e){if(n=ui(n),Dg("collection","path",t),n instanceof Ea){const r=St.fromString(t,...e);return ad(r),new Bn(n,null,r)}{if(!(n instanceof Ge||n instanceof Bn))throw new Z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(St.fromString(t,...e));return ad(r),new Bn(n.firestore,null,r)}}function Y0(n,t,...e){if(n=ui(n),arguments.length===1&&(t=tm.newId()),Dg("doc","path",t),n instanceof Ea){const r=St.fromString(t,...e);return od(r),new Ge(n,null,new Y(r))}{if(!(n instanceof Ge||n instanceof Bn))throw new Z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(St.fromString(t,...e));return od(r),new Ge(n.firestore,n instanceof Bn?n.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new dg(this,"async_queue_retry"),this.Vu=()=>{const r=yo();r&&$("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=t;const e=yo();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const e=yo();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const e=new pn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Hn(t))throw t;$("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const e=this.mu.then(()=>(this.du=!0,t().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw ve("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=e,e}enqueueAfterDelay(t,e,r){this.fu(),this.Ru.indexOf(t)>-1&&(e=0);const s=Hl.createAndSchedule(this,t,e,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&rt()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const e of this.Tu)if(e.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.Tu)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const e=this.Tu.indexOf(t);this.Tu.splice(e,1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=-1;class Ia extends Ea{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new ld,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ld(t),this._firestoreClient=void 0,await t}}}function Z0(n,t,e){e||(e="(default)");const r=$p(n,"firestore");if(r.isInitialized(e)){const s=r.getImmediate({identifier:e}),i=r.getOptions(e);if(Co(i,t))return s;throw new Z(F.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(t.cacheSizeBytes!==void 0&&t.localCache!==void 0)throw new Z(F.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(t.cacheSizeBytes!==void 0&&t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Z(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:t,instanceIdentifier:e})}function tA(n,t){const e=typeof n=="object"?n:DT(),r=typeof n=="string"?n:"(default)",s=$p(e,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=AI("firestore");i&&J0(s,...i)}return s}function Ng(n){if(n._terminated)throw new Z(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kg(n),n._firestoreClient}function kg(n){var t,e,r;const s=n._freezeSettings(),i=function(c,l,u,f){return new ww(c,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Vg(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((e=s.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new K0(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(c){const l=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(l),_online:l}}(n._componentsProvider))}function eA(n,t){yr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();return nA(n,$o.provider,{build:r=>new q0(r,e.cacheSizeBytes,void 0)}),Promise.resolve()}function nA(n,t,e){if((n=Ti(n,Ia))._firestoreClient||n._terminated)throw new Z(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Z(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:t,_offline:e},kg(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(t){this._byteString=t}static fromBase64String(t){try{return new hs(Wt.fromBase64String(t))}catch(e){throw new Z(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new hs(Wt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Z(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Z(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Z(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return pt(this._lat,t._lat)||pt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=/^__.*__$/;class sA{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new Wn(t,this.data,this.fieldMask,e,this.fieldTransforms):new ps(t,this.data,e,this.fieldTransforms)}}function Mg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt()}}class eu{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new eu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var e;const r=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.Fu({path:r,xu:!1});return s.Ou(t),s}Nu(t){var e;const r=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return Ko(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(Mg(this.Cu)&&rA.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class iA{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||_a(t)}Qu(t,e,r,s=!1){return new eu({Cu:t,methodName:e,qu:r,path:jt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function oA(n){const t=n._freezeSettings(),e=_a(n._databaseId);return new iA(n._databaseId,!!t.ignoreUndefinedProperties,e)}function aA(n,t,e,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,t,e,s);Ug("Data must be an object, but it was:",o,r);const c=Lg(r,o);let l,u;if(i.merge)l=new Le(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const g=cA(t,p,e);if(!o.contains(g))throw new Z(F.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);uA(f,g)||f.push(g)}l=new Le(f),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new sA(new Ae(c),l,u)}function Fg(n,t){if(Bg(n=ui(n)))return Ug("Unsupported field value:",t,n),Lg(n,t);if(n instanceof Og)return function(r,s){if(!Mg(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let l=Fg(c,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,t)}return function(r,s){if((r=ui(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Kw(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$t.fromDate(r);return{timestampValue:ls(s.serializer,i)}}if(r instanceof $t){const i=new $t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ls(s.serializer,i)}}if(r instanceof Zl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof hs)return{bytesValue:Lm(s.serializer,r._byteString)};if(r instanceof Ge){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ml(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof tu)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw c.Bu("VectorValues must only contain numeric values.");return xl(c.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Yl(r)}`)}(n,t)}function Lg(n,t){const e={};return um(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ar(n,(r,s)=>{const i=Fg(s,t.Mu(r));i!=null&&(e[r]=i)}),{mapValue:{fields:e}}}function Bg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $t||n instanceof Zl||n instanceof hs||n instanceof Ge||n instanceof Og||n instanceof tu)}function Ug(n,t,e){if(!Bg(e)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(e)){const r=Yl(e);throw r==="an object"?t.Bu(n+" a custom object"):t.Bu(n+" "+r)}}function cA(n,t,e){if((t=ui(t))instanceof Xl)return t._internalPath;if(typeof t=="string")return jg(n,t);throw Ko("Field path arguments must be of type string or ",n,!1,void 0,e)}const lA=new RegExp("[~\\*/\\[\\]]");function jg(n,t,e){if(t.search(lA)>=0)throw Ko(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Xl(...t.split("."))._internalPath}catch{throw Ko(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Ko(n,t,e,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new Z(F.INVALID_ARGUMENT,c+n+l)}function uA(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ge(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new hA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field($g("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class hA extends qg{data(){return super.data()}}function $g(n,t){return typeof t=="string"?jg(n,t):t instanceof Xl?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Z(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dA{convertValue(t,e="none"){switch(Un(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ft(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_n(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw rt()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return Ar(t,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertVectorValue(t){var e,r,s;const i=(s=(r=(e=t.fields)===null||e===void 0?void 0:e.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ft(o.doubleValue));return new tu(i)}convertGeoPoint(t){return new Zl(Ft(t.latitude),Ft(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=aa(t);return r==null?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(gi(t));default:return null}}convertTimestamp(t){const e=gn(t);return new $t(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=St.fromString(t);it(Wm(r));const s=new Er(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(e)||ve(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pA(n,t,e){let r;return r=n?n.toFirestore(t):t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class mA extends qg{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Eo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field($g("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class Eo extends mA{data(t={}){return super.data(t)}}class gA{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new ro(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new Eo(this._firestore,this._userDataWriter,r.key,r,new ro(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Z(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const l=new Eo(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ro(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const l=new Eo(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ro(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return c.type!==0&&(u=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:_A(c.type),doc:l,oldIndex:u,newIndex:f}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function _A(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt()}}class yA extends dA{constructor(t){super(),this.firestore=t}convertBytes(t){return new hs(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ge(this.firestore,null,e)}}function nu(n){n=Ti(n,va);const t=Ti(n.firestore,Ia),e=Ng(t),r=new yA(t);return fA(n._query),W0(e,n._query).then(s=>new gA(t,r,n,s))}function ru(n,t){const e=Ti(n.firestore,Ia),r=Y0(n),s=pA(n.converter,t);return EA(e,[aA(oA(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,De.exists(!1))]).then(()=>r)}function EA(n,t){return function(r,s){const i=new pn;return r.asyncQueue.enqueueAndForget(async()=>k0(await G0(r),s,i)),i.promise}(Ng(n),t)}(function(t,e=!0){(function(s){ds=s})(VT),Vo(new hi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new Ia(new KT(r.getProvider("auth-internal")),new WT(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Z(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Er(u.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:e},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Yr(rf,"4.7.4",t),Yr(rf,"4.7.4","esm2017")})();var vA="firebase",IA="11.0.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yr(vA,IA,"app");const TA={apiKey:"AIzaSyDAjkmkmixb-HR-Gyh5K6QYWXo6Kc2S8Q0",authDomain:"nekay-b4b50.firebaseapp.com",projectId:"nekay-b4b50",storageBucket:"nekay-b4b50.firebasestorage.app",messagingSenderId:"833816673115",appId:"1:833816673115:web:2b51df86efd3f4bfeb787e",measurementId:"G-YJHYN5NKJ1"},Kg=Kp(TA),wA=Z0(Kg,{cacheSizeBytes:X0});eA(wA).then(()=>{console.log("Offline persistence enabled")}).catch(n=>{n.code=="failed-precondition"?console.warn("Multiple tabs open, offline persistence can only be enabled in one tab at a time."):n.code=="unimplemented"&&console.warn("Current browser doesn't support offline persistence")});window.addEventListener("online",()=>{console.log("App is online")});window.addEventListener("offline",()=>{console.log("App is offline")});const _s=tA(Kg),zg=async n=>{try{await ru(gs(_s,"tasks"),n),console.log("Task stored successfully!")}catch(t){console.error("Error storing task:",t)}},Gg=async n=>{try{await ru(gs(_s,"journalEntries"),n),console.log("Journal entry stored successfully!")}catch(t){console.error("Error storing journal entry:",t)}},Hg=async n=>{try{await ru(gs(_s,"folders"),n),console.log("Folder stored successfully!")}catch(t){console.error("Error storing folder:",t)}},bA=async()=>{try{const n=await nu(gs(_s,"tasks")),t=[];return n.forEach(e=>{t.push({...e.data(),id:e.id})}),t}catch(n){return console.error("Error fetching tasks:",n),[]}},AA=async()=>{try{const n=await nu(gs(_s,"journalEntries")),t=[];return n.forEach(e=>{t.push({...e.data(),id:e.id})}),t}catch(n){return console.error("Error fetching journal entries:",n),[]}},RA=async()=>{try{const n=await nu(gs(_s,"folders")),t=[];return n.forEach(e=>{t.push({...e.data(),id:e.id})}),t}catch(n){return console.error("Error fetching folders:",n),[]}};class SA{constructor(){Ma(this,"isSyncing",!1)}async syncData(){if(!this.isSyncing)try{this.isSyncing=!0;const t=await be.getPendingSyncItems("tasks");for(const s of t)try{await zg(s),await be.updateSyncStatus("tasks",s.id,"synced")}catch(i){console.error("Error syncing task:",i),await be.updateSyncStatus("tasks",s.id,"failed")}const e=await be.getPendingSyncItems("journal");for(const s of e)try{await Gg(s),await be.updateSyncStatus("journal",s.id,"synced")}catch(i){console.error("Error syncing journal entry:",i),await be.updateSyncStatus("journal",s.id,"failed")}const r=await be.getPendingSyncItems("folders");for(const s of r)try{await Hg(s),await be.updateSyncStatus("folders",s.id,"synced")}catch(i){console.error("Error syncing folder:",i),await be.updateSyncStatus("folders",s.id,"failed")}}finally{this.isSyncing=!1}}}const PA=new SA,CA=iv("notes",{state:()=>({tasks:[],journalEntries:[],folders:[],loading:!1}),actions:{async initialise(){this.tasks=await be.getAllItems("tasks"),this.journalEntries=await be.getAllItems("journal"),this.folders=await be.getAllItems("folders"),navigator.onLine&&PA.syncData()},async fetchTasks(){this.loading=!0;const n=await bA();this.tasks=n,this.loading=!1},async addTask(n,t=null){const e={id:Date.now().toString(),title:n,completed:!1,folderId:t};this.tasks.push(e),zg(e),await be.addItem("tasks",e)},toggleTask(n){const t=this.tasks.find(e=>e.id===n);t&&(t.completed=!t.completed)},deleteTask(n){this.tasks=this.tasks.filter(t=>t.id!==n)},async fetchJournalEntries(){this.loading=!0;const n=await AA();this.journalEntries=n,this.loading=!1},addJournalEntry(n,t,e=null){const r={id:Date.now().toString(),title:n,content:t,date:new Date().toISOString(),folderId:e};this.journalEntries.push(r),Gg(r)},updateJournalEntry(n,t){const e=this.journalEntries.find(r=>r.id===n);e&&Object.assign(e,t)},async deleteJournalEntry(n){const t=this.journalEntries.findIndex(e=>e.id===n);t!==-1&&this.journalEntries.splice(t,1)},async fetchFolders(){this.loading=!0;const n=await RA();this.folders=n,this.loading=!1},addFolder(n,t){const e={id:Date.now().toString(),name:n,type:t};this.folders.push(e),Hg(e)},deleteFolder(n){this.folders=this.folders.filter(t=>t.id!==n),this.tasks=this.tasks.map(t=>t.folderId===n?{...t,folderId:null}:t),this.journalEntries=this.journalEntries.map(t=>t.folderId===n?{...t,folderId:null}:t)},editTask(n,t){const e=this.tasks.findIndex(r=>r.id===n);e!==-1&&(this.tasks[e].title=t)},editFolder(n,t){const e=this.folders.findIndex(r=>r.id===n);e!==-1&&(this.folders[e].name=t)}}}),xA=async()=>{try{await be.init()}catch(r){const s=r;s.code==="INDEXEDDB_INIT_ERROR"?alert(`Unable to start offline storage: ${s.message}`):s.code==="INDEXEDDB_BLOCKED"?alert(s.message):alert("Unable to initialize app storage. Some features may be unavailable.")}const n=QE(hI),t=ZE();n.use(t),n.use(Np),CA(t).initialise(),n.mount("#app")};xA();mI();export{Cy as A,Qt as B,hy as C,ln as F,fp as a,OA as b,cE as c,Yo as d,FA as e,DA as f,fE as g,kA as h,vy as i,CA as j,Zc as k,iv as l,hE as m,tl as n,_c as o,hr as p,Me as q,ur as r,BA as s,x_ as t,UA as u,MA as v,Ws as w,NA as x,LA as y,jA as z};
