import{s as b,x as f,d as v,y as L,j as R,z as I,c as r,A as e,t as u,g as k,a as i,q as n,n as w,p as M,o as l}from"./app-DJtXMlp-.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N="/assets/melody3.gif",c=25*60,g=5*60,B=.5,y="pomodoro-state",P=b("pomodoro",{state:()=>({timeLeft:c,isRunning:!1,timer:null,stats:null,currentSession:null,error:null,isLoading:!1,mode:"work"}),getters:{formattedTime:t=>{const o=Math.floor(t.timeLeft/60),a=t.timeLeft%60;return`${o}:${a.toString().padStart(2,"0")}`},formattedTotalTime:t=>t.stats?`${Math.floor(t.stats.totalFocusTime/60)} minutes`:"0 minutes",progress:t=>{const o=t.mode==="work"?c:g;return(o-t.timeLeft)/o*100}},actions:{async init(){try{this.isLoading=!0,this.error=null;const t=localStorage.getItem(y);if(t){const{timeLeft:a,isRunning:h,mode:p}=JSON.parse(t);this.timeLeft=a,this.mode=p,h&&this.start()}const o=await f.getItem("pomodoro","stats");if(o)this.stats=o;else{const a={id:"stats",completedSessions:0,totalFocusTime:0,lastModified:Date.now(),syncStatus:"pending"};await f.addItem("pomodoro",a),this.stats=a}"Notification"in window&&await Notification.requestPermission(),window.addEventListener("keydown",this.handleKeyPress)}catch(t){this.error="Failed to initialize Pomodoro timer",console.error(t)}finally{this.isLoading=!1}},handleKeyPress(t){if(!(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement))switch(t.key.toLowerCase()){case" ":t.preventDefault(),this.isRunning?this.pause():this.start();break;case"r":t.preventDefault(),this.reset();break;case"b":t.preventDefault(),this.toggleMode();break}},saveState(){localStorage.setItem(y,JSON.stringify({timeLeft:this.timeLeft,isRunning:this.isRunning,mode:this.mode}))},toggleMode(){this.pause(),this.mode=this.mode==="work"?"break":"work",this.timeLeft=this.mode==="work"?c:g,this.saveState()},start(){this.isRunning||(this.isRunning=!0,this.mode==="work"&&(this.currentSession={id:crypto.randomUUID(),startTime:Date.now(),endTime:0,duration:0,type:"work",completed:!1,lastModified:Date.now(),syncStatus:"pending"}),this.timer=setInterval(()=>{this.timeLeft>0?(this.timeLeft--,this.saveState()):this.complete()},1e3))},pause(){this.isRunning&&(this.isRunning=!1,this.timer&&(clearInterval(this.timer),this.timer=null),this.saveState())},reset(){this.pause(),this.timeLeft=this.mode==="work"?c:g,this.currentSession=null,this.saveState()},async complete(){try{if(this.pause(),this.currentSession&&this.stats&&this.mode==="work"){this.currentSession.endTime=Date.now();const t=Math.floor((this.currentSession.endTime-this.currentSession.startTime)/1e3);this.currentSession.duration=t,this.currentSession.completed=!0,await f.addItem("pomodoro",this.currentSession),this.stats.completedSessions++,this.stats.totalFocusTime+=t,this.stats.lastModified=Date.now(),this.stats.syncStatus="pending",await f.updateItem("pomodoro","stats",this.stats)}this.mode=this.mode==="work"?"break":"work",this.timeLeft=this.mode==="work"?c:g,this.saveState();try{const t=new Audio("/notification.mp3");t.volume=B,await t.play()}catch(t){console.warn("Failed to play notification sound:",t)}"Notification"in window&&Notification.permission==="granted"&&new Notification(this.mode==="work"?"Break Time!":"Back to Work!",{body:this.mode==="work"?"Time to focus on your next task!":"Great job! Take a short break.",icon:"/favicon.ico"})}catch(t){this.error="Failed to save session",console.error(t)}},dispose(){window.removeEventListener("keydown",this.handleKeyPress),this.pause()}}}),_={class:"pomodoro-container"},C={key:0,class:"error-message",role:"alert"},E={key:1,class:"loading-spinner",role:"status"},F={key:2,class:"timer-card"},O=["aria-label"],x={class:"timer-controls",role:"group","aria-label":"Timer controls"},A=["aria-label"],K={key:0,class:"stats-container",role:"region","aria-label":"Progress statistics"},U={class:"stats-content"},$={key:1,class:"dancing-melody",role:"status","aria-label":"Timer is running"},z=v({__name:"Pomodoro",setup(t){const o=P(),{isRunning:a,stats:h,error:p,isLoading:S,mode:d,progress:T}=L(o);return R(async()=>{await o.init()}),I(()=>{o.dispose()}),(W,s)=>(l(),r("div",_,[e(p)?(l(),r("div",C,u(e(p)),1)):k("v-if",!0),e(S)?(l(),r("div",E,s[4]||(s[4]=[i("span",{class:"sr-only"},"Loading...",-1),n(" Loading... ")]))):(l(),r("div",F,[i("div",{class:w(["mode-indicator",e(d)])},u(e(d)==="work"?"Work Time":"Break Time"),3),i("div",{class:"timer-display",role:"timer","aria-label":`${e(d)==="work"?"Work":"Break"} timer: ${e(o).formattedTime} remaining`},[n(u(e(o).formattedTime)+" ",1),i("div",{class:w(["progress-bar",e(d)]),style:M({width:`${e(T)}%`})},null,6)],8,O),i("div",x,[e(a)?(l(),r("button",{key:1,class:"control-button secondary",onClick:s[1]||(s[1]=(...m)=>e(o).pause&&e(o).pause(...m)),"aria-label":"Pause timer"},s[6]||(s[6]=[i("span",{class:"button-icon","aria-hidden":"true"},"‚è∏",-1),n(" Pause ")]))):(l(),r("button",{key:0,class:"control-button primary",onClick:s[0]||(s[0]=(...m)=>e(o).start&&e(o).start(...m)),"aria-label":"Start timer"},s[5]||(s[5]=[i("span",{class:"button-icon","aria-hidden":"true"},"‚ñ∂",-1),n(" Start ")]))),i("button",{class:"control-button secondary",onClick:s[2]||(s[2]=(...m)=>e(o).reset&&e(o).reset(...m)),"aria-label":"Reset timer"},s[7]||(s[7]=[i("span",{class:"button-icon","aria-hidden":"true"},"‚Ü∫",-1),n(" Reset ")])),i("button",{class:"control-button secondary",onClick:s[3]||(s[3]=(...m)=>e(o).toggleMode&&e(o).toggleMode(...m)),"aria-label":e(d)==="work"?"Switch to break timer":"Switch to work timer"},[s[8]||(s[8]=i("span",{class:"button-icon","aria-hidden":"true"},"‚áÑ",-1)),n(" "+u(e(d)==="work"?"Take Break":"Work Time"),1)],8,A)]),k(` 
      <div class="keyboard-shortcuts" role="region" aria-label="Keyboard shortcuts">
        <p>Keyboard Shortcuts:</p>
        <ul>
          <li>Space - Start/Pause</li>
          <li>R - Reset</li>
          <li>B - Toggle Break</li>
        </ul>
      </div> `),e(h)?(l(),r("div",K,[s[11]||(s[11]=i("div",{class:"stats-header"},[i("span",{class:"stats-icon","aria-hidden":"true"},"üìä"),i("h2",null,"Your Progress")],-1)),i("div",U,[i("p",null,[s[9]||(s[9]=i("span",{class:"stats-icon","aria-hidden":"true"},"üéØ",-1)),n(" Completed Sessions: "+u(e(h).completedSessions),1)]),i("p",null,[s[10]||(s[10]=i("span",{class:"stats-icon","aria-hidden":"true"},"‚è±",-1)),n(" Total Focus Time: "+u(e(o).formattedTotalTime),1)])])])):k("v-if",!0),e(a)?(l(),r("div",$,[i("p",null,u(e(d)==="work"?"Focus Time!":"Take a Break!"),1),s[12]||(s[12]=i("img",{src:N,alt:"My Melody Dancing",loading:"lazy"},null,-1))])):k("v-if",!0)]))]))}}),q=D(z,[["__scopeId","data-v-d224a1cf"]]);export{q as default};
