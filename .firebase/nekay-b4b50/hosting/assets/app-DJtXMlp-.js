const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-D3B3jRms.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/Login-C7Q4DLet.css","assets/Home-BZYxxMMQ.js","assets/Home-Bwp-Wt0x.css","assets/Pomodoro-cbIl1dkd.js","assets/Pomodoro-8r4-qdcw.css","assets/Tasks-DZlFyIoJ.js","assets/Tasks-BZlvaEt3.css","assets/Journal-D216jYl5.js","assets/Journal-CS1jK10m.css","assets/BottomNav-WBoUsA8z.js","assets/BottomNav-D_4GV9n9.css"])))=>i.map(i=>d[i]);
var fv=Object.defineProperty;var dv=(n,e,t)=>e in n?fv(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Tn=(n,e,t)=>dv(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Fh(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Et={},xo=[],Nr=()=>{},pv=()=>!1,Cc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Lh=n=>n.startsWith("onUpdate:"),Jt=Object.assign,Bh=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},mv=Object.prototype.hasOwnProperty,pt=(n,e)=>mv.call(n,e),qe=Array.isArray,Co=n=>Dc(n)==="[object Map]",wm=n=>Dc(n)==="[object Set]",Ke=n=>typeof n=="function",Kt=n=>typeof n=="string",zi=n=>typeof n=="symbol",Tt=n=>n!==null&&typeof n=="object",Em=n=>(Tt(n)||Ke(n))&&Ke(n.then)&&Ke(n.catch),bm=Object.prototype.toString,Dc=n=>bm.call(n),gv=n=>Dc(n).slice(8,-1),Im=n=>Dc(n)==="[object Object]",jh=n=>Kt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Sa=Fh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Vc=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},yv=/-(\w)/g,or=Vc(n=>n.replace(yv,(e,t)=>t?t.toUpperCase():"")),_v=/\B([A-Z])/g,Gi=Vc(n=>n.replace(_v,"-$1").toLowerCase()),kc=Vc(n=>n.charAt(0).toUpperCase()+n.slice(1)),_l=Vc(n=>n?`on${kc(n)}`:""),Mi=(n,e)=>!Object.is(n,e),zu=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Tm=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Gl=n=>{const e=parseFloat(n);return isNaN(e)?n:e},vv=n=>{const e=Kt(n)?Number(n):NaN;return isNaN(e)?n:e};let Yf;const Oc=()=>Yf||(Yf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Uh(n){if(qe(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=Kt(r)?Iv(r):Uh(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(Kt(n)||Tt(n))return n}const wv=/;(?![^(]*\))/g,Ev=/:([^]+)/,bv=/\/\*[^]*?\*\//g;function Iv(n){const e={};return n.replace(bv,"").split(wv).forEach(t=>{if(t){const r=t.split(Ev);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function qh(n){let e="";if(Kt(n))e=n;else if(qe(n))for(let t=0;t<n.length;t++){const r=qh(n[t]);r&&(e+=r+" ")}else if(Tt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Tv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Av=Fh(Tv);function Am(n){return!!n||n===""}const Sm=n=>!!(n&&n.__v_isRef===!0),Rm=n=>Kt(n)?n:n==null?"":qe(n)||Tt(n)&&(n.toString===bm||!Ke(n.toString))?Sm(n)?Rm(n.value):JSON.stringify(n,Pm,2):String(n),Pm=(n,e)=>Sm(e)?Pm(n,e.value):Co(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i],s)=>(t[vl(r,s)+" =>"]=i,t),{})}:wm(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>vl(t))}:zi(e)?vl(e):Tt(e)&&!qe(e)&&!Im(e)?String(e):e,vl=(n,e="")=>{var t;return zi(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Sn;class xm{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Sn,!e&&Sn&&(this.index=(Sn.scopes||(Sn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Sn;try{return Sn=this,e()}finally{Sn=t}}}on(){Sn=this}off(){Sn=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function Cm(n){return new xm(n)}function Dm(){return Sn}function Sv(n,e=!1){Sn&&Sn.cleanups.push(n)}let It;const wl=new WeakSet;class Vm{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Sn&&Sn.active&&Sn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wl.has(this)&&(wl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Om(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jf(this),Nm(this);const e=It,t=_r;It=this,_r=!0;try{return this.fn()}finally{Mm(this),It=e,_r=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)zh(e);this.deps=this.depsTail=void 0,Jf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Hl(this)&&this.run()}get dirty(){return Hl(this)}}let km=0,Ra,Pa;function Om(n,e=!1){if(n.flags|=8,e){n.next=Pa,Pa=n;return}n.next=Ra,Ra=n}function Kh(){km++}function $h(){if(--km>0)return;if(Pa){let e=Pa;for(Pa=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Ra;){let e=Ra;for(Ra=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function Nm(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Mm(n){let e,t=n.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),zh(r),Rv(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=e,n.depsTail=t}function Hl(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Fm(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function Fm(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ja))return;n.globalVersion=ja;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!Hl(n)){n.flags&=-3;return}const t=It,r=_r;It=n,_r=!0;try{Nm(n);const i=n.fn(n._value);(e.version===0||Mi(i,n._value))&&(n._value=i,e.version++)}catch(i){throw e.version++,i}finally{It=t,_r=r,Mm(n),n.flags&=-3}}function zh(n,e=!1){const{dep:t,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)zh(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Rv(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let _r=!0;const Lm=[];function Hi(){Lm.push(_r),_r=!1}function Wi(){const n=Lm.pop();_r=n===void 0?!0:n}function Jf(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=It;It=void 0;try{e()}finally{It=t}}}let ja=0;class Pv{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Gh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!It||!_r||It===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==It)t=this.activeLink=new Pv(It,this),It.deps?(t.prevDep=It.depsTail,It.depsTail.nextDep=t,It.depsTail=t):It.deps=It.depsTail=t,Bm(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=It.depsTail,t.nextDep=void 0,It.depsTail.nextDep=t,It.depsTail=t,It.deps===t&&(It.deps=r)}return t}trigger(e){this.version++,ja++,this.notify(e)}notify(e){Kh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{$h()}}}function Bm(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)Bm(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const oc=new WeakMap,Rs=Symbol(""),Wl=Symbol(""),Ua=Symbol("");function yn(n,e,t){if(_r&&It){let r=oc.get(n);r||oc.set(n,r=new Map);let i=r.get(t);i||(r.set(t,i=new Gh),i.map=r,i.key=t),i.track()}}function ri(n,e,t,r,i,s){const o=oc.get(n);if(!o){ja++;return}const u=l=>{l&&l.trigger()};if(Kh(),e==="clear")o.forEach(u);else{const l=qe(n),f=l&&jh(t);if(l&&t==="length"){const m=Number(r);o.forEach((g,w)=>{(w==="length"||w===Ua||!zi(w)&&w>=m)&&u(g)})}else switch((t!==void 0||o.has(void 0))&&u(o.get(t)),f&&u(o.get(Ua)),e){case"add":l?f&&u(o.get("length")):(u(o.get(Rs)),Co(n)&&u(o.get(Wl)));break;case"delete":l||(u(o.get(Rs)),Co(n)&&u(o.get(Wl)));break;case"set":Co(n)&&u(o.get(Rs));break}}$h()}function xv(n,e){const t=oc.get(n);return t&&t.get(e)}function fo(n){const e=at(n);return e===n?e:(yn(e,"iterate",Ua),tr(n)?e:e.map(_n))}function Nc(n){return yn(n=at(n),"iterate",Ua),n}const Cv={__proto__:null,[Symbol.iterator](){return El(this,Symbol.iterator,_n)},concat(...n){return fo(this).concat(...n.map(e=>qe(e)?fo(e):e))},entries(){return El(this,"entries",n=>(n[1]=_n(n[1]),n))},every(n,e){return Zr(this,"every",n,e,void 0,arguments)},filter(n,e){return Zr(this,"filter",n,e,t=>t.map(_n),arguments)},find(n,e){return Zr(this,"find",n,e,_n,arguments)},findIndex(n,e){return Zr(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Zr(this,"findLast",n,e,_n,arguments)},findLastIndex(n,e){return Zr(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Zr(this,"forEach",n,e,void 0,arguments)},includes(...n){return bl(this,"includes",n)},indexOf(...n){return bl(this,"indexOf",n)},join(n){return fo(this).join(n)},lastIndexOf(...n){return bl(this,"lastIndexOf",n)},map(n,e){return Zr(this,"map",n,e,void 0,arguments)},pop(){return da(this,"pop")},push(...n){return da(this,"push",n)},reduce(n,...e){return Xf(this,"reduce",n,e)},reduceRight(n,...e){return Xf(this,"reduceRight",n,e)},shift(){return da(this,"shift")},some(n,e){return Zr(this,"some",n,e,void 0,arguments)},splice(...n){return da(this,"splice",n)},toReversed(){return fo(this).toReversed()},toSorted(n){return fo(this).toSorted(n)},toSpliced(...n){return fo(this).toSpliced(...n)},unshift(...n){return da(this,"unshift",n)},values(){return El(this,"values",_n)}};function El(n,e,t){const r=Nc(n),i=r[e]();return r!==n&&!tr(n)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=t(s.value)),s}),i}const Dv=Array.prototype;function Zr(n,e,t,r,i,s){const o=Nc(n),u=o!==n&&!tr(n),l=o[e];if(l!==Dv[e]){const g=l.apply(n,s);return u?_n(g):g}let f=t;o!==n&&(u?f=function(g,w){return t.call(this,_n(g),w,n)}:t.length>2&&(f=function(g,w){return t.call(this,g,w,n)}));const m=l.call(o,f,r);return u&&i?i(m):m}function Xf(n,e,t,r){const i=Nc(n);let s=t;return i!==n&&(tr(n)?t.length>3&&(s=function(o,u,l){return t.call(this,o,u,l,n)}):s=function(o,u,l){return t.call(this,o,_n(u),l,n)}),i[e](s,...r)}function bl(n,e,t){const r=at(n);yn(r,"iterate",Ua);const i=r[e](...t);return(i===-1||i===!1)&&Qh(t[0])?(t[0]=at(t[0]),r[e](...t)):i}function da(n,e,t=[]){Hi(),Kh();const r=at(n)[e].apply(n,t);return $h(),Wi(),r}const Vv=Fh("__proto__,__v_isRef,__isVue"),jm=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(zi));function kv(n){zi(n)||(n=String(n));const e=at(this);return yn(e,"has",n),e.hasOwnProperty(n)}class Um{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?Kv:zm:s?$m:Km).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=qe(e);if(!i){let l;if(o&&(l=Cv[t]))return l;if(t==="hasOwnProperty")return kv}const u=Reflect.get(e,t,Ot(e)?e:r);return(zi(t)?jm.has(t):Vv(t))||(i||yn(e,"get",t),s)?u:Ot(u)?o&&jh(t)?u:u.value:Tt(u)?i?Hm(u):cu(u):u}}class qm extends Um{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];if(!this._isShallow){const l=Vs(s);if(!tr(r)&&!Vs(r)&&(s=at(s),r=at(r)),!qe(e)&&Ot(s)&&!Ot(r))return l?!1:(s.value=r,!0)}const o=qe(e)&&jh(t)?Number(t)<e.length:pt(e,t),u=Reflect.set(e,t,r,Ot(e)?e:i);return e===at(i)&&(o?Mi(r,s)&&ri(e,"set",t,r):ri(e,"add",t,r)),u}deleteProperty(e,t){const r=pt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&ri(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!zi(t)||!jm.has(t))&&yn(e,"has",t),r}ownKeys(e){return yn(e,"iterate",qe(e)?"length":Rs),Reflect.ownKeys(e)}}class Ov extends Um{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Nv=new qm,Mv=new Ov,Fv=new qm(!0);const Ql=n=>n,ku=n=>Reflect.getPrototypeOf(n);function Lv(n,e,t){return function(...r){const i=this.__v_raw,s=at(i),o=Co(s),u=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,f=i[n](...r),m=t?Ql:e?Yl:_n;return!e&&yn(s,"iterate",l?Wl:Rs),{next(){const{value:g,done:w}=f.next();return w?{value:g,done:w}:{value:u?[m(g[0]),m(g[1])]:m(g),done:w}},[Symbol.iterator](){return this}}}}function Ou(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function Bv(n,e){const t={get(i){const s=this.__v_raw,o=at(s),u=at(i);n||(Mi(i,u)&&yn(o,"get",i),yn(o,"get",u));const{has:l}=ku(o),f=e?Ql:n?Yl:_n;if(l.call(o,i))return f(s.get(i));if(l.call(o,u))return f(s.get(u));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!n&&yn(at(i),"iterate",Rs),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,o=at(s),u=at(i);return n||(Mi(i,u)&&yn(o,"has",i),yn(o,"has",u)),i===u?s.has(i):s.has(i)||s.has(u)},forEach(i,s){const o=this,u=o.__v_raw,l=at(u),f=e?Ql:n?Yl:_n;return!n&&yn(l,"iterate",Rs),u.forEach((m,g)=>i.call(s,f(m),f(g),o))}};return Jt(t,n?{add:Ou("add"),set:Ou("set"),delete:Ou("delete"),clear:Ou("clear")}:{add(i){!e&&!tr(i)&&!Vs(i)&&(i=at(i));const s=at(this);return ku(s).has.call(s,i)||(s.add(i),ri(s,"add",i,i)),this},set(i,s){!e&&!tr(s)&&!Vs(s)&&(s=at(s));const o=at(this),{has:u,get:l}=ku(o);let f=u.call(o,i);f||(i=at(i),f=u.call(o,i));const m=l.call(o,i);return o.set(i,s),f?Mi(s,m)&&ri(o,"set",i,s):ri(o,"add",i,s),this},delete(i){const s=at(this),{has:o,get:u}=ku(s);let l=o.call(s,i);l||(i=at(i),l=o.call(s,i)),u&&u.call(s,i);const f=s.delete(i);return l&&ri(s,"delete",i,void 0),f},clear(){const i=at(this),s=i.size!==0,o=i.clear();return s&&ri(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Lv(i,n,e)}),t}function Hh(n,e){const t=Bv(n,e);return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(pt(t,i)&&i in r?t:r,i,s)}const jv={get:Hh(!1,!1)},Uv={get:Hh(!1,!0)},qv={get:Hh(!0,!1)};const Km=new WeakMap,$m=new WeakMap,zm=new WeakMap,Kv=new WeakMap;function $v(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function zv(n){return n.__v_skip||!Object.isExtensible(n)?0:$v(gv(n))}function cu(n){return Vs(n)?n:Wh(n,!1,Nv,jv,Km)}function Gm(n){return Wh(n,!1,Fv,Uv,$m)}function Hm(n){return Wh(n,!0,Mv,qv,zm)}function Wh(n,e,t,r,i){if(!Tt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=zv(n);if(o===0)return n;const u=new Proxy(n,o===2?r:t);return i.set(n,u),u}function oi(n){return Vs(n)?oi(n.__v_raw):!!(n&&n.__v_isReactive)}function Vs(n){return!!(n&&n.__v_isReadonly)}function tr(n){return!!(n&&n.__v_isShallow)}function Qh(n){return n?!!n.__v_raw:!1}function at(n){const e=n&&n.__v_raw;return e?at(e):n}function Yh(n){return!pt(n,"__v_skip")&&Object.isExtensible(n)&&Tm(n,"__v_skip",!0),n}const _n=n=>Tt(n)?cu(n):n,Yl=n=>Tt(n)?Hm(n):n;function Ot(n){return n?n.__v_isRef===!0:!1}function nr(n){return Wm(n,!1)}function Gv(n){return Wm(n,!0)}function Wm(n,e){return Ot(n)?n:new Hv(n,e)}class Hv{constructor(e,t){this.dep=new Gh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:at(e),this._value=t?e:_n(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||tr(e)||Vs(e);e=r?e:at(e),Mi(e,t)&&(this._rawValue=e,this._value=r?e:_n(e),this.dep.trigger())}}function Ps(n){return Ot(n)?n.value:n}const Wv={get:(n,e,t)=>e==="__v_raw"?n:Ps(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return Ot(i)&&!Ot(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function Qm(n){return oi(n)?n:new Proxy(n,Wv)}function Qv(n){const e=qe(n)?new Array(n.length):{};for(const t in n)e[t]=Ym(n,t);return e}class Yv{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return xv(at(this._object),this._key)}}class Jv{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Xv(n,e,t){return Ot(n)?n:Ke(n)?new Jv(n):Tt(n)&&arguments.length>1?Ym(n,e,t):nr(n)}function Ym(n,e,t){const r=n[e];return Ot(r)?r:new Yv(n,e,t)}class Zv{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Gh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ja-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&It!==this)return Om(this,!0),!0}get value(){const e=this.dep.track();return Fm(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function ew(n,e,t=!1){let r,i;return Ke(n)?r=n:(r=n.get,i=n.set),new Zv(r,i,t)}const Nu={},ac=new WeakMap;let vs;function tw(n,e=!1,t=vs){if(t){let r=ac.get(t);r||ac.set(t,r=[]),r.push(n)}}function nw(n,e,t=Et){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:u,call:l}=t,f=ce=>i?ce:tr(ce)||i===!1||i===0?ii(ce,1):ii(ce);let m,g,w,I,L=!1,K=!1;if(Ot(n)?(g=()=>n.value,L=tr(n)):oi(n)?(g=()=>f(n),L=!0):qe(n)?(K=!0,L=n.some(ce=>oi(ce)||tr(ce)),g=()=>n.map(ce=>{if(Ot(ce))return ce.value;if(oi(ce))return f(ce);if(Ke(ce))return l?l(ce,2):ce()})):Ke(n)?e?g=l?()=>l(n,2):n:g=()=>{if(w){Hi();try{w()}finally{Wi()}}const ce=vs;vs=m;try{return l?l(n,3,[I]):n(I)}finally{vs=ce}}:g=Nr,e&&i){const ce=g,Se=i===!0?1/0:i;g=()=>ii(ce(),Se)}const J=Dm(),ae=()=>{m.stop(),J&&Bh(J.effects,m)};if(s&&e){const ce=e;e=(...Se)=>{ce(...Se),ae()}}let oe=K?new Array(n.length).fill(Nu):Nu;const te=ce=>{if(!(!(m.flags&1)||!m.dirty&&!ce))if(e){const Se=m.run();if(i||L||(K?Se.some((Pe,D)=>Mi(Pe,oe[D])):Mi(Se,oe))){w&&w();const Pe=vs;vs=m;try{const D=[Se,oe===Nu?void 0:K&&oe[0]===Nu?[]:oe,I];l?l(e,3,D):e(...D),oe=Se}finally{vs=Pe}}}else m.run()};return u&&u(te),m=new Vm(g),m.scheduler=o?()=>o(te,!1):te,I=ce=>tw(ce,!1,m),w=m.onStop=()=>{const ce=ac.get(m);if(ce){if(l)l(ce,4);else for(const Se of ce)Se();ac.delete(m)}},e?r?te(!0):oe=m.run():o?o(te.bind(null,!0),!0):m.run(),ae.pause=m.pause.bind(m),ae.resume=m.resume.bind(m),ae.stop=ae,ae}function ii(n,e=1/0,t){if(e<=0||!Tt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Ot(n))ii(n.value,e,t);else if(qe(n))for(let r=0;r<n.length;r++)ii(n[r],e,t);else if(wm(n)||Co(n))n.forEach(r=>{ii(r,e,t)});else if(Im(n)){for(const r in n)ii(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&ii(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function lu(n,e,t,r){try{return r?n(...r):n()}catch(i){hu(i,e,t)}}function vr(n,e,t,r){if(Ke(n)){const i=lu(n,e,t,r);return i&&Em(i)&&i.catch(s=>{hu(s,e,t)}),i}if(qe(n)){const i=[];for(let s=0;s<n.length;s++)i.push(vr(n[s],e,t,r));return i}}function hu(n,e,t,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Et;if(e){let u=e.parent;const l=e.proxy,f=`https://vuejs.org/error-reference/#runtime-${t}`;for(;u;){const m=u.ec;if(m){for(let g=0;g<m.length;g++)if(m[g](n,l,f)===!1)return}u=u.parent}if(s){Hi(),lu(s,null,10,[n,l,f]),Wi();return}}rw(n,t,i,r,o)}function rw(n,e,t,r=!0,i=!1){if(i)throw n;console.error(n)}const Rn=[];let Dr=-1;const Do=[];let Ci=null,vo=0;const Jm=Promise.resolve();let uc=null;function Jh(n){const e=uc||Jm;return n?e.then(this?n.bind(this):n):e}function iw(n){let e=Dr+1,t=Rn.length;for(;e<t;){const r=e+t>>>1,i=Rn[r],s=qa(i);s<n||s===n&&i.flags&2?e=r+1:t=r}return e}function Xh(n){if(!(n.flags&1)){const e=qa(n),t=Rn[Rn.length-1];!t||!(n.flags&2)&&e>=qa(t)?Rn.push(n):Rn.splice(iw(e),0,n),n.flags|=1,Xm()}}function Xm(){uc||(uc=Jm.then(eg))}function sw(n){qe(n)?Do.push(...n):Ci&&n.id===-1?Ci.splice(vo+1,0,n):n.flags&1||(Do.push(n),n.flags|=1),Xm()}function Zf(n,e,t=Dr+1){for(;t<Rn.length;t++){const r=Rn[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Rn.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Zm(n){if(Do.length){const e=[...new Set(Do)].sort((t,r)=>qa(t)-qa(r));if(Do.length=0,Ci){Ci.push(...e);return}for(Ci=e,vo=0;vo<Ci.length;vo++){const t=Ci[vo];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Ci=null,vo=0}}const qa=n=>n.id==null?n.flags&2?-1:1/0:n.id;function eg(n){try{for(Dr=0;Dr<Rn.length;Dr++){const e=Rn[Dr];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),lu(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Dr<Rn.length;Dr++){const e=Rn[Dr];e&&(e.flags&=-2)}Dr=-1,Rn.length=0,Zm(),uc=null,(Rn.length||Do.length)&&eg()}}let xn=null,tg=null;function cc(n){const e=xn;return xn=n,tg=n&&n.type.__scopeId||null,e}function ow(n,e=xn,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&ld(-1);const s=cc(e);let o;try{o=n(...i)}finally{cc(s),r._d&&ld(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function $R(n,e){if(xn===null)return n;const t=Uc(xn),r=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,u,l=Et]=e[i];s&&(Ke(s)&&(s={mounted:s,updated:s}),s.deep&&ii(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:u,modifiers:l}))}return n}function ps(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const u=i[o];s&&(u.oldValue=s[o].value);let l=u.dir[r];l&&(Hi(),vr(l,t,8,[n.el,u,n,e]),Wi())}}const aw=Symbol("_vte"),ng=n=>n.__isTeleport,Di=Symbol("_leaveCb"),Mu=Symbol("_enterCb");function uw(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Lc(()=>{n.isMounted=!0}),cg(()=>{n.isUnmounting=!0}),n}const Jn=[Function,Array],rg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Jn,onEnter:Jn,onAfterEnter:Jn,onEnterCancelled:Jn,onBeforeLeave:Jn,onLeave:Jn,onAfterLeave:Jn,onLeaveCancelled:Jn,onBeforeAppear:Jn,onAppear:Jn,onAfterAppear:Jn,onAppearCancelled:Jn},ig=n=>{const e=n.subTree;return e.component?ig(e.component):e},cw={name:"BaseTransition",props:rg,setup(n,{slots:e}){const t=hE(),r=uw();return()=>{const i=e.default&&ag(e.default(),!0);if(!i||!i.length)return;const s=sg(i),o=at(n),{mode:u}=o;if(r.isLeaving)return Il(s);const l=ed(s);if(!l)return Il(s);let f=Jl(l,o,r,t,w=>f=w);l.type!==On&&Ka(l,f);const m=t.subTree,g=m&&ed(m);if(g&&g.type!==On&&!bs(l,g)&&ig(t).type!==On){const w=Jl(g,o,r,t);if(Ka(g,w),u==="out-in"&&l.type!==On)return r.isLeaving=!0,w.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete w.afterLeave},Il(s);u==="in-out"&&l.type!==On&&(w.delayLeave=(I,L,K)=>{const J=og(r,g);J[String(g.key)]=g,I[Di]=()=>{L(),I[Di]=void 0,delete f.delayedLeave},f.delayedLeave=K})}return s}}};function sg(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==On){e=t;break}}return e}const lw=cw;function og(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function Jl(n,e,t,r,i){const{appear:s,mode:o,persisted:u=!1,onBeforeEnter:l,onEnter:f,onAfterEnter:m,onEnterCancelled:g,onBeforeLeave:w,onLeave:I,onAfterLeave:L,onLeaveCancelled:K,onBeforeAppear:J,onAppear:ae,onAfterAppear:oe,onAppearCancelled:te}=e,ce=String(n.key),Se=og(t,n),Pe=(A,V)=>{A&&vr(A,r,9,V)},D=(A,V)=>{const N=V[1];Pe(A,V),qe(A)?A.every(k=>k.length<=1)&&N():A.length<=1&&N()},S={mode:o,persisted:u,beforeEnter(A){let V=l;if(!t.isMounted)if(s)V=J||l;else return;A[Di]&&A[Di](!0);const N=Se[ce];N&&bs(n,N)&&N.el[Di]&&N.el[Di](),Pe(V,[A])},enter(A){let V=f,N=m,k=g;if(!t.isMounted)if(s)V=ae||f,N=oe||m,k=te||g;else return;let P=!1;const lt=A[Mu]=Vt=>{P||(P=!0,Vt?Pe(k,[A]):Pe(N,[A]),S.delayedLeave&&S.delayedLeave(),A[Mu]=void 0)};V?D(V,[A,lt]):lt()},leave(A,V){const N=String(n.key);if(A[Mu]&&A[Mu](!0),t.isUnmounting)return V();Pe(w,[A]);let k=!1;const P=A[Di]=lt=>{k||(k=!0,V(),lt?Pe(K,[A]):Pe(L,[A]),A[Di]=void 0,Se[N]===n&&delete Se[N])};Se[N]=n,I?D(I,[A,P]):P()},clone(A){const V=Jl(A,e,t,r,i);return i&&i(V),V}};return S}function Il(n){if(fu(n))return n=Ui(n),n.children=null,n}function ed(n){if(!fu(n))return ng(n.type)&&n.children?sg(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&Ke(t.default))return t.default()}}function Ka(n,e){n.shapeFlag&6&&n.component?(n.transition=e,Ka(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function ag(n,e=!1,t){let r=[],i=0;for(let s=0;s<n.length;s++){let o=n[s];const u=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===yr?(o.patchFlag&128&&i++,r=r.concat(ag(o.children,e,u))):(e||o.type!==On)&&r.push(u!=null?Ui(o,{key:u}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Mc(n,e){return Ke(n)?Jt({name:n.name},e,{setup:n}):n}function Zh(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Xl(n,e,t,r,i=!1){if(qe(n)){n.forEach((L,K)=>Xl(L,e&&(qe(e)?e[K]:e),t,r,i));return}if(xa(r)&&!i)return;const s=r.shapeFlag&4?Uc(r.component):r.el,o=i?null:s,{i:u,r:l}=n,f=e&&e.r,m=u.refs===Et?u.refs={}:u.refs,g=u.setupState,w=at(g),I=g===Et?()=>!1:L=>pt(w,L);if(f!=null&&f!==l&&(Kt(f)?(m[f]=null,I(f)&&(g[f]=null)):Ot(f)&&(f.value=null)),Ke(l))lu(l,u,12,[o,m]);else{const L=Kt(l),K=Ot(l);if(L||K){const J=()=>{if(n.f){const ae=L?I(l)?g[l]:m[l]:l.value;i?qe(ae)&&Bh(ae,s):qe(ae)?ae.includes(s)||ae.push(s):L?(m[l]=[s],I(l)&&(g[l]=m[l])):(l.value=[s],n.k&&(m[n.k]=l.value))}else L?(m[l]=o,I(l)&&(g[l]=o)):K&&(l.value=o,n.k&&(m[n.k]=o))};o?(J.id=-1,Bn(J,t)):J()}}}const td=n=>n.nodeType===8;Oc().requestIdleCallback;Oc().cancelIdleCallback;function hw(n,e){if(td(n)&&n.data==="["){let t=1,r=n.nextSibling;for(;r;){if(r.nodeType===1){if(e(r)===!1)break}else if(td(r))if(r.data==="]"){if(--t===0)break}else r.data==="["&&t++;r=r.nextSibling}}else e(n)}const xa=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function fw(n){Ke(n)&&(n={loader:n});const{loader:e,loadingComponent:t,errorComponent:r,delay:i=200,hydrate:s,timeout:o,suspensible:u=!0,onError:l}=n;let f=null,m,g=0;const w=()=>(g++,f=null,I()),I=()=>{let L;return f||(L=f=e().catch(K=>{if(K=K instanceof Error?K:new Error(String(K)),l)return new Promise((J,ae)=>{l(K,()=>J(w()),()=>ae(K),g+1)});throw K}).then(K=>L!==f&&f?f:(K&&(K.__esModule||K[Symbol.toStringTag]==="Module")&&(K=K.default),m=K,K)))};return Mc({name:"AsyncComponentWrapper",__asyncLoader:I,__asyncHydrate(L,K,J){const ae=s?()=>{const oe=s(J,te=>hw(L,te));oe&&(K.bum||(K.bum=[])).push(oe)}:J;m?ae():I().then(()=>!K.isUnmounted&&ae())},get __asyncResolved(){return m},setup(){const L=tn;if(Zh(L),m)return()=>Tl(m,L);const K=te=>{f=null,hu(te,L,13,!r)};if(u&&L.suspense||Mo)return I().then(te=>()=>Tl(te,L)).catch(te=>(K(te),()=>r?nn(r,{error:te}):null));const J=nr(!1),ae=nr(),oe=nr(!!i);return i&&setTimeout(()=>{oe.value=!1},i),o!=null&&setTimeout(()=>{if(!J.value&&!ae.value){const te=new Error(`Async component timed out after ${o}ms.`);K(te),ae.value=te}},o),I().then(()=>{J.value=!0,L.parent&&fu(L.parent.vnode)&&L.parent.update()}).catch(te=>{K(te),ae.value=te}),()=>{if(J.value&&m)return Tl(m,L);if(ae.value&&r)return nn(r,{error:ae.value});if(t&&!oe.value)return nn(t)}}})}function Tl(n,e){const{ref:t,props:r,children:i,ce:s}=e.vnode,o=nn(n,r,i);return o.ref=t,o.ce=s,delete e.vnode.ce,o}const fu=n=>n.type.__isKeepAlive;function dw(n,e){ug(n,"a",e)}function pw(n,e){ug(n,"da",e)}function ug(n,e,t=tn){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Fc(e,r,t),t){let i=t.parent;for(;i&&i.parent;)fu(i.parent.vnode)&&mw(r,e,t,i),i=i.parent}}function mw(n,e,t,r){const i=Fc(e,n,r,!0);ef(()=>{Bh(r[e],i)},t)}function Fc(n,e,t=tn,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{Hi();const u=du(t),l=vr(e,t,n,o);return u(),Wi(),l});return r?i.unshift(s):i.push(s),s}}const hi=n=>(e,t=tn)=>{(!Mo||n==="sp")&&Fc(n,(...r)=>e(...r),t)},gw=hi("bm"),Lc=hi("m"),yw=hi("bu"),_w=hi("u"),cg=hi("bum"),ef=hi("um"),vw=hi("sp"),ww=hi("rtg"),Ew=hi("rtc");function bw(n,e=tn){Fc("ec",n,e)}const Iw="components";function Tw(n,e){return Sw(Iw,n,!0,e)||n}const Aw=Symbol.for("v-ndc");function Sw(n,e,t=!0,r=!1){const i=xn||tn;if(i){const s=i.type;{const u=gE(s,!1);if(u&&(u===e||u===or(e)||u===kc(or(e))))return s}const o=nd(i[n]||s[n],e)||nd(i.appContext[n],e);return!o&&r?s:o}}function nd(n,e){return n&&(n[e]||n[or(e)]||n[kc(or(e))])}function zR(n,e,t,r){let i;const s=t,o=qe(n);if(o||Kt(n)){const u=o&&oi(n);let l=!1;u&&(l=!tr(n),n=Nc(n)),i=new Array(n.length);for(let f=0,m=n.length;f<m;f++)i[f]=e(l?_n(n[f]):n[f],f,void 0,s)}else if(typeof n=="number"){i=new Array(n);for(let u=0;u<n;u++)i[u]=e(u+1,u,void 0,s)}else if(Tt(n))if(n[Symbol.iterator])i=Array.from(n,(u,l)=>e(u,l,void 0,s));else{const u=Object.keys(n);i=new Array(u.length);for(let l=0,f=u.length;l<f;l++){const m=u[l];i[l]=e(n[m],m,l,s)}}else i=[];return i}const Zl=n=>n?Cg(n)?Uc(n):Zl(n.parent):null,Ca=Jt(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Zl(n.parent),$root:n=>Zl(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>tf(n),$forceUpdate:n=>n.f||(n.f=()=>{Xh(n.update)}),$nextTick:n=>n.n||(n.n=Jh.bind(n.proxy)),$watch:n=>Ww.bind(n)}),Al=(n,e)=>n!==Et&&!n.__isScriptSetup&&pt(n,e),Rw={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:u,appContext:l}=n;let f;if(e[0]!=="$"){const I=o[e];if(I!==void 0)switch(I){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(Al(r,e))return o[e]=1,r[e];if(i!==Et&&pt(i,e))return o[e]=2,i[e];if((f=n.propsOptions[0])&&pt(f,e))return o[e]=3,s[e];if(t!==Et&&pt(t,e))return o[e]=4,t[e];eh&&(o[e]=0)}}const m=Ca[e];let g,w;if(m)return e==="$attrs"&&yn(n.attrs,"get",""),m(n);if((g=u.__cssModules)&&(g=g[e]))return g;if(t!==Et&&pt(t,e))return o[e]=4,t[e];if(w=l.config.globalProperties,pt(w,e))return w[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return Al(i,e)?(i[e]=t,!0):r!==Et&&pt(r,e)?(r[e]=t,!0):pt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let u;return!!t[o]||n!==Et&&pt(n,o)||Al(e,o)||(u=s[0])&&pt(u,o)||pt(r,o)||pt(Ca,o)||pt(i.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:pt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function rd(n){return qe(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let eh=!0;function Pw(n){const e=tf(n),t=n.proxy,r=n.ctx;eh=!1,e.beforeCreate&&id(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:u,provide:l,inject:f,created:m,beforeMount:g,mounted:w,beforeUpdate:I,updated:L,activated:K,deactivated:J,beforeDestroy:ae,beforeUnmount:oe,destroyed:te,unmounted:ce,render:Se,renderTracked:Pe,renderTriggered:D,errorCaptured:S,serverPrefetch:A,expose:V,inheritAttrs:N,components:k,directives:P,filters:lt}=e;if(f&&xw(f,r,null),o)for(const Ue in o){const ze=o[Ue];Ke(ze)&&(r[Ue]=ze.bind(t))}if(i){const Ue=i.call(t,t);Tt(Ue)&&(n.data=cu(Ue))}if(eh=!0,s)for(const Ue in s){const ze=s[Ue],$t=Ke(ze)?ze.bind(t,t):Ke(ze.get)?ze.get.bind(t,t):Nr,Ft=!Ke(ze)&&Ke(ze.set)?ze.set.bind(t):Nr,hn=Zn({get:$t,set:Ft});Object.defineProperty(r,Ue,{enumerable:!0,configurable:!0,get:()=>hn.value,set:At=>hn.value=At})}if(u)for(const Ue in u)lg(u[Ue],r,t,Ue);if(l){const Ue=Ke(l)?l.call(t):l;Reflect.ownKeys(Ue).forEach(ze=>{Gu(ze,Ue[ze])})}m&&id(m,n,"c");function ct(Ue,ze){qe(ze)?ze.forEach($t=>Ue($t.bind(t))):ze&&Ue(ze.bind(t))}if(ct(gw,g),ct(Lc,w),ct(yw,I),ct(_w,L),ct(dw,K),ct(pw,J),ct(bw,S),ct(Ew,Pe),ct(ww,D),ct(cg,oe),ct(ef,ce),ct(vw,A),qe(V))if(V.length){const Ue=n.exposed||(n.exposed={});V.forEach(ze=>{Object.defineProperty(Ue,ze,{get:()=>t[ze],set:$t=>t[ze]=$t})})}else n.exposed||(n.exposed={});Se&&n.render===Nr&&(n.render=Se),N!=null&&(n.inheritAttrs=N),k&&(n.components=k),P&&(n.directives=P),A&&Zh(n)}function xw(n,e,t=Nr){qe(n)&&(n=th(n));for(const r in n){const i=n[r];let s;Tt(i)?"default"in i?s=rr(i.from||r,i.default,!0):s=rr(i.from||r):s=rr(i),Ot(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function id(n,e,t){vr(qe(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function lg(n,e,t,r){let i=r.includes(".")?Ig(t,r):()=>t[r];if(Kt(n)){const s=e[n];Ke(s)&&Vo(i,s)}else if(Ke(n))Vo(i,n.bind(t));else if(Tt(n))if(qe(n))n.forEach(s=>lg(s,e,t,r));else{const s=Ke(n.handler)?n.handler.bind(t):e[n.handler];Ke(s)&&Vo(i,s,n)}}function tf(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,u=s.get(e);let l;return u?l=u:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(f=>lc(l,f,o,!0)),lc(l,e,o)),Tt(e)&&s.set(e,l),l}function lc(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&lc(n,s,t,!0),i&&i.forEach(o=>lc(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const u=Cw[o]||t&&t[o];n[o]=u?u(n[o],e[o]):e[o]}return n}const Cw={data:sd,props:od,emits:od,methods:Ea,computed:Ea,beforeCreate:An,created:An,beforeMount:An,mounted:An,beforeUpdate:An,updated:An,beforeDestroy:An,beforeUnmount:An,destroyed:An,unmounted:An,activated:An,deactivated:An,errorCaptured:An,serverPrefetch:An,components:Ea,directives:Ea,watch:Vw,provide:sd,inject:Dw};function sd(n,e){return e?n?function(){return Jt(Ke(n)?n.call(this,this):n,Ke(e)?e.call(this,this):e)}:e:n}function Dw(n,e){return Ea(th(n),th(e))}function th(n){if(qe(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function An(n,e){return n?[...new Set([].concat(n,e))]:e}function Ea(n,e){return n?Jt(Object.create(null),n,e):e}function od(n,e){return n?qe(n)&&qe(e)?[...new Set([...n,...e])]:Jt(Object.create(null),rd(n),rd(e??{})):e}function Vw(n,e){if(!n)return e;if(!e)return n;const t=Jt(Object.create(null),n);for(const r in e)t[r]=An(n[r],e[r]);return t}function hg(){return{app:null,config:{isNativeTag:pv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kw=0;function Ow(n,e){return function(r,i=null){Ke(r)||(r=Jt({},r)),i!=null&&!Tt(i)&&(i=null);const s=hg(),o=new WeakSet,u=[];let l=!1;const f=s.app={_uid:kw++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:_E,get config(){return s.config},set config(m){},use(m,...g){return o.has(m)||(m&&Ke(m.install)?(o.add(m),m.install(f,...g)):Ke(m)&&(o.add(m),m(f,...g))),f},mixin(m){return s.mixins.includes(m)||s.mixins.push(m),f},component(m,g){return g?(s.components[m]=g,f):s.components[m]},directive(m,g){return g?(s.directives[m]=g,f):s.directives[m]},mount(m,g,w){if(!l){const I=f._ceVNode||nn(r,i);return I.appContext=s,w===!0?w="svg":w===!1&&(w=void 0),g&&e?e(I,m):n(I,m,w),l=!0,f._container=m,m.__vue_app__=f,Uc(I.component)}},onUnmount(m){u.push(m)},unmount(){l&&(vr(u,f._instance,16),n(null,f._container),delete f._container.__vue_app__)},provide(m,g){return s.provides[m]=g,f},runWithContext(m){const g=xs;xs=f;try{return m()}finally{xs=g}}};return f}}let xs=null;function Gu(n,e){if(tn){let t=tn.provides;const r=tn.parent&&tn.parent.provides;r===t&&(t=tn.provides=Object.create(r)),t[n]=e}}function rr(n,e,t=!1){const r=tn||xn;if(r||xs){const i=xs?xs._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&Ke(e)?e.call(r&&r.proxy):e}}function Nw(){return!!(tn||xn||xs)}const fg={},dg=()=>Object.create(fg),pg=n=>Object.getPrototypeOf(n)===fg;function Mw(n,e,t,r=!1){const i={},s=dg();n.propsDefaults=Object.create(null),mg(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:Gm(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function Fw(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,u=at(i),[l]=n.propsOptions;let f=!1;if((r||o>0)&&!(o&16)){if(o&8){const m=n.vnode.dynamicProps;for(let g=0;g<m.length;g++){let w=m[g];if(Bc(n.emitsOptions,w))continue;const I=e[w];if(l)if(pt(s,w))I!==s[w]&&(s[w]=I,f=!0);else{const L=or(w);i[L]=nh(l,u,L,I,n,!1)}else I!==s[w]&&(s[w]=I,f=!0)}}}else{mg(n,e,i,s)&&(f=!0);let m;for(const g in u)(!e||!pt(e,g)&&((m=Gi(g))===g||!pt(e,m)))&&(l?t&&(t[g]!==void 0||t[m]!==void 0)&&(i[g]=nh(l,u,g,void 0,n,!0)):delete i[g]);if(s!==u)for(const g in s)(!e||!pt(e,g))&&(delete s[g],f=!0)}f&&ri(n.attrs,"set","")}function mg(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,u;if(e)for(let l in e){if(Sa(l))continue;const f=e[l];let m;i&&pt(i,m=or(l))?!s||!s.includes(m)?t[m]=f:(u||(u={}))[m]=f:Bc(n.emitsOptions,l)||(!(l in r)||f!==r[l])&&(r[l]=f,o=!0)}if(s){const l=at(t),f=u||Et;for(let m=0;m<s.length;m++){const g=s[m];t[g]=nh(i,l,g,f[g],n,!pt(f,g))}}return o}function nh(n,e,t,r,i,s){const o=n[t];if(o!=null){const u=pt(o,"default");if(u&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ke(l)){const{propsDefaults:f}=i;if(t in f)r=f[t];else{const m=du(i);r=f[t]=l.call(null,e),m()}}else r=l;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!u?r=!1:o[1]&&(r===""||r===Gi(t))&&(r=!0))}return r}const Lw=new WeakMap;function gg(n,e,t=!1){const r=t?Lw:e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},u=[];let l=!1;if(!Ke(n)){const m=g=>{l=!0;const[w,I]=gg(g,e,!0);Jt(o,w),I&&u.push(...I)};!t&&e.mixins.length&&e.mixins.forEach(m),n.extends&&m(n.extends),n.mixins&&n.mixins.forEach(m)}if(!s&&!l)return Tt(n)&&r.set(n,xo),xo;if(qe(s))for(let m=0;m<s.length;m++){const g=or(s[m]);ad(g)&&(o[g]=Et)}else if(s)for(const m in s){const g=or(m);if(ad(g)){const w=s[m],I=o[g]=qe(w)||Ke(w)?{type:w}:Jt({},w),L=I.type;let K=!1,J=!0;if(qe(L))for(let ae=0;ae<L.length;++ae){const oe=L[ae],te=Ke(oe)&&oe.name;if(te==="Boolean"){K=!0;break}else te==="String"&&(J=!1)}else K=Ke(L)&&L.name==="Boolean";I[0]=K,I[1]=J,(K||pt(I,"default"))&&u.push(g)}}const f=[o,u];return Tt(n)&&r.set(n,f),f}function ad(n){return n[0]!=="$"&&!Sa(n)}const yg=n=>n[0]==="_"||n==="$stable",nf=n=>qe(n)?n.map(Vr):[Vr(n)],Bw=(n,e,t)=>{if(e._n)return e;const r=ow((...i)=>nf(e(...i)),t);return r._c=!1,r},_g=(n,e,t)=>{const r=n._ctx;for(const i in n){if(yg(i))continue;const s=n[i];if(Ke(s))e[i]=Bw(i,s,r);else if(s!=null){const o=nf(s);e[i]=()=>o}}},vg=(n,e)=>{const t=nf(e);n.slots.default=()=>t},wg=(n,e,t)=>{for(const r in e)(t||r!=="_")&&(n[r]=e[r])},jw=(n,e,t)=>{const r=n.slots=dg();if(n.vnode.shapeFlag&32){const i=e._;i?(wg(r,e,t),t&&Tm(r,"_",i,!0)):_g(e,r)}else e&&vg(n,e)},Uw=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=Et;if(r.shapeFlag&32){const u=e._;u?t&&u===1?s=!1:wg(i,e,t):(s=!e.$stable,_g(e,i)),o=e}else e&&(vg(n,e),o={default:1});if(s)for(const u in i)!yg(u)&&o[u]==null&&delete i[u]},Bn=tE;function qw(n){return Kw(n)}function Kw(n,e){const t=Oc();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:u,createComment:l,setText:f,setElementText:m,parentNode:g,nextSibling:w,setScopeId:I=Nr,insertStaticContent:L}=n,K=(R,C,W,ue=null,se=null,le=null,be=void 0,ge=null,fe=!!C.dynamicChildren)=>{if(R===C)return;R&&!bs(R,C)&&(ue=re(R),At(R,se,le,!0),R=null),C.patchFlag===-2&&(fe=!1,C.dynamicChildren=null);const{type:he,ref:Me,shapeFlag:Te}=C;switch(he){case jc:J(R,C,W,ue);break;case On:ae(R,C,W,ue);break;case Hu:R==null&&oe(C,W,ue,be);break;case yr:k(R,C,W,ue,se,le,be,ge,fe);break;default:Te&1?Se(R,C,W,ue,se,le,be,ge,fe):Te&6?P(R,C,W,ue,se,le,be,ge,fe):(Te&64||Te&128)&&he.process(R,C,W,ue,se,le,be,ge,fe,Ve)}Me!=null&&se&&Xl(Me,R&&R.ref,le,C||R,!C)},J=(R,C,W,ue)=>{if(R==null)r(C.el=u(C.children),W,ue);else{const se=C.el=R.el;C.children!==R.children&&f(se,C.children)}},ae=(R,C,W,ue)=>{R==null?r(C.el=l(C.children||""),W,ue):C.el=R.el},oe=(R,C,W,ue)=>{[R.el,R.anchor]=L(R.children,C,W,ue,R.el,R.anchor)},te=({el:R,anchor:C},W,ue)=>{let se;for(;R&&R!==C;)se=w(R),r(R,W,ue),R=se;r(C,W,ue)},ce=({el:R,anchor:C})=>{let W;for(;R&&R!==C;)W=w(R),i(R),R=W;i(C)},Se=(R,C,W,ue,se,le,be,ge,fe)=>{C.type==="svg"?be="svg":C.type==="math"&&(be="mathml"),R==null?Pe(C,W,ue,se,le,be,ge,fe):A(R,C,se,le,be,ge,fe)},Pe=(R,C,W,ue,se,le,be,ge)=>{let fe,he;const{props:Me,shapeFlag:Te,transition:Oe,dirs:Ce}=R;if(fe=R.el=o(R.type,le,Me&&Me.is,Me),Te&8?m(fe,R.children):Te&16&&S(R.children,fe,null,ue,se,Sl(R,le),be,ge),Ce&&ps(R,null,ue,"created"),D(fe,R,R.scopeId,be,ue),Me){for(const tt in Me)tt!=="value"&&!Sa(tt)&&s(fe,tt,null,Me[tt],le,ue);"value"in Me&&s(fe,"value",null,Me.value,le),(he=Me.onVnodeBeforeMount)&&xr(he,ue,R)}Ce&&ps(R,null,ue,"beforeMount");const Be=$w(se,Oe);Be&&Oe.beforeEnter(fe),r(fe,C,W),((he=Me&&Me.onVnodeMounted)||Be||Ce)&&Bn(()=>{he&&xr(he,ue,R),Be&&Oe.enter(fe),Ce&&ps(R,null,ue,"mounted")},se)},D=(R,C,W,ue,se)=>{if(W&&I(R,W),ue)for(let le=0;le<ue.length;le++)I(R,ue[le]);if(se){let le=se.subTree;if(C===le||Ag(le.type)&&(le.ssContent===C||le.ssFallback===C)){const be=se.vnode;D(R,be,be.scopeId,be.slotScopeIds,se.parent)}}},S=(R,C,W,ue,se,le,be,ge,fe=0)=>{for(let he=fe;he<R.length;he++){const Me=R[he]=ge?Vi(R[he]):Vr(R[he]);K(null,Me,C,W,ue,se,le,be,ge)}},A=(R,C,W,ue,se,le,be)=>{const ge=C.el=R.el;let{patchFlag:fe,dynamicChildren:he,dirs:Me}=C;fe|=R.patchFlag&16;const Te=R.props||Et,Oe=C.props||Et;let Ce;if(W&&ms(W,!1),(Ce=Oe.onVnodeBeforeUpdate)&&xr(Ce,W,C,R),Me&&ps(C,R,W,"beforeUpdate"),W&&ms(W,!0),(Te.innerHTML&&Oe.innerHTML==null||Te.textContent&&Oe.textContent==null)&&m(ge,""),he?V(R.dynamicChildren,he,ge,W,ue,Sl(C,se),le):be||ze(R,C,ge,null,W,ue,Sl(C,se),le,!1),fe>0){if(fe&16)N(ge,Te,Oe,W,se);else if(fe&2&&Te.class!==Oe.class&&s(ge,"class",null,Oe.class,se),fe&4&&s(ge,"style",Te.style,Oe.style,se),fe&8){const Be=C.dynamicProps;for(let tt=0;tt<Be.length;tt++){const nt=Be[tt],Bt=Te[nt],bt=Oe[nt];(bt!==Bt||nt==="value")&&s(ge,nt,Bt,bt,se,W)}}fe&1&&R.children!==C.children&&m(ge,C.children)}else!be&&he==null&&N(ge,Te,Oe,W,se);((Ce=Oe.onVnodeUpdated)||Me)&&Bn(()=>{Ce&&xr(Ce,W,C,R),Me&&ps(C,R,W,"updated")},ue)},V=(R,C,W,ue,se,le,be)=>{for(let ge=0;ge<C.length;ge++){const fe=R[ge],he=C[ge],Me=fe.el&&(fe.type===yr||!bs(fe,he)||fe.shapeFlag&70)?g(fe.el):W;K(fe,he,Me,null,ue,se,le,be,!0)}},N=(R,C,W,ue,se)=>{if(C!==W){if(C!==Et)for(const le in C)!Sa(le)&&!(le in W)&&s(R,le,C[le],null,se,ue);for(const le in W){if(Sa(le))continue;const be=W[le],ge=C[le];be!==ge&&le!=="value"&&s(R,le,ge,be,se,ue)}"value"in W&&s(R,"value",C.value,W.value,se)}},k=(R,C,W,ue,se,le,be,ge,fe)=>{const he=C.el=R?R.el:u(""),Me=C.anchor=R?R.anchor:u("");let{patchFlag:Te,dynamicChildren:Oe,slotScopeIds:Ce}=C;Ce&&(ge=ge?ge.concat(Ce):Ce),R==null?(r(he,W,ue),r(Me,W,ue),S(C.children||[],W,Me,se,le,be,ge,fe)):Te>0&&Te&64&&Oe&&R.dynamicChildren?(V(R.dynamicChildren,Oe,W,se,le,be,ge),(C.key!=null||se&&C===se.subTree)&&Eg(R,C,!0)):ze(R,C,W,Me,se,le,be,ge,fe)},P=(R,C,W,ue,se,le,be,ge,fe)=>{C.slotScopeIds=ge,R==null?C.shapeFlag&512?se.ctx.activate(C,W,ue,be,fe):lt(C,W,ue,se,le,be,fe):Vt(R,C,fe)},lt=(R,C,W,ue,se,le,be)=>{const ge=R.component=lE(R,ue,se);if(fu(R)&&(ge.ctx.renderer=Ve),fE(ge,!1,be),ge.asyncDep){if(se&&se.registerDep(ge,ct,be),!R.el){const fe=ge.subTree=nn(On);ae(null,fe,C,W)}}else ct(ge,R,C,W,se,le,be)},Vt=(R,C,W)=>{const ue=C.component=R.component;if(Zw(R,C,W))if(ue.asyncDep&&!ue.asyncResolved){Ue(ue,C,W);return}else ue.next=C,ue.update();else C.el=R.el,ue.vnode=C},ct=(R,C,W,ue,se,le,be)=>{const ge=()=>{if(R.isMounted){let{next:Te,bu:Oe,u:Ce,parent:Be,vnode:tt}=R;{const zt=bg(R);if(zt){Te&&(Te.el=tt.el,Ue(R,Te,be)),zt.asyncDep.then(()=>{R.isUnmounted||ge()});return}}let nt=Te,Bt;ms(R,!1),Te?(Te.el=tt.el,Ue(R,Te,be)):Te=tt,Oe&&zu(Oe),(Bt=Te.props&&Te.props.onVnodeBeforeUpdate)&&xr(Bt,Be,Te,tt),ms(R,!0);const bt=Rl(R),Nt=R.subTree;R.subTree=bt,K(Nt,bt,g(Nt.el),re(Nt),R,se,le),Te.el=bt.el,nt===null&&eE(R,bt.el),Ce&&Bn(Ce,se),(Bt=Te.props&&Te.props.onVnodeUpdated)&&Bn(()=>xr(Bt,Be,Te,tt),se)}else{let Te;const{el:Oe,props:Ce}=C,{bm:Be,m:tt,parent:nt,root:Bt,type:bt}=R,Nt=xa(C);if(ms(R,!1),Be&&zu(Be),!Nt&&(Te=Ce&&Ce.onVnodeBeforeMount)&&xr(Te,nt,C),ms(R,!0),Oe&&Le){const zt=()=>{R.subTree=Rl(R),Le(Oe,R.subTree,R,se,null)};Nt&&bt.__asyncHydrate?bt.__asyncHydrate(Oe,R,zt):zt()}else{Bt.ce&&Bt.ce._injectChildStyle(bt);const zt=R.subTree=Rl(R);K(null,zt,W,ue,R,se,le),C.el=zt.el}if(tt&&Bn(tt,se),!Nt&&(Te=Ce&&Ce.onVnodeMounted)){const zt=C;Bn(()=>xr(Te,nt,zt),se)}(C.shapeFlag&256||nt&&xa(nt.vnode)&&nt.vnode.shapeFlag&256)&&R.a&&Bn(R.a,se),R.isMounted=!0,C=W=ue=null}};R.scope.on();const fe=R.effect=new Vm(ge);R.scope.off();const he=R.update=fe.run.bind(fe),Me=R.job=fe.runIfDirty.bind(fe);Me.i=R,Me.id=R.uid,fe.scheduler=()=>Xh(Me),ms(R,!0),he()},Ue=(R,C,W)=>{C.component=R;const ue=R.vnode.props;R.vnode=C,R.next=null,Fw(R,C.props,ue,W),Uw(R,C.children,W),Hi(),Zf(R),Wi()},ze=(R,C,W,ue,se,le,be,ge,fe=!1)=>{const he=R&&R.children,Me=R?R.shapeFlag:0,Te=C.children,{patchFlag:Oe,shapeFlag:Ce}=C;if(Oe>0){if(Oe&128){Ft(he,Te,W,ue,se,le,be,ge,fe);return}else if(Oe&256){$t(he,Te,W,ue,se,le,be,ge,fe);return}}Ce&8?(Me&16&&Lt(he,se,le),Te!==he&&m(W,Te)):Me&16?Ce&16?Ft(he,Te,W,ue,se,le,be,ge,fe):Lt(he,se,le,!0):(Me&8&&m(W,""),Ce&16&&S(Te,W,ue,se,le,be,ge,fe))},$t=(R,C,W,ue,se,le,be,ge,fe)=>{R=R||xo,C=C||xo;const he=R.length,Me=C.length,Te=Math.min(he,Me);let Oe;for(Oe=0;Oe<Te;Oe++){const Ce=C[Oe]=fe?Vi(C[Oe]):Vr(C[Oe]);K(R[Oe],Ce,W,null,se,le,be,ge,fe)}he>Me?Lt(R,se,le,!0,!1,Te):S(C,W,ue,se,le,be,ge,fe,Te)},Ft=(R,C,W,ue,se,le,be,ge,fe)=>{let he=0;const Me=C.length;let Te=R.length-1,Oe=Me-1;for(;he<=Te&&he<=Oe;){const Ce=R[he],Be=C[he]=fe?Vi(C[he]):Vr(C[he]);if(bs(Ce,Be))K(Ce,Be,W,null,se,le,be,ge,fe);else break;he++}for(;he<=Te&&he<=Oe;){const Ce=R[Te],Be=C[Oe]=fe?Vi(C[Oe]):Vr(C[Oe]);if(bs(Ce,Be))K(Ce,Be,W,null,se,le,be,ge,fe);else break;Te--,Oe--}if(he>Te){if(he<=Oe){const Ce=Oe+1,Be=Ce<Me?C[Ce].el:ue;for(;he<=Oe;)K(null,C[he]=fe?Vi(C[he]):Vr(C[he]),W,Be,se,le,be,ge,fe),he++}}else if(he>Oe)for(;he<=Te;)At(R[he],se,le,!0),he++;else{const Ce=he,Be=he,tt=new Map;for(he=Be;he<=Oe;he++){const jt=C[he]=fe?Vi(C[he]):Vr(C[he]);jt.key!=null&&tt.set(jt.key,he)}let nt,Bt=0;const bt=Oe-Be+1;let Nt=!1,zt=0;const on=new Array(bt);for(he=0;he<bt;he++)on[he]=0;for(he=Ce;he<=Te;he++){const jt=R[he];if(Bt>=bt){At(jt,se,le,!0);continue}let Gt;if(jt.key!=null)Gt=tt.get(jt.key);else for(nt=Be;nt<=Oe;nt++)if(on[nt-Be]===0&&bs(jt,C[nt])){Gt=nt;break}Gt===void 0?At(jt,se,le,!0):(on[Gt-Be]=he+1,Gt>=zt?zt=Gt:Nt=!0,K(jt,C[Gt],W,null,se,le,be,ge,fe),Bt++)}const ke=Nt?zw(on):xo;for(nt=ke.length-1,he=bt-1;he>=0;he--){const jt=Be+he,Gt=C[jt],ur=jt+1<Me?C[jt+1].el:ue;on[he]===0?K(null,Gt,W,ur,se,le,be,ge,fe):Nt&&(nt<0||he!==ke[nt]?hn(Gt,W,ur,2):nt--)}}},hn=(R,C,W,ue,se=null)=>{const{el:le,type:be,transition:ge,children:fe,shapeFlag:he}=R;if(he&6){hn(R.component.subTree,C,W,ue);return}if(he&128){R.suspense.move(C,W,ue);return}if(he&64){be.move(R,C,W,Ve);return}if(be===yr){r(le,C,W);for(let Te=0;Te<fe.length;Te++)hn(fe[Te],C,W,ue);r(R.anchor,C,W);return}if(be===Hu){te(R,C,W);return}if(ue!==2&&he&1&&ge)if(ue===0)ge.beforeEnter(le),r(le,C,W),Bn(()=>ge.enter(le),se);else{const{leave:Te,delayLeave:Oe,afterLeave:Ce}=ge,Be=()=>r(le,C,W),tt=()=>{Te(le,()=>{Be(),Ce&&Ce()})};Oe?Oe(le,Be,tt):tt()}else r(le,C,W)},At=(R,C,W,ue=!1,se=!1)=>{const{type:le,props:be,ref:ge,children:fe,dynamicChildren:he,shapeFlag:Me,patchFlag:Te,dirs:Oe,cacheIndex:Ce}=R;if(Te===-2&&(se=!1),ge!=null&&Xl(ge,null,W,R,!0),Ce!=null&&(C.renderCache[Ce]=void 0),Me&256){C.ctx.deactivate(R);return}const Be=Me&1&&Oe,tt=!xa(R);let nt;if(tt&&(nt=be&&be.onVnodeBeforeUnmount)&&xr(nt,C,R),Me&6)En(R.component,W,ue);else{if(Me&128){R.suspense.unmount(W,ue);return}Be&&ps(R,null,C,"beforeUnmount"),Me&64?R.type.remove(R,C,W,Ve,ue):he&&!he.hasOnce&&(le!==yr||Te>0&&Te&64)?Lt(he,C,W,!1,!0):(le===yr&&Te&384||!se&&Me&16)&&Lt(fe,C,W),ue&&ft(R)}(tt&&(nt=be&&be.onVnodeUnmounted)||Be)&&Bn(()=>{nt&&xr(nt,C,R),Be&&ps(R,null,C,"unmounted")},W)},ft=R=>{const{type:C,el:W,anchor:ue,transition:se}=R;if(C===yr){ar(W,ue);return}if(C===Hu){ce(R);return}const le=()=>{i(W),se&&!se.persisted&&se.afterLeave&&se.afterLeave()};if(R.shapeFlag&1&&se&&!se.persisted){const{leave:be,delayLeave:ge}=se,fe=()=>be(W,le);ge?ge(R.el,le,fe):fe()}else le()},ar=(R,C)=>{let W;for(;R!==C;)W=w(R),i(R),R=W;i(C)},En=(R,C,W)=>{const{bum:ue,scope:se,job:le,subTree:be,um:ge,m:fe,a:he}=R;ud(fe),ud(he),ue&&zu(ue),se.stop(),le&&(le.flags|=8,At(be,R,C,W)),ge&&Bn(ge,C),Bn(()=>{R.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},Lt=(R,C,W,ue=!1,se=!1,le=0)=>{for(let be=le;be<R.length;be++)At(R[be],C,W,ue,se)},re=R=>{if(R.shapeFlag&6)return re(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const C=w(R.anchor||R.el),W=C&&C[aw];return W?w(W):C};let xe=!1;const ee=(R,C,W)=>{R==null?C._vnode&&At(C._vnode,null,null,!0):K(C._vnode||null,R,C,null,null,null,W),C._vnode=R,xe||(xe=!0,Zf(),Zm(),xe=!1)},Ve={p:K,um:At,m:hn,r:ft,mt:lt,mc:S,pc:ze,pbc:V,n:re,o:n};let Qe,Le;return{render:ee,hydrate:Qe,createApp:Ow(ee,Qe)}}function Sl({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function ms({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function $w(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Eg(n,e,t=!1){const r=n.children,i=e.children;if(qe(r)&&qe(i))for(let s=0;s<r.length;s++){const o=r[s];let u=i[s];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[s]=Vi(i[s]),u.el=o.el),!t&&u.patchFlag!==-2&&Eg(o,u)),u.type===jc&&(u.el=o.el)}}function zw(n){const e=n.slice(),t=[0];let r,i,s,o,u;const l=n.length;for(r=0;r<l;r++){const f=n[r];if(f!==0){if(i=t[t.length-1],n[i]<f){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)u=s+o>>1,n[t[u]]<f?s=u+1:o=u;f<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function bg(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:bg(e)}function ud(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const Gw=Symbol.for("v-scx"),Hw=()=>rr(Gw);function GR(n,e){return rf(n,null,e)}function Vo(n,e,t){return rf(n,e,t)}function rf(n,e,t=Et){const{immediate:r,deep:i,flush:s,once:o}=t,u=Jt({},t),l=e&&r||!e&&s!=="post";let f;if(Mo){if(s==="sync"){const I=Hw();f=I.__watcherHandles||(I.__watcherHandles=[])}else if(!l){const I=()=>{};return I.stop=Nr,I.resume=Nr,I.pause=Nr,I}}const m=tn;u.call=(I,L,K)=>vr(I,m,L,K);let g=!1;s==="post"?u.scheduler=I=>{Bn(I,m&&m.suspense)}:s!=="sync"&&(g=!0,u.scheduler=(I,L)=>{L?I():Xh(I)}),u.augmentJob=I=>{e&&(I.flags|=4),g&&(I.flags|=2,m&&(I.id=m.uid,I.i=m))};const w=nw(n,e,u);return Mo&&(f?f.push(w):l&&w()),w}function Ww(n,e,t){const r=this.proxy,i=Kt(n)?n.includes(".")?Ig(r,n):()=>r[n]:n.bind(r,r);let s;Ke(e)?s=e:(s=e.handler,t=e);const o=du(this),u=rf(i,s.bind(r),t);return o(),u}function Ig(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const Qw=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${or(e)}Modifiers`]||n[`${Gi(e)}Modifiers`];function Yw(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Et;let i=t;const s=e.startsWith("update:"),o=s&&Qw(r,e.slice(7));o&&(o.trim&&(i=t.map(m=>Kt(m)?m.trim():m)),o.number&&(i=t.map(Gl)));let u,l=r[u=_l(e)]||r[u=_l(or(e))];!l&&s&&(l=r[u=_l(Gi(e))]),l&&vr(l,n,6,i);const f=r[u+"Once"];if(f){if(!n.emitted)n.emitted={};else if(n.emitted[u])return;n.emitted[u]=!0,vr(f,n,6,i)}}function Tg(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},u=!1;if(!Ke(n)){const l=f=>{const m=Tg(f,e,!0);m&&(u=!0,Jt(o,m))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!u?(Tt(n)&&r.set(n,null),null):(qe(s)?s.forEach(l=>o[l]=null):Jt(o,s),Tt(n)&&r.set(n,o),o)}function Bc(n,e){return!n||!Cc(e)?!1:(e=e.slice(2).replace(/Once$/,""),pt(n,e[0].toLowerCase()+e.slice(1))||pt(n,Gi(e))||pt(n,e))}function Rl(n){const{type:e,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:u,emit:l,render:f,renderCache:m,props:g,data:w,setupState:I,ctx:L,inheritAttrs:K}=n,J=cc(n);let ae,oe;try{if(t.shapeFlag&4){const ce=i||r,Se=ce;ae=Vr(f.call(Se,ce,m,g,I,w,L)),oe=u}else{const ce=e;ae=Vr(ce.length>1?ce(g,{attrs:u,slots:o,emit:l}):ce(g,null)),oe=e.props?u:Jw(u)}}catch(ce){Da.length=0,hu(ce,n,1),ae=nn(On)}let te=ae;if(oe&&K!==!1){const ce=Object.keys(oe),{shapeFlag:Se}=te;ce.length&&Se&7&&(s&&ce.some(Lh)&&(oe=Xw(oe,s)),te=Ui(te,oe,!1,!0))}return t.dirs&&(te=Ui(te,null,!1,!0),te.dirs=te.dirs?te.dirs.concat(t.dirs):t.dirs),t.transition&&Ka(te,t.transition),ae=te,cc(J),ae}const Jw=n=>{let e;for(const t in n)(t==="class"||t==="style"||Cc(t))&&((e||(e={}))[t]=n[t]);return e},Xw=(n,e)=>{const t={};for(const r in n)(!Lh(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function Zw(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:u,patchFlag:l}=e,f=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?cd(r,o,f):!!o;if(l&8){const m=e.dynamicProps;for(let g=0;g<m.length;g++){const w=m[g];if(o[w]!==r[w]&&!Bc(f,w))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:r===o?!1:r?o?cd(r,o,f):!0:!!o;return!1}function cd(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!Bc(t,s))return!0}return!1}function eE({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const Ag=n=>n.__isSuspense;function tE(n,e){e&&e.pendingBranch?qe(n)?e.effects.push(...n):e.effects.push(n):sw(n)}const yr=Symbol.for("v-fgt"),jc=Symbol.for("v-txt"),On=Symbol.for("v-cmt"),Hu=Symbol.for("v-stc"),Da=[];let jn=null;function wo(n=!1){Da.push(jn=n?null:[])}function nE(){Da.pop(),jn=Da[Da.length-1]||null}let $a=1;function ld(n){$a+=n,n<0&&jn&&(jn.hasOnce=!0)}function Sg(n){return n.dynamicChildren=$a>0?jn||xo:null,nE(),$a>0&&jn&&jn.push(n),n}function Fu(n,e,t,r,i,s){return Sg(xg(n,e,t,r,i,s,!0))}function Rg(n,e,t,r,i){return Sg(nn(n,e,t,r,i,!0))}function hc(n){return n?n.__v_isVNode===!0:!1}function bs(n,e){return n.type===e.type&&n.key===e.key}const Pg=({key:n})=>n??null,Wu=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Kt(n)||Ot(n)||Ke(n)?{i:xn,r:n,k:e,f:!!t}:n:null);function xg(n,e=null,t=null,r=0,i=null,s=n===yr?0:1,o=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Pg(e),ref:e&&Wu(e),scopeId:tg,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:xn};return u?(sf(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=Kt(t)?8:16),$a>0&&!o&&jn&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&jn.push(l),l}const nn=rE;function rE(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===Aw)&&(n=On),hc(n)){const u=Ui(n,e,!0);return t&&sf(u,t),$a>0&&!s&&jn&&(u.shapeFlag&6?jn[jn.indexOf(n)]=u:jn.push(u)),u.patchFlag=-2,u}if(yE(n)&&(n=n.__vccOpts),e){e=iE(e);let{class:u,style:l}=e;u&&!Kt(u)&&(e.class=qh(u)),Tt(l)&&(Qh(l)&&!qe(l)&&(l=Jt({},l)),e.style=Uh(l))}const o=Kt(n)?1:Ag(n)?128:ng(n)?64:Tt(n)?4:Ke(n)?2:0;return xg(n,e,t,r,i,o,s,!0)}function iE(n){return n?Qh(n)||pg(n)?Jt({},n):n:null}function Ui(n,e,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:u,transition:l}=n,f=e?aE(i||{},e):i,m={__v_isVNode:!0,__v_skip:!0,type:n.type,props:f,key:f&&Pg(f),ref:e&&e.ref?t&&s?qe(s)?s.concat(Wu(e)):[s,Wu(e)]:Wu(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:u,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==yr?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ui(n.ssContent),ssFallback:n.ssFallback&&Ui(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&Ka(m,l.clone(m)),m}function sE(n=" ",e=0){return nn(jc,null,n,e)}function HR(n,e){const t=nn(Hu,null,n);return t.staticCount=e,t}function oE(n="",e=!1){return e?(wo(),Rg(On,null,n)):nn(On,null,n)}function Vr(n){return n==null||typeof n=="boolean"?nn(On):qe(n)?nn(yr,null,n.slice()):hc(n)?Vi(n):nn(jc,null,String(n))}function Vi(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ui(n)}function sf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(qe(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),sf(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!pg(e)?e._ctx=xn:i===3&&xn&&(xn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Ke(e)?(e={default:e,_ctx:xn},t=32):(e=String(e),r&64?(t=16,e=[sE(e)]):t=8);n.children=e,n.shapeFlag|=t}function aE(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=qh([e.class,r.class]));else if(i==="style")e.style=Uh([e.style,r.style]);else if(Cc(i)){const s=e[i],o=r[i];o&&s!==o&&!(qe(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function xr(n,e,t,r=null){vr(n,e,7,[t,r])}const uE=hg();let cE=0;function lE(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||uE,s={uid:cE++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new xm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:gg(r,i),emitsOptions:Tg(r,i),emit:null,emitted:null,propsDefaults:Et,inheritAttrs:r.inheritAttrs,ctx:Et,data:Et,props:Et,attrs:Et,slots:Et,refs:Et,setupState:Et,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Yw.bind(null,s),n.ce&&n.ce(s),s}let tn=null;const hE=()=>tn||xn;let fc,rh;{const n=Oc(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};fc=e("__VUE_INSTANCE_SETTERS__",t=>tn=t),rh=e("__VUE_SSR_SETTERS__",t=>Mo=t)}const du=n=>{const e=tn;return fc(n),n.scope.on(),()=>{n.scope.off(),fc(e)}},hd=()=>{tn&&tn.scope.off(),fc(null)};function Cg(n){return n.vnode.shapeFlag&4}let Mo=!1;function fE(n,e=!1,t=!1){e&&rh(e);const{props:r,children:i}=n.vnode,s=Cg(n);Mw(n,r,s,e),jw(n,i,t);const o=s?dE(n,e):void 0;return e&&rh(!1),o}function dE(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,Rw);const{setup:r}=t;if(r){Hi();const i=n.setupContext=r.length>1?mE(n):null,s=du(n),o=lu(r,n,0,[n.props,i]),u=Em(o);if(Wi(),s(),(u||n.sp)&&!xa(n)&&Zh(n),u){if(o.then(hd,hd),e)return o.then(l=>{fd(n,l,e)}).catch(l=>{hu(l,n,0)});n.asyncDep=o}else fd(n,o,e)}else Dg(n,e)}function fd(n,e,t){Ke(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Tt(e)&&(n.setupState=Qm(e)),Dg(n,t)}let dd;function Dg(n,e,t){const r=n.type;if(!n.render){if(!e&&dd&&!r.render){const i=r.template||tf(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:u,compilerOptions:l}=r,f=Jt(Jt({isCustomElement:s,delimiters:u},o),l);r.render=dd(i,f)}}n.render=r.render||Nr}{const i=du(n);Hi();try{Pw(n)}finally{Wi(),i()}}}const pE={get(n,e){return yn(n,"get",""),n[e]}};function mE(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,pE),slots:n.slots,emit:n.emit,expose:e}}function Uc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Qm(Yh(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ca)return Ca[t](n)},has(e,t){return t in e||t in Ca}})):n.proxy}function gE(n,e=!0){return Ke(n)?n.displayName||n.name:n.name||e&&n.__name}function yE(n){return Ke(n)&&"__vccOpts"in n}const Zn=(n,e)=>ew(n,e,Mo);function of(n,e,t){const r=arguments.length;return r===2?Tt(e)&&!qe(e)?hc(e)?nn(n,null,[e]):nn(n,e):nn(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&hc(t)&&(t=[t]),nn(n,e,t))}const _E="3.5.12";/**
* @vue/runtime-dom v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ih;const pd=typeof window<"u"&&window.trustedTypes;if(pd)try{ih=pd.createPolicy("vue",{createHTML:n=>n})}catch{}const Vg=ih?n=>ih.createHTML(n):n=>n,vE="http://www.w3.org/2000/svg",wE="http://www.w3.org/1998/Math/MathML",ni=typeof document<"u"?document:null,md=ni&&ni.createElement("template"),EE={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?ni.createElementNS(vE,n):e==="mathml"?ni.createElementNS(wE,n):t?ni.createElement(n,{is:t}):ni.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>ni.createTextNode(n),createComment:n=>ni.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ni.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{md.innerHTML=Vg(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const u=md.content;if(r==="svg"||r==="mathml"){const l=u.firstChild;for(;l.firstChild;)u.appendChild(l.firstChild);u.removeChild(l)}e.insertBefore(u,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Ii="transition",pa="animation",za=Symbol("_vtc"),kg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},bE=Jt({},rg,kg),IE=n=>(n.displayName="Transition",n.props=bE,n),WR=IE((n,{slots:e})=>of(lw,TE(n),e)),gs=(n,e=[])=>{qe(n)?n.forEach(t=>t(...e)):n&&n(...e)},gd=n=>n?qe(n)?n.some(e=>e.length>1):n.length>1:!1;function TE(n){const e={};for(const k in n)k in kg||(e[k]=n[k]);if(n.css===!1)return e;const{name:t="v",type:r,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:u=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:f=o,appearToClass:m=u,leaveFromClass:g=`${t}-leave-from`,leaveActiveClass:w=`${t}-leave-active`,leaveToClass:I=`${t}-leave-to`}=n,L=AE(i),K=L&&L[0],J=L&&L[1],{onBeforeEnter:ae,onEnter:oe,onEnterCancelled:te,onLeave:ce,onLeaveCancelled:Se,onBeforeAppear:Pe=ae,onAppear:D=oe,onAppearCancelled:S=te}=e,A=(k,P,lt)=>{ys(k,P?m:u),ys(k,P?f:o),lt&&lt()},V=(k,P)=>{k._isLeaving=!1,ys(k,g),ys(k,I),ys(k,w),P&&P()},N=k=>(P,lt)=>{const Vt=k?D:oe,ct=()=>A(P,k,lt);gs(Vt,[P,ct]),yd(()=>{ys(P,k?l:s),Ti(P,k?m:u),gd(Vt)||_d(P,r,K,ct)})};return Jt(e,{onBeforeEnter(k){gs(ae,[k]),Ti(k,s),Ti(k,o)},onBeforeAppear(k){gs(Pe,[k]),Ti(k,l),Ti(k,f)},onEnter:N(!1),onAppear:N(!0),onLeave(k,P){k._isLeaving=!0;const lt=()=>V(k,P);Ti(k,g),Ti(k,w),PE(),yd(()=>{k._isLeaving&&(ys(k,g),Ti(k,I),gd(ce)||_d(k,r,J,lt))}),gs(ce,[k,lt])},onEnterCancelled(k){A(k,!1),gs(te,[k])},onAppearCancelled(k){A(k,!0),gs(S,[k])},onLeaveCancelled(k){V(k),gs(Se,[k])}})}function AE(n){if(n==null)return null;if(Tt(n))return[Pl(n.enter),Pl(n.leave)];{const e=Pl(n);return[e,e]}}function Pl(n){return vv(n)}function Ti(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[za]||(n[za]=new Set)).add(e)}function ys(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[za];t&&(t.delete(e),t.size||(n[za]=void 0))}function yd(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let SE=0;function _d(n,e,t,r){const i=n._endId=++SE,s=()=>{i===n._endId&&r()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:u,propCount:l}=RE(n,e);if(!o)return r();const f=o+"end";let m=0;const g=()=>{n.removeEventListener(f,w),s()},w=I=>{I.target===n&&++m>=l&&g()};setTimeout(()=>{m<l&&g()},u+1),n.addEventListener(f,w)}function RE(n,e){const t=window.getComputedStyle(n),r=L=>(t[L]||"").split(", "),i=r(`${Ii}Delay`),s=r(`${Ii}Duration`),o=vd(i,s),u=r(`${pa}Delay`),l=r(`${pa}Duration`),f=vd(u,l);let m=null,g=0,w=0;e===Ii?o>0&&(m=Ii,g=o,w=s.length):e===pa?f>0&&(m=pa,g=f,w=l.length):(g=Math.max(o,f),m=g>0?o>f?Ii:pa:null,w=m?m===Ii?s.length:l.length:0);const I=m===Ii&&/\b(transform|all)(,|$)/.test(r(`${Ii}Property`).toString());return{type:m,timeout:g,propCount:w,hasTransform:I}}function vd(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>wd(t)+wd(n[r])))}function wd(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function PE(){return document.body.offsetHeight}function xE(n,e,t){const r=n[za];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Ed=Symbol("_vod"),CE=Symbol("_vsh"),DE=Symbol(""),VE=/(^|;)\s*display\s*:/;function kE(n,e,t){const r=n.style,i=Kt(t);let s=!1;if(t&&!i){if(e)if(Kt(e))for(const o of e.split(";")){const u=o.slice(0,o.indexOf(":")).trim();t[u]==null&&Qu(r,u,"")}else for(const o in e)t[o]==null&&Qu(r,o,"");for(const o in t)o==="display"&&(s=!0),Qu(r,o,t[o])}else if(i){if(e!==t){const o=r[DE];o&&(t+=";"+o),r.cssText=t,s=VE.test(t)}}else e&&n.removeAttribute("style");Ed in n&&(n[Ed]=s?r.display:"",n[CE]&&(r.display="none"))}const bd=/\s*!important$/;function Qu(n,e,t){if(qe(t))t.forEach(r=>Qu(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=OE(n,e);bd.test(t)?n.setProperty(Gi(r),t.replace(bd,""),"important"):n[r]=t}}const Id=["Webkit","Moz","ms"],xl={};function OE(n,e){const t=xl[e];if(t)return t;let r=or(e);if(r!=="filter"&&r in n)return xl[e]=r;r=kc(r);for(let i=0;i<Id.length;i++){const s=Id[i]+r;if(s in n)return xl[e]=s}return e}const Td="http://www.w3.org/1999/xlink";function Ad(n,e,t,r,i,s=Av(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Td,e.slice(6,e.length)):n.setAttributeNS(Td,e,t):t==null||s&&!Am(t)?n.removeAttribute(e):n.setAttribute(e,s?"":zi(t)?String(t):t)}function Sd(n,e,t,r,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Vg(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const u=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(u!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const u=typeof n[e];u==="boolean"?t=Am(t):t==null&&u==="string"?(t="",o=!0):u==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(i||e)}function Eo(n,e,t,r){n.addEventListener(e,t,r)}function NE(n,e,t,r){n.removeEventListener(e,t,r)}const Rd=Symbol("_vei");function ME(n,e,t,r,i=null){const s=n[Rd]||(n[Rd]={}),o=s[e];if(r&&o)o.value=r;else{const[u,l]=FE(e);if(r){const f=s[e]=jE(r,i);Eo(n,u,f,l)}else o&&(NE(n,u,o,l),s[e]=void 0)}}const Pd=/(?:Once|Passive|Capture)$/;function FE(n){let e;if(Pd.test(n)){e={};let r;for(;r=n.match(Pd);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Gi(n.slice(2)),e]}let Cl=0;const LE=Promise.resolve(),BE=()=>Cl||(LE.then(()=>Cl=0),Cl=Date.now());function jE(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;vr(UE(r,t.value),e,5,[r])};return t.value=n,t.attached=BE(),t}function UE(n,e){if(qe(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const xd=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,qE=(n,e,t,r,i,s)=>{const o=i==="svg";e==="class"?xE(n,r,o):e==="style"?kE(n,t,r):Cc(e)?Lh(e)||ME(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):KE(n,e,r,o))?(Sd(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ad(n,e,r,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Kt(r))?Sd(n,or(e),r,s,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Ad(n,e,r,o))};function KE(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&xd(e)&&Ke(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return xd(e)&&Kt(t)?!1:e in n}const Cd=n=>{const e=n.props["onUpdate:modelValue"]||!1;return qe(e)?t=>zu(e,t):e};function $E(n){n.target.composing=!0}function Dd(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Dl=Symbol("_assign"),QR={created(n,{modifiers:{lazy:e,trim:t,number:r}},i){n[Dl]=Cd(i);const s=r||i.props&&i.props.type==="number";Eo(n,e?"change":"input",o=>{if(o.target.composing)return;let u=n.value;t&&(u=u.trim()),s&&(u=Gl(u)),n[Dl](u)}),t&&Eo(n,"change",()=>{n.value=n.value.trim()}),e||(Eo(n,"compositionstart",$E),Eo(n,"compositionend",Dd),Eo(n,"change",Dd))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:i,number:s}},o){if(n[Dl]=Cd(o),n.composing)return;const u=(s||n.type==="number")&&!/^0\d/.test(n.value)?Gl(n.value):n.value,l=e??"";u!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||i&&n.value.trim()===l)||(n.value=l))}},zE=["ctrl","shift","alt","meta"],GE={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>zE.some(t=>n[`${t}Key`]&&!e.includes(t))},YR=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(i,...s)=>{for(let o=0;o<e.length;o++){const u=GE[e[o]];if(u&&u(i,e))return}return n(i,...s)})},HE={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},JR=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=i=>{if(!("key"in i))return;const s=Gi(i.key);if(e.some(o=>o===s||HE[o]===s))return n(i)})},WE=Jt({patchProp:qE},EE);let Vd;function QE(){return Vd||(Vd=qw(WE))}const YE=(...n)=>{const e=QE().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=XE(r);if(!i)return;const s=e._component;!Ke(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,JE(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function JE(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function XE(n){return Kt(n)?document.querySelector(n):n}var ZE=!1;/*!
 * pinia v2.2.6
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let Og;const qc=n=>Og=n,Ng=Symbol();function sh(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Va;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Va||(Va={}));function eb(){const n=Cm(!0),e=n.run(()=>nr({}));let t=[],r=[];const i=Yh({install(s){qc(i),i._a=s,s.provide(Ng,i),s.config.globalProperties.$pinia=i,r.forEach(o=>t.push(o)),r=[]},use(s){return!this._a&&!ZE?r.push(s):t.push(s),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return i}const Mg=()=>{};function kd(n,e,t,r=Mg){n.push(e);const i=()=>{const s=n.indexOf(e);s>-1&&(n.splice(s,1),r())};return!t&&Dm()&&Sv(i),i}function po(n,...e){n.slice().forEach(t=>{t(...e)})}const tb=n=>n(),Od=Symbol(),Vl=Symbol();function oh(n,e){n instanceof Map&&e instanceof Map?e.forEach((t,r)=>n.set(r,t)):n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],i=n[t];sh(i)&&sh(r)&&n.hasOwnProperty(t)&&!Ot(r)&&!oi(r)?n[t]=oh(i,r):n[t]=r}return n}const nb=Symbol();function rb(n){return!sh(n)||!n.hasOwnProperty(nb)}const{assign:xi}=Object;function ib(n){return!!(Ot(n)&&n.effect)}function sb(n,e,t,r){const{state:i,actions:s,getters:o}=e,u=t.state.value[n];let l;function f(){u||(t.state.value[n]=i?i():{});const m=Qv(t.state.value[n]);return xi(m,s,Object.keys(o||{}).reduce((g,w)=>(g[w]=Yh(Zn(()=>{qc(t);const I=t._s.get(n);return o[w].call(I,I)})),g),{}))}return l=Fg(n,f,e,t,r,!0),l}function Fg(n,e,t={},r,i,s){let o;const u=xi({actions:{}},t),l={deep:!0};let f,m,g=[],w=[],I;const L=r.state.value[n];!s&&!L&&(r.state.value[n]={}),nr({});let K;function J(S){let A;f=m=!1,typeof S=="function"?(S(r.state.value[n]),A={type:Va.patchFunction,storeId:n,events:I}):(oh(r.state.value[n],S),A={type:Va.patchObject,payload:S,storeId:n,events:I});const V=K=Symbol();Jh().then(()=>{K===V&&(f=!0)}),m=!0,po(g,A,r.state.value[n])}const ae=s?function(){const{state:A}=t,V=A?A():{};this.$patch(N=>{xi(N,V)})}:Mg;function oe(){o.stop(),g=[],w=[],r._s.delete(n)}const te=(S,A="")=>{if(Od in S)return S[Vl]=A,S;const V=function(){qc(r);const N=Array.from(arguments),k=[],P=[];function lt(Ue){k.push(Ue)}function Vt(Ue){P.push(Ue)}po(w,{args:N,name:V[Vl],store:Se,after:lt,onError:Vt});let ct;try{ct=S.apply(this&&this.$id===n?this:Se,N)}catch(Ue){throw po(P,Ue),Ue}return ct instanceof Promise?ct.then(Ue=>(po(k,Ue),Ue)).catch(Ue=>(po(P,Ue),Promise.reject(Ue))):(po(k,ct),ct)};return V[Od]=!0,V[Vl]=A,V},ce={_p:r,$id:n,$onAction:kd.bind(null,w),$patch:J,$reset:ae,$subscribe(S,A={}){const V=kd(g,S,A.detached,()=>N()),N=o.run(()=>Vo(()=>r.state.value[n],k=>{(A.flush==="sync"?m:f)&&S({storeId:n,type:Va.direct,events:I},k)},xi({},l,A)));return V},$dispose:oe},Se=cu(ce);r._s.set(n,Se);const D=(r._a&&r._a.runWithContext||tb)(()=>r._e.run(()=>(o=Cm()).run(()=>e({action:te}))));for(const S in D){const A=D[S];if(Ot(A)&&!ib(A)||oi(A))s||(L&&rb(A)&&(Ot(A)?A.value=L[S]:oh(A,L[S])),r.state.value[n][S]=A);else if(typeof A=="function"){const V=te(A,S);D[S]=V,u.actions[S]=A}}return xi(Se,D),xi(at(Se),D),Object.defineProperty(Se,"$state",{get:()=>r.state.value[n],set:S=>{J(A=>{xi(A,S)})}}),r._p.forEach(S=>{xi(Se,o.run(()=>S({store:Se,app:r._a,pinia:r,options:u})))}),L&&s&&t.hydrate&&t.hydrate(Se.$state,L),f=!0,m=!0,Se}/*! #__NO_SIDE_EFFECTS__ */function ob(n,e,t){let r,i;const s=typeof e=="function";typeof n=="string"?(r=n,i=s?t:e):(i=n,r=n.id);function o(u,l){const f=Nw();return u=u||(f?rr(Ng,null):null),u&&qc(u),u=Og,u._s.has(r)||(s?Fg(r,e,i,u):sb(r,i,u)),u._s.get(r)}return o.$id=r,o}function ab(n){{const e=at(n),t={};for(const r in e){const i=e[r];(Ot(i)||oi(i))&&(t[r]=Xv(n,r))}return t}}const ub="modulepreload",cb=function(n){return"/"+n},Nd={},bo=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=cb(l),l in Nd)return;Nd[l]=!0;const f=l.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":ub,f||(g.as="script"),g.crossOrigin="",g.href=l,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((w,I)=>{g.addEventListener("load",w),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Io=typeof document<"u";function Lg(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function lb(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&Lg(n.default)}const gt=Object.assign;function kl(n,e){const t={};for(const r in e){const i=e[r];t[r]=wr(i)?i.map(n):n(i)}return t}const ka=()=>{},wr=Array.isArray,Bg=/#/g,hb=/&/g,fb=/\//g,db=/=/g,pb=/\?/g,jg=/\+/g,mb=/%5B/g,gb=/%5D/g,Ug=/%5E/g,yb=/%60/g,qg=/%7B/g,_b=/%7C/g,Kg=/%7D/g,vb=/%20/g;function af(n){return encodeURI(""+n).replace(_b,"|").replace(mb,"[").replace(gb,"]")}function wb(n){return af(n).replace(qg,"{").replace(Kg,"}").replace(Ug,"^")}function ah(n){return af(n).replace(jg,"%2B").replace(vb,"+").replace(Bg,"%23").replace(hb,"%26").replace(yb,"`").replace(qg,"{").replace(Kg,"}").replace(Ug,"^")}function Eb(n){return ah(n).replace(db,"%3D")}function bb(n){return af(n).replace(Bg,"%23").replace(pb,"%3F")}function Ib(n){return n==null?"":bb(n).replace(fb,"%2F")}function Ga(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const Tb=/\/$/,Ab=n=>n.replace(Tb,"");function Ol(n,e,t="/"){let r,i={},s="",o="";const u=e.indexOf("#");let l=e.indexOf("?");return u<l&&u>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,u>-1?u:e.length),i=n(s)),u>-1&&(r=r||e.slice(0,u),o=e.slice(u,e.length)),r=xb(r??e,t),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:Ga(o)}}function Sb(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Md(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function Rb(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&Fo(e.matched[r],t.matched[i])&&$g(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Fo(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function $g(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!Pb(n[t],e[t]))return!1;return!0}function Pb(n,e){return wr(n)?Fd(n,e):wr(e)?Fd(e,n):n===e}function Fd(n,e){return wr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function xb(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,u;for(o=0;o<r.length;o++)if(u=r[o],u!==".")if(u==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const Ai={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ha;(function(n){n.pop="pop",n.push="push"})(Ha||(Ha={}));var Oa;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Oa||(Oa={}));function Cb(n){if(!n)if(Io){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),Ab(n)}const Db=/^[^#]+#/;function Vb(n,e){return n.replace(Db,"#")+e}function kb(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Kc=()=>({left:window.scrollX,top:window.scrollY});function Ob(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=kb(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Ld(n,e){return(history.state?history.state.position-e:-1)+n}const uh=new Map;function Nb(n,e){uh.set(n,e)}function Mb(n){const e=uh.get(n);return uh.delete(n),e}let Fb=()=>location.protocol+"//"+location.host;function zg(n,e){const{pathname:t,search:r,hash:i}=e,s=n.indexOf("#");if(s>-1){let u=i.includes(n.slice(s))?n.slice(s).length:1,l=i.slice(u);return l[0]!=="/"&&(l="/"+l),Md(l,"")}return Md(t,n)+r+i}function Lb(n,e,t,r){let i=[],s=[],o=null;const u=({state:w})=>{const I=zg(n,location),L=t.value,K=e.value;let J=0;if(w){if(t.value=I,e.value=w,o&&o===L){o=null;return}J=K?w.position-K.position:0}else r(I);i.forEach(ae=>{ae(t.value,L,{delta:J,type:Ha.pop,direction:J?J>0?Oa.forward:Oa.back:Oa.unknown})})};function l(){o=t.value}function f(w){i.push(w);const I=()=>{const L=i.indexOf(w);L>-1&&i.splice(L,1)};return s.push(I),I}function m(){const{history:w}=window;w.state&&w.replaceState(gt({},w.state,{scroll:Kc()}),"")}function g(){for(const w of s)w();s=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",m)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",m,{passive:!0}),{pauseListeners:l,listen:f,destroy:g}}function Bd(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?Kc():null}}function Bb(n){const{history:e,location:t}=window,r={value:zg(n,t)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,f,m){const g=n.indexOf("#"),w=g>-1?(t.host&&document.querySelector("base")?n:n.slice(g))+l:Fb()+n+l;try{e[m?"replaceState":"pushState"](f,"",w),i.value=f}catch(I){console.error(I),t[m?"replace":"assign"](w)}}function o(l,f){const m=gt({},e.state,Bd(i.value.back,l,i.value.forward,!0),f,{position:i.value.position});s(l,m,!0),r.value=l}function u(l,f){const m=gt({},i.value,e.state,{forward:l,scroll:Kc()});s(m.current,m,!0);const g=gt({},Bd(r.value,l,null),{position:m.position+1},f);s(l,g,!1),r.value=l}return{location:r,state:i,push:u,replace:o}}function jb(n){n=Cb(n);const e=Bb(n),t=Lb(n,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=gt({location:"",base:n,go:r,createHref:Vb.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function Ub(n){return typeof n=="string"||n&&typeof n=="object"}function Gg(n){return typeof n=="string"||typeof n=="symbol"}const Hg=Symbol("");var jd;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(jd||(jd={}));function Lo(n,e){return gt(new Error,{type:n,[Hg]:!0},e)}function ei(n,e){return n instanceof Error&&Hg in n&&(e==null||!!(n.type&e))}const Ud="[^/]+?",qb={sensitive:!1,strict:!1,start:!0,end:!0},Kb=/[.+*?^${}()[\]/\\]/g;function $b(n,e){const t=gt({},qb,e),r=[];let i=t.start?"^":"";const s=[];for(const f of n){const m=f.length?[]:[90];t.strict&&!f.length&&(i+="/");for(let g=0;g<f.length;g++){const w=f[g];let I=40+(t.sensitive?.25:0);if(w.type===0)g||(i+="/"),i+=w.value.replace(Kb,"\\$&"),I+=40;else if(w.type===1){const{value:L,repeatable:K,optional:J,regexp:ae}=w;s.push({name:L,repeatable:K,optional:J});const oe=ae||Ud;if(oe!==Ud){I+=10;try{new RegExp(`(${oe})`)}catch(ce){throw new Error(`Invalid custom RegExp for param "${L}" (${oe}): `+ce.message)}}let te=K?`((?:${oe})(?:/(?:${oe}))*)`:`(${oe})`;g||(te=J&&f.length<2?`(?:/${te})`:"/"+te),J&&(te+="?"),i+=te,I+=20,J&&(I+=-8),K&&(I+=-20),oe===".*"&&(I+=-50)}m.push(I)}r.push(m)}if(t.strict&&t.end){const f=r.length-1;r[f][r[f].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function u(f){const m=f.match(o),g={};if(!m)return null;for(let w=1;w<m.length;w++){const I=m[w]||"",L=s[w-1];g[L.name]=I&&L.repeatable?I.split("/"):I}return g}function l(f){let m="",g=!1;for(const w of n){(!g||!m.endsWith("/"))&&(m+="/"),g=!1;for(const I of w)if(I.type===0)m+=I.value;else if(I.type===1){const{value:L,repeatable:K,optional:J}=I,ae=L in f?f[L]:"";if(wr(ae)&&!K)throw new Error(`Provided param "${L}" is an array but it is not repeatable (* or + modifiers)`);const oe=wr(ae)?ae.join("/"):ae;if(!oe)if(J)w.length<2&&(m.endsWith("/")?m=m.slice(0,-1):g=!0);else throw new Error(`Missing required param "${L}"`);m+=oe}}return m||"/"}return{re:o,score:r,keys:s,parse:u,stringify:l}}function zb(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function Wg(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const s=zb(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(qd(r))return 1;if(qd(i))return-1}return i.length-r.length}function qd(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const Gb={type:0,value:""},Hb=/[a-zA-Z0-9_]/;function Wb(n){if(!n)return[[]];if(n==="/")return[[Gb]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(I){throw new Error(`ERR (${t})/"${f}": ${I}`)}let t=0,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let u=0,l,f="",m="";function g(){f&&(t===0?s.push({type:0,value:f}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:f,regexp:m,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),f="")}function w(){f+=l}for(;u<n.length;){if(l=n[u++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(f&&g(),o()):l===":"?(g(),t=1):w();break;case 4:w(),t=r;break;case 1:l==="("?t=2:Hb.test(l)?w():(g(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&u--);break;case 2:l===")"?m[m.length-1]=="\\"?m=m.slice(0,-1)+l:t=3:m+=l;break;case 3:g(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&u--,m="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${f}"`),g(),o(),i}function Qb(n,e,t){const r=$b(Wb(n.path),t),i=gt(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function Yb(n,e){const t=[],r=new Map;e=Gd({strict:!1,end:!0,sensitive:!1},e);function i(g){return r.get(g)}function s(g,w,I){const L=!I,K=$d(g);K.aliasOf=I&&I.record;const J=Gd(e,g),ae=[K];if("alias"in g){const ce=typeof g.alias=="string"?[g.alias]:g.alias;for(const Se of ce)ae.push($d(gt({},K,{components:I?I.record.components:K.components,path:Se,aliasOf:I?I.record:K})))}let oe,te;for(const ce of ae){const{path:Se}=ce;if(w&&Se[0]!=="/"){const Pe=w.record.path,D=Pe[Pe.length-1]==="/"?"":"/";ce.path=w.record.path+(Se&&D+Se)}if(oe=Qb(ce,w,J),I?I.alias.push(oe):(te=te||oe,te!==oe&&te.alias.push(oe),L&&g.name&&!zd(oe)&&o(g.name)),Qg(oe)&&l(oe),K.children){const Pe=K.children;for(let D=0;D<Pe.length;D++)s(Pe[D],oe,I&&I.children[D])}I=I||oe}return te?()=>{o(te)}:ka}function o(g){if(Gg(g)){const w=r.get(g);w&&(r.delete(g),t.splice(t.indexOf(w),1),w.children.forEach(o),w.alias.forEach(o))}else{const w=t.indexOf(g);w>-1&&(t.splice(w,1),g.record.name&&r.delete(g.record.name),g.children.forEach(o),g.alias.forEach(o))}}function u(){return t}function l(g){const w=Zb(g,t);t.splice(w,0,g),g.record.name&&!zd(g)&&r.set(g.record.name,g)}function f(g,w){let I,L={},K,J;if("name"in g&&g.name){if(I=r.get(g.name),!I)throw Lo(1,{location:g});J=I.record.name,L=gt(Kd(w.params,I.keys.filter(te=>!te.optional).concat(I.parent?I.parent.keys.filter(te=>te.optional):[]).map(te=>te.name)),g.params&&Kd(g.params,I.keys.map(te=>te.name))),K=I.stringify(L)}else if(g.path!=null)K=g.path,I=t.find(te=>te.re.test(K)),I&&(L=I.parse(K),J=I.record.name);else{if(I=w.name?r.get(w.name):t.find(te=>te.re.test(w.path)),!I)throw Lo(1,{location:g,currentLocation:w});J=I.record.name,L=gt({},w.params,g.params),K=I.stringify(L)}const ae=[];let oe=I;for(;oe;)ae.unshift(oe.record),oe=oe.parent;return{name:J,path:K,params:L,matched:ae,meta:Xb(ae)}}n.forEach(g=>s(g));function m(){t.length=0,r.clear()}return{addRoute:s,resolve:f,removeRoute:o,clearRoutes:m,getRoutes:u,getRecordMatcher:i}}function Kd(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function $d(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:Jb(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Jb(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function zd(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function Xb(n){return n.reduce((e,t)=>gt(e,t.meta),{})}function Gd(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function Zb(n,e){let t=0,r=e.length;for(;t!==r;){const s=t+r>>1;Wg(n,e[s])<0?r=s:t=s+1}const i=eI(n);return i&&(r=e.lastIndexOf(i,r-1)),r}function eI(n){let e=n;for(;e=e.parent;)if(Qg(e)&&Wg(n,e)===0)return e}function Qg({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function tI(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(jg," "),o=s.indexOf("="),u=Ga(o<0?s:s.slice(0,o)),l=o<0?null:Ga(s.slice(o+1));if(u in e){let f=e[u];wr(f)||(f=e[u]=[f]),f.push(l)}else e[u]=l}return e}function Hd(n){let e="";for(let t in n){const r=n[t];if(t=Eb(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(wr(r)?r.map(s=>s&&ah(s)):[r&&ah(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function nI(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=wr(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const rI=Symbol(""),Wd=Symbol(""),$c=Symbol(""),uf=Symbol(""),ch=Symbol("");function ma(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ki(n,e,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((u,l)=>{const f=w=>{w===!1?l(Lo(4,{from:t,to:e})):w instanceof Error?l(w):Ub(w)?l(Lo(2,{from:e,to:w})):(o&&r.enterCallbacks[i]===o&&typeof w=="function"&&o.push(w),u())},m=s(()=>n.call(r&&r.instances[i],e,t,f));let g=Promise.resolve(m);n.length<3&&(g=g.then(f)),g.catch(w=>l(w))})}function Nl(n,e,t,r,i=s=>s()){const s=[];for(const o of n)for(const u in o.components){let l=o.components[u];if(!(e!=="beforeRouteEnter"&&!o.instances[u]))if(Lg(l)){const m=(l.__vccOpts||l)[e];m&&s.push(ki(m,t,r,o,u,i))}else{let f=l();s.push(()=>f.then(m=>{if(!m)throw new Error(`Couldn't resolve component "${u}" at "${o.path}"`);const g=lb(m)?m.default:m;o.mods[u]=m,o.components[u]=g;const I=(g.__vccOpts||g)[e];return I&&ki(I,t,r,o,u,i)()}))}}return s}function Qd(n){const e=rr($c),t=rr(uf),r=Zn(()=>{const l=Ps(n.to);return e.resolve(l)}),i=Zn(()=>{const{matched:l}=r.value,{length:f}=l,m=l[f-1],g=t.matched;if(!m||!g.length)return-1;const w=g.findIndex(Fo.bind(null,m));if(w>-1)return w;const I=Yd(l[f-2]);return f>1&&Yd(m)===I&&g[g.length-1].path!==I?g.findIndex(Fo.bind(null,l[f-2])):w}),s=Zn(()=>i.value>-1&&aI(t.params,r.value.params)),o=Zn(()=>i.value>-1&&i.value===t.matched.length-1&&$g(t.params,r.value.params));function u(l={}){return oI(l)?e[Ps(n.replace)?"replace":"push"](Ps(n.to)).catch(ka):Promise.resolve()}return{route:r,href:Zn(()=>r.value.href),isActive:s,isExactActive:o,navigate:u}}const iI=Mc({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Qd,setup(n,{slots:e}){const t=cu(Qd(n)),{options:r}=rr($c),i=Zn(()=>({[Jd(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Jd(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return n.custom?s:of("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),sI=iI;function oI(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function aI(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!wr(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function Yd(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Jd=(n,e,t)=>n??e??t,uI=Mc({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=rr(ch),i=Zn(()=>n.route||r.value),s=rr(Wd,0),o=Zn(()=>{let f=Ps(s);const{matched:m}=i.value;let g;for(;(g=m[f])&&!g.components;)f++;return f}),u=Zn(()=>i.value.matched[o.value]);Gu(Wd,Zn(()=>o.value+1)),Gu(rI,u),Gu(ch,i);const l=nr();return Vo(()=>[l.value,u.value,n.name],([f,m,g],[w,I,L])=>{m&&(m.instances[g]=f,I&&I!==m&&f&&f===w&&(m.leaveGuards.size||(m.leaveGuards=I.leaveGuards),m.updateGuards.size||(m.updateGuards=I.updateGuards))),f&&m&&(!I||!Fo(m,I)||!w)&&(m.enterCallbacks[g]||[]).forEach(K=>K(f))},{flush:"post"}),()=>{const f=i.value,m=n.name,g=u.value,w=g&&g.components[m];if(!w)return Xd(t.default,{Component:w,route:f});const I=g.props[m],L=I?I===!0?f.params:typeof I=="function"?I(f):I:null,J=of(w,gt({},L,e,{onVnodeUnmounted:ae=>{ae.component.isUnmounted&&(g.instances[m]=null)},ref:l}));return Xd(t.default,{Component:J,route:f})||J}}});function Xd(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const cI=uI;function lI(n){const e=Yb(n.routes,n),t=n.parseQuery||tI,r=n.stringifyQuery||Hd,i=n.history,s=ma(),o=ma(),u=ma(),l=Gv(Ai);let f=Ai;Io&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const m=kl.bind(null,re=>""+re),g=kl.bind(null,Ib),w=kl.bind(null,Ga);function I(re,xe){let ee,Ve;return Gg(re)?(ee=e.getRecordMatcher(re),Ve=xe):Ve=re,e.addRoute(Ve,ee)}function L(re){const xe=e.getRecordMatcher(re);xe&&e.removeRoute(xe)}function K(){return e.getRoutes().map(re=>re.record)}function J(re){return!!e.getRecordMatcher(re)}function ae(re,xe){if(xe=gt({},xe||l.value),typeof re=="string"){const C=Ol(t,re,xe.path),W=e.resolve({path:C.path},xe),ue=i.createHref(C.fullPath);return gt(C,W,{params:w(W.params),hash:Ga(C.hash),redirectedFrom:void 0,href:ue})}let ee;if(re.path!=null)ee=gt({},re,{path:Ol(t,re.path,xe.path).path});else{const C=gt({},re.params);for(const W in C)C[W]==null&&delete C[W];ee=gt({},re,{params:g(C)}),xe.params=g(xe.params)}const Ve=e.resolve(ee,xe),Qe=re.hash||"";Ve.params=m(w(Ve.params));const Le=Sb(r,gt({},re,{hash:wb(Qe),path:Ve.path})),R=i.createHref(Le);return gt({fullPath:Le,hash:Qe,query:r===Hd?nI(re.query):re.query||{}},Ve,{redirectedFrom:void 0,href:R})}function oe(re){return typeof re=="string"?Ol(t,re,l.value.path):gt({},re)}function te(re,xe){if(f!==re)return Lo(8,{from:xe,to:re})}function ce(re){return D(re)}function Se(re){return ce(gt(oe(re),{replace:!0}))}function Pe(re){const xe=re.matched[re.matched.length-1];if(xe&&xe.redirect){const{redirect:ee}=xe;let Ve=typeof ee=="function"?ee(re):ee;return typeof Ve=="string"&&(Ve=Ve.includes("?")||Ve.includes("#")?Ve=oe(Ve):{path:Ve},Ve.params={}),gt({query:re.query,hash:re.hash,params:Ve.path!=null?{}:re.params},Ve)}}function D(re,xe){const ee=f=ae(re),Ve=l.value,Qe=re.state,Le=re.force,R=re.replace===!0,C=Pe(ee);if(C)return D(gt(oe(C),{state:typeof C=="object"?gt({},Qe,C.state):Qe,force:Le,replace:R}),xe||ee);const W=ee;W.redirectedFrom=xe;let ue;return!Le&&Rb(r,Ve,ee)&&(ue=Lo(16,{to:W,from:Ve}),hn(Ve,Ve,!0,!1)),(ue?Promise.resolve(ue):V(W,Ve)).catch(se=>ei(se)?ei(se,2)?se:Ft(se):ze(se,W,Ve)).then(se=>{if(se){if(ei(se,2))return D(gt({replace:R},oe(se.to),{state:typeof se.to=="object"?gt({},Qe,se.to.state):Qe,force:Le}),xe||W)}else se=k(W,Ve,!0,R,Qe);return N(W,Ve,se),se})}function S(re,xe){const ee=te(re,xe);return ee?Promise.reject(ee):Promise.resolve()}function A(re){const xe=ar.values().next().value;return xe&&typeof xe.runWithContext=="function"?xe.runWithContext(re):re()}function V(re,xe){let ee;const[Ve,Qe,Le]=hI(re,xe);ee=Nl(Ve.reverse(),"beforeRouteLeave",re,xe);for(const C of Ve)C.leaveGuards.forEach(W=>{ee.push(ki(W,re,xe))});const R=S.bind(null,re,xe);return ee.push(R),Lt(ee).then(()=>{ee=[];for(const C of s.list())ee.push(ki(C,re,xe));return ee.push(R),Lt(ee)}).then(()=>{ee=Nl(Qe,"beforeRouteUpdate",re,xe);for(const C of Qe)C.updateGuards.forEach(W=>{ee.push(ki(W,re,xe))});return ee.push(R),Lt(ee)}).then(()=>{ee=[];for(const C of Le)if(C.beforeEnter)if(wr(C.beforeEnter))for(const W of C.beforeEnter)ee.push(ki(W,re,xe));else ee.push(ki(C.beforeEnter,re,xe));return ee.push(R),Lt(ee)}).then(()=>(re.matched.forEach(C=>C.enterCallbacks={}),ee=Nl(Le,"beforeRouteEnter",re,xe,A),ee.push(R),Lt(ee))).then(()=>{ee=[];for(const C of o.list())ee.push(ki(C,re,xe));return ee.push(R),Lt(ee)}).catch(C=>ei(C,8)?C:Promise.reject(C))}function N(re,xe,ee){u.list().forEach(Ve=>A(()=>Ve(re,xe,ee)))}function k(re,xe,ee,Ve,Qe){const Le=te(re,xe);if(Le)return Le;const R=xe===Ai,C=Io?history.state:{};ee&&(Ve||R?i.replace(re.fullPath,gt({scroll:R&&C&&C.scroll},Qe)):i.push(re.fullPath,Qe)),l.value=re,hn(re,xe,ee,R),Ft()}let P;function lt(){P||(P=i.listen((re,xe,ee)=>{if(!En.listening)return;const Ve=ae(re),Qe=Pe(Ve);if(Qe){D(gt(Qe,{replace:!0}),Ve).catch(ka);return}f=Ve;const Le=l.value;Io&&Nb(Ld(Le.fullPath,ee.delta),Kc()),V(Ve,Le).catch(R=>ei(R,12)?R:ei(R,2)?(D(R.to,Ve).then(C=>{ei(C,20)&&!ee.delta&&ee.type===Ha.pop&&i.go(-1,!1)}).catch(ka),Promise.reject()):(ee.delta&&i.go(-ee.delta,!1),ze(R,Ve,Le))).then(R=>{R=R||k(Ve,Le,!1),R&&(ee.delta&&!ei(R,8)?i.go(-ee.delta,!1):ee.type===Ha.pop&&ei(R,20)&&i.go(-1,!1)),N(Ve,Le,R)}).catch(ka)}))}let Vt=ma(),ct=ma(),Ue;function ze(re,xe,ee){Ft(re);const Ve=ct.list();return Ve.length?Ve.forEach(Qe=>Qe(re,xe,ee)):console.error(re),Promise.reject(re)}function $t(){return Ue&&l.value!==Ai?Promise.resolve():new Promise((re,xe)=>{Vt.add([re,xe])})}function Ft(re){return Ue||(Ue=!re,lt(),Vt.list().forEach(([xe,ee])=>re?ee(re):xe()),Vt.reset()),re}function hn(re,xe,ee,Ve){const{scrollBehavior:Qe}=n;if(!Io||!Qe)return Promise.resolve();const Le=!ee&&Mb(Ld(re.fullPath,0))||(Ve||!ee)&&history.state&&history.state.scroll||null;return Jh().then(()=>Qe(re,xe,Le)).then(R=>R&&Ob(R)).catch(R=>ze(R,re,xe))}const At=re=>i.go(re);let ft;const ar=new Set,En={currentRoute:l,listening:!0,addRoute:I,removeRoute:L,clearRoutes:e.clearRoutes,hasRoute:J,getRoutes:K,resolve:ae,options:n,push:ce,replace:Se,go:At,back:()=>At(-1),forward:()=>At(1),beforeEach:s.add,beforeResolve:o.add,afterEach:u.add,onError:ct.add,isReady:$t,install(re){const xe=this;re.component("RouterLink",sI),re.component("RouterView",cI),re.config.globalProperties.$router=xe,Object.defineProperty(re.config.globalProperties,"$route",{enumerable:!0,get:()=>Ps(l)}),Io&&!ft&&l.value===Ai&&(ft=!0,ce(i.location).catch(Qe=>{}));const ee={};for(const Qe in Ai)Object.defineProperty(ee,Qe,{get:()=>l.value[Qe],enumerable:!0});re.provide($c,xe),re.provide(uf,Gm(ee)),re.provide(ch,l);const Ve=re.unmount;ar.add(re),re.unmount=function(){ar.delete(re),ar.size<1&&(f=Ai,P&&P(),P=null,l.value=Ai,ft=!1,Ue=!1),Ve()}}};function Lt(re){return re.reduce((xe,ee)=>xe.then(()=>A(ee)),Promise.resolve())}return En}function hI(n,e){const t=[],r=[],i=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const u=e.matched[o];u&&(n.matched.find(f=>Fo(f,u))?r.push(u):t.push(u));const l=n.matched[o];l&&(e.matched.find(f=>Fo(f,l))||i.push(l))}return[t,r,i]}function XR(){return rr($c)}function ZR(n){return rr(uf)}const Yg=lI({history:jb(),routes:[{path:"/login",name:"Login",component:()=>bo(()=>import("./Login-D3B3jRms.js"),__vite__mapDeps([0,1,2])),meta:{hideBottomNav:!0,requiresAuth:!1}},{path:"/",component:()=>bo(()=>import("./Home-BZYxxMMQ.js"),__vite__mapDeps([3,1,4])),meta:{requiresAuth:!0}},{path:"/home",redirect:"/",meta:{requiresAuth:!0}},{path:"/pomodoro",component:()=>bo(()=>import("./Pomodoro-cbIl1dkd.js"),__vite__mapDeps([5,1,6])),meta:{requiresAuth:!0}},{path:"/tasks",component:()=>bo(()=>import("./Tasks-DZlFyIoJ.js"),__vite__mapDeps([7,8])),meta:{requiresAuth:!0}},{path:"/journal",component:()=>bo(()=>import("./Journal-D216jYl5.js"),__vite__mapDeps([9,1,10])),meta:{requiresAuth:!0}}]});Yg.beforeEach((n,e,t)=>{const r=localStorage.getItem("isAuthenticated")==="true";n.meta.requiresAuth&&!r?t("/login"):n.path==="/login"&&r?t("/"):t()});var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Jg={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Zd,function(){var t=function(c,h){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,y){d.__proto__=y}||function(d,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(d[v]=y[v])})(c,h)},r=function(){return(r=Object.assign||function(c){for(var h,d=1,y=arguments.length;d<y;d++)for(var v in h=arguments[d])Object.prototype.hasOwnProperty.call(h,v)&&(c[v]=h[v]);return c}).apply(this,arguments)};function i(c,h,d){for(var y,v=0,E=h.length;v<E;v++)!y&&v in h||((y=y||Array.prototype.slice.call(h,0,v))[v]=h[v]);return c.concat(y||Array.prototype.slice.call(h))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Zd,o=Object.keys,u=Array.isArray;function l(c,h){return typeof h!="object"||o(h).forEach(function(d){c[d]=h[d]}),c}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var f=Object.getPrototypeOf,m={}.hasOwnProperty;function g(c,h){return m.call(c,h)}function w(c,h){typeof h=="function"&&(h=h(f(c))),(typeof Reflect>"u"?o:Reflect.ownKeys)(h).forEach(function(d){L(c,d,h[d])})}var I=Object.defineProperty;function L(c,h,d,y){I(c,h,l(d&&g(d,"get")&&typeof d.get=="function"?{get:d.get,set:d.set,configurable:!0}:{value:d,configurable:!0,writable:!0},y))}function K(c){return{from:function(h){return c.prototype=Object.create(h.prototype),L(c.prototype,"constructor",c),{extend:w.bind(null,c.prototype)}}}}var J=Object.getOwnPropertyDescriptor,ae=[].slice;function oe(c,h,d){return ae.call(c,h,d)}function te(c,h){return h(c)}function ce(c){if(!c)throw new Error("Assertion Failed")}function Se(c){s.setImmediate?setImmediate(c):setTimeout(c,0)}function Pe(c,h){if(typeof h=="string"&&g(c,h))return c[h];if(!h)return c;if(typeof h!="string"){for(var d=[],y=0,v=h.length;y<v;++y){var E=Pe(c,h[y]);d.push(E)}return d}var T=h.indexOf(".");if(T!==-1){var x=c[h.substr(0,T)];return x==null?void 0:Pe(x,h.substr(T+1))}}function D(c,h,d){if(c&&h!==void 0&&!("isFrozen"in Object&&Object.isFrozen(c)))if(typeof h!="string"&&"length"in h){ce(typeof d!="string"&&"length"in d);for(var y=0,v=h.length;y<v;++y)D(c,h[y],d[y])}else{var E,T,x=h.indexOf(".");x!==-1?(E=h.substr(0,x),(T=h.substr(x+1))===""?d===void 0?u(c)&&!isNaN(parseInt(E))?c.splice(E,1):delete c[E]:c[E]=d:D(x=!(x=c[E])||!g(c,E)?c[E]={}:x,T,d)):d===void 0?u(c)&&!isNaN(parseInt(h))?c.splice(h,1):delete c[h]:c[h]=d}}function S(c){var h,d={};for(h in c)g(c,h)&&(d[h]=c[h]);return d}var A=[].concat;function V(c){return A.apply([],c)}var Gn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(V([8,16,32,64].map(function(c){return["Int","Uint","Float"].map(function(h){return h+c+"Array"})}))).filter(function(c){return s[c]}),N=new Set(Gn.map(function(c){return s[c]})),k=null;function P(c){return k=new WeakMap,c=function h(d){if(!d||typeof d!="object")return d;var y=k.get(d);if(y)return y;if(u(d)){y=[],k.set(d,y);for(var v=0,E=d.length;v<E;++v)y.push(h(d[v]))}else if(N.has(d.constructor))y=d;else{var T,x=f(d);for(T in y=x===Object.prototype?{}:Object.create(x),k.set(d,y),d)g(d,T)&&(y[T]=h(d[T]))}return y}(c),k=null,c}var lt={}.toString;function Vt(c){return lt.call(c).slice(8,-1)}var ct=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ue=typeof ct=="symbol"?function(c){var h;return c!=null&&(h=c[ct])&&h.apply(c)}:function(){return null};function ze(c,h){return h=c.indexOf(h),0<=h&&c.splice(h,1),0<=h}var $t={};function Ft(c){var h,d,y,v;if(arguments.length===1){if(u(c))return c.slice();if(this===$t&&typeof c=="string")return[c];if(v=Ue(c)){for(d=[];!(y=v.next()).done;)d.push(y.value);return d}if(c==null)return[c];if(typeof(h=c.length)!="number")return[c];for(d=new Array(h);h--;)d[h]=c[h];return d}for(h=arguments.length,d=new Array(h);h--;)d[h]=arguments[h];return d}var hn=typeof Symbol<"u"?function(c){return c[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Oe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Oe),At={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ft(c,h){this.name=c,this.message=h}function ar(c,h){return c+". Errors: "+Object.keys(h).map(function(d){return h[d].toString()}).filter(function(d,y,v){return v.indexOf(d)===y}).join(`
`)}function En(c,h,d,y){this.failures=h,this.failedKeys=y,this.successCount=d,this.message=ar(c,h)}function Lt(c,h){this.name="BulkError",this.failures=Object.keys(h).map(function(d){return h[d]}),this.failuresByPos=h,this.message=ar(c,this.failures)}K(ft).from(Error).extend({toString:function(){return this.name+": "+this.message}}),K(En).from(ft),K(Lt).from(ft);var re=Yn.reduce(function(c,h){return c[h]=h+"Error",c},{}),xe=ft,ee=Yn.reduce(function(c,h){var d=h+"Error";function y(v,E){this.name=d,v?typeof v=="string"?(this.message="".concat(v).concat(E?`
 `+E:""),this.inner=E||null):typeof v=="object"&&(this.message="".concat(v.name," ").concat(v.message),this.inner=v):(this.message=At[h]||d,this.inner=null)}return K(y).from(xe),c[h]=y,c},{});ee.Syntax=SyntaxError,ee.Type=TypeError,ee.Range=RangeError;var Ve=Oe.reduce(function(c,h){return c[h+"Error"]=ee[h],c},{}),Qe=Yn.reduce(function(c,h){return["Syntax","Type","Range"].indexOf(h)===-1&&(c[h+"Error"]=ee[h]),c},{});function Le(){}function R(c){return c}function C(c,h){return c==null||c===R?h:function(d){return h(c(d))}}function W(c,h){return function(){c.apply(this,arguments),h.apply(this,arguments)}}function ue(c,h){return c===Le?h:function(){var d=c.apply(this,arguments);d!==void 0&&(arguments[0]=d);var y=this.onsuccess,v=this.onerror;this.onsuccess=null,this.onerror=null;var E=h.apply(this,arguments);return y&&(this.onsuccess=this.onsuccess?W(y,this.onsuccess):y),v&&(this.onerror=this.onerror?W(v,this.onerror):v),E!==void 0?E:d}}function se(c,h){return c===Le?h:function(){c.apply(this,arguments);var d=this.onsuccess,y=this.onerror;this.onsuccess=this.onerror=null,h.apply(this,arguments),d&&(this.onsuccess=this.onsuccess?W(d,this.onsuccess):d),y&&(this.onerror=this.onerror?W(y,this.onerror):y)}}function le(c,h){return c===Le?h:function(d){var y=c.apply(this,arguments);l(d,y);var v=this.onsuccess,E=this.onerror;return this.onsuccess=null,this.onerror=null,d=h.apply(this,arguments),v&&(this.onsuccess=this.onsuccess?W(v,this.onsuccess):v),E&&(this.onerror=this.onerror?W(E,this.onerror):E),y===void 0?d===void 0?void 0:d:l(y,d)}}function be(c,h){return c===Le?h:function(){return h.apply(this,arguments)!==!1&&c.apply(this,arguments)}}function ge(c,h){return c===Le?h:function(){var d=c.apply(this,arguments);if(d&&typeof d.then=="function"){for(var y=this,v=arguments.length,E=new Array(v);v--;)E[v]=arguments[v];return d.then(function(){return h.apply(y,E)})}return h.apply(this,arguments)}}Qe.ModifyError=En,Qe.DexieError=ft,Qe.BulkError=Lt;var fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function he(c){fe=c}var Me={},Te=100,Gn=typeof Promise>"u"?[]:function(){var c=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[c,f(c),c];var h=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[h,f(h),c]}(),Oe=Gn[0],Yn=Gn[1],Gn=Gn[2],Yn=Yn&&Yn.then,Ce=Oe&&Oe.constructor,Be=!!Gn,tt=function(c,h){jt.push([c,h]),Bt&&(queueMicrotask(zs),Bt=!1)},nt=!0,Bt=!0,bt=[],Nt=[],zt=R,on={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Le,pgp:!1,env:{},finalize:Le},ke=on,jt=[],Gt=0,ur=[];function Ae(c){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var h=this._PSD=ke;if(typeof c!="function"){if(c!==Me)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ji(this,this._value))}this._state=null,this._value=null,++h.ref,function d(y,v){try{v(function(E){if(y._state===null){if(E===y)throw new TypeError("A promise cannot be resolved with itself.");var T=y._lib&&Lr();E&&typeof E.then=="function"?d(y,function(x,M){E instanceof Ae?E._then(x,M):E.then(x,M)}):(y._state=!0,y._value=E,$s(y)),T&&Kn()}},Ji.bind(null,y))}catch(E){Ji(y,E)}}(this,c)}var Ks={get:function(){var c=ke,h=lr;function d(y,v){var E=this,T=!c.global&&(c!==ke||h!==lr),x=T&&!fr(),M=new Ae(function(B,q){cr(E,new pi(Ys(y,c,T,x),Ys(v,c,T,x),B,q,c))});return this._consoleTask&&(M._consoleTask=this._consoleTask),M}return d.prototype=Me,d},set:function(c){L(this,"then",c&&c.prototype===Me?Ks:{get:function(){return c},set:Ks.set})}};function pi(c,h,d,y,v){this.onFulfilled=typeof c=="function"?c:null,this.onRejected=typeof h=="function"?h:null,this.resolve=d,this.reject=y,this.psd=v}function Ji(c,h){var d,y;Nt.push(h),c._state===null&&(d=c._lib&&Lr(),h=zt(h),c._state=!1,c._value=h,y=c,bt.some(function(v){return v._value===y._value})||bt.push(y),$s(c),d&&Kn())}function $s(c){var h=c._listeners;c._listeners=[];for(var d=0,y=h.length;d<y;++d)cr(c,h[d]);var v=c._PSD;--v.ref||v.finalize(),Gt===0&&(++Gt,tt(function(){--Gt==0&&Gs()},[]))}function cr(c,h){if(c._state!==null){var d=c._state?h.onFulfilled:h.onRejected;if(d===null)return(c._state?h.resolve:h.reject)(c._value);++h.psd.ref,++Gt,tt(Eu,[d,c,h])}else c._listeners.push(h)}function Eu(c,h,d){try{var y,v=h._value;!h._state&&Nt.length&&(Nt=[]),y=fe&&h._consoleTask?h._consoleTask.run(function(){return c(v)}):c(v),h._state||Nt.indexOf(v)!==-1||function(E){for(var T=bt.length;T;)if(bt[--T]._value===E._value)return bt.splice(T,1)}(h),d.resolve(y)}catch(E){d.reject(E)}finally{--Gt==0&&Gs(),--d.psd.ref||d.psd.finalize()}}function zs(){br(on,function(){Lr()&&Kn()})}function Lr(){var c=nt;return Bt=nt=!1,c}function Kn(){var c,h,d;do for(;0<jt.length;)for(c=jt,jt=[],d=c.length,h=0;h<d;++h){var y=c[h];y[0].apply(null,y[1])}while(0<jt.length);Bt=nt=!0}function Gs(){var c=bt;bt=[],c.forEach(function(y){y._PSD.onunhandled.call(null,y._value,y)});for(var h=ur.slice(0),d=h.length;d;)h[--d]()}function Ht(c){return new Ae(Me,!1,c)}function wt(c,h){var d=ke;return function(){var y=Lr(),v=ke;try{return an(d,!0),c.apply(this,arguments)}catch(E){h&&h(E)}finally{an(v,!1),y&&Kn()}}}w(Ae.prototype,{then:Ks,_then:function(c,h){cr(this,new pi(null,null,c,h,ke))},catch:function(c){if(arguments.length===1)return this.then(null,c);var h=c,d=arguments[1];return typeof h=="function"?this.then(null,function(y){return(y instanceof h?d:Ht)(y)}):this.then(null,function(y){return(y&&y.name===h?d:Ht)(y)})},finally:function(c){return this.then(function(h){return Ae.resolve(c()).then(function(){return h})},function(h){return Ae.resolve(c()).then(function(){return Ht(h)})})},timeout:function(c,h){var d=this;return c<1/0?new Ae(function(y,v){var E=setTimeout(function(){return v(new ee.Timeout(h))},c);d.then(y,v).finally(clearTimeout.bind(null,E))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&L(Ae.prototype,Symbol.toStringTag,"Dexie.Promise"),on.env=Zo(),w(Ae,{all:function(){var c=Ft.apply(null,arguments).map(mi);return new Ae(function(h,d){c.length===0&&h([]);var y=c.length;c.forEach(function(v,E){return Ae.resolve(v).then(function(T){c[E]=T,--y||h(c)},d)})})},resolve:function(c){return c instanceof Ae?c:c&&typeof c.then=="function"?new Ae(function(h,d){c.then(h,d)}):new Ae(Me,!0,c)},reject:Ht,race:function(){var c=Ft.apply(null,arguments).map(mi);return new Ae(function(h,d){c.map(function(y){return Ae.resolve(y).then(h,d)})})},PSD:{get:function(){return ke},set:function(c){return ke=c}},totalEchoes:{get:function(){return lr}},newPSD:Er,usePSD:br,scheduler:{get:function(){return tt},set:function(c){tt=c}},rejectionMapper:{get:function(){return zt},set:function(c){zt=c}},follow:function(c,h){return new Ae(function(d,y){return Er(function(v,E){var T=ke;T.unhandleds=[],T.onunhandled=E,T.finalize=W(function(){var x,M=this;x=function(){M.unhandleds.length===0?v():E(M.unhandleds[0])},ur.push(function B(){x(),ur.splice(ur.indexOf(B),1)}),++Gt,tt(function(){--Gt==0&&Gs()},[])},T.finalize),c()},h,d,y)})}}),Ce&&(Ce.allSettled&&L(Ae,"allSettled",function(){var c=Ft.apply(null,arguments).map(mi);return new Ae(function(h){c.length===0&&h([]);var d=c.length,y=new Array(d);c.forEach(function(v,E){return Ae.resolve(v).then(function(T){return y[E]={status:"fulfilled",value:T}},function(T){return y[E]={status:"rejected",reason:T}}).then(function(){return--d||h(y)})})})}),Ce.any&&typeof AggregateError<"u"&&L(Ae,"any",function(){var c=Ft.apply(null,arguments).map(mi);return new Ae(function(h,d){c.length===0&&d(new AggregateError([]));var y=c.length,v=new Array(y);c.forEach(function(E,T){return Ae.resolve(E).then(function(x){return h(x)},function(x){v[T]=x,--y||d(new AggregateError(v))})})})}),Ce.withResolvers&&(Ae.withResolvers=Ce.withResolvers));var Rt={awaits:0,echoes:0,id:0},Xi=0,Hs=[],Ws=0,lr=0,fl=0;function Er(c,h,d,y){var v=ke,E=Object.create(v);return E.parent=v,E.ref=0,E.global=!1,E.id=++fl,on.env,E.env=Be?{Promise:Ae,PromiseProp:{value:Ae,configurable:!0,writable:!0},all:Ae.all,race:Ae.race,allSettled:Ae.allSettled,any:Ae.any,resolve:Ae.resolve,reject:Ae.reject}:{},h&&l(E,h),++v.ref,E.finalize=function(){--this.parent.ref||this.parent.finalize()},y=br(E,c,d,y),E.ref===0&&E.finalize(),y}function hr(){return Rt.id||(Rt.id=++Xi),++Rt.awaits,Rt.echoes+=Te,Rt.id}function fr(){return!!Rt.awaits&&(--Rt.awaits==0&&(Rt.id=0),Rt.echoes=Rt.awaits*Te,!0)}function mi(c){return Rt.echoes&&c&&c.constructor===Ce?(hr(),c.then(function(h){return fr(),h},function(h){return fr(),Pt(h)})):c}function Qs(){var c=Hs[Hs.length-1];Hs.pop(),an(c,!1)}function an(c,h){var d,y=ke;(h?!Rt.echoes||Ws++&&c===ke:!Ws||--Ws&&c===ke)||queueMicrotask(h?(function(v){++lr,Rt.echoes&&--Rt.echoes!=0||(Rt.echoes=Rt.awaits=Rt.id=0),Hs.push(ke),an(v,!0)}).bind(null,c):Qs),c!==ke&&(ke=c,y===on&&(on.env=Zo()),Be&&(d=on.env.Promise,h=c.env,(y.global||c.global)&&(Object.defineProperty(s,"Promise",h.PromiseProp),d.all=h.all,d.race=h.race,d.resolve=h.resolve,d.reject=h.reject,h.allSettled&&(d.allSettled=h.allSettled),h.any&&(d.any=h.any))))}function Zo(){var c=s.Promise;return Be?{Promise:c,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:c.all,race:c.race,allSettled:c.allSettled,any:c.any,resolve:c.resolve,reject:c.reject}:{}}function br(c,h,d,y,v){var E=ke;try{return an(c,!0),h(d,y,v)}finally{an(E,!1)}}function Ys(c,h,d,y){return typeof c!="function"?c:function(){var v=ke;d&&hr(),an(h,!0);try{return c.apply(this,arguments)}finally{an(v,!1),y&&queueMicrotask(fr)}}}function Zi(c){Promise===Ce&&Rt.echoes===0?Ws===0?c():enqueueNativeMicroTask(c):setTimeout(c,0)}(""+Yn).indexOf("[native code]")===-1&&(hr=fr=Le);var Pt=Ae.reject,Ir="￿",dr="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",es="String expected.",Br=[],gi="__dbnames",jr="readonly",pr="readwrite";function mr(c,h){return c?h?function(){return c.apply(this,arguments)&&h.apply(this,arguments)}:c:h}var bu={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ts(c){return typeof c!="string"||/\./.test(c)?function(h){return h}:function(h){return h[c]===void 0&&c in h&&delete(h=P(h))[c],h}}function ea(){throw ee.Type()}function Je(c,h){try{var d=Js(c),y=Js(h);if(d!==y)return d==="Array"?1:y==="Array"?-1:d==="binary"?1:y==="binary"?-1:d==="string"?1:y==="string"?-1:d==="Date"?1:y!=="Date"?NaN:-1;switch(d){case"number":case"Date":case"string":return h<c?1:c<h?-1:0;case"binary":return function(v,E){for(var T=v.length,x=E.length,M=T<x?T:x,B=0;B<M;++B)if(v[B]!==E[B])return v[B]<E[B]?-1:1;return T===x?0:T<x?-1:1}(Xs(c),Xs(h));case"Array":return function(v,E){for(var T=v.length,x=E.length,M=T<x?T:x,B=0;B<M;++B){var q=Je(v[B],E[B]);if(q!==0)return q}return T===x?0:T<x?-1:1}(c,h)}}catch{}return NaN}function Js(c){var h=typeof c;return h!="object"?h:ArrayBuffer.isView(c)?"binary":(c=Vt(c),c==="ArrayBuffer"?"binary":c)}function Xs(c){return c instanceof Uint8Array?c:ArrayBuffer.isView(c)?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c)}var ta=(_t.prototype._trans=function(c,h,d){var y=this._tx||ke.trans,v=this.name,E=fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(c==="readonly"?"read":"write"," ").concat(this.name));function T(B,q,O){if(!O.schema[v])throw new ee.NotFound("Table "+v+" not part of transaction");return h(O.idbtrans,O)}var x=Lr();try{var M=y&&y.db._novip===this.db._novip?y===ke.trans?y._promise(c,T,d):Er(function(){return y._promise(c,T,d)},{trans:y,transless:ke.transless||ke}):function B(q,O,z,F){if(q.idbdb&&(q._state.openComplete||ke.letThrough||q._vip)){var U=q._createTransaction(O,z,q._dbSchema);try{U.create(),q._state.PR1398_maxLoop=3}catch($){return $.name===re.InvalidState&&q.isOpen()&&0<--q._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),q.close({disableAutoOpen:!1}),q.open().then(function(){return B(q,O,z,F)})):Pt($)}return U._promise(O,function($,j){return Er(function(){return ke.trans=U,F($,j,U)})}).then(function($){if(O==="readwrite")try{U.idbtrans.commit()}catch{}return O==="readonly"?$:U._completion.then(function(){return $})})}if(q._state.openComplete)return Pt(new ee.DatabaseClosed(q._state.dbOpenError));if(!q._state.isBeingOpened){if(!q._state.autoOpen)return Pt(new ee.DatabaseClosed);q.open().catch(Le)}return q._state.dbReadyPromise.then(function(){return B(q,O,z,F)})}(this.db,c,[this.name],T);return E&&(M._consoleTask=E,M=M.catch(function(B){return console.trace(B),Pt(B)})),M}finally{x&&Kn()}},_t.prototype.get=function(c,h){var d=this;return c&&c.constructor===Object?this.where(c).first(h):c==null?Pt(new ee.Type("Invalid argument to Table.get()")):this._trans("readonly",function(y){return d.core.get({trans:y,key:c}).then(function(v){return d.hook.reading.fire(v)})}).then(h)},_t.prototype.where=function(c){if(typeof c=="string")return new this.db.WhereClause(this,c);if(u(c))return new this.db.WhereClause(this,"[".concat(c.join("+"),"]"));var h=o(c);if(h.length===1)return this.where(h[0]).equals(c[h[0]]);var d=this.schema.indexes.concat(this.schema.primKey).filter(function(x){if(x.compound&&h.every(function(B){return 0<=x.keyPath.indexOf(B)})){for(var M=0;M<h.length;++M)if(h.indexOf(x.keyPath[M])===-1)return!1;return!0}return!1}).sort(function(x,M){return x.keyPath.length-M.keyPath.length})[0];if(d&&this.db._maxKey!==Ir){var E=d.keyPath.slice(0,h.length);return this.where(E).equals(E.map(function(M){return c[M]}))}!d&&fe&&console.warn("The query ".concat(JSON.stringify(c)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(h.join("+"),"]"));var y=this.schema.idxByName;function v(x,M){return Je(x,M)===0}var T=h.reduce(function(O,M){var B=O[0],q=O[1],O=y[M],z=c[M];return[B||O,B||!O?mr(q,O&&O.multi?function(F){return F=Pe(F,M),u(F)&&F.some(function(U){return v(z,U)})}:function(F){return v(z,Pe(F,M))}):q]},[null,null]),E=T[0],T=T[1];return E?this.where(E.name).equals(c[E.keyPath]).filter(T):d?this.filter(T):this.where(h).equals("")},_t.prototype.filter=function(c){return this.toCollection().and(c)},_t.prototype.count=function(c){return this.toCollection().count(c)},_t.prototype.offset=function(c){return this.toCollection().offset(c)},_t.prototype.limit=function(c){return this.toCollection().limit(c)},_t.prototype.each=function(c){return this.toCollection().each(c)},_t.prototype.toArray=function(c){return this.toCollection().toArray(c)},_t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},_t.prototype.orderBy=function(c){return new this.db.Collection(new this.db.WhereClause(this,u(c)?"[".concat(c.join("+"),"]"):c))},_t.prototype.reverse=function(){return this.toCollection().reverse()},_t.prototype.mapToClass=function(c){var h,d=this.db,y=this.name;function v(){return h!==null&&h.apply(this,arguments)||this}(this.schema.mappedClass=c).prototype instanceof ea&&(function(M,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function q(){this.constructor=M}t(M,B),M.prototype=B===null?Object.create(B):(q.prototype=B.prototype,new q)}(v,h=c),Object.defineProperty(v.prototype,"db",{get:function(){return d},enumerable:!1,configurable:!0}),v.prototype.table=function(){return y},c=v);for(var E=new Set,T=c.prototype;T;T=f(T))Object.getOwnPropertyNames(T).forEach(function(M){return E.add(M)});function x(M){if(!M)return M;var B,q=Object.create(c.prototype);for(B in M)if(!E.has(B))try{q[B]=M[B]}catch{}return q}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=x,this.hook("reading",x),c},_t.prototype.defineClass=function(){return this.mapToClass(function(c){l(this,c)})},_t.prototype.add=function(c,h){var d=this,y=this.schema.primKey,v=y.auto,E=y.keyPath,T=c;return E&&v&&(T=ts(E)(c)),this._trans("readwrite",function(x){return d.core.mutate({trans:x,type:"add",keys:h!=null?[h]:null,values:[T]})}).then(function(x){return x.numFailures?Ae.reject(x.failures[0]):x.lastResult}).then(function(x){if(E)try{D(c,E,x)}catch{}return x})},_t.prototype.update=function(c,h){return typeof c!="object"||u(c)?this.where(":id").equals(c).modify(h):(c=Pe(c,this.schema.primKey.keyPath),c===void 0?Pt(new ee.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(h))},_t.prototype.put=function(c,h){var d=this,y=this.schema.primKey,v=y.auto,E=y.keyPath,T=c;return E&&v&&(T=ts(E)(c)),this._trans("readwrite",function(x){return d.core.mutate({trans:x,type:"put",values:[T],keys:h!=null?[h]:null})}).then(function(x){return x.numFailures?Ae.reject(x.failures[0]):x.lastResult}).then(function(x){if(E)try{D(c,E,x)}catch{}return x})},_t.prototype.delete=function(c){var h=this;return this._trans("readwrite",function(d){return h.core.mutate({trans:d,type:"delete",keys:[c]})}).then(function(d){return d.numFailures?Ae.reject(d.failures[0]):void 0})},_t.prototype.clear=function(){var c=this;return this._trans("readwrite",function(h){return c.core.mutate({trans:h,type:"deleteRange",range:bu})}).then(function(h){return h.numFailures?Ae.reject(h.failures[0]):void 0})},_t.prototype.bulkGet=function(c){var h=this;return this._trans("readonly",function(d){return h.core.getMany({keys:c,trans:d}).then(function(y){return y.map(function(v){return h.hook.reading.fire(v)})})})},_t.prototype.bulkAdd=function(c,h,d){var y=this,v=Array.isArray(h)?h:void 0,E=(d=d||(v?void 0:h))?d.allKeys:void 0;return this._trans("readwrite",function(T){var B=y.schema.primKey,x=B.auto,B=B.keyPath;if(B&&v)throw new ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(v&&v.length!==c.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var M=c.length,B=B&&x?c.map(ts(B)):c;return y.core.mutate({trans:T,type:"add",keys:v,values:B,wantResults:E}).then(function(U){var O=U.numFailures,z=U.results,F=U.lastResult,U=U.failures;if(O===0)return E?z:F;throw new Lt("".concat(y.name,".bulkAdd(): ").concat(O," of ").concat(M," operations failed"),U)})})},_t.prototype.bulkPut=function(c,h,d){var y=this,v=Array.isArray(h)?h:void 0,E=(d=d||(v?void 0:h))?d.allKeys:void 0;return this._trans("readwrite",function(T){var B=y.schema.primKey,x=B.auto,B=B.keyPath;if(B&&v)throw new ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(v&&v.length!==c.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var M=c.length,B=B&&x?c.map(ts(B)):c;return y.core.mutate({trans:T,type:"put",keys:v,values:B,wantResults:E}).then(function(U){var O=U.numFailures,z=U.results,F=U.lastResult,U=U.failures;if(O===0)return E?z:F;throw new Lt("".concat(y.name,".bulkPut(): ").concat(O," of ").concat(M," operations failed"),U)})})},_t.prototype.bulkUpdate=function(c){var h=this,d=this.core,y=c.map(function(T){return T.key}),v=c.map(function(T){return T.changes}),E=[];return this._trans("readwrite",function(T){return d.getMany({trans:T,keys:y,cache:"clone"}).then(function(x){var M=[],B=[];c.forEach(function(O,z){var F=O.key,U=O.changes,$=x[z];if($){for(var j=0,Q=Object.keys(U);j<Q.length;j++){var Y=Q[j],X=U[Y];if(Y===h.schema.primKey.keyPath){if(Je(X,F)!==0)throw new ee.Constraint("Cannot update primary key in bulkUpdate()")}else D($,Y,X)}E.push(z),M.push(F),B.push($)}});var q=M.length;return d.mutate({trans:T,type:"put",keys:M,values:B,updates:{keys:y,changeSpecs:v}}).then(function(O){var z=O.numFailures,F=O.failures;if(z===0)return q;for(var U=0,$=Object.keys(F);U<$.length;U++){var j,Q=$[U],Y=E[Number(Q)];Y!=null&&(j=F[Q],delete F[Q],F[Y]=j)}throw new Lt("".concat(h.name,".bulkUpdate(): ").concat(z," of ").concat(q," operations failed"),F)})})})},_t.prototype.bulkDelete=function(c){var h=this,d=c.length;return this._trans("readwrite",function(y){return h.core.mutate({trans:y,type:"delete",keys:c})}).then(function(T){var v=T.numFailures,E=T.lastResult,T=T.failures;if(v===0)return E;throw new Lt("".concat(h.name,".bulkDelete(): ").concat(v," of ").concat(d," operations failed"),T)})},_t);function _t(){}function ns(c){function h(T,x){if(x){for(var M=arguments.length,B=new Array(M-1);--M;)B[M-1]=arguments[M];return d[T].subscribe.apply(null,B),c}if(typeof T=="string")return d[T]}var d={};h.addEventType=E;for(var y=1,v=arguments.length;y<v;++y)E(arguments[y]);return h;function E(T,x,M){if(typeof T!="object"){var B;x=x||be;var q={subscribers:[],fire:M=M||Le,subscribe:function(O){q.subscribers.indexOf(O)===-1&&(q.subscribers.push(O),q.fire=x(q.fire,O))},unsubscribe:function(O){q.subscribers=q.subscribers.filter(function(z){return z!==O}),q.fire=q.subscribers.reduce(x,M)}};return d[T]=h[T]=q}o(B=T).forEach(function(O){var z=B[O];if(u(z))E(O,B[O][0],B[O][1]);else{if(z!=="asap")throw new ee.InvalidArgument("Invalid event config");var F=E(O,R,function(){for(var U=arguments.length,$=new Array(U);U--;)$[U]=arguments[U];F.subscribers.forEach(function(j){Se(function(){j.apply(null,$)})})})}})}}function rs(c,h){return K(h).from({prototype:c}),h}function Ur(c,h){return!(c.filter||c.algorithm||c.or)&&(h?c.justLimit:!c.replayFilter)}function Zs(c,h){c.filter=mr(c.filter,h)}function na(c,h,d){var y=c.replayFilter;c.replayFilter=y?function(){return mr(y(),h())}:h,c.justLimit=d&&!y}function $n(c,h){if(c.isPrimKey)return h.primaryKey;var d=h.getIndexByKeyPath(c.index);if(!d)throw new ee.Schema("KeyPath "+c.index+" on object store "+h.name+" is not indexed");return d}function zn(c,h,d){var y=$n(c,h.schema);return h.openCursor({trans:d,values:!c.keysOnly,reverse:c.dir==="prev",unique:!!c.unique,query:{index:y,range:c.range}})}function qr(c,h,d,y){var v=c.replayFilter?mr(c.filter,c.replayFilter()):c.filter;if(c.or){var E={},T=function(x,M,B){var q,O;v&&!v(M,B,function(z){return M.stop(z)},function(z){return M.fail(z)})||((O=""+(q=M.primaryKey))=="[object ArrayBuffer]"&&(O=""+new Uint8Array(q)),g(E,O)||(E[O]=!0,h(x,M,B)))};return Promise.all([c.or._iterate(T,d),is(zn(c,y,d),c.algorithm,T,!c.keysOnly&&c.valueMapper)])}return is(zn(c,y,d),mr(c.algorithm,v),h,!c.keysOnly&&c.valueMapper)}function is(c,h,d,y){var v=wt(y?function(E,T,x){return d(y(E),T,x)}:d);return c.then(function(E){if(E)return E.start(function(){var T=function(){return E.continue()};h&&!h(E,function(x){return T=x},function(x){E.stop(x),T=Le},function(x){E.fail(x),T=Le})||v(E.value,E,function(x){return T=x}),T()})})}var Gn=Symbol(),ht=(ss.prototype.execute=function(c){if(this.add!==void 0){var h=this.add;if(u(h))return i(i([],u(c)?c:[],!0),h).sort();if(typeof h=="number")return(Number(c)||0)+h;if(typeof h=="bigint")try{return BigInt(c)+h}catch{return BigInt(0)+h}throw new TypeError("Invalid term ".concat(h))}if(this.remove!==void 0){var d=this.remove;if(u(d))return u(c)?c.filter(function(y){return!d.includes(y)}).sort():[];if(typeof d=="number")return Number(c)-d;if(typeof d=="bigint")try{return BigInt(c)-d}catch{return BigInt(0)-d}throw new TypeError("Invalid subtrahend ".concat(d))}return h=(h=this.replacePrefix)===null||h===void 0?void 0:h[0],h&&typeof c=="string"&&c.startsWith(h)?this.replacePrefix[1]+c.substring(h.length):c},ss);function ss(c){Object.assign(this,c)}var os=(Xe.prototype._read=function(c,h){var d=this._ctx;return d.error?d.table._trans(null,Pt.bind(null,d.error)):d.table._trans("readonly",c).then(h)},Xe.prototype._write=function(c){var h=this._ctx;return h.error?h.table._trans(null,Pt.bind(null,h.error)):h.table._trans("readwrite",c,"locked")},Xe.prototype._addAlgorithm=function(c){var h=this._ctx;h.algorithm=mr(h.algorithm,c)},Xe.prototype._iterate=function(c,h){return qr(this._ctx,c,h,this._ctx.table.core)},Xe.prototype.clone=function(c){var h=Object.create(this.constructor.prototype),d=Object.create(this._ctx);return c&&l(d,c),h._ctx=d,h},Xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Xe.prototype.each=function(c){var h=this._ctx;return this._read(function(d){return qr(h,c,d,h.table.core)})},Xe.prototype.count=function(c){var h=this;return this._read(function(d){var y=h._ctx,v=y.table.core;if(Ur(y,!0))return v.count({trans:d,query:{index:$n(y,v.schema),range:y.range}}).then(function(T){return Math.min(T,y.limit)});var E=0;return qr(y,function(){return++E,!1},d,v).then(function(){return E})}).then(c)},Xe.prototype.sortBy=function(c,h){var d=c.split(".").reverse(),y=d[0],v=d.length-1;function E(M,B){return B?E(M[d[B]],B-1):M[y]}var T=this._ctx.dir==="next"?1:-1;function x(M,B){return Je(E(M,v),E(B,v))*T}return this.toArray(function(M){return M.sort(x)}).then(h)},Xe.prototype.toArray=function(c){var h=this;return this._read(function(d){var y=h._ctx;if(y.dir==="next"&&Ur(y,!0)&&0<y.limit){var v=y.valueMapper,E=$n(y,y.table.core.schema);return y.table.core.query({trans:d,limit:y.limit,values:!0,query:{index:E,range:y.range}}).then(function(x){return x=x.result,v?x.map(v):x})}var T=[];return qr(y,function(x){return T.push(x)},d,y.table.core).then(function(){return T})},c)},Xe.prototype.offset=function(c){var h=this._ctx;return c<=0||(h.offset+=c,Ur(h)?na(h,function(){var d=c;return function(y,v){return d===0||(d===1?--d:v(function(){y.advance(d),d=0}),!1)}}):na(h,function(){var d=c;return function(){return--d<0}})),this},Xe.prototype.limit=function(c){return this._ctx.limit=Math.min(this._ctx.limit,c),na(this._ctx,function(){var h=c;return function(d,y,v){return--h<=0&&y(v),0<=h}},!0),this},Xe.prototype.until=function(c,h){return Zs(this._ctx,function(d,y,v){return!c(d.value)||(y(v),h)}),this},Xe.prototype.first=function(c){return this.limit(1).toArray(function(h){return h[0]}).then(c)},Xe.prototype.last=function(c){return this.reverse().first(c)},Xe.prototype.filter=function(c){var h;return Zs(this._ctx,function(d){return c(d.value)}),(h=this._ctx).isMatch=mr(h.isMatch,c),this},Xe.prototype.and=function(c){return this.filter(c)},Xe.prototype.or=function(c){return new this.db.WhereClause(this._ctx.table,c,this)},Xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Xe.prototype.desc=function(){return this.reverse()},Xe.prototype.eachKey=function(c){var h=this._ctx;return h.keysOnly=!h.isMatch,this.each(function(d,y){c(y.key,y)})},Xe.prototype.eachUniqueKey=function(c){return this._ctx.unique="unique",this.eachKey(c)},Xe.prototype.eachPrimaryKey=function(c){var h=this._ctx;return h.keysOnly=!h.isMatch,this.each(function(d,y){c(y.primaryKey,y)})},Xe.prototype.keys=function(c){var h=this._ctx;h.keysOnly=!h.isMatch;var d=[];return this.each(function(y,v){d.push(v.key)}).then(function(){return d}).then(c)},Xe.prototype.primaryKeys=function(c){var h=this._ctx;if(h.dir==="next"&&Ur(h,!0)&&0<h.limit)return this._read(function(y){var v=$n(h,h.table.core.schema);return h.table.core.query({trans:y,values:!1,limit:h.limit,query:{index:v,range:h.range}})}).then(function(y){return y.result}).then(c);h.keysOnly=!h.isMatch;var d=[];return this.each(function(y,v){d.push(v.primaryKey)}).then(function(){return d}).then(c)},Xe.prototype.uniqueKeys=function(c){return this._ctx.unique="unique",this.keys(c)},Xe.prototype.firstKey=function(c){return this.limit(1).keys(function(h){return h[0]}).then(c)},Xe.prototype.lastKey=function(c){return this.reverse().firstKey(c)},Xe.prototype.distinct=function(){var c=this._ctx,c=c.index&&c.table.schema.idxByName[c.index];if(!c||!c.multi)return this;var h={};return Zs(this._ctx,function(v){var y=v.primaryKey.toString(),v=g(h,y);return h[y]=!0,!v}),this},Xe.prototype.modify=function(c){var h=this,d=this._ctx;return this._write(function(y){var v,E,T;T=typeof c=="function"?c:(v=o(c),E=v.length,function(j){for(var Q=!1,Y=0;Y<E;++Y){var X=v[Y],ie=c[X],pe=Pe(j,X);ie instanceof ht?(D(j,X,ie.execute(pe)),Q=!0):pe!==ie&&(D(j,X,ie),Q=!0)}return Q});var x=d.table.core,O=x.schema.primaryKey,M=O.outbound,B=O.extractKey,q=200,O=h.db._options.modifyChunkSize;O&&(q=typeof O=="object"?O[x.name]||O["*"]||200:O);function z(j,X){var Y=X.failures,X=X.numFailures;U+=j-X;for(var ie=0,pe=o(Y);ie<pe.length;ie++){var Ee=pe[ie];F.push(Y[Ee])}}var F=[],U=0,$=[];return h.clone().primaryKeys().then(function(j){function Q(X){var ie=Math.min(q,j.length-X);return x.getMany({trans:y,keys:j.slice(X,X+ie),cache:"immutable"}).then(function(pe){for(var Ee=[],me=[],ye=M?[]:null,Ie=[],ve=0;ve<ie;++ve){var De=pe[ve],We={value:P(De),primKey:j[X+ve]};T.call(We,We.value,We)!==!1&&(We.value==null?Ie.push(j[X+ve]):M||Je(B(De),B(We.value))===0?(me.push(We.value),M&&ye.push(j[X+ve])):(Ie.push(j[X+ve]),Ee.push(We.value)))}return Promise.resolve(0<Ee.length&&x.mutate({trans:y,type:"add",values:Ee}).then(function(Ze){for(var et in Ze.failures)Ie.splice(parseInt(et),1);z(Ee.length,Ze)})).then(function(){return(0<me.length||Y&&typeof c=="object")&&x.mutate({trans:y,type:"put",keys:ye,values:me,criteria:Y,changeSpec:typeof c!="function"&&c,isAdditionalChunk:0<X}).then(function(Ze){return z(me.length,Ze)})}).then(function(){return(0<Ie.length||Y&&c===ra)&&x.mutate({trans:y,type:"delete",keys:Ie,criteria:Y,isAdditionalChunk:0<X}).then(function(Ze){return z(Ie.length,Ze)})}).then(function(){return j.length>X+ie&&Q(X+q)})})}var Y=Ur(d)&&d.limit===1/0&&(typeof c!="function"||c===ra)&&{index:d.index,range:d.range};return Q(0).then(function(){if(0<F.length)throw new En("Error modifying one or more objects",F,U,$);return j.length})})})},Xe.prototype.delete=function(){var c=this._ctx,h=c.range;return Ur(c)&&(c.isPrimKey||h.type===3)?this._write(function(d){var y=c.table.core.schema.primaryKey,v=h;return c.table.core.count({trans:d,query:{index:y,range:v}}).then(function(E){return c.table.core.mutate({trans:d,type:"deleteRange",range:v}).then(function(T){var x=T.failures;if(T.lastResult,T.results,T=T.numFailures,T)throw new En("Could not delete some values",Object.keys(x).map(function(M){return x[M]}),E-T);return E-T})})}):this.modify(ra)},Xe);function Xe(){}var ra=function(c,h){return h.value=null};function Iu(c,h){return c<h?-1:c===h?0:1}function dl(c,h){return h<c?-1:c===h?0:1}function bn(c,h,d){return c=c instanceof ia?new c.Collection(c):c,c._ctx.error=new(d||TypeError)(h),c}function yi(c){return new c.Collection(c,function(){return gr("")}).limit(0)}function eo(c,h,d,y){var v,E,T,x,M,B,q,O=d.length;if(!d.every(function(U){return typeof U=="string"}))return bn(c,es);function z(U){v=U==="next"?function(j){return j.toUpperCase()}:function(j){return j.toLowerCase()},E=U==="next"?function(j){return j.toLowerCase()}:function(j){return j.toUpperCase()},T=U==="next"?Iu:dl;var $=d.map(function(j){return{lower:E(j),upper:v(j)}}).sort(function(j,Q){return T(j.lower,Q.lower)});x=$.map(function(j){return j.upper}),M=$.map(function(j){return j.lower}),q=(B=U)==="next"?"":y}z("next"),c=new c.Collection(c,function(){return Vn(x[0],M[O-1]+y)}),c._ondirectionchange=function(U){z(U)};var F=0;return c._addAlgorithm(function(U,$,j){var Q=U.key;if(typeof Q!="string")return!1;var Y=E(Q);if(h(Y,M,F))return!0;for(var X=null,ie=F;ie<O;++ie){var pe=function(Ee,me,ye,Ie,ve,De){for(var We=Math.min(Ee.length,Ie.length),Ze=-1,et=0;et<We;++et){var Ln=me[et];if(Ln!==Ie[et])return ve(Ee[et],ye[et])<0?Ee.substr(0,et)+ye[et]+ye.substr(et+1):ve(Ee[et],Ie[et])<0?Ee.substr(0,et)+Ie[et]+ye.substr(et+1):0<=Ze?Ee.substr(0,Ze)+me[Ze]+ye.substr(Ze+1):null;ve(Ee[et],Ln)<0&&(Ze=et)}return We<Ie.length&&De==="next"?Ee+ye.substr(Ee.length):We<Ee.length&&De==="prev"?Ee.substr(0,ye.length):Ze<0?null:Ee.substr(0,Ze)+Ie[Ze]+ye.substr(Ze+1)}(Q,Y,x[ie],M[ie],T,B);pe===null&&X===null?F=ie+1:(X===null||0<T(X,pe))&&(X=pe)}return $(X!==null?function(){U.continue(X+q)}:j),!1}),c}function Vn(c,h,d,y){return{type:2,lower:c,upper:h,lowerOpen:d,upperOpen:y}}function gr(c){return{type:1,lower:c,upper:c}}var ia=(Object.defineProperty(Ut.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ut.prototype.between=function(c,h,d,y){d=d!==!1,y=y===!0;try{return 0<this._cmp(c,h)||this._cmp(c,h)===0&&(d||y)&&(!d||!y)?yi(this):new this.Collection(this,function(){return Vn(c,h,!d,!y)})}catch{return bn(this,dr)}},Ut.prototype.equals=function(c){return c==null?bn(this,dr):new this.Collection(this,function(){return gr(c)})},Ut.prototype.above=function(c){return c==null?bn(this,dr):new this.Collection(this,function(){return Vn(c,void 0,!0)})},Ut.prototype.aboveOrEqual=function(c){return c==null?bn(this,dr):new this.Collection(this,function(){return Vn(c,void 0,!1)})},Ut.prototype.below=function(c){return c==null?bn(this,dr):new this.Collection(this,function(){return Vn(void 0,c,!1,!0)})},Ut.prototype.belowOrEqual=function(c){return c==null?bn(this,dr):new this.Collection(this,function(){return Vn(void 0,c)})},Ut.prototype.startsWith=function(c){return typeof c!="string"?bn(this,es):this.between(c,c+Ir,!0,!0)},Ut.prototype.startsWithIgnoreCase=function(c){return c===""?this.startsWith(c):eo(this,function(h,d){return h.indexOf(d[0])===0},[c],Ir)},Ut.prototype.equalsIgnoreCase=function(c){return eo(this,function(h,d){return h===d[0]},[c],"")},Ut.prototype.anyOfIgnoreCase=function(){var c=Ft.apply($t,arguments);return c.length===0?yi(this):eo(this,function(h,d){return d.indexOf(h)!==-1},c,"")},Ut.prototype.startsWithAnyOfIgnoreCase=function(){var c=Ft.apply($t,arguments);return c.length===0?yi(this):eo(this,function(h,d){return d.some(function(y){return h.indexOf(y)===0})},c,Ir)},Ut.prototype.anyOf=function(){var c=this,h=Ft.apply($t,arguments),d=this._cmp;try{h.sort(d)}catch{return bn(this,dr)}if(h.length===0)return yi(this);var y=new this.Collection(this,function(){return Vn(h[0],h[h.length-1])});y._ondirectionchange=function(E){d=E==="next"?c._ascending:c._descending,h.sort(d)};var v=0;return y._addAlgorithm(function(E,T,x){for(var M=E.key;0<d(M,h[v]);)if(++v===h.length)return T(x),!1;return d(M,h[v])===0||(T(function(){E.continue(h[v])}),!1)}),y},Ut.prototype.notEqual=function(c){return this.inAnyRange([[-1/0,c],[c,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ut.prototype.noneOf=function(){var c=Ft.apply($t,arguments);if(c.length===0)return new this.Collection(this);try{c.sort(this._ascending)}catch{return bn(this,dr)}var h=c.reduce(function(d,y){return d?d.concat([[d[d.length-1][1],y]]):[[-1/0,y]]},null);return h.push([c[c.length-1],this.db._maxKey]),this.inAnyRange(h,{includeLowers:!1,includeUppers:!1})},Ut.prototype.inAnyRange=function(Q,h){var d=this,y=this._cmp,v=this._ascending,E=this._descending,T=this._min,x=this._max;if(Q.length===0)return yi(this);if(!Q.every(function(Y){return Y[0]!==void 0&&Y[1]!==void 0&&v(Y[0],Y[1])<=0}))return bn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ee.InvalidArgument);var M=!h||h.includeLowers!==!1,B=h&&h.includeUppers===!0,q,O=v;function z(Y,X){return O(Y[0],X[0])}try{(q=Q.reduce(function(Y,X){for(var ie=0,pe=Y.length;ie<pe;++ie){var Ee=Y[ie];if(y(X[0],Ee[1])<0&&0<y(X[1],Ee[0])){Ee[0]=T(Ee[0],X[0]),Ee[1]=x(Ee[1],X[1]);break}}return ie===pe&&Y.push(X),Y},[])).sort(z)}catch{return bn(this,dr)}var F=0,U=B?function(Y){return 0<v(Y,q[F][1])}:function(Y){return 0<=v(Y,q[F][1])},$=M?function(Y){return 0<E(Y,q[F][0])}:function(Y){return 0<=E(Y,q[F][0])},j=U,Q=new this.Collection(this,function(){return Vn(q[0][0],q[q.length-1][1],!M,!B)});return Q._ondirectionchange=function(Y){O=Y==="next"?(j=U,v):(j=$,E),q.sort(z)},Q._addAlgorithm(function(Y,X,ie){for(var pe,Ee=Y.key;j(Ee);)if(++F===q.length)return X(ie),!1;return!U(pe=Ee)&&!$(pe)||(d._cmp(Ee,q[F][1])===0||d._cmp(Ee,q[F][0])===0||X(function(){O===v?Y.continue(q[F][0]):Y.continue(q[F][1])}),!1)}),Q},Ut.prototype.startsWithAnyOf=function(){var c=Ft.apply($t,arguments);return c.every(function(h){return typeof h=="string"})?c.length===0?yi(this):this.inAnyRange(c.map(function(h){return[h,h+Ir]})):bn(this,"startsWithAnyOf() only works with strings")},Ut);function Ut(){}function Mn(c){return wt(function(h){return Hn(h),c(h.target.error),!1})}function Hn(c){c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault()}var as="storagemutated",sa="x-storagemutated-1",Tr=ns(null,as),Ar=(Wn.prototype._lock=function(){return ce(!ke.global),++this._reculock,this._reculock!==1||ke.global||(ke.lockOwnerFor=this),this},Wn.prototype._unlock=function(){if(ce(!ke.global),--this._reculock==0)for(ke.global||(ke.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var c=this._blockedFuncs.shift();try{br(c[1],c[0])}catch{}}return this},Wn.prototype._locked=function(){return this._reculock&&ke.lockOwnerFor!==this},Wn.prototype.create=function(c){var h=this;if(!this.mode)return this;var d=this.db.idbdb,y=this.db._state.dbOpenError;if(ce(!this.idbtrans),!c&&!d)switch(y&&y.name){case"DatabaseClosedError":throw new ee.DatabaseClosed(y);case"MissingAPIError":throw new ee.MissingAPI(y.message,y);default:throw new ee.OpenFailed(y)}if(!this.active)throw new ee.TransactionInactive;return ce(this._completion._state===null),(c=this.idbtrans=c||(this.db.core||d).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=wt(function(v){Hn(v),h._reject(c.error)}),c.onabort=wt(function(v){Hn(v),h.active&&h._reject(new ee.Abort(c.error)),h.active=!1,h.on("abort").fire(v)}),c.oncomplete=wt(function(){h.active=!1,h._resolve(),"mutatedParts"in c&&Tr.storagemutated.fire(c.mutatedParts)}),this},Wn.prototype._promise=function(c,h,d){var y=this;if(c==="readwrite"&&this.mode!=="readwrite")return Pt(new ee.ReadOnly("Transaction is readonly"));if(!this.active)return Pt(new ee.TransactionInactive);if(this._locked())return new Ae(function(E,T){y._blockedFuncs.push([function(){y._promise(c,h,d).then(E,T)},ke])});if(d)return Er(function(){var E=new Ae(function(T,x){y._lock();var M=h(T,x,y);M&&M.then&&M.then(T,x)});return E.finally(function(){return y._unlock()}),E._lib=!0,E});var v=new Ae(function(E,T){var x=h(E,T,y);x&&x.then&&x.then(E,T)});return v._lib=!0,v},Wn.prototype._root=function(){return this.parent?this.parent._root():this},Wn.prototype.waitFor=function(c){var h,d=this._root(),y=Ae.resolve(c);d._waitingFor?d._waitingFor=d._waitingFor.then(function(){return y}):(d._waitingFor=y,d._waitingQueue=[],h=d.idbtrans.objectStore(d.storeNames[0]),function E(){for(++d._spinCount;d._waitingQueue.length;)d._waitingQueue.shift()();d._waitingFor&&(h.get(-1/0).onsuccess=E)}());var v=d._waitingFor;return new Ae(function(E,T){y.then(function(x){return d._waitingQueue.push(wt(E.bind(null,x)))},function(x){return d._waitingQueue.push(wt(T.bind(null,x)))}).finally(function(){d._waitingFor===v&&(d._waitingFor=null)})})},Wn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ee.Abort))},Wn.prototype.table=function(c){var h=this._memoizedTables||(this._memoizedTables={});if(g(h,c))return h[c];var d=this.schema[c];if(!d)throw new ee.NotFound("Table "+c+" not part of transaction");return d=new this.db.Table(c,d,this),d.core=this.db.core.table(c),h[c]=d},Wn);function Wn(){}function oa(c,h,d,y,v,E,T){return{name:c,keyPath:h,unique:d,multi:y,auto:v,compound:E,src:(d&&!T?"&":"")+(y?"*":"")+(v?"++":"")+us(h)}}function us(c){return typeof c=="string"?c:c?"["+[].join.call(c,"+")+"]":""}function _i(c,h,d){return{name:c,primKey:h,indexes:d,mappedClass:null,idxByName:(y=function(v){return[v.name,v]},d.reduce(function(v,E,T){return T=y(E,T),T&&(v[T[0]]=T[1]),v},{}))};var y}var vi=function(c){try{return c.only([[]]),vi=function(){return[[]]},[[]]}catch{return vi=function(){return Ir},Ir}};function Kr(c){return c==null?function(){}:typeof c=="string"?(h=c).split(".").length===1?function(d){return d[h]}:function(d){return Pe(d,h)}:function(d){return Pe(d,c)};var h}function wi(c){return[].slice.call(c)}var Tu=0;function $r(c){return c==null?":id":typeof c=="string"?c:"[".concat(c.join("+"),"]")}function xt(c,h,M){function y(j){if(j.type===3)return null;if(j.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var F=j.lower,U=j.upper,$=j.lowerOpen,j=j.upperOpen;return F===void 0?U===void 0?null:h.upperBound(U,!!j):U===void 0?h.lowerBound(F,!!$):h.bound(F,U,!!$,!!j)}function v(z){var F,U=z.name;return{name:U,schema:z,mutate:function($){var j=$.trans,Q=$.type,Y=$.keys,X=$.values,ie=$.range;return new Promise(function(pe,Ee){pe=wt(pe);var me=j.objectStore(U),ye=me.keyPath==null,Ie=Q==="put"||Q==="add";if(!Ie&&Q!=="delete"&&Q!=="deleteRange")throw new Error("Invalid operation type: "+Q);var ve,De=(Y||X||{length:1}).length;if(Y&&X&&Y.length!==X.length)throw new Error("Given keys array must have same length as given values array.");if(De===0)return pe({numFailures:0,failures:{},results:[],lastResult:void 0});function We(In){++Ln,Hn(In)}var Ze=[],et=[],Ln=0;if(Q==="deleteRange"){if(ie.type===4)return pe({numFailures:Ln,failures:et,results:[],lastResult:void 0});ie.type===3?Ze.push(ve=me.clear()):Ze.push(ve=me.delete(y(ie)))}else{var ye=Ie?ye?[X,Y]:[X,null]:[Y,null],Ge=ye[0],fn=ye[1];if(Ie)for(var dn=0;dn<De;++dn)Ze.push(ve=fn&&fn[dn]!==void 0?me[Q](Ge[dn],fn[dn]):me[Q](Ge[dn])),ve.onerror=We;else for(dn=0;dn<De;++dn)Ze.push(ve=me[Q](Ge[dn])),ve.onerror=We}function Vu(In){In=In.target.result,Ze.forEach(function(ds,yl){return ds.error!=null&&(et[yl]=ds.error)}),pe({numFailures:Ln,failures:et,results:Q==="delete"?Y:Ze.map(function(ds){return ds.result}),lastResult:In})}ve.onerror=function(In){We(In),Vu(In)},ve.onsuccess=Vu})},getMany:function($){var j=$.trans,Q=$.keys;return new Promise(function(Y,X){Y=wt(Y);for(var ie,pe=j.objectStore(U),Ee=Q.length,me=new Array(Ee),ye=0,Ie=0,ve=function(Ze){Ze=Ze.target,me[Ze._pos]=Ze.result,++Ie===ye&&Y(me)},De=Mn(X),We=0;We<Ee;++We)Q[We]!=null&&((ie=pe.get(Q[We]))._pos=We,ie.onsuccess=ve,ie.onerror=De,++ye);ye===0&&Y(me)})},get:function($){var j=$.trans,Q=$.key;return new Promise(function(Y,X){Y=wt(Y);var ie=j.objectStore(U).get(Q);ie.onsuccess=function(pe){return Y(pe.target.result)},ie.onerror=Mn(X)})},query:(F=B,function($){return new Promise(function(j,Q){j=wt(j);var Y,X,ie,ye=$.trans,pe=$.values,Ee=$.limit,ve=$.query,me=Ee===1/0?void 0:Ee,Ie=ve.index,ve=ve.range,ye=ye.objectStore(U),Ie=Ie.isPrimaryKey?ye:ye.index(Ie.name),ve=y(ve);if(Ee===0)return j({result:[]});F?((me=pe?Ie.getAll(ve,me):Ie.getAllKeys(ve,me)).onsuccess=function(De){return j({result:De.target.result})},me.onerror=Mn(Q)):(Y=0,X=!pe&&"openKeyCursor"in Ie?Ie.openKeyCursor(ve):Ie.openCursor(ve),ie=[],X.onsuccess=function(De){var We=X.result;return We?(ie.push(pe?We.value:We.primaryKey),++Y===Ee?j({result:ie}):void We.continue()):j({result:ie})},X.onerror=Mn(Q))})}),openCursor:function($){var j=$.trans,Q=$.values,Y=$.query,X=$.reverse,ie=$.unique;return new Promise(function(pe,Ee){pe=wt(pe);var Ie=Y.index,me=Y.range,ye=j.objectStore(U),ye=Ie.isPrimaryKey?ye:ye.index(Ie.name),Ie=X?ie?"prevunique":"prev":ie?"nextunique":"next",ve=!Q&&"openKeyCursor"in ye?ye.openKeyCursor(y(me),Ie):ye.openCursor(y(me),Ie);ve.onerror=Mn(Ee),ve.onsuccess=wt(function(De){var We,Ze,et,Ln,Ge=ve.result;Ge?(Ge.___id=++Tu,Ge.done=!1,We=Ge.continue.bind(Ge),Ze=(Ze=Ge.continuePrimaryKey)&&Ze.bind(Ge),et=Ge.advance.bind(Ge),Ln=function(){throw new Error("Cursor not stopped")},Ge.trans=j,Ge.stop=Ge.continue=Ge.continuePrimaryKey=Ge.advance=function(){throw new Error("Cursor not started")},Ge.fail=wt(Ee),Ge.next=function(){var fn=this,dn=1;return this.start(function(){return dn--?fn.continue():fn.stop()}).then(function(){return fn})},Ge.start=function(fn){function dn(){if(ve.result)try{fn()}catch(In){Ge.fail(In)}else Ge.done=!0,Ge.start=function(){throw new Error("Cursor behind last entry")},Ge.stop()}var Vu=new Promise(function(In,ds){In=wt(In),ve.onerror=Mn(ds),Ge.fail=ds,Ge.stop=function(yl){Ge.stop=Ge.continue=Ge.continuePrimaryKey=Ge.advance=Ln,In(yl)}});return ve.onsuccess=wt(function(In){ve.onsuccess=dn,dn()}),Ge.continue=We,Ge.continuePrimaryKey=Ze,Ge.advance=et,dn(),Vu},pe(Ge)):pe(null)},Ee)})},count:function($){var j=$.query,Q=$.trans,Y=j.index,X=j.range;return new Promise(function(ie,pe){var Ee=Q.objectStore(U),me=Y.isPrimaryKey?Ee:Ee.index(Y.name),Ee=y(X),me=Ee?me.count(Ee):me.count();me.onsuccess=wt(function(ye){return ie(ye.target.result)}),me.onerror=Mn(pe)})}}}var E,T,x,q=(T=M,x=wi((E=c).objectStoreNames),{schema:{name:E.name,tables:x.map(function(z){return T.objectStore(z)}).map(function(z){var F=z.keyPath,j=z.autoIncrement,U=u(F),$={},j={name:z.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:F==null,compound:U,keyPath:F,autoIncrement:j,unique:!0,extractKey:Kr(F)},indexes:wi(z.indexNames).map(function(Q){return z.index(Q)}).map(function(ie){var Y=ie.name,X=ie.unique,pe=ie.multiEntry,ie=ie.keyPath,pe={name:Y,compound:u(ie),keyPath:ie,unique:X,multiEntry:pe,extractKey:Kr(ie)};return $[$r(ie)]=pe}),getIndexByKeyPath:function(Q){return $[$r(Q)]}};return $[":id"]=j.primaryKey,F!=null&&($[$r(F)]=j.primaryKey),j})},hasGetAll:0<x.length&&"getAll"in T.objectStore(x[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),M=q.schema,B=q.hasGetAll,q=M.tables.map(v),O={};return q.forEach(function(z){return O[z.name]=z}),{stack:"dbcore",transaction:c.transaction.bind(c),table:function(z){if(!O[z])throw new Error("Table '".concat(z,"' not found"));return O[z]},MIN_KEY:-1/0,MAX_KEY:vi(h),schema:M}}function pl(c,h,d,y){var v=d.IDBKeyRange;return d.indexedDB,{dbcore:(y=xt(h,v,y),c.dbcore.reduce(function(E,T){return T=T.create,r(r({},E),T(E))},y))}}function to(c,y){var d=y.db,y=pl(c._middlewares,d,c._deps,y);c.core=y.dbcore,c.tables.forEach(function(v){var E=v.name;c.core.schema.tables.some(function(T){return T.name===E})&&(v.core=c.core.table(E),c[E]instanceof c.Table&&(c[E].core=v.core))})}function cs(c,h,d,y){d.forEach(function(v){var E=y[v];h.forEach(function(T){var x=function M(B,q){return J(B,q)||(B=f(B))&&M(B,q)}(T,v);(!x||"value"in x&&x.value===void 0)&&(T===c.Transaction.prototype||T instanceof c.Transaction?L(T,v,{get:function(){return this.table(v)},set:function(M){I(this,v,{value:M,writable:!0,configurable:!0,enumerable:!0})}}):T[v]=new c.Table(v,E))})})}function no(c,h){h.forEach(function(d){for(var y in d)d[y]instanceof c.Table&&delete d[y]})}function Au(c,h){return c._cfg.version-h._cfg.version}function ro(c,h,d,y){var v=c._dbSchema;d.objectStoreNames.contains("$meta")&&!v.$meta&&(v.$meta=_i("$meta",hs("")[0],[]),c._storeNames.push("$meta"));var E=c._createTransaction("readwrite",c._storeNames,v);E.create(d),E._completion.catch(y);var T=E._reject.bind(E),x=ke.transless||ke;Er(function(){return ke.trans=E,ke.transless=x,h!==0?(to(c,d),B=h,((M=E).storeNames.includes("$meta")?M.table("$meta").get("version").then(function(q){return q??B}):Ae.resolve(B)).then(function(q){return z=q,F=E,U=d,$=[],q=(O=c)._versions,j=O._dbSchema=ls(0,O.idbdb,U),(q=q.filter(function(Q){return Q._cfg.version>=z})).length!==0?(q.forEach(function(Q){$.push(function(){var Y=j,X=Q._cfg.dbschema;Ei(O,Y,U),Ei(O,X,U),j=O._dbSchema=X;var ie=Fn(Y,X);ie.add.forEach(function(Ie){io(U,Ie[0],Ie[1].primKey,Ie[1].indexes)}),ie.change.forEach(function(Ie){if(Ie.recreate)throw new ee.Upgrade("Not yet support for changing primary key");var ve=U.objectStore(Ie.name);Ie.add.forEach(function(De){return Sr(ve,De)}),Ie.change.forEach(function(De){ve.deleteIndex(De.name),Sr(ve,De)}),Ie.del.forEach(function(De){return ve.deleteIndex(De)})});var pe=Q._cfg.contentUpgrade;if(pe&&Q._cfg.version>z){to(O,U),F._memoizedTables={};var Ee=S(X);ie.del.forEach(function(Ie){Ee[Ie]=Y[Ie]}),no(O,[O.Transaction.prototype]),cs(O,[O.Transaction.prototype],o(Ee),Ee),F.schema=Ee;var me,ye=hn(pe);return ye&&hr(),ie=Ae.follow(function(){var Ie;(me=pe(F))&&ye&&(Ie=fr.bind(null,null),me.then(Ie,Ie))}),me&&typeof me.then=="function"?Ae.resolve(me):ie.then(function(){return me})}}),$.push(function(Y){var X,ie,pe=Q._cfg.dbschema;X=pe,ie=Y,[].slice.call(ie.db.objectStoreNames).forEach(function(Ee){return X[Ee]==null&&ie.db.deleteObjectStore(Ee)}),no(O,[O.Transaction.prototype]),cs(O,[O.Transaction.prototype],O._storeNames,O._dbSchema),F.schema=O._dbSchema}),$.push(function(Y){O.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(O.idbdb.version/10)===Q._cfg.version?(O.idbdb.deleteObjectStore("$meta"),delete O._dbSchema.$meta,O._storeNames=O._storeNames.filter(function(X){return X!=="$meta"})):Y.objectStore("$meta").put(Q._cfg.version,"version"))})}),function Q(){return $.length?Ae.resolve($.shift()(F.idbtrans)).then(Q):Ae.resolve()}().then(function(){Ru(j,U)})):Ae.resolve();var O,z,F,U,$,j}).catch(T)):(o(v).forEach(function(q){io(d,q,v[q].primKey,v[q].indexes)}),to(c,d),void Ae.follow(function(){return c.on.populate.fire(E)}).catch(T));var M,B})}function Su(c,h){Ru(c._dbSchema,h),h.db.version%10!=0||h.objectStoreNames.contains("$meta")||h.db.createObjectStore("$meta").add(Math.ceil(h.db.version/10-1),"version");var d=ls(0,c.idbdb,h);Ei(c,c._dbSchema,h);for(var y=0,v=Fn(d,c._dbSchema).change;y<v.length;y++){var E=function(T){if(T.change.length||T.recreate)return console.warn("Unable to patch indexes of table ".concat(T.name," because it has changes on the type of index or primary key.")),{value:void 0};var x=h.objectStore(T.name);T.add.forEach(function(M){fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(T.name,".").concat(M.src)),Sr(x,M)})}(v[y]);if(typeof E=="object")return E.value}}function Fn(c,h){var d,y={del:[],add:[],change:[]};for(d in c)h[d]||y.del.push(d);for(d in h){var v=c[d],E=h[d];if(v){var T={name:d,def:E,recreate:!1,del:[],add:[],change:[]};if(""+(v.primKey.keyPath||"")!=""+(E.primKey.keyPath||"")||v.primKey.auto!==E.primKey.auto)T.recreate=!0,y.change.push(T);else{var x=v.idxByName,M=E.idxByName,B=void 0;for(B in x)M[B]||T.del.push(B);for(B in M){var q=x[B],O=M[B];q?q.src!==O.src&&T.change.push(O):T.add.push(O)}(0<T.del.length||0<T.add.length||0<T.change.length)&&y.change.push(T)}}else y.add.push([d,E])}return y}function io(c,h,d,y){var v=c.db.createObjectStore(h,d.keyPath?{keyPath:d.keyPath,autoIncrement:d.auto}:{autoIncrement:d.auto});return y.forEach(function(E){return Sr(v,E)}),v}function Ru(c,h){o(c).forEach(function(d){h.db.objectStoreNames.contains(d)||(fe&&console.debug("Dexie: Creating missing table",d),io(h,d,c[d].primKey,c[d].indexes))})}function Sr(c,h){c.createIndex(h.name,h.keyPath,{unique:h.unique,multiEntry:h.multi})}function ls(c,h,d){var y={};return oe(h.objectStoreNames,0).forEach(function(v){for(var E=d.objectStore(v),T=oa(us(B=E.keyPath),B||"",!0,!1,!!E.autoIncrement,B&&typeof B!="string",!0),x=[],M=0;M<E.indexNames.length;++M){var q=E.index(E.indexNames[M]),B=q.keyPath,q=oa(q.name,B,!!q.unique,!!q.multiEntry,!1,B&&typeof B!="string",!1);x.push(q)}y[v]=_i(v,T,x)}),y}function Ei(c,h,d){for(var y=d.db.objectStoreNames,v=0;v<y.length;++v){var E=y[v],T=d.objectStore(E);c._hasGetAll="getAll"in T;for(var x=0;x<T.indexNames.length;++x){var M=T.indexNames[x],B=T.index(M).keyPath,q=typeof B=="string"?B:"["+oe(B).join("+")+"]";!h[E]||(B=h[E].idxByName[q])&&(B.name=M,delete h[E].idxByName[q],h[E].idxByName[M]=B)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(c._hasGetAll=!1)}function hs(c){return c.split(",").map(function(h,d){var y=(h=h.trim()).replace(/([&*]|\+\+)/g,""),v=/^\[/.test(y)?y.match(/^\[(.*)\]$/)[1].split("+"):y;return oa(y,v||null,/\&/.test(h),/\*/.test(h),/\+\+/.test(h),u(v),d===0)})}var Pu=(zr.prototype._parseStoresSpec=function(c,h){o(c).forEach(function(d){if(c[d]!==null){var y=hs(c[d]),v=y.shift();if(v.unique=!0,v.multi)throw new ee.Schema("Primary key cannot be multi-valued");y.forEach(function(E){if(E.auto)throw new ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!E.keyPath)throw new ee.Schema("Index must have a name and cannot be an empty string")}),h[d]=_i(d,v,y)}})},zr.prototype.stores=function(d){var h=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,d):d;var d=h._versions,y={},v={};return d.forEach(function(E){l(y,E._cfg.storesSource),v=E._cfg.dbschema={},E._parseStoresSpec(y,v)}),h._dbSchema=v,no(h,[h._allTables,h,h.Transaction.prototype]),cs(h,[h._allTables,h,h.Transaction.prototype,this._cfg.tables],o(v),v),h._storeNames=o(v),this},zr.prototype.upgrade=function(c){return this._cfg.contentUpgrade=ge(this._cfg.contentUpgrade||Le,c),this},zr);function zr(){}function aa(c,h){var d=c._dbNamesDB;return d||(d=c._dbNamesDB=new Xr(gi,{addons:[],indexedDB:c,IDBKeyRange:h})).version(1).stores({dbnames:"name"}),d.table("dbnames")}function so(c){return c&&typeof c.databases=="function"}function Gr(c){return Er(function(){return ke.letThrough=!0,c()})}function oo(c){return!("from"in c)}var Zt=function(c,h){if(!this){var d=new Zt;return c&&"d"in c&&l(d,c),d}l(this,arguments.length?{d:1,from:c,to:1<arguments.length?h:c}:{d:0})};function Hr(c,h,d){var y=Je(h,d);if(!isNaN(y)){if(0<y)throw RangeError();if(oo(c))return l(c,{from:h,to:d,d:1});var v=c.l,y=c.r;if(Je(d,c.from)<0)return v?Hr(v,h,d):c.l={from:h,to:d,d:1,l:null,r:null},ca(c);if(0<Je(h,c.to))return y?Hr(y,h,d):c.r={from:h,to:d,d:1,l:null,r:null},ca(c);Je(h,c.from)<0&&(c.from=h,c.l=null,c.d=y?y.d+1:1),0<Je(d,c.to)&&(c.to=d,c.r=null,c.d=c.l?c.l.d+1:1),d=!c.r,v&&!c.l&&Wr(c,v),y&&d&&Wr(c,y)}}function Wr(c,h){oo(h)||function d(y,M){var E=M.from,T=M.to,x=M.l,M=M.r;Hr(y,E,T),x&&d(y,x),M&&d(y,M)}(c,h)}function ua(c,h){var d=Qr(h),y=d.next();if(y.done)return!1;for(var v=y.value,E=Qr(c),T=E.next(v.from),x=T.value;!y.done&&!T.done;){if(Je(x.from,v.to)<=0&&0<=Je(x.to,v.from))return!0;Je(v.from,x.from)<0?v=(y=d.next(x.from)).value:x=(T=E.next(v.from)).value}return!1}function Qr(c){var h=oo(c)?null:{s:0,n:c};return{next:function(d){for(var y=0<arguments.length;h;)switch(h.s){case 0:if(h.s=1,y)for(;h.n.l&&Je(d,h.n.from)<0;)h={up:h,n:h.n.l,s:1};else for(;h.n.l;)h={up:h,n:h.n.l,s:1};case 1:if(h.s=2,!y||Je(d,h.n.to)<=0)return{value:h.n,done:!1};case 2:if(h.n.r){h.s=3,h={up:h,n:h.n.r,s:0};continue}case 3:h=h.up}return{done:!0}}}}function ca(c){var h,d,y=(((h=c.r)===null||h===void 0?void 0:h.d)||0)-(((d=c.l)===null||d===void 0?void 0:d.d)||0),v=1<y?"r":y<-1?"l":"";v&&(h=v=="r"?"l":"r",d=r({},c),y=c[v],c.from=y.from,c.to=y.to,c[v]=y[v],d[v]=y[h],(c[h]=d).d=la(d)),c.d=la(c)}function la(d){var h=d.r,d=d.l;return(h?d?Math.max(h.d,d.d):h.d:d?d.d:0)+1}function Qn(c,h){return o(h).forEach(function(d){c[d]?Wr(c[d],h[d]):c[d]=function y(v){var E,T,x={};for(E in v)g(v,E)&&(T=v[E],x[E]=!T||typeof T!="object"||N.has(T.constructor)?T:y(T));return x}(h[d])}),c}function ao(c,h){return c.all||h.all||Object.keys(c).some(function(d){return h[d]&&ua(h[d],c[d])})}w(Zt.prototype,((Yn={add:function(c){return Wr(this,c),this},addKey:function(c){return Hr(this,c,c),this},addKeys:function(c){var h=this;return c.forEach(function(d){return Hr(h,d,d)}),this},hasKey:function(c){var h=Qr(this).next(c).value;return h&&Je(h.from,c)<=0&&0<=Je(h.to,c)}})[ct]=function(){return Qr(this)},Yn));var Rr={},uo={},co=!1;function Yr(c){Qn(uo,c),co||(co=!0,setTimeout(function(){co=!1,un(uo,!(uo={}))},0))}function un(c,h){h===void 0&&(h=!1);var d=new Set;if(c.all)for(var y=0,v=Object.values(Rr);y<v.length;y++)ha(T=v[y],c,d,h);else for(var E in c){var T,x=/^idb\:\/\/(.*)\/(.*)\//.exec(E);x&&(E=x[1],x=x[2],(T=Rr["idb://".concat(E,"/").concat(x)])&&ha(T,c,d,h))}d.forEach(function(M){return M()})}function ha(c,h,d,y){for(var v=[],E=0,T=Object.entries(c.queries.query);E<T.length;E++){for(var x=T[E],M=x[0],B=[],q=0,O=x[1];q<O.length;q++){var z=O[q];ao(h,z.obsSet)?z.subscribers.forEach(function(j){return d.add(j)}):y&&B.push(z)}y&&v.push([M,B])}if(y)for(var F=0,U=v;F<U.length;F++){var $=U[F],M=$[0],B=$[1];c.queries.query[M]=B}}function xu(c){var h=c._state,d=c._deps.indexedDB;if(h.isBeingOpened||c.idbdb)return h.dbReadyPromise.then(function(){return h.dbOpenError?Pt(h.dbOpenError):c});h.isBeingOpened=!0,h.dbOpenError=null,h.openComplete=!1;var y=h.openCanceller,v=Math.round(10*c.verno),E=!1;function T(){if(h.openCanceller!==y)throw new ee.DatabaseClosed("db.open() was cancelled")}function x(){return new Ae(function(z,F){if(T(),!d)throw new ee.MissingAPI;var U=c.name,$=h.autoSchema||!v?d.open(U):d.open(U,v);if(!$)throw new ee.MissingAPI;$.onerror=Mn(F),$.onblocked=wt(c._fireOnBlocked),$.onupgradeneeded=wt(function(j){var Q;q=$.transaction,h.autoSchema&&!c._options.allowEmptyDB?($.onerror=Hn,q.abort(),$.result.close(),(Q=d.deleteDatabase(U)).onsuccess=Q.onerror=wt(function(){F(new ee.NoSuchDatabase("Database ".concat(U," doesnt exist")))})):(q.onerror=Mn(F),j=j.oldVersion>Math.pow(2,62)?0:j.oldVersion,O=j<1,c.idbdb=$.result,E&&Su(c,q),ro(c,j/10,q,F))},F),$.onsuccess=wt(function(){q=null;var j,Q,Y,X,ie,pe=c.idbdb=$.result,Ee=oe(pe.objectStoreNames);if(0<Ee.length)try{var me=pe.transaction((X=Ee).length===1?X[0]:X,"readonly");if(h.autoSchema)Q=pe,Y=me,(j=c).verno=Q.version/10,Y=j._dbSchema=ls(0,Q,Y),j._storeNames=oe(Q.objectStoreNames,0),cs(j,[j._allTables],o(Y),Y);else if(Ei(c,c._dbSchema,me),((ie=Fn(ls(0,(ie=c).idbdb,me),ie._dbSchema)).add.length||ie.change.some(function(ye){return ye.add.length||ye.change.length}))&&!E)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),pe.close(),v=pe.version+1,E=!0,z(x());to(c,me)}catch{}Br.push(c),pe.onversionchange=wt(function(ye){h.vcFired=!0,c.on("versionchange").fire(ye)}),pe.onclose=wt(function(ye){c.on("close").fire(ye)}),O&&(ie=c._deps,me=U,pe=ie.indexedDB,ie=ie.IDBKeyRange,so(pe)||me===gi||aa(pe,ie).put({name:me}).catch(Le)),z()},F)}).catch(function(z){switch(z==null?void 0:z.name){case"UnknownError":if(0<h.PR1398_maxLoop)return h.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),x();break;case"VersionError":if(0<v)return v=0,x()}return Ae.reject(z)})}var M,B=h.dbReadyResolve,q=null,O=!1;return Ae.race([y,(typeof navigator>"u"?Ae.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(z){function F(){return indexedDB.databases().finally(z)}M=setInterval(F,100),F()}).finally(function(){return clearInterval(M)}):Promise.resolve()).then(x)]).then(function(){return T(),h.onReadyBeingFired=[],Ae.resolve(Gr(function(){return c.on.ready.fire(c.vip)})).then(function z(){if(0<h.onReadyBeingFired.length){var F=h.onReadyBeingFired.reduce(ge,Le);return h.onReadyBeingFired=[],Ae.resolve(Gr(function(){return F(c.vip)})).then(z)}})}).finally(function(){h.openCanceller===y&&(h.onReadyBeingFired=null,h.isBeingOpened=!1)}).catch(function(z){h.dbOpenError=z;try{q&&q.abort()}catch{}return y===h.openCanceller&&c._close(),Pt(z)}).finally(function(){h.openComplete=!0,B()}).then(function(){var z;return O&&(z={},c.tables.forEach(function(F){F.schema.indexes.forEach(function(U){U.name&&(z["idb://".concat(c.name,"/").concat(F.name,"/").concat(U.name)]=new Zt(-1/0,[[[]]]))}),z["idb://".concat(c.name,"/").concat(F.name,"/")]=z["idb://".concat(c.name,"/").concat(F.name,"/:dels")]=new Zt(-1/0,[[[]]])}),Tr(as).fire(z),un(z,!0)),c})}function Pr(c){function h(E){return c.next(E)}var d=v(h),y=v(function(E){return c.throw(E)});function v(E){return function(M){var x=E(M),M=x.value;return x.done?M:M&&typeof M.then=="function"?M.then(d,y):u(M)?Promise.all(M).then(d,y):d(M)}}return v(h)()}function a(c,h,d){for(var y=u(c)?c.slice():[c],v=0;v<d;++v)y.push(h);return y}var p={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(c){return r(r({},c),{table:function(h){var d=c.table(h),y=d.schema,v={},E=[];function T(O,z,F){var U=$r(O),$=v[U]=v[U]||[],j=O==null?0:typeof O=="string"?1:O.length,Q=0<z,Q=r(r({},F),{name:Q?"".concat(U,"(virtual-from:").concat(F.name,")"):F.name,lowLevelIndex:F,isVirtual:Q,keyTail:z,keyLength:j,extractKey:Kr(O),unique:!Q&&F.unique});return $.push(Q),Q.isPrimaryKey||E.push(Q),1<j&&T(j===2?O[0]:O.slice(0,j-1),z+1,F),$.sort(function(Y,X){return Y.keyTail-X.keyTail}),Q}h=T(y.primaryKey.keyPath,0,y.primaryKey),v[":id"]=[h];for(var x=0,M=y.indexes;x<M.length;x++){var B=M[x];T(B.keyPath,0,B)}function q(O){var z,F=O.query.index;return F.isVirtual?r(r({},O),{query:{index:F.lowLevelIndex,range:(z=O.query.range,F=F.keyTail,{type:z.type===1?2:z.type,lower:a(z.lower,z.lowerOpen?c.MAX_KEY:c.MIN_KEY,F),lowerOpen:!0,upper:a(z.upper,z.upperOpen?c.MIN_KEY:c.MAX_KEY,F),upperOpen:!0})}}):O}return r(r({},d),{schema:r(r({},y),{primaryKey:h,indexes:E,getIndexByKeyPath:function(O){return(O=v[$r(O)])&&O[0]}}),count:function(O){return d.count(q(O))},query:function(O){return d.query(q(O))},openCursor:function(O){var z=O.query.index,F=z.keyTail,U=z.isVirtual,$=z.keyLength;return U?d.openCursor(q(O)).then(function(Q){return Q&&j(Q)}):d.openCursor(O);function j(Q){return Object.create(Q,{continue:{value:function(Y){Y!=null?Q.continue(a(Y,O.reverse?c.MAX_KEY:c.MIN_KEY,F)):O.unique?Q.continue(Q.key.slice(0,$).concat(O.reverse?c.MIN_KEY:c.MAX_KEY,F)):Q.continue()}},continuePrimaryKey:{value:function(Y,X){Q.continuePrimaryKey(a(Y,c.MAX_KEY,F),X)}},primaryKey:{get:function(){return Q.primaryKey}},key:{get:function(){var Y=Q.key;return $===1?Y[0]:Y.slice(0,$)}},value:{get:function(){return Q.value}}})}}})}})}};function _(c,h,d,y){return d=d||{},y=y||"",o(c).forEach(function(v){var E,T,x;g(h,v)?(E=c[v],T=h[v],typeof E=="object"&&typeof T=="object"&&E&&T?(x=Vt(E))!==Vt(T)?d[y+v]=h[v]:x==="Object"?_(E,T,d,y+v+"."):E!==T&&(d[y+v]=h[v]):E!==T&&(d[y+v]=h[v])):d[y+v]=void 0}),o(h).forEach(function(v){g(c,v)||(d[y+v]=h[v])}),d}function b(c,h){return h.type==="delete"?h.keys:h.keys||h.values.map(c.extractKey)}var G={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(c){return r(r({},c),{table:function(h){var d=c.table(h),y=d.schema.primaryKey;return r(r({},d),{mutate:function(v){var E=ke.trans,T=E.table(h).hook,x=T.deleting,M=T.creating,B=T.updating;switch(v.type){case"add":if(M.fire===Le)break;return E._promise("readwrite",function(){return q(v)},!0);case"put":if(M.fire===Le&&B.fire===Le)break;return E._promise("readwrite",function(){return q(v)},!0);case"delete":if(x.fire===Le)break;return E._promise("readwrite",function(){return q(v)},!0);case"deleteRange":if(x.fire===Le)break;return E._promise("readwrite",function(){return function O(z,F,U){return d.query({trans:z,values:!1,query:{index:y,range:F},limit:U}).then(function($){var j=$.result;return q({type:"delete",keys:j,trans:z}).then(function(Q){return 0<Q.numFailures?Promise.reject(Q.failures[0]):j.length<U?{failures:[],numFailures:0,lastResult:void 0}:O(z,r(r({},F),{lower:j[j.length-1],lowerOpen:!0}),U)})})}(v.trans,v.range,1e4)},!0)}return d.mutate(v);function q(O){var z,F,U,$=ke.trans,j=O.keys||b(y,O);if(!j)throw new Error("Keys missing");return(O=O.type==="add"||O.type==="put"?r(r({},O),{keys:j}):r({},O)).type!=="delete"&&(O.values=i([],O.values)),O.keys&&(O.keys=i([],O.keys)),z=d,U=j,((F=O).type==="add"?Promise.resolve([]):z.getMany({trans:F.trans,keys:U,cache:"immutable"})).then(function(Q){var Y=j.map(function(X,ie){var pe,Ee,me,ye=Q[ie],Ie={onerror:null,onsuccess:null};return O.type==="delete"?x.fire.call(Ie,X,ye,$):O.type==="add"||ye===void 0?(pe=M.fire.call(Ie,X,O.values[ie],$),X==null&&pe!=null&&(O.keys[ie]=X=pe,y.outbound||D(O.values[ie],y.keyPath,X))):(pe=_(ye,O.values[ie]),(Ee=B.fire.call(Ie,pe,X,ye,$))&&(me=O.values[ie],Object.keys(Ee).forEach(function(ve){g(me,ve)?me[ve]=Ee[ve]:D(me,ve,Ee[ve])}))),Ie});return d.mutate(O).then(function(X){for(var ie=X.failures,pe=X.results,Ee=X.numFailures,X=X.lastResult,me=0;me<j.length;++me){var ye=(pe||j)[me],Ie=Y[me];ye==null?Ie.onerror&&Ie.onerror(ie[me]):Ie.onsuccess&&Ie.onsuccess(O.type==="put"&&Q[me]?O.values[me]:ye)}return{failures:ie,results:pe,numFailures:Ee,lastResult:X}}).catch(function(X){return Y.forEach(function(ie){return ie.onerror&&ie.onerror(X)}),Promise.reject(X)})})}}})}})}};function Z(c,h,d){try{if(!h||h.keys.length<c.length)return null;for(var y=[],v=0,E=0;v<h.keys.length&&E<c.length;++v)Je(h.keys[v],c[E])===0&&(y.push(d?P(h.values[v]):h.values[v]),++E);return y.length===c.length?y:null}catch{return null}}var _e={stack:"dbcore",level:-1,create:function(c){return{table:function(h){var d=c.table(h);return r(r({},d),{getMany:function(y){if(!y.cache)return d.getMany(y);var v=Z(y.keys,y.trans._cache,y.cache==="clone");return v?Ae.resolve(v):d.getMany(y).then(function(E){return y.trans._cache={keys:y.keys,values:y.cache==="clone"?P(E):E},E})},mutate:function(y){return y.type!=="add"&&(y.trans._cache=null),d.mutate(y)}})}}}};function dt(c,h){return c.trans.mode==="readonly"&&!!c.subscr&&!c.trans.explicit&&c.trans.db._options.cache!=="disabled"&&!h.schema.primaryKey.outbound}function Wt(c,h){switch(c){case"query":return h.values&&!h.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var it={stack:"dbcore",level:0,name:"Observability",create:function(c){var h=c.schema.name,d=new Zt(c.MIN_KEY,c.MAX_KEY);return r(r({},c),{transaction:function(y,v,E){if(ke.subscr&&v!=="readonly")throw new ee.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ke.querier));return c.transaction(y,v,E)},table:function(y){var v=c.table(y),E=v.schema,T=E.primaryKey,O=E.indexes,x=T.extractKey,M=T.outbound,B=T.autoIncrement&&O.filter(function(F){return F.compound&&F.keyPath.includes(T.keyPath)}),q=r(r({},v),{mutate:function(F){function U(ve){return ve="idb://".concat(h,"/").concat(y,"/").concat(ve),X[ve]||(X[ve]=new Zt)}var $,j,Q,Y=F.trans,X=F.mutatedParts||(F.mutatedParts={}),ie=U(""),pe=U(":dels"),Ee=F.type,Ie=F.type==="deleteRange"?[F.range]:F.type==="delete"?[F.keys]:F.values.length<50?[b(T,F).filter(function(ve){return ve}),F.values]:[],me=Ie[0],ye=Ie[1],Ie=F.trans._cache;return u(me)?(ie.addKeys(me),(Ie=Ee==="delete"||me.length===ye.length?Z(me,Ie):null)||pe.addKeys(me),(Ie||ye)&&($=U,j=Ie,Q=ye,E.indexes.forEach(function(ve){var De=$(ve.name||"");function We(et){return et!=null?ve.extractKey(et):null}function Ze(et){return ve.multiEntry&&u(et)?et.forEach(function(Ln){return De.addKey(Ln)}):De.addKey(et)}(j||Q).forEach(function(et,fn){var Ge=j&&We(j[fn]),fn=Q&&We(Q[fn]);Je(Ge,fn)!==0&&(Ge!=null&&Ze(Ge),fn!=null&&Ze(fn))})}))):me?(ye={from:(ye=me.lower)!==null&&ye!==void 0?ye:c.MIN_KEY,to:(ye=me.upper)!==null&&ye!==void 0?ye:c.MAX_KEY},pe.add(ye),ie.add(ye)):(ie.add(d),pe.add(d),E.indexes.forEach(function(ve){return U(ve.name).add(d)})),v.mutate(F).then(function(ve){return!me||F.type!=="add"&&F.type!=="put"||(ie.addKeys(ve.results),B&&B.forEach(function(De){for(var We=F.values.map(function(Ge){return De.extractKey(Ge)}),Ze=De.keyPath.findIndex(function(Ge){return Ge===T.keyPath}),et=0,Ln=ve.results.length;et<Ln;++et)We[et][Ze]=ve.results[et];U(De.name).addKeys(We)})),Y.mutatedParts=Qn(Y.mutatedParts||{},X),ve})}}),O=function(U){var $=U.query,U=$.index,$=$.range;return[U,new Zt((U=$.lower)!==null&&U!==void 0?U:c.MIN_KEY,($=$.upper)!==null&&$!==void 0?$:c.MAX_KEY)]},z={get:function(F){return[T,new Zt(F.key)]},getMany:function(F){return[T,new Zt().addKeys(F.keys)]},count:O,query:O,openCursor:O};return o(z).forEach(function(F){q[F]=function(U){var $=ke.subscr,j=!!$,Q=dt(ke,v)&&Wt(F,U)?U.obsSet={}:$;if(j){var Y=function(ye){return ye="idb://".concat(h,"/").concat(y,"/").concat(ye),Q[ye]||(Q[ye]=new Zt)},X=Y(""),ie=Y(":dels"),$=z[F](U),j=$[0],$=$[1];if((F==="query"&&j.isPrimaryKey&&!U.values?ie:Y(j.name||"")).add($),!j.isPrimaryKey){if(F!=="count"){var pe=F==="query"&&M&&U.values&&v.query(r(r({},U),{values:!1}));return v[F].apply(this,arguments).then(function(ye){if(F==="query"){if(M&&U.values)return pe.then(function(We){return We=We.result,X.addKeys(We),ye});var Ie=U.values?ye.result.map(x):ye.result;(U.values?X:ie).addKeys(Ie)}else if(F==="openCursor"){var ve=ye,De=U.values;return ve&&Object.create(ve,{key:{get:function(){return ie.addKey(ve.primaryKey),ve.key}},primaryKey:{get:function(){var We=ve.primaryKey;return ie.addKey(We),We}},value:{get:function(){return De&&X.addKey(ve.primaryKey),ve.value}}})}return ye})}ie.add(d)}}return v[F].apply(this,arguments)}}),q}})}};function en(c,h,d){if(d.numFailures===0)return h;if(h.type==="deleteRange")return null;var y=h.keys?h.keys.length:"values"in h&&h.values?h.values.length:1;return d.numFailures===y?null:(h=r({},h),u(h.keys)&&(h.keys=h.keys.filter(function(v,E){return!(E in d.failures)})),"values"in h&&u(h.values)&&(h.values=h.values.filter(function(v,E){return!(E in d.failures)})),h)}function Qt(c,h){return d=c,((y=h).lower===void 0||(y.lowerOpen?0<Je(d,y.lower):0<=Je(d,y.lower)))&&(c=c,(h=h).upper===void 0||(h.upperOpen?Je(c,h.upper)<0:Je(c,h.upper)<=0));var d,y}function Jr(c,h,z,y,v,E){if(!z||z.length===0)return c;var T=h.query.index,x=T.multiEntry,M=h.query.range,B=y.schema.primaryKey.extractKey,q=T.extractKey,O=(T.lowLevelIndex||T).extractKey,z=z.reduce(function(F,U){var $=F,j=[];if(U.type==="add"||U.type==="put")for(var Q=new Zt,Y=U.values.length-1;0<=Y;--Y){var X,ie=U.values[Y],pe=B(ie);Q.hasKey(pe)||(X=q(ie),(x&&u(X)?X.some(function(ve){return Qt(ve,M)}):Qt(X,M))&&(Q.addKey(pe),j.push(ie)))}switch(U.type){case"add":var Ee=new Zt().addKeys(h.values?F.map(function(De){return B(De)}):F),$=F.concat(h.values?j.filter(function(De){return De=B(De),!Ee.hasKey(De)&&(Ee.addKey(De),!0)}):j.map(function(De){return B(De)}).filter(function(De){return!Ee.hasKey(De)&&(Ee.addKey(De),!0)}));break;case"put":var me=new Zt().addKeys(U.values.map(function(De){return B(De)}));$=F.filter(function(De){return!me.hasKey(h.values?B(De):De)}).concat(h.values?j:j.map(function(De){return B(De)}));break;case"delete":var ye=new Zt().addKeys(U.keys);$=F.filter(function(De){return!ye.hasKey(h.values?B(De):De)});break;case"deleteRange":var Ie=U.range;$=F.filter(function(De){return!Qt(B(De),Ie)})}return $},c);return z===c?c:(z.sort(function(F,U){return Je(O(F),O(U))||Je(B(F),B(U))}),h.limit&&h.limit<1/0&&(z.length>h.limit?z.length=h.limit:c.length===h.limit&&z.length<h.limit&&(v.dirty=!0)),E?Object.freeze(z):z)}function kn(c,h){return Je(c.lower,h.lower)===0&&Je(c.upper,h.upper)===0&&!!c.lowerOpen==!!h.lowerOpen&&!!c.upperOpen==!!h.upperOpen}function lo(c,h){return function(d,y,v,E){if(d===void 0)return y!==void 0?-1:0;if(y===void 0)return 1;if((y=Je(d,y))===0){if(v&&E)return 0;if(v)return 1;if(E)return-1}return y}(c.lower,h.lower,c.lowerOpen,h.lowerOpen)<=0&&0<=function(d,y,v,E){if(d===void 0)return y!==void 0?1:0;if(y===void 0)return-1;if((y=Je(d,y))===0){if(v&&E)return 0;if(v)return-1;if(E)return 1}return y}(c.upper,h.upper,c.upperOpen,h.upperOpen)}function fa(c,h,d,y){c.subscribers.add(d),y.addEventListener("abort",function(){var v,E;c.subscribers.delete(d),c.subscribers.size===0&&(v=c,E=h,setTimeout(function(){v.subscribers.size===0&&ze(E,v)},3e3))})}var lv={stack:"dbcore",level:0,name:"Cache",create:function(c){var h=c.schema.name;return r(r({},c),{transaction:function(d,y,v){var E,T,x=c.transaction(d,y,v);return y==="readwrite"&&(T=(E=new AbortController).signal,v=function(M){return function(){if(E.abort(),y==="readwrite"){for(var B=new Set,q=0,O=d;q<O.length;q++){var z=O[q],F=Rr["idb://".concat(h,"/").concat(z)];if(F){var U=c.table(z),$=F.optimisticOps.filter(function(De){return De.trans===x});if(x._explicit&&M&&x.mutatedParts)for(var j=0,Q=Object.values(F.queries.query);j<Q.length;j++)for(var Y=0,X=(Ee=Q[j]).slice();Y<X.length;Y++)ao((me=X[Y]).obsSet,x.mutatedParts)&&(ze(Ee,me),me.subscribers.forEach(function(De){return B.add(De)}));else if(0<$.length){F.optimisticOps=F.optimisticOps.filter(function(De){return De.trans!==x});for(var ie=0,pe=Object.values(F.queries.query);ie<pe.length;ie++)for(var Ee,me,ye,Ie=0,ve=(Ee=pe[ie]).slice();Ie<ve.length;Ie++)(me=ve[Ie]).res!=null&&x.mutatedParts&&(M&&!me.dirty?(ye=Object.isFrozen(me.res),ye=Jr(me.res,me.req,$,U,me,ye),me.dirty?(ze(Ee,me),me.subscribers.forEach(function(De){return B.add(De)})):ye!==me.res&&(me.res=ye,me.promise=Ae.resolve({result:ye}))):(me.dirty&&ze(Ee,me),me.subscribers.forEach(function(De){return B.add(De)})))}}}B.forEach(function(De){return De()})}}},x.addEventListener("abort",v(!1),{signal:T}),x.addEventListener("error",v(!1),{signal:T}),x.addEventListener("complete",v(!0),{signal:T})),x},table:function(d){var y=c.table(d),v=y.schema.primaryKey;return r(r({},y),{mutate:function(E){var T=ke.trans;if(v.outbound||T.db._options.cache==="disabled"||T.explicit||T.idbtrans.mode!=="readwrite")return y.mutate(E);var x=Rr["idb://".concat(h,"/").concat(d)];return x?(T=y.mutate(E),E.type!=="add"&&E.type!=="put"||!(50<=E.values.length||b(v,E).some(function(M){return M==null}))?(x.optimisticOps.push(E),E.mutatedParts&&Yr(E.mutatedParts),T.then(function(M){0<M.numFailures&&(ze(x.optimisticOps,E),(M=en(0,E,M))&&x.optimisticOps.push(M),E.mutatedParts&&Yr(E.mutatedParts))}),T.catch(function(){ze(x.optimisticOps,E),E.mutatedParts&&Yr(E.mutatedParts)})):T.then(function(M){var B=en(0,r(r({},E),{values:E.values.map(function(q,O){var z;return M.failures[O]?q:(q=(z=v.keyPath)!==null&&z!==void 0&&z.includes(".")?P(q):r({},q),D(q,v.keyPath,M.results[O]),q)})}),M);x.optimisticOps.push(B),queueMicrotask(function(){return E.mutatedParts&&Yr(E.mutatedParts)})}),T):y.mutate(E)},query:function(E){if(!dt(ke,y)||!Wt("query",E))return y.query(E);var T=((B=ke.trans)===null||B===void 0?void 0:B.db._options.cache)==="immutable",O=ke,x=O.requery,M=O.signal,B=function(U,$,j,Q){var Y=Rr["idb://".concat(U,"/").concat($)];if(!Y)return[];if(!($=Y.queries[j]))return[null,!1,Y,null];var X=$[(Q.query?Q.query.index.name:null)||""];if(!X)return[null,!1,Y,null];switch(j){case"query":var ie=X.find(function(pe){return pe.req.limit===Q.limit&&pe.req.values===Q.values&&kn(pe.req.query.range,Q.query.range)});return ie?[ie,!0,Y,X]:[X.find(function(pe){return("limit"in pe.req?pe.req.limit:1/0)>=Q.limit&&(!Q.values||pe.req.values)&&lo(pe.req.query.range,Q.query.range)}),!1,Y,X];case"count":return ie=X.find(function(pe){return kn(pe.req.query.range,Q.query.range)}),[ie,!!ie,Y,X]}}(h,d,"query",E),q=B[0],O=B[1],z=B[2],F=B[3];return q&&O?q.obsSet=E.obsSet:(O=y.query(E).then(function(U){var $=U.result;if(q&&(q.res=$),T){for(var j=0,Q=$.length;j<Q;++j)Object.freeze($[j]);Object.freeze($)}else U.result=P($);return U}).catch(function(U){return F&&q&&ze(F,q),Promise.reject(U)}),q={obsSet:E.obsSet,promise:O,subscribers:new Set,type:"query",req:E,dirty:!1},F?F.push(q):(F=[q],(z=z||(Rr["idb://".concat(h,"/").concat(d)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[E.query.index.name||""]=F)),fa(q,F,x,M),q.promise.then(function(U){return{result:Jr(U.result,E,z==null?void 0:z.optimisticOps,y,q,T)}})}})}})}};function Cu(c,h){return new Proxy(c,{get:function(d,y,v){return y==="db"?h:Reflect.get(d,y,v)}})}var Xr=(qt.prototype.version=function(c){if(isNaN(c)||c<.1)throw new ee.Type("Given version is not a positive number");if(c=Math.round(10*c)/10,this.idbdb||this._state.isBeingOpened)throw new ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,c);var h=this._versions,d=h.filter(function(y){return y._cfg.version===c})[0];return d||(d=new this.Version(c),h.push(d),h.sort(Au),d.stores({}),this._state.autoSchema=!1,d)},qt.prototype._whenReady=function(c){var h=this;return this.idbdb&&(this._state.openComplete||ke.letThrough||this._vip)?c():new Ae(function(d,y){if(h._state.openComplete)return y(new ee.DatabaseClosed(h._state.dbOpenError));if(!h._state.isBeingOpened){if(!h._state.autoOpen)return void y(new ee.DatabaseClosed);h.open().catch(Le)}h._state.dbReadyPromise.then(d,y)}).then(c)},qt.prototype.use=function(c){var h=c.stack,d=c.create,y=c.level,v=c.name;return v&&this.unuse({stack:h,name:v}),c=this._middlewares[h]||(this._middlewares[h]=[]),c.push({stack:h,create:d,level:y??10,name:v}),c.sort(function(E,T){return E.level-T.level}),this},qt.prototype.unuse=function(c){var h=c.stack,d=c.name,y=c.create;return h&&this._middlewares[h]&&(this._middlewares[h]=this._middlewares[h].filter(function(v){return y?v.create!==y:!!d&&v.name!==d})),this},qt.prototype.open=function(){var c=this;return br(on,function(){return xu(c)})},qt.prototype._close=function(){var c=this._state,h=Br.indexOf(this);if(0<=h&&Br.splice(h,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}c.isBeingOpened||(c.dbReadyPromise=new Ae(function(d){c.dbReadyResolve=d}),c.openCanceller=new Ae(function(d,y){c.cancelOpen=y}))},qt.prototype.close=function(d){var h=(d===void 0?{disableAutoOpen:!0}:d).disableAutoOpen,d=this._state;h?(d.isBeingOpened&&d.cancelOpen(new ee.DatabaseClosed),this._close(),d.autoOpen=!1,d.dbOpenError=new ee.DatabaseClosed):(this._close(),d.autoOpen=this._options.autoOpen||d.isBeingOpened,d.openComplete=!1,d.dbOpenError=null)},qt.prototype.delete=function(c){var h=this;c===void 0&&(c={disableAutoOpen:!0});var d=0<arguments.length&&typeof arguments[0]!="object",y=this._state;return new Ae(function(v,E){function T(){h.close(c);var x=h._deps.indexedDB.deleteDatabase(h.name);x.onsuccess=wt(function(){var M,B,q;M=h._deps,B=h.name,q=M.indexedDB,M=M.IDBKeyRange,so(q)||B===gi||aa(q,M).delete(B).catch(Le),v()}),x.onerror=Mn(E),x.onblocked=h._fireOnBlocked}if(d)throw new ee.InvalidArgument("Invalid closeOptions argument to db.delete()");y.isBeingOpened?y.dbReadyPromise.then(T):T()})},qt.prototype.backendDB=function(){return this.idbdb},qt.prototype.isOpen=function(){return this.idbdb!==null},qt.prototype.hasBeenClosed=function(){var c=this._state.dbOpenError;return c&&c.name==="DatabaseClosed"},qt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qt.prototype,"tables",{get:function(){var c=this;return o(this._allTables).map(function(h){return c._allTables[h]})},enumerable:!1,configurable:!0}),qt.prototype.transaction=function(){var c=(function(h,d,y){var v=arguments.length;if(v<2)throw new ee.InvalidArgument("Too few arguments");for(var E=new Array(v-1);--v;)E[v-1]=arguments[v];return y=E.pop(),[h,V(E),y]}).apply(this,arguments);return this._transaction.apply(this,c)},qt.prototype._transaction=function(c,h,d){var y=this,v=ke.trans;v&&v.db===this&&c.indexOf("!")===-1||(v=null);var E,T,x=c.indexOf("?")!==-1;c=c.replace("!","").replace("?","");try{if(T=h.map(function(B){if(B=B instanceof y.Table?B.name:B,typeof B!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return B}),c=="r"||c===jr)E=jr;else{if(c!="rw"&&c!=pr)throw new ee.InvalidArgument("Invalid transaction mode: "+c);E=pr}if(v){if(v.mode===jr&&E===pr){if(!x)throw new ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");v=null}v&&T.forEach(function(B){if(v&&v.storeNames.indexOf(B)===-1){if(!x)throw new ee.SubTransaction("Table "+B+" not included in parent transaction.");v=null}}),x&&v&&!v.active&&(v=null)}}catch(B){return v?v._promise(null,function(q,O){O(B)}):Pt(B)}var M=(function B(q,O,z,F,U){return Ae.resolve().then(function(){var $=ke.transless||ke,j=q._createTransaction(O,z,q._dbSchema,F);if(j.explicit=!0,$={trans:j,transless:$},F)j.idbtrans=F.idbtrans;else try{j.create(),j.idbtrans._explicit=!0,q._state.PR1398_maxLoop=3}catch(X){return X.name===re.InvalidState&&q.isOpen()&&0<--q._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),q.close({disableAutoOpen:!1}),q.open().then(function(){return B(q,O,z,null,U)})):Pt(X)}var Q,Y=hn(U);return Y&&hr(),$=Ae.follow(function(){var X;(Q=U.call(j,j))&&(Y?(X=fr.bind(null,null),Q.then(X,X)):typeof Q.next=="function"&&typeof Q.throw=="function"&&(Q=Pr(Q)))},$),(Q&&typeof Q.then=="function"?Ae.resolve(Q).then(function(X){return j.active?X:Pt(new ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):$.then(function(){return Q})).then(function(X){return F&&j._resolve(),j._completion.then(function(){return X})}).catch(function(X){return j._reject(X),Pt(X)})})}).bind(null,this,E,T,v,d);return v?v._promise(E,M,"lock"):ke.trans?br(ke.transless,function(){return y._whenReady(M)}):this._whenReady(M)},qt.prototype.table=function(c){if(!g(this._allTables,c))throw new ee.InvalidTable("Table ".concat(c," does not exist"));return this._allTables[c]},qt);function qt(c,h){var d=this;this._middlewares={},this.verno=0;var y=qt.dependencies;this._options=h=r({addons:qt.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},h),this._deps={indexedDB:h.indexedDB,IDBKeyRange:h.IDBKeyRange},y=h.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var v,E,T,x,M,B={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Le,dbReadyPromise:null,cancelOpen:Le,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:h.autoOpen};B.dbReadyPromise=new Ae(function(O){B.dbReadyResolve=O}),B.openCanceller=new Ae(function(O,z){B.cancelOpen=z}),this._state=B,this.name=c,this.on=ns(this,"populate","blocked","versionchange","close",{ready:[ge,Le]}),this.on.ready.subscribe=te(this.on.ready.subscribe,function(O){return function(z,F){qt.vip(function(){var U,$=d._state;$.openComplete?($.dbOpenError||Ae.resolve().then(z),F&&O(z)):$.onReadyBeingFired?($.onReadyBeingFired.push(z),F&&O(z)):(O(z),U=d,F||O(function j(){U.on.ready.unsubscribe(z),U.on.ready.unsubscribe(j)}))})}}),this.Collection=(v=this,rs(os.prototype,function(Q,j){this.db=v;var F=bu,U=null;if(j)try{F=j()}catch(Y){U=Y}var $=Q._ctx,j=$.table,Q=j.hook.reading.fire;this._ctx={table:j,index:$.index,isPrimKey:!$.index||j.schema.primKey.keyPath&&$.index===j.schema.primKey.name,range:F,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:U,or:$.or,valueMapper:Q!==R?Q:null}})),this.Table=(E=this,rs(ta.prototype,function(O,z,F){this.db=E,this._tx=F,this.name=O,this.schema=z,this.hook=E._allTables[O]?E._allTables[O].hook:ns(null,{creating:[ue,Le],reading:[C,R],updating:[le,Le],deleting:[se,Le]})})),this.Transaction=(T=this,rs(Ar.prototype,function(O,z,F,U,$){var j=this;this.db=T,this.mode=O,this.storeNames=z,this.schema=F,this.chromeTransactionDurability=U,this.idbtrans=null,this.on=ns(this,"complete","error","abort"),this.parent=$||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ae(function(Q,Y){j._resolve=Q,j._reject=Y}),this._completion.then(function(){j.active=!1,j.on.complete.fire()},function(Q){var Y=j.active;return j.active=!1,j.on.error.fire(Q),j.parent?j.parent._reject(Q):Y&&j.idbtrans&&j.idbtrans.abort(),Pt(Q)})})),this.Version=(x=this,rs(Pu.prototype,function(O){this.db=x,this._cfg={version:O,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(M=this,rs(ia.prototype,function(O,z,F){if(this.db=M,this._ctx={table:O,index:z===":id"?null:z,or:F},this._cmp=this._ascending=Je,this._descending=function(U,$){return Je($,U)},this._max=function(U,$){return 0<Je(U,$)?U:$},this._min=function(U,$){return Je(U,$)<0?U:$},this._IDBKeyRange=M._deps.IDBKeyRange,!this._IDBKeyRange)throw new ee.MissingAPI})),this.on("versionchange",function(O){0<O.newVersion?console.warn("Another connection wants to upgrade database '".concat(d.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(d.name,"'. Closing db now to resume the delete request.")),d.close({disableAutoOpen:!1})}),this.on("blocked",function(O){!O.newVersion||O.newVersion<O.oldVersion?console.warn("Dexie.delete('".concat(d.name,"') was blocked")):console.warn("Upgrade '".concat(d.name,"' blocked by other connection holding version ").concat(O.oldVersion/10))}),this._maxKey=vi(h.IDBKeyRange),this._createTransaction=function(O,z,F,U){return new d.Transaction(O,z,F,d._options.chromeTransactionDurability,U)},this._fireOnBlocked=function(O){d.on("blocked").fire(O),Br.filter(function(z){return z.name===d.name&&z!==d&&!z._state.vcFired}).map(function(z){return z.on("versionchange").fire(O)})},this.use(_e),this.use(lv),this.use(it),this.use(p),this.use(G);var q=new Proxy(this,{get:function(O,z,F){if(z==="_vip")return!0;if(z==="table")return function($){return Cu(d.table($),q)};var U=Reflect.get(O,z,F);return U instanceof ta?Cu(U,q):z==="tables"?U.map(function($){return Cu($,q)}):z==="_createTransaction"?function(){return Cu(U.apply(this,arguments),q)}:U}});this.vip=q,y.forEach(function(O){return O(d)})}var Du,Yn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",hv=(ml.prototype.subscribe=function(c,h,d){return this._subscribe(c&&typeof c!="function"?c:{next:c,error:h,complete:d})},ml.prototype[Yn]=function(){return this},ml);function ml(c){this._subscribe=c}try{Du={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Du={indexedDB:null,IDBKeyRange:null}}function Wf(c){var h,d=!1,y=new hv(function(v){var E=hn(c),T,x=!1,M={},B={},q={get closed(){return x},unsubscribe:function(){x||(x=!0,T&&T.abort(),O&&Tr.storagemutated.unsubscribe(F))}};v.start&&v.start(q);var O=!1,z=function(){return Zi(U)},F=function($){Qn(M,$),ao(B,M)&&z()},U=function(){var $,j,Q;!x&&Du.indexedDB&&(M={},$={},T&&T.abort(),T=new AbortController,Q=function(Y){var X=Lr();try{E&&hr();var ie=Er(c,Y);return ie=E?ie.finally(fr):ie}finally{X&&Kn()}}(j={subscr:$,signal:T.signal,requery:z,querier:c,trans:null}),Promise.resolve(Q).then(function(Y){d=!0,h=Y,x||j.signal.aborted||(M={},function(X){for(var ie in X)if(g(X,ie))return;return 1}(B=$)||O||(Tr(as,F),O=!0),Zi(function(){return!x&&v.next&&v.next(Y)}))},function(Y){d=!1,["DatabaseClosedError","AbortError"].includes(Y==null?void 0:Y.name)||x||Zi(function(){x||v.error&&v.error(Y)})}))};return setTimeout(z,0),q});return y.hasValue=function(){return d},y.getValue=function(){return h},y}var fs=Xr;function gl(c){var h=bi;try{bi=!0,Tr.storagemutated.fire(c),un(c,!0)}finally{bi=h}}w(fs,r(r({},Qe),{delete:function(c){return new fs(c,{addons:[]}).delete()},exists:function(c){return new fs(c,{addons:[]}).open().then(function(h){return h.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(c){try{return h=fs.dependencies,d=h.indexedDB,h=h.IDBKeyRange,(so(d)?Promise.resolve(d.databases()).then(function(y){return y.map(function(v){return v.name}).filter(function(v){return v!==gi})}):aa(d,h).toCollection().primaryKeys()).then(c)}catch{return Pt(new ee.MissingAPI)}var h,d},defineClass:function(){return function(c){l(this,c)}},ignoreTransaction:function(c){return ke.trans?br(ke.transless,c):c()},vip:Gr,async:function(c){return function(){try{var h=Pr(c.apply(this,arguments));return h&&typeof h.then=="function"?h:Ae.resolve(h)}catch(d){return Pt(d)}}},spawn:function(c,h,d){try{var y=Pr(c.apply(d,h||[]));return y&&typeof y.then=="function"?y:Ae.resolve(y)}catch(v){return Pt(v)}},currentTransaction:{get:function(){return ke.trans||null}},waitFor:function(c,h){return h=Ae.resolve(typeof c=="function"?fs.ignoreTransaction(c):c).timeout(h||6e4),ke.trans?ke.trans.waitFor(h):h},Promise:Ae,debug:{get:function(){return fe},set:function(c){he(c)}},derive:K,extend:l,props:w,override:te,Events:ns,on:Tr,liveQuery:Wf,extendObservabilitySet:Qn,getByKeyPath:Pe,setByKeyPath:D,delByKeyPath:function(c,h){typeof h=="string"?D(c,h,void 0):"length"in h&&[].map.call(h,function(d){D(c,d,void 0)})},shallowClone:S,deepClone:P,getObjectDiff:_,cmp:Je,asap:Se,minKey:-1/0,addons:[],connections:Br,errnames:re,dependencies:Du,cache:Rr,semVer:"4.0.10",version:"4.0.10".split(".").map(function(c){return parseInt(c)}).reduce(function(c,h,d){return c+h/Math.pow(10,2*d)})})),fs.maxKey=vi(fs.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Tr(as,function(c){bi||(c=new CustomEvent(sa,{detail:c}),bi=!0,dispatchEvent(c),bi=!1)}),addEventListener(sa,function(c){c=c.detail,bi||gl(c)}));var ho,bi=!1,Qf=function(){};return typeof BroadcastChannel<"u"&&((Qf=function(){(ho=new BroadcastChannel(sa)).onmessage=function(c){return c.data&&gl(c.data)}})(),typeof ho.unref=="function"&&ho.unref(),Tr(as,function(c){bi||ho.postMessage(c)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(c){if(!Xr.disableBfCache&&c.persisted){fe&&console.debug("Dexie: handling persisted pagehide"),ho!=null&&ho.close();for(var h=0,d=Br;h<d.length;h++)d[h].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(c){!Xr.disableBfCache&&c.persisted&&(fe&&console.debug("Dexie: handling persisted pageshow"),Qf(),gl({all:new Zt(-1/0,[[]])}))})),Ae.rejectionMapper=function(c,h){return!c||c instanceof ft||c instanceof TypeError||c instanceof SyntaxError||!c.name||!Ve[c.name]?c:(h=new Ve[c.name](h||c.message,c),"stack"in c&&L(h,"stack",{get:function(){return this.inner.stack}}),h)},he(fe),r(Xr,Object.freeze({__proto__:null,Dexie:Xr,liveQuery:Wf,Entity:ea,cmp:Je,PropModSymbol:Gn,PropModification:ht,replacePrefix:function(c,h){return new ht({replacePrefix:[c,h]})},add:function(c){return new ht({add:c})},remove:function(c){return new ht({remove:c})},default:Xr,RangeSet:Zt,mergeRanges:Wr,rangesOverlap:ua}),{default:Xr}),Xr})})(Jg);var dI=Jg.exports;const lh=fI(dI),ep=Symbol.for("Dexie"),Wa=globalThis[ep]||(globalThis[ep]=lh);if(lh.semVer!==Wa.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${lh.semVer} and ${Wa.semVer}`);class pI extends Wa{constructor(){super("NekayOfflineDB_v2");Tn(this,"tasks");Tn(this,"journal");Tn(this,"folders");Tn(this,"notes");Tn(this,"pomodoro");Tn(this,"syncQueue");this.version(1).stores({tasks:"id, syncStatus, folderId, lastModified, [syncStatus+lastModified]",journal:"id, syncStatus, folderId, date, lastModified, [syncStatus+lastModified]",folders:"id, syncStatus, type, lastModified, [syncStatus+lastModified]",notes:"id, syncStatus, lastModified, [syncStatus+lastModified]",pomodoro:"id, syncStatus, type, startTime, lastModified, [syncStatus+lastModified]",syncQueue:"++id, action, store, timestamp"}),this.tasks=this.table("tasks"),this.journal=this.table("journal"),this.folders=this.table("folders"),this.notes=this.table("notes"),this.pomodoro=this.table("pomodoro"),this.syncQueue=this.table("syncQueue")}}const Xn=new pI;class mI{constructor(){Tn(this,"validStores",["tasks","journal","folders","notes","pomodoro","syncQueue"]);Tn(this,"isInitialized",!1)}validateStore(e){if(!this.validStores.includes(e))throw new Error(`Invalid store name: ${e}`)}addMetadata(e){const t=Date.now();return{...e,id:e.id||crypto.randomUUID(),syncStatus:e.syncStatus||"pending",lastModified:t,timestamp:t}}async init(){if(!this.isInitialized)try{await Xn.open(),this.isInitialized=!0}catch(e){throw console.error("Failed to open database:",e),e}}async retryOnQuotaError(e,t=3){let r=0;for(;r<t;)try{return await e()}catch(i){if(r++,i.name==="QuotaExceededError"){if(console.warn("Storage quota exceeded, attempting cleanup..."),await this.cleanup(),r===t)throw i}else throw i}throw new Error("Max retry attempts reached")}async cleanup(){console.log("Starting storage cleanup...");const e=Date.now()-30*24*60*60*1e3;try{await Xn.transaction("rw",this.validStores,async()=>{await Promise.all(this.validStores.map(t=>Xn.table(t).where("timestamp").below(e).delete()))}),console.log("Cleanup completed successfully")}catch(t){throw console.error("Cleanup failed:",t),t}}async addItem(e,t){this.isInitialized||await this.init(),this.validateStore(e);const r=this.addMetadata(t);return await this.retryOnQuotaError(async()=>{try{return await Xn.table(e).add(r),r.id}catch(i){if(i.name==="ConstraintError")return await Xn.table(e).put(r),r.id;throw i}})}async updateItem(e,t,r){this.isInitialized||await this.init();try{this.validateStore(e),await Xn.table(e).update(t,{...r,lastModified:Date.now()})}catch(i){throw console.error(`Failed to update item in ${e}:`,i),i}}async getAllItems(e){this.isInitialized||await this.init();try{return this.validateStore(e),await Xn.table(e).toArray()}catch(t){throw console.error(`Failed to get items from ${e}:`,t),t}}async getItem(e,t){this.isInitialized||await this.init();try{return this.validateStore(e),await Xn.table(e).get(t)}catch(r){throw console.error(`Failed to get item from ${e}:`,r),r}}async deleteItem(e,t){this.isInitialized||await this.init();try{this.validateStore(e),await Xn.table(e).delete(t)}catch(r){throw console.error(`Failed to delete item from ${e}:`,r),r}}async clearItems(e){this.isInitialized||await this.init();try{this.validateStore(e),await Xn.table(e).clear()}catch(t){throw console.error(`Failed to clear items from ${e}:`,t),t}}async clearStore(e){this.isInitialized||await this.init();try{this.validateStore(e),await Xn.table(e).clear()}catch(t){throw console.error(`Failed to clear store ${e}:`,t),t}}async getPendingSyncItems(e,t,r){this.isInitialized||await this.init();try{return this.validateStore(e),await Xn.table(e).where("[syncStatus+lastModified]").between(["pending",Wa.minKey],["pending",Wa.maxKey]).offset(r).limit(t).toArray()}catch(i){throw console.error(`Failed to get pending sync items from ${e}:`,i),i}}}const ot=new mI;var tp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},gI=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Zg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,u=o?n[i+1]:0,l=i+2<n.length,f=l?n[i+2]:0,m=s>>2,g=(s&3)<<4|u>>4;let w=(u&15)<<2|f>>6,I=f&63;l||(I=64,o||(w=64)),r.push(t[m],t[g],t[w],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xg(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||f==null||g==null)throw new yI;const w=s<<2|u>>4;if(r.push(w),f!==64){const I=u<<4&240|f>>2;if(r.push(I),g!==64){const L=f<<6&192|g;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _I=function(n){const e=Xg(n);return Zg.encodeByteArray(e,!0)},dc=function(n){return _I(n).replace(/\./g,"")},vI=function(n){try{return Zg.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=()=>wI().__FIREBASE_DEFAULTS__,bI=()=>{if(typeof process>"u"||typeof tp>"u")return;const n=tp.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},II=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&vI(n[1]);return e&&JSON.parse(e)},cf=()=>{try{return EI()||bI()||II()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},TI=n=>{var e,t;return(t=(e=cf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},AI=n=>{const e=TI(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ey=()=>{var n;return(n=cf())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RI(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[dc(JSON.stringify(t)),dc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PI(){var n;const e=(n=cf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ty(){return!PI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ny(){try{return typeof indexedDB=="object"}catch{return!1}}function xI(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="FirebaseError";class Wo extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=CI,Object.setPrototypeOf(this,Wo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ry.prototype.create)}}class ry{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?DI(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Wo(i,u,r)}}function DI(n,e){return n.replace(VI,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const VI=/\{\$([^}]+)}/g;function mc(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(np(s)&&np(o)){if(!mc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function np(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(n){return n&&n._delegate?n._delegate:n}class Qa{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new SI;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NI(e))try{this.getOrInitializeService({instanceIdentifier:ws})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ws){return this.instances.has(e)}getOptions(e=ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:OI(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ws){return this.component?this.component.multipleInstances?e:ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function OI(n){return n===ws?void 0:n}function NI(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new kI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ut||(ut={}));const FI={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},LI=ut.INFO,BI={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},jI=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=BI[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iy{constructor(e){this.name=e,this._logLevel=LI,this._logHandler=jI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const UI=(n,e)=>e.some(t=>n instanceof t);let rp,ip;function qI(){return rp||(rp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KI(){return ip||(ip=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sy=new WeakMap,hh=new WeakMap,oy=new WeakMap,Ml=new WeakMap,lf=new WeakMap;function $I(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Fi(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&sy.set(t,n)}).catch(()=>{}),lf.set(e,n),e}function zI(n){if(hh.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});hh.set(n,e)}let fh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return hh.get(n);if(e==="objectStoreNames")return n.objectStoreNames||oy.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function GI(n){fh=n(fh)}function HI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Fl(this),e,...t);return oy.set(r,e.sort?e.sort():[e]),Fi(r)}:KI().includes(n)?function(...e){return n.apply(Fl(this),e),Fi(sy.get(this))}:function(...e){return Fi(n.apply(Fl(this),e))}}function WI(n){return typeof n=="function"?HI(n):(n instanceof IDBTransaction&&zI(n),UI(n,qI())?new Proxy(n,fh):n)}function Fi(n){if(n instanceof IDBRequest)return $I(n);if(Ml.has(n))return Ml.get(n);const e=WI(n);return e!==n&&(Ml.set(n,e),lf.set(e,n)),e}const Fl=n=>lf.get(n);function QI(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),u=Fi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Fi(o.result),l.oldVersion,l.newVersion,Fi(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const YI=["get","getKey","getAll","getAllKeys","count"],JI=["put","add","delete","clear"],Ll=new Map;function sp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ll.get(e))return Ll.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=JI.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||YI.includes(t)))return;const s=async function(o,...u){const l=this.transaction(o,i?"readwrite":"readonly");let f=l.store;return r&&(f=f.index(u.shift())),(await Promise.all([f[t](...u),i&&l.done]))[0]};return Ll.set(e,s),s}GI(n=>({...n,get:(e,t,r)=>sp(e,t)||n.get(e,t,r),has:(e,t)=>!!sp(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZI(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ZI(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dh="@firebase/app",op="0.10.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new iy("@firebase/app"),e0="@firebase/app-compat",t0="@firebase/analytics-compat",n0="@firebase/analytics",r0="@firebase/app-check-compat",i0="@firebase/app-check",s0="@firebase/auth",o0="@firebase/auth-compat",a0="@firebase/database",u0="@firebase/data-connect",c0="@firebase/database-compat",l0="@firebase/functions",h0="@firebase/functions-compat",f0="@firebase/installations",d0="@firebase/installations-compat",p0="@firebase/messaging",m0="@firebase/messaging-compat",g0="@firebase/performance",y0="@firebase/performance-compat",_0="@firebase/remote-config",v0="@firebase/remote-config-compat",w0="@firebase/storage",E0="@firebase/storage-compat",b0="@firebase/firestore",I0="@firebase/vertexai",T0="@firebase/firestore-compat",A0="firebase",S0="11.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph="[DEFAULT]",R0={[dh]:"fire-core",[e0]:"fire-core-compat",[n0]:"fire-analytics",[t0]:"fire-analytics-compat",[i0]:"fire-app-check",[r0]:"fire-app-check-compat",[s0]:"fire-auth",[o0]:"fire-auth-compat",[a0]:"fire-rtdb",[u0]:"fire-data-connect",[c0]:"fire-rtdb-compat",[l0]:"fire-fn",[h0]:"fire-fn-compat",[f0]:"fire-iid",[d0]:"fire-iid-compat",[p0]:"fire-fcm",[m0]:"fire-fcm-compat",[g0]:"fire-perf",[y0]:"fire-perf-compat",[_0]:"fire-rc",[v0]:"fire-rc-compat",[w0]:"fire-gcs",[E0]:"fire-gcs-compat",[b0]:"fire-fst",[T0]:"fire-fst-compat",[I0]:"fire-vertex","fire-js":"fire-js",[A0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=new Map,P0=new Map,mh=new Map;function ap(n,e){try{n.container.addComponent(e)}catch(t){ui.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function yc(n){const e=n.name;if(mh.has(e))return ui.debug(`There were multiple attempts to register component ${e}.`),!1;mh.set(e,n);for(const t of gc.values())ap(t,n);for(const t of P0.values())ap(t,n);return!0}function ay(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Li=new ry("app","Firebase",x0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Li.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0=S0;function uy(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ph,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Li.create("bad-app-name",{appName:String(i)});if(t||(t=ey()),!t)throw Li.create("no-options");const s=gc.get(i);if(s){if(mc(t,s.options)&&mc(r,s.config))return s;throw Li.create("duplicate-app",{appName:i})}const o=new MI(i);for(const l of mh.values())o.addComponent(l);const u=new C0(t,r,o);return gc.set(i,u),u}function V0(n=ph){const e=gc.get(n);if(!e&&n===ph&&ey())return uy();if(!e)throw Li.create("no-app",{appName:n});return e}function ko(n,e,t){var r;let i=(r=R0[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ui.warn(u.join(" "));return}yc(new Qa(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="firebase-heartbeat-database",O0=1,Ya="firebase-heartbeat-store";let Bl=null;function cy(){return Bl||(Bl=QI(k0,O0,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ya)}catch(t){console.warn(t)}}}}).catch(n=>{throw Li.create("idb-open",{originalErrorMessage:n.message})})),Bl}async function N0(n){try{const t=(await cy()).transaction(Ya),r=await t.objectStore(Ya).get(ly(n));return await t.done,r}catch(e){if(e instanceof Wo)ui.warn(e.message);else{const t=Li.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ui.warn(t.message)}}}async function up(n,e){try{const r=(await cy()).transaction(Ya,"readwrite");await r.objectStore(Ya).put(e,ly(n)),await r.done}catch(t){if(t instanceof Wo)ui.warn(t.message);else{const r=Li.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ui.warn(r.message)}}}function ly(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=1024,F0=30*24*60*60*1e3;class L0{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new j0(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=cp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=F0}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ui.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=cp(),{heartbeatsToSend:r,unsentEntries:i}=B0(this._heartbeatsCache.heartbeats),s=dc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ui.warn(t),""}}}function cp(){return new Date().toISOString().substring(0,10)}function B0(n,e=M0){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),lp(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),lp(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class j0{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ny()?xI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await N0(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return up(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return up(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function lp(n){return dc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n){yc(new Qa("platform-logger",e=>new XI(e),"PRIVATE")),yc(new Qa("heartbeat",e=>new L0(e),"PRIVATE")),ko(dh,op,n),ko(dh,op,"esm2017"),ko("fire-js","")}U0("");var hp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cs,hy;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,S){function A(){}A.prototype=S.prototype,D.D=S.prototype,D.prototype=new A,D.prototype.constructor=D,D.C=function(V,N,k){for(var P=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)P[lt-2]=arguments[lt];return S.prototype[N].apply(V,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,S,A){A||(A=0);var V=Array(16);if(typeof S=="string")for(var N=0;16>N;++N)V[N]=S.charCodeAt(A++)|S.charCodeAt(A++)<<8|S.charCodeAt(A++)<<16|S.charCodeAt(A++)<<24;else for(N=0;16>N;++N)V[N]=S[A++]|S[A++]<<8|S[A++]<<16|S[A++]<<24;S=D.g[0],A=D.g[1],N=D.g[2];var k=D.g[3],P=S+(k^A&(N^k))+V[0]+3614090360&4294967295;S=A+(P<<7&4294967295|P>>>25),P=k+(N^S&(A^N))+V[1]+3905402710&4294967295,k=S+(P<<12&4294967295|P>>>20),P=N+(A^k&(S^A))+V[2]+606105819&4294967295,N=k+(P<<17&4294967295|P>>>15),P=A+(S^N&(k^S))+V[3]+3250441966&4294967295,A=N+(P<<22&4294967295|P>>>10),P=S+(k^A&(N^k))+V[4]+4118548399&4294967295,S=A+(P<<7&4294967295|P>>>25),P=k+(N^S&(A^N))+V[5]+1200080426&4294967295,k=S+(P<<12&4294967295|P>>>20),P=N+(A^k&(S^A))+V[6]+2821735955&4294967295,N=k+(P<<17&4294967295|P>>>15),P=A+(S^N&(k^S))+V[7]+4249261313&4294967295,A=N+(P<<22&4294967295|P>>>10),P=S+(k^A&(N^k))+V[8]+1770035416&4294967295,S=A+(P<<7&4294967295|P>>>25),P=k+(N^S&(A^N))+V[9]+2336552879&4294967295,k=S+(P<<12&4294967295|P>>>20),P=N+(A^k&(S^A))+V[10]+4294925233&4294967295,N=k+(P<<17&4294967295|P>>>15),P=A+(S^N&(k^S))+V[11]+2304563134&4294967295,A=N+(P<<22&4294967295|P>>>10),P=S+(k^A&(N^k))+V[12]+1804603682&4294967295,S=A+(P<<7&4294967295|P>>>25),P=k+(N^S&(A^N))+V[13]+4254626195&4294967295,k=S+(P<<12&4294967295|P>>>20),P=N+(A^k&(S^A))+V[14]+2792965006&4294967295,N=k+(P<<17&4294967295|P>>>15),P=A+(S^N&(k^S))+V[15]+1236535329&4294967295,A=N+(P<<22&4294967295|P>>>10),P=S+(N^k&(A^N))+V[1]+4129170786&4294967295,S=A+(P<<5&4294967295|P>>>27),P=k+(A^N&(S^A))+V[6]+3225465664&4294967295,k=S+(P<<9&4294967295|P>>>23),P=N+(S^A&(k^S))+V[11]+643717713&4294967295,N=k+(P<<14&4294967295|P>>>18),P=A+(k^S&(N^k))+V[0]+3921069994&4294967295,A=N+(P<<20&4294967295|P>>>12),P=S+(N^k&(A^N))+V[5]+3593408605&4294967295,S=A+(P<<5&4294967295|P>>>27),P=k+(A^N&(S^A))+V[10]+38016083&4294967295,k=S+(P<<9&4294967295|P>>>23),P=N+(S^A&(k^S))+V[15]+3634488961&4294967295,N=k+(P<<14&4294967295|P>>>18),P=A+(k^S&(N^k))+V[4]+3889429448&4294967295,A=N+(P<<20&4294967295|P>>>12),P=S+(N^k&(A^N))+V[9]+568446438&4294967295,S=A+(P<<5&4294967295|P>>>27),P=k+(A^N&(S^A))+V[14]+3275163606&4294967295,k=S+(P<<9&4294967295|P>>>23),P=N+(S^A&(k^S))+V[3]+4107603335&4294967295,N=k+(P<<14&4294967295|P>>>18),P=A+(k^S&(N^k))+V[8]+1163531501&4294967295,A=N+(P<<20&4294967295|P>>>12),P=S+(N^k&(A^N))+V[13]+2850285829&4294967295,S=A+(P<<5&4294967295|P>>>27),P=k+(A^N&(S^A))+V[2]+4243563512&4294967295,k=S+(P<<9&4294967295|P>>>23),P=N+(S^A&(k^S))+V[7]+1735328473&4294967295,N=k+(P<<14&4294967295|P>>>18),P=A+(k^S&(N^k))+V[12]+2368359562&4294967295,A=N+(P<<20&4294967295|P>>>12),P=S+(A^N^k)+V[5]+4294588738&4294967295,S=A+(P<<4&4294967295|P>>>28),P=k+(S^A^N)+V[8]+2272392833&4294967295,k=S+(P<<11&4294967295|P>>>21),P=N+(k^S^A)+V[11]+1839030562&4294967295,N=k+(P<<16&4294967295|P>>>16),P=A+(N^k^S)+V[14]+4259657740&4294967295,A=N+(P<<23&4294967295|P>>>9),P=S+(A^N^k)+V[1]+2763975236&4294967295,S=A+(P<<4&4294967295|P>>>28),P=k+(S^A^N)+V[4]+1272893353&4294967295,k=S+(P<<11&4294967295|P>>>21),P=N+(k^S^A)+V[7]+4139469664&4294967295,N=k+(P<<16&4294967295|P>>>16),P=A+(N^k^S)+V[10]+3200236656&4294967295,A=N+(P<<23&4294967295|P>>>9),P=S+(A^N^k)+V[13]+681279174&4294967295,S=A+(P<<4&4294967295|P>>>28),P=k+(S^A^N)+V[0]+3936430074&4294967295,k=S+(P<<11&4294967295|P>>>21),P=N+(k^S^A)+V[3]+3572445317&4294967295,N=k+(P<<16&4294967295|P>>>16),P=A+(N^k^S)+V[6]+76029189&4294967295,A=N+(P<<23&4294967295|P>>>9),P=S+(A^N^k)+V[9]+3654602809&4294967295,S=A+(P<<4&4294967295|P>>>28),P=k+(S^A^N)+V[12]+3873151461&4294967295,k=S+(P<<11&4294967295|P>>>21),P=N+(k^S^A)+V[15]+530742520&4294967295,N=k+(P<<16&4294967295|P>>>16),P=A+(N^k^S)+V[2]+3299628645&4294967295,A=N+(P<<23&4294967295|P>>>9),P=S+(N^(A|~k))+V[0]+4096336452&4294967295,S=A+(P<<6&4294967295|P>>>26),P=k+(A^(S|~N))+V[7]+1126891415&4294967295,k=S+(P<<10&4294967295|P>>>22),P=N+(S^(k|~A))+V[14]+2878612391&4294967295,N=k+(P<<15&4294967295|P>>>17),P=A+(k^(N|~S))+V[5]+4237533241&4294967295,A=N+(P<<21&4294967295|P>>>11),P=S+(N^(A|~k))+V[12]+1700485571&4294967295,S=A+(P<<6&4294967295|P>>>26),P=k+(A^(S|~N))+V[3]+2399980690&4294967295,k=S+(P<<10&4294967295|P>>>22),P=N+(S^(k|~A))+V[10]+4293915773&4294967295,N=k+(P<<15&4294967295|P>>>17),P=A+(k^(N|~S))+V[1]+2240044497&4294967295,A=N+(P<<21&4294967295|P>>>11),P=S+(N^(A|~k))+V[8]+1873313359&4294967295,S=A+(P<<6&4294967295|P>>>26),P=k+(A^(S|~N))+V[15]+4264355552&4294967295,k=S+(P<<10&4294967295|P>>>22),P=N+(S^(k|~A))+V[6]+2734768916&4294967295,N=k+(P<<15&4294967295|P>>>17),P=A+(k^(N|~S))+V[13]+1309151649&4294967295,A=N+(P<<21&4294967295|P>>>11),P=S+(N^(A|~k))+V[4]+4149444226&4294967295,S=A+(P<<6&4294967295|P>>>26),P=k+(A^(S|~N))+V[11]+3174756917&4294967295,k=S+(P<<10&4294967295|P>>>22),P=N+(S^(k|~A))+V[2]+718787259&4294967295,N=k+(P<<15&4294967295|P>>>17),P=A+(k^(N|~S))+V[9]+3951481745&4294967295,D.g[0]=D.g[0]+S&4294967295,D.g[1]=D.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,D.g[2]=D.g[2]+N&4294967295,D.g[3]=D.g[3]+k&4294967295}r.prototype.u=function(D,S){S===void 0&&(S=D.length);for(var A=S-this.blockSize,V=this.B,N=this.h,k=0;k<S;){if(N==0)for(;k<=A;)i(this,D,k),k+=this.blockSize;if(typeof D=="string"){for(;k<S;)if(V[N++]=D.charCodeAt(k++),N==this.blockSize){i(this,V),N=0;break}}else for(;k<S;)if(V[N++]=D[k++],N==this.blockSize){i(this,V),N=0;break}}this.h=N,this.o+=S},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var S=1;S<D.length-8;++S)D[S]=0;var A=8*this.o;for(S=D.length-8;S<D.length;++S)D[S]=A&255,A/=256;for(this.u(D),D=Array(16),S=A=0;4>S;++S)for(var V=0;32>V;V+=8)D[A++]=this.g[S]>>>V&255;return D};function s(D,S){var A=u;return Object.prototype.hasOwnProperty.call(A,D)?A[D]:A[D]=S(D)}function o(D,S){this.h=S;for(var A=[],V=!0,N=D.length-1;0<=N;N--){var k=D[N]|0;V&&k==S||(A[N]=k,V=!1)}this.g=A}var u={};function l(D){return-128<=D&&128>D?s(D,function(S){return new o([S|0],0>S?-1:0)}):new o([D|0],0>D?-1:0)}function f(D){if(isNaN(D)||!isFinite(D))return g;if(0>D)return J(f(-D));for(var S=[],A=1,V=0;D>=A;V++)S[V]=D/A|0,A*=4294967296;return new o(S,0)}function m(D,S){if(D.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(D.charAt(0)=="-")return J(m(D.substring(1),S));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=f(Math.pow(S,8)),V=g,N=0;N<D.length;N+=8){var k=Math.min(8,D.length-N),P=parseInt(D.substring(N,N+k),S);8>k?(k=f(Math.pow(S,k)),V=V.j(k).add(f(P))):(V=V.j(A),V=V.add(f(P)))}return V}var g=l(0),w=l(1),I=l(16777216);n=o.prototype,n.m=function(){if(K(this))return-J(this).m();for(var D=0,S=1,A=0;A<this.g.length;A++){var V=this.i(A);D+=(0<=V?V:4294967296+V)*S,S*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(L(this))return"0";if(K(this))return"-"+J(this).toString(D);for(var S=f(Math.pow(D,6)),A=this,V="";;){var N=ce(A,S).g;A=ae(A,N.j(S));var k=((0<A.g.length?A.g[0]:A.h)>>>0).toString(D);if(A=N,L(A))return k+V;for(;6>k.length;)k="0"+k;V=k+V}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function L(D){if(D.h!=0)return!1;for(var S=0;S<D.g.length;S++)if(D.g[S]!=0)return!1;return!0}function K(D){return D.h==-1}n.l=function(D){return D=ae(this,D),K(D)?-1:L(D)?0:1};function J(D){for(var S=D.g.length,A=[],V=0;V<S;V++)A[V]=~D.g[V];return new o(A,~D.h).add(w)}n.abs=function(){return K(this)?J(this):this},n.add=function(D){for(var S=Math.max(this.g.length,D.g.length),A=[],V=0,N=0;N<=S;N++){var k=V+(this.i(N)&65535)+(D.i(N)&65535),P=(k>>>16)+(this.i(N)>>>16)+(D.i(N)>>>16);V=P>>>16,k&=65535,P&=65535,A[N]=P<<16|k}return new o(A,A[A.length-1]&-2147483648?-1:0)};function ae(D,S){return D.add(J(S))}n.j=function(D){if(L(this)||L(D))return g;if(K(this))return K(D)?J(this).j(J(D)):J(J(this).j(D));if(K(D))return J(this.j(J(D)));if(0>this.l(I)&&0>D.l(I))return f(this.m()*D.m());for(var S=this.g.length+D.g.length,A=[],V=0;V<2*S;V++)A[V]=0;for(V=0;V<this.g.length;V++)for(var N=0;N<D.g.length;N++){var k=this.i(V)>>>16,P=this.i(V)&65535,lt=D.i(N)>>>16,Vt=D.i(N)&65535;A[2*V+2*N]+=P*Vt,oe(A,2*V+2*N),A[2*V+2*N+1]+=k*Vt,oe(A,2*V+2*N+1),A[2*V+2*N+1]+=P*lt,oe(A,2*V+2*N+1),A[2*V+2*N+2]+=k*lt,oe(A,2*V+2*N+2)}for(V=0;V<S;V++)A[V]=A[2*V+1]<<16|A[2*V];for(V=S;V<2*S;V++)A[V]=0;return new o(A,0)};function oe(D,S){for(;(D[S]&65535)!=D[S];)D[S+1]+=D[S]>>>16,D[S]&=65535,S++}function te(D,S){this.g=D,this.h=S}function ce(D,S){if(L(S))throw Error("division by zero");if(L(D))return new te(g,g);if(K(D))return S=ce(J(D),S),new te(J(S.g),J(S.h));if(K(S))return S=ce(D,J(S)),new te(J(S.g),S.h);if(30<D.g.length){if(K(D)||K(S))throw Error("slowDivide_ only works with positive integers.");for(var A=w,V=S;0>=V.l(D);)A=Se(A),V=Se(V);var N=Pe(A,1),k=Pe(V,1);for(V=Pe(V,2),A=Pe(A,2);!L(V);){var P=k.add(V);0>=P.l(D)&&(N=N.add(A),k=P),V=Pe(V,1),A=Pe(A,1)}return S=ae(D,N.j(S)),new te(N,S)}for(N=g;0<=D.l(S);){for(A=Math.max(1,Math.floor(D.m()/S.m())),V=Math.ceil(Math.log(A)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),k=f(A),P=k.j(S);K(P)||0<P.l(D);)A-=V,k=f(A),P=k.j(S);L(k)&&(k=w),N=N.add(k),D=ae(D,P)}return new te(N,D)}n.A=function(D){return ce(this,D).h},n.and=function(D){for(var S=Math.max(this.g.length,D.g.length),A=[],V=0;V<S;V++)A[V]=this.i(V)&D.i(V);return new o(A,this.h&D.h)},n.or=function(D){for(var S=Math.max(this.g.length,D.g.length),A=[],V=0;V<S;V++)A[V]=this.i(V)|D.i(V);return new o(A,this.h|D.h)},n.xor=function(D){for(var S=Math.max(this.g.length,D.g.length),A=[],V=0;V<S;V++)A[V]=this.i(V)^D.i(V);return new o(A,this.h^D.h)};function Se(D){for(var S=D.g.length+1,A=[],V=0;V<S;V++)A[V]=D.i(V)<<1|D.i(V-1)>>>31;return new o(A,D.h)}function Pe(D,S){var A=S>>5;S%=32;for(var V=D.g.length-A,N=[],k=0;k<V;k++)N[k]=0<S?D.i(k+A)>>>S|D.i(k+A+1)<<32-S:D.i(k+A);return new o(N,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,hy=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Cs=o}).apply(typeof hp<"u"?hp:typeof self<"u"?self:typeof window<"u"?window:{});var Lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fy,ba,dy,Yu,gh,py,my,gy;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,p,_){return a==Array.prototype||a==Object.prototype||(a[p]=_.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lu=="object"&&Lu];for(var p=0;p<a.length;++p){var _=a[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=t(this);function i(a,p){if(p)e:{var _=r;a=a.split(".");for(var b=0;b<a.length-1;b++){var G=a[b];if(!(G in _))break e;_=_[G]}a=a[a.length-1],b=_[a],p=p(b),p!=b&&p!=null&&e(_,a,{configurable:!0,writable:!0,value:p})}}function s(a,p){a instanceof String&&(a+="");var _=0,b=!1,G={next:function(){if(!b&&_<a.length){var Z=_++;return{value:p(Z,a[Z]),done:!1}}return b=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}i("Array.prototype.values",function(a){return a||function(){return s(this,function(p,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function l(a){var p=typeof a;return p=p!="object"?p:a?Array.isArray(a)?"array":p:"null",p=="array"||p=="object"&&typeof a.length=="number"}function f(a){var p=typeof a;return p=="object"&&a!=null||p=="function"}function m(a,p,_){return a.call.apply(a.bind,arguments)}function g(a,p,_){if(!a)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,b),a.apply(p,G)}}return function(){return a.apply(p,arguments)}}function w(a,p,_){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,w.apply(null,arguments)}function I(a,p){var _=Array.prototype.slice.call(arguments,1);return function(){var b=_.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function L(a,p){function _(){}_.prototype=p.prototype,a.aa=p.prototype,a.prototype=new _,a.prototype.constructor=a,a.Qb=function(b,G,Z){for(var _e=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)_e[dt-2]=arguments[dt];return p.prototype[G].apply(b,_e)}}function K(a){const p=a.length;if(0<p){const _=Array(p);for(let b=0;b<p;b++)_[b]=a[b];return _}return[]}function J(a,p){for(let _=1;_<arguments.length;_++){const b=arguments[_];if(l(b)){const G=a.length||0,Z=b.length||0;a.length=G+Z;for(let _e=0;_e<Z;_e++)a[G+_e]=b[_e]}else a.push(b)}}class ae{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function oe(a){return/^[\s\xa0]*$/.test(a)}function te(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function ce(a){return ce[" "](a),a}ce[" "]=function(){};var Se=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function Pe(a,p,_){for(const b in a)p.call(_,a[b],b,a)}function D(a,p){for(const _ in a)p.call(void 0,a[_],_,a)}function S(a){const p={};for(const _ in a)p[_]=a[_];return p}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(a,p){let _,b;for(let G=1;G<arguments.length;G++){b=arguments[G];for(_ in b)a[_]=b[_];for(let Z=0;Z<A.length;Z++)_=A[Z],Object.prototype.hasOwnProperty.call(b,_)&&(a[_]=b[_])}}function N(a){var p=1;a=a.split(":");const _=[];for(;0<p&&a.length;)_.push(a.shift()),p--;return a.length&&_.push(a.join(":")),_}function k(a){u.setTimeout(()=>{throw a},0)}function P(){var a=$t;let p=null;return a.g&&(p=a.g,a.g=a.g.next,a.g||(a.h=null),p.next=null),p}class lt{constructor(){this.h=this.g=null}add(p,_){const b=Vt.get();b.set(p,_),this.h?this.h.next=b:this.g=b,this.h=b}}var Vt=new ae(()=>new ct,a=>a.reset());class ct{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ue,ze=!1,$t=new lt,Ft=()=>{const a=u.Promise.resolve(void 0);Ue=()=>{a.then(hn)}};var hn=()=>{for(var a;a=P();){try{a.h.call(a.g)}catch(_){k(_)}var p=Vt;p.j(a),100>p.h&&(p.h++,a.next=p.g,p.g=a)}ze=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ft(a,p){this.type=a,this.g=this.target=p,this.defaultPrevented=!1}ft.prototype.h=function(){this.defaultPrevented=!0};var ar=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,p=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const _=()=>{};u.addEventListener("test",_,p),u.removeEventListener("test",_,p)}catch{}return a}();function En(a,p){if(ft.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var _=this.type=a.type,b=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=p,p=a.relatedTarget){if(Se){e:{try{ce(p.nodeName);var G=!0;break e}catch{}G=!1}G||(p=null)}}else _=="mouseover"?p=a.fromElement:_=="mouseout"&&(p=a.toElement);this.relatedTarget=p,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Lt[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&En.aa.h.call(this)}}L(En,ft);var Lt={2:"touch",3:"pen",4:"mouse"};En.prototype.h=function(){En.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var re="closure_listenable_"+(1e6*Math.random()|0),xe=0;function ee(a,p,_,b,G){this.listener=a,this.proxy=null,this.src=p,this.type=_,this.capture=!!b,this.ha=G,this.key=++xe,this.da=this.fa=!1}function Ve(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Qe(a){this.src=a,this.g={},this.h=0}Qe.prototype.add=function(a,p,_,b,G){var Z=a.toString();a=this.g[Z],a||(a=this.g[Z]=[],this.h++);var _e=R(a,p,b,G);return-1<_e?(p=a[_e],_||(p.fa=!1)):(p=new ee(p,this.src,Z,!!b,G),p.fa=_,a.push(p)),p};function Le(a,p){var _=p.type;if(_ in a.g){var b=a.g[_],G=Array.prototype.indexOf.call(b,p,void 0),Z;(Z=0<=G)&&Array.prototype.splice.call(b,G,1),Z&&(Ve(p),a.g[_].length==0&&(delete a.g[_],a.h--))}}function R(a,p,_,b){for(var G=0;G<a.length;++G){var Z=a[G];if(!Z.da&&Z.listener==p&&Z.capture==!!_&&Z.ha==b)return G}return-1}var C="closure_lm_"+(1e6*Math.random()|0),W={};function ue(a,p,_,b,G){if(Array.isArray(p)){for(var Z=0;Z<p.length;Z++)ue(a,p[Z],_,b,G);return null}return _=Oe(_),a&&a[re]?a.K(p,_,f(b)?!!b.capture:!!b,G):se(a,p,_,!1,b,G)}function se(a,p,_,b,G,Z){if(!p)throw Error("Invalid event type");var _e=f(G)?!!G.capture:!!G,dt=Me(a);if(dt||(a[C]=dt=new Qe(a)),_=dt.add(p,_,b,_e,Z),_.proxy)return _;if(b=le(),_.proxy=b,b.src=a,b.listener=_,a.addEventListener)ar||(G=_e),G===void 0&&(G=!1),a.addEventListener(p.toString(),b,G);else if(a.attachEvent)a.attachEvent(fe(p.toString()),b);else if(a.addListener&&a.removeListener)a.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return _}function le(){function a(_){return p.call(a.src,a.listener,_)}const p=he;return a}function be(a,p,_,b,G){if(Array.isArray(p))for(var Z=0;Z<p.length;Z++)be(a,p[Z],_,b,G);else b=f(b)?!!b.capture:!!b,_=Oe(_),a&&a[re]?(a=a.i,p=String(p).toString(),p in a.g&&(Z=a.g[p],_=R(Z,_,b,G),-1<_&&(Ve(Z[_]),Array.prototype.splice.call(Z,_,1),Z.length==0&&(delete a.g[p],a.h--)))):a&&(a=Me(a))&&(p=a.g[p.toString()],a=-1,p&&(a=R(p,_,b,G)),(_=-1<a?p[a]:null)&&ge(_))}function ge(a){if(typeof a!="number"&&a&&!a.da){var p=a.src;if(p&&p[re])Le(p.i,a);else{var _=a.type,b=a.proxy;p.removeEventListener?p.removeEventListener(_,b,a.capture):p.detachEvent?p.detachEvent(fe(_),b):p.addListener&&p.removeListener&&p.removeListener(b),(_=Me(p))?(Le(_,a),_.h==0&&(_.src=null,p[C]=null)):Ve(a)}}}function fe(a){return a in W?W[a]:W[a]="on"+a}function he(a,p){if(a.da)a=!0;else{p=new En(p,this);var _=a.listener,b=a.ha||a.src;a.fa&&ge(a),a=_.call(b,p)}return a}function Me(a){return a=a[C],a instanceof Qe?a:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oe(a){return typeof a=="function"?a:(a[Te]||(a[Te]=function(p){return a.handleEvent(p)}),a[Te])}function Ce(){At.call(this),this.i=new Qe(this),this.M=this,this.F=null}L(Ce,At),Ce.prototype[re]=!0,Ce.prototype.removeEventListener=function(a,p,_,b){be(this,a,p,_,b)};function Be(a,p){var _,b=a.F;if(b)for(_=[];b;b=b.F)_.push(b);if(a=a.M,b=p.type||p,typeof p=="string")p=new ft(p,a);else if(p instanceof ft)p.target=p.target||a;else{var G=p;p=new ft(b,a),V(p,G)}if(G=!0,_)for(var Z=_.length-1;0<=Z;Z--){var _e=p.g=_[Z];G=tt(_e,b,!0,p)&&G}if(_e=p.g=a,G=tt(_e,b,!0,p)&&G,G=tt(_e,b,!1,p)&&G,_)for(Z=0;Z<_.length;Z++)_e=p.g=_[Z],G=tt(_e,b,!1,p)&&G}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var a=this.i,p;for(p in a.g){for(var _=a.g[p],b=0;b<_.length;b++)Ve(_[b]);delete a.g[p],a.h--}}this.F=null},Ce.prototype.K=function(a,p,_,b){return this.i.add(String(a),p,!1,_,b)},Ce.prototype.L=function(a,p,_,b){return this.i.add(String(a),p,!0,_,b)};function tt(a,p,_,b){if(p=a.i.g[String(p)],!p)return!0;p=p.concat();for(var G=!0,Z=0;Z<p.length;++Z){var _e=p[Z];if(_e&&!_e.da&&_e.capture==_){var dt=_e.listener,Wt=_e.ha||_e.src;_e.fa&&Le(a.i,_e),G=dt.call(Wt,b)!==!1&&G}}return G&&!b.defaultPrevented}function nt(a,p,_){if(typeof a=="function")_&&(a=w(a,_));else if(a&&typeof a.handleEvent=="function")a=w(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:u.setTimeout(a,p||0)}function Bt(a){a.g=nt(()=>{a.g=null,a.i&&(a.i=!1,Bt(a))},a.l);const p=a.h;a.h=null,a.m.apply(null,p)}class bt extends At{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Bt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nt(a){At.call(this),this.h=a,this.g={}}L(Nt,At);var zt=[];function on(a){Pe(a.g,function(p,_){this.g.hasOwnProperty(_)&&ge(p)},a),a.g={}}Nt.prototype.N=function(){Nt.aa.N.call(this),on(this)},Nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ke=u.JSON.stringify,jt=u.JSON.parse,Gt=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function ur(){}ur.prototype.h=null;function Ae(a){return a.h||(a.h=a.i())}function Ks(){}var pi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ji(){ft.call(this,"d")}L(Ji,ft);function $s(){ft.call(this,"c")}L($s,ft);var cr={},Eu=null;function zs(){return Eu=Eu||new Ce}cr.La="serverreachability";function Lr(a){ft.call(this,cr.La,a)}L(Lr,ft);function Kn(a){const p=zs();Be(p,new Lr(p))}cr.STAT_EVENT="statevent";function Gs(a,p){ft.call(this,cr.STAT_EVENT,a),this.stat=p}L(Gs,ft);function Ht(a){const p=zs();Be(p,new Gs(p,a))}cr.Ma="timingevent";function wt(a,p){ft.call(this,cr.Ma,a),this.size=p}L(wt,ft);function Rt(a,p){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},p)}function Xi(){this.g=!0}Xi.prototype.xa=function(){this.g=!1};function Hs(a,p,_,b,G,Z){a.info(function(){if(a.g)if(Z)for(var _e="",dt=Z.split("&"),Wt=0;Wt<dt.length;Wt++){var it=dt[Wt].split("=");if(1<it.length){var en=it[0];it=it[1];var Qt=en.split("_");_e=2<=Qt.length&&Qt[1]=="type"?_e+(en+"="+it+"&"):_e+(en+"=redacted&")}}else _e=null;else _e=Z;return"XMLHTTP REQ ("+b+") [attempt "+G+"]: "+p+`
`+_+`
`+_e})}function Ws(a,p,_,b,G,Z,_e){a.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+G+"]: "+p+`
`+_+`
`+Z+" "+_e})}function lr(a,p,_,b){a.info(function(){return"XMLHTTP TEXT ("+p+"): "+Er(a,_)+(b?" "+b:"")})}function fl(a,p){a.info(function(){return"TIMEOUT: "+p})}Xi.prototype.info=function(){};function Er(a,p){if(!a.g)return p;if(!p)return null;try{var _=JSON.parse(p);if(_){for(a=0;a<_.length;a++)if(Array.isArray(_[a])){var b=_[a];if(!(2>b.length)){var G=b[1];if(Array.isArray(G)&&!(1>G.length)){var Z=G[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(var _e=1;_e<G.length;_e++)G[_e]=""}}}}return ke(_)}catch{return p}}var hr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},fr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},mi;function Qs(){}L(Qs,ur),Qs.prototype.g=function(){return new XMLHttpRequest},Qs.prototype.i=function(){return{}},mi=new Qs;function an(a,p,_,b){this.j=a,this.i=p,this.l=_,this.R=b||1,this.U=new Nt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Zo}function Zo(){this.i=null,this.g="",this.h=!1}var br={},Ys={};function Zi(a,p,_){a.L=1,a.v=ss(zn(p)),a.m=_,a.P=!0,Pt(a,null)}function Pt(a,p){a.F=Date.now(),es(a),a.A=zn(a.v);var _=a.A,b=a.R;Array.isArray(b)||(b=[String(b)]),Mn(_.i,"t",b),a.C=0,_=a.j.J,a.h=new Zo,a.g=uo(a.j,_?p:null,!a.m),0<a.O&&(a.M=new bt(w(a.Y,a,a.g),a.O)),p=a.U,_=a.g,b=a.ca;var G="readystatechange";Array.isArray(G)||(G&&(zt[0]=G.toString()),G=zt);for(var Z=0;Z<G.length;Z++){var _e=ue(_,G[Z],b||p.handleEvent,!1,p.h||p);if(!_e)break;p.g[_e.key]=_e}p=a.H?S(a.H):{},a.m?(a.u||(a.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,p)):(a.u="GET",a.g.ea(a.A,a.u,null,p)),Kn(),Hs(a.i,a.u,a.A,a.l,a.R,a.m)}an.prototype.ca=function(a){a=a.target;const p=this.M;p&&Fn(a)==3?p.j():this.Y(a)},an.prototype.Y=function(a){try{if(a==this.g)e:{const Qt=Fn(this.g);var p=this.g.Ba();const Jr=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||io(this.g)))){this.J||Qt!=4||p==7||(p==8||0>=Jr?Kn(3):Kn(2)),gi(this);var _=this.g.Z();this.X=_;t:if(Ir(this)){var b=io(this.g);a="";var G=b.length,Z=Fn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pr(this),jr(this);var _e="";break t}this.h.i=new u.TextDecoder}for(p=0;p<G;p++)this.h.h=!0,a+=this.h.i.decode(b[p],{stream:!(Z&&p==G-1)});b.length=0,this.h.g+=a,this.C=0,_e=this.h.g}else _e=this.g.oa();if(this.o=_==200,Ws(this.i,this.u,this.A,this.l,this.R,Qt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var dt,Wt=this.g;if((dt=Wt.g?Wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!oe(dt)){var it=dt;break t}}it=null}if(_=it)lr(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mr(this,_);else{this.o=!1,this.s=3,Ht(12),pr(this),jr(this);break e}}if(this.P){_=!0;let kn;for(;!this.J&&this.C<_e.length;)if(kn=dr(this,_e),kn==Ys){Qt==4&&(this.s=4,Ht(14),_=!1),lr(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==br){this.s=4,Ht(15),lr(this.i,this.l,_e,"[Invalid Chunk]"),_=!1;break}else lr(this.i,this.l,kn,null),mr(this,kn);if(Ir(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||_e.length!=0||this.h.h||(this.s=1,Ht(16),_=!1),this.o=this.o&&_,!_)lr(this.i,this.l,_e,"[Invalid Chunked Response]"),pr(this),jr(this);else if(0<_e.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+_e.length),Wr(en),en.M=!0,Ht(11))}}else lr(this.i,this.l,_e,null),mr(this,_e);Qt==4&&pr(this),this.o&&!this.J&&(Qt==4?ca(this.j,this):(this.o=!1,es(this)))}else Ru(this.g),_==400&&0<_e.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),pr(this),jr(this)}}}catch{}finally{}};function Ir(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function dr(a,p){var _=a.C,b=p.indexOf(`
`,_);return b==-1?Ys:(_=Number(p.substring(_,b)),isNaN(_)?br:(b+=1,b+_>p.length?Ys:(p=p.slice(b,b+_),a.C=b+_,p)))}an.prototype.cancel=function(){this.J=!0,pr(this)};function es(a){a.S=Date.now()+a.I,Br(a,a.I)}function Br(a,p){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Rt(w(a.ba,a),p)}function gi(a){a.B&&(u.clearTimeout(a.B),a.B=null)}an.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(fl(this.i,this.A),this.L!=2&&(Kn(),Ht(17)),pr(this),this.s=2,jr(this)):Br(this,this.S-a)};function jr(a){a.j.G==0||a.J||ca(a.j,a)}function pr(a){gi(a);var p=a.M;p&&typeof p.ma=="function"&&p.ma(),a.M=null,on(a.U),a.g&&(p=a.g,a.g=null,p.abort(),p.ma())}function mr(a,p){try{var _=a.j;if(_.G!=0&&(_.g==a||Js(_.h,a))){if(!a.K&&Js(_.h,a)&&_.G==3){try{var b=_.Da.g.parse(p)}catch{b=null}if(Array.isArray(b)&&b.length==3){var G=b;if(G[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<a.F)Qr(_),hs(_);else break e;Hr(_),Ht(18)}}else _.za=G[1],0<_.za-_.T&&37500>G[2]&&_.F&&_.v==0&&!_.C&&(_.C=Rt(w(_.Za,_),6e3));if(1>=Je(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Qn(_,11)}else if((a.K||_.g==a)&&Qr(_),!oe(p))for(G=_.Da.g.parse(p),p=0;p<G.length;p++){let it=G[p];if(_.T=it[0],it=it[1],_.G==2)if(it[0]=="c"){_.K=it[1],_.ia=it[2];const en=it[3];en!=null&&(_.la=en,_.j.info("VER="+_.la));const Qt=it[4];Qt!=null&&(_.Aa=Qt,_.j.info("SVER="+_.Aa));const Jr=it[5];Jr!=null&&typeof Jr=="number"&&0<Jr&&(b=1.5*Jr,_.L=b,_.j.info("backChannelRequestTimeoutMs_="+b)),b=_;const kn=a.g;if(kn){const lo=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(lo){var Z=b.h;Z.g||lo.indexOf("spdy")==-1&&lo.indexOf("quic")==-1&&lo.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(Xs(Z,Z.h),Z.h=null))}if(b.D){const fa=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;fa&&(b.ya=fa,ht(b.I,b.D,fa))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-a.F,_.j.info("Handshake RTT: "+_.R+"ms")),b=_;var _e=a;if(b.qa=Rr(b,b.J?b.ia:null,b.W),_e.K){ta(b.h,_e);var dt=_e,Wt=b.L;Wt&&(dt.I=Wt),dt.B&&(gi(dt),es(dt)),b.g=_e}else Zt(b);0<_.i.length&&zr(_)}else it[0]!="stop"&&it[0]!="close"||Qn(_,7);else _.G==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?Qn(_,7):Ei(_):it[0]!="noop"&&_.l&&_.l.ta(it),_.v=0)}}Kn(4)}catch{}}var bu=class{constructor(a,p){this.g=a,this.map=p}};function ts(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ea(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Je(a){return a.h?1:a.g?a.g.size:0}function Js(a,p){return a.h?a.h==p:a.g?a.g.has(p):!1}function Xs(a,p){a.g?a.g.add(p):a.h=p}function ta(a,p){a.h&&a.h==p?a.h=null:a.g&&a.g.has(p)&&a.g.delete(p)}ts.prototype.cancel=function(){if(this.i=_t(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function _t(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let p=a.i;for(const _ of a.g.values())p=p.concat(_.D);return p}return K(a.i)}function ns(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var p=[],_=a.length,b=0;b<_;b++)p.push(a[b]);return p}p=[],_=0;for(b in a)p[_++]=a[b];return p}function rs(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var p=[];a=a.length;for(var _=0;_<a;_++)p.push(_);return p}p=[],_=0;for(const b in a)p[_++]=b;return p}}}function Ur(a,p){if(a.forEach&&typeof a.forEach=="function")a.forEach(p,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,p,void 0);else for(var _=rs(a),b=ns(a),G=b.length,Z=0;Z<G;Z++)p.call(void 0,b[Z],_&&_[Z],a)}var Zs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function na(a,p){if(a){a=a.split("&");for(var _=0;_<a.length;_++){var b=a[_].indexOf("="),G=null;if(0<=b){var Z=a[_].substring(0,b);G=a[_].substring(b+1)}else Z=a[_];p(Z,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function $n(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof $n){this.h=a.h,qr(this,a.j),this.o=a.o,this.g=a.g,is(this,a.s),this.l=a.l;var p=a.i,_=new Vn;_.i=p.i,p.g&&(_.g=new Map(p.g),_.h=p.h),Gn(this,_),this.m=a.m}else a&&(p=String(a).match(Zs))?(this.h=!1,qr(this,p[1]||"",!0),this.o=os(p[2]||""),this.g=os(p[3]||"",!0),is(this,p[4]),this.l=os(p[5]||"",!0),Gn(this,p[6]||"",!0),this.m=os(p[7]||"")):(this.h=!1,this.i=new Vn(null,this.h))}$n.prototype.toString=function(){var a=[],p=this.j;p&&a.push(Xe(p,Iu,!0),":");var _=this.g;return(_||p=="file")&&(a.push("//"),(p=this.o)&&a.push(Xe(p,Iu,!0),"@"),a.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&a.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&a.push("/"),a.push(Xe(_,_.charAt(0)=="/"?bn:dl,!0))),(_=this.i.toString())&&a.push("?",_),(_=this.m)&&a.push("#",Xe(_,eo)),a.join("")};function zn(a){return new $n(a)}function qr(a,p,_){a.j=_?os(p,!0):p,a.j&&(a.j=a.j.replace(/:$/,""))}function is(a,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);a.s=p}else a.s=null}function Gn(a,p,_){p instanceof Vn?(a.i=p,as(a.i,a.h)):(_||(p=Xe(p,yi)),a.i=new Vn(p,a.h))}function ht(a,p,_){a.i.set(p,_)}function ss(a){return ht(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function os(a,p){return a?p?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Xe(a,p,_){return typeof a=="string"?(a=encodeURI(a).replace(p,ra),_&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function ra(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Iu=/[#\/\?@]/g,dl=/[#\?:]/g,bn=/[#\?]/g,yi=/[#\?@]/g,eo=/#/g;function Vn(a,p){this.h=this.g=null,this.i=a||null,this.j=!!p}function gr(a){a.g||(a.g=new Map,a.h=0,a.i&&na(a.i,function(p,_){a.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}n=Vn.prototype,n.add=function(a,p){gr(this),this.i=null,a=Hn(this,a);var _=this.g.get(a);return _||this.g.set(a,_=[]),_.push(p),this.h+=1,this};function ia(a,p){gr(a),p=Hn(a,p),a.g.has(p)&&(a.i=null,a.h-=a.g.get(p).length,a.g.delete(p))}function Ut(a,p){return gr(a),p=Hn(a,p),a.g.has(p)}n.forEach=function(a,p){gr(this),this.g.forEach(function(_,b){_.forEach(function(G){a.call(p,G,b,this)},this)},this)},n.na=function(){gr(this);const a=Array.from(this.g.values()),p=Array.from(this.g.keys()),_=[];for(let b=0;b<p.length;b++){const G=a[b];for(let Z=0;Z<G.length;Z++)_.push(p[b])}return _},n.V=function(a){gr(this);let p=[];if(typeof a=="string")Ut(this,a)&&(p=p.concat(this.g.get(Hn(this,a))));else{a=Array.from(this.g.values());for(let _=0;_<a.length;_++)p=p.concat(a[_])}return p},n.set=function(a,p){return gr(this),this.i=null,a=Hn(this,a),Ut(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[p]),this.h+=1,this},n.get=function(a,p){return a?(a=this.V(a),0<a.length?String(a[0]):p):p};function Mn(a,p,_){ia(a,p),0<_.length&&(a.i=null,a.g.set(Hn(a,p),K(_)),a.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],p=Array.from(this.g.keys());for(var _=0;_<p.length;_++){var b=p[_];const Z=encodeURIComponent(String(b)),_e=this.V(b);for(b=0;b<_e.length;b++){var G=Z;_e[b]!==""&&(G+="="+encodeURIComponent(String(_e[b]))),a.push(G)}}return this.i=a.join("&")};function Hn(a,p){return p=String(p),a.j&&(p=p.toLowerCase()),p}function as(a,p){p&&!a.j&&(gr(a),a.i=null,a.g.forEach(function(_,b){var G=b.toLowerCase();b!=G&&(ia(this,b),Mn(this,G,_))},a)),a.j=p}function sa(a,p){const _=new Xi;if(u.Image){const b=new Image;b.onload=I(Ar,_,"TestLoadImage: loaded",!0,p,b),b.onerror=I(Ar,_,"TestLoadImage: error",!1,p,b),b.onabort=I(Ar,_,"TestLoadImage: abort",!1,p,b),b.ontimeout=I(Ar,_,"TestLoadImage: timeout",!1,p,b),u.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=a}else p(!1)}function Tr(a,p){const _=new Xi,b=new AbortController,G=setTimeout(()=>{b.abort(),Ar(_,"TestPingServer: timeout",!1,p)},1e4);fetch(a,{signal:b.signal}).then(Z=>{clearTimeout(G),Z.ok?Ar(_,"TestPingServer: ok",!0,p):Ar(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(G),Ar(_,"TestPingServer: error",!1,p)})}function Ar(a,p,_,b,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),b(_)}catch{}}function Wn(){this.g=new Gt}function oa(a,p,_){const b=_||"";try{Ur(a,function(G,Z){let _e=G;f(G)&&(_e=ke(G)),p.push(b+Z+"="+encodeURIComponent(_e))})}catch(G){throw p.push(b+"type="+encodeURIComponent("_badmap")),G}}function us(a){this.l=a.Ub||null,this.j=a.eb||!1}L(us,ur),us.prototype.g=function(){return new _i(this.l,this.j)},us.prototype.i=function(a){return function(){return a}}({});function _i(a,p){Ce.call(this),this.D=a,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(_i,Ce),n=_i.prototype,n.open=function(a,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=p,this.readyState=1,wi(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(p.body=a),(this.D||u).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,wi(this)),this.g&&(this.readyState=3,wi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vi(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function vi(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var p=a.value?a.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!a.done}))&&(this.response=this.responseText+=p)}a.done?Kr(this):wi(this),this.readyState==3&&vi(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Kr(this))},n.Qa=function(a){this.g&&(this.response=a,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(a){a.readyState=4,a.l=null,a.j=null,a.v=null,wi(a)}n.setRequestHeader=function(a,p){this.u.append(a,p)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,a.push(_[0]+": "+_[1]),_=p.next();return a.join(`\r
`)};function wi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(_i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Tu(a){let p="";return Pe(a,function(_,b){p+=b,p+=":",p+=_,p+=`\r
`}),p}function $r(a,p,_){e:{for(b in _){var b=!1;break e}b=!0}b||(_=Tu(_),typeof a=="string"?_!=null&&encodeURIComponent(String(_)):ht(a,p,_))}function xt(a){Ce.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(xt,Ce);var pl=/^https?$/i,to=["POST","PUT"];n=xt.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,p,_,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);p=p?p.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():mi.g(),this.v=this.o?Ae(this.o):Ae(mi),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(p,String(a),!0),this.B=!1}catch(Z){cs(this,Z);return}if(a=_||"",_=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var G in b)_.set(G,b[G]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const Z of b.keys())_.set(Z,b.get(Z));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(_.keys()).find(Z=>Z.toLowerCase()=="content-type"),G=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(to,p,void 0))||b||G||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,_e]of _)this.g.setRequestHeader(Z,_e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Su(this),this.u=!0,this.g.send(a),this.u=!1}catch(Z){cs(this,Z)}};function cs(a,p){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=p,a.m=5,no(a),ro(a)}function no(a){a.A||(a.A=!0,Be(a,"complete"),Be(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Be(this,"complete"),Be(this,"abort"),ro(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ro(this,!0)),xt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Au(this):this.bb())},n.bb=function(){Au(this)};function Au(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Fn(a)!=4||a.Z()!=2)){if(a.u&&Fn(a)==4)nt(a.Ea,0,a);else if(Be(a,"readystatechange"),Fn(a)==4){a.h=!1;try{const _e=a.Z();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var b;if(b=_e===0){var G=String(a.D).match(Zs)[1]||null;!G&&u.self&&u.self.location&&(G=u.self.location.protocol.slice(0,-1)),b=!pl.test(G?G.toLowerCase():"")}_=b}if(_)Be(a,"complete"),Be(a,"success");else{a.m=6;try{var Z=2<Fn(a)?a.g.statusText:""}catch{Z=""}a.l=Z+" ["+a.Z()+"]",no(a)}}finally{ro(a)}}}}function ro(a,p){if(a.g){Su(a);const _=a.g,b=a.v[0]?()=>{}:null;a.g=null,a.v=null,p||Be(a,"ready");try{_.onreadystatechange=b}catch{}}}function Su(a){a.I&&(u.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function Fn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<Fn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var p=this.g.responseText;return a&&p.indexOf(a)==0&&(p=p.substring(a.length)),jt(p)}};function io(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ru(a){const p={};a=(a.g&&2<=Fn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<a.length;b++){if(oe(a[b]))continue;var _=N(a[b]);const G=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const Z=p[G]||[];p[G]=Z,Z.push(_)}D(p,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sr(a,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[a]||p}function ls(a){this.Aa=0,this.i=[],this.j=new Xi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Sr("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Sr("baseRetryDelayMs",5e3,a),this.cb=Sr("retryDelaySeedMs",1e4,a),this.Wa=Sr("forwardChannelMaxRetries",2,a),this.wa=Sr("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new ts(a&&a.concurrentRequestLimit),this.Da=new Wn,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ls.prototype,n.la=8,n.G=1,n.connect=function(a,p,_,b){Ht(0),this.W=a,this.H=p||{},_&&b!==void 0&&(this.H.OSID=_,this.H.OAID=b),this.F=this.X,this.I=Rr(this,null,this.W),zr(this)};function Ei(a){if(Pu(a),a.G==3){var p=a.U++,_=zn(a.I);if(ht(_,"SID",a.K),ht(_,"RID",p),ht(_,"TYPE","terminate"),Gr(a,_),p=new an(a,a.j,p),p.L=2,p.v=ss(zn(_)),_=!1,u.navigator&&u.navigator.sendBeacon)try{_=u.navigator.sendBeacon(p.v.toString(),"")}catch{}!_&&u.Image&&(new Image().src=p.v,_=!0),_||(p.g=uo(p.j,null),p.g.ea(p.v)),p.F=Date.now(),es(p)}ao(a)}function hs(a){a.g&&(Wr(a),a.g.cancel(),a.g=null)}function Pu(a){hs(a),a.u&&(u.clearTimeout(a.u),a.u=null),Qr(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function zr(a){if(!ea(a.h)&&!a.s){a.s=!0;var p=a.Ga;Ue||Ft(),ze||(Ue(),ze=!0),$t.add(p,a),a.B=0}}function aa(a,p){return Je(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=p.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Rt(w(a.Ga,a,p),la(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const G=new an(this,this.j,a);let Z=this.o;if(this.S&&(Z?(Z=S(Z),V(Z,this.S)):Z=this.S),this.m!==null||this.O||(G.H=Z,Z=null),this.P)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var b=this.i[_];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(p+=b,4096<p){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=oo(this,G,p),_=zn(this.I),ht(_,"RID",a),ht(_,"CVER",22),this.D&&ht(_,"X-HTTP-Session-Id",this.D),Gr(this,_),Z&&(this.O?p="headers="+encodeURIComponent(String(Tu(Z)))+"&"+p:this.m&&$r(_,this.m,Z)),Xs(this.h,G),this.Ua&&ht(_,"TYPE","init"),this.P?(ht(_,"$req",p),ht(_,"SID","null"),G.T=!0,Zi(G,_,null)):Zi(G,_,p),this.G=2}}else this.G==3&&(a?so(this,a):this.i.length==0||ea(this.h)||so(this))};function so(a,p){var _;p?_=p.l:_=a.U++;const b=zn(a.I);ht(b,"SID",a.K),ht(b,"RID",_),ht(b,"AID",a.T),Gr(a,b),a.m&&a.o&&$r(b,a.m,a.o),_=new an(a,a.j,_,a.B+1),a.m===null&&(_.H=a.o),p&&(a.i=p.D.concat(a.i)),p=oo(a,_,1e3),_.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Xs(a.h,_),Zi(_,b,p)}function Gr(a,p){a.H&&Pe(a.H,function(_,b){ht(p,b,_)}),a.l&&Ur({},function(_,b){ht(p,b,_)})}function oo(a,p,_){_=Math.min(a.i.length,_);var b=a.l?w(a.l.Na,a.l,a):null;e:{var G=a.i;let Z=-1;for(;;){const _e=["count="+_];Z==-1?0<_?(Z=G[0].g,_e.push("ofs="+Z)):Z=0:_e.push("ofs="+Z);let dt=!0;for(let Wt=0;Wt<_;Wt++){let it=G[Wt].g;const en=G[Wt].map;if(it-=Z,0>it)Z=Math.max(0,G[Wt].g-100),dt=!1;else try{oa(en,_e,"req"+it+"_")}catch{b&&b(en)}}if(dt){b=_e.join("&");break e}}}return a=a.i.splice(0,_),p.D=a,b}function Zt(a){if(!a.g&&!a.u){a.Y=1;var p=a.Fa;Ue||Ft(),ze||(Ue(),ze=!0),$t.add(p,a),a.v=0}}function Hr(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Rt(w(a.Fa,a),la(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,ua(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Rt(w(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),hs(this),ua(this))};function Wr(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function ua(a){a.g=new an(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var p=zn(a.qa);ht(p,"RID","rpc"),ht(p,"SID",a.K),ht(p,"AID",a.T),ht(p,"CI",a.F?"0":"1"),!a.F&&a.ja&&ht(p,"TO",a.ja),ht(p,"TYPE","xmlhttp"),Gr(a,p),a.m&&a.o&&$r(p,a.m,a.o),a.L&&(a.g.I=a.L);var _=a.g;a=a.ia,_.L=1,_.v=ss(zn(p)),_.m=null,_.P=!0,Pt(_,a)}n.Za=function(){this.C!=null&&(this.C=null,hs(this),Hr(this),Ht(19))};function Qr(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function ca(a,p){var _=null;if(a.g==p){Qr(a),Wr(a),a.g=null;var b=2}else if(Js(a.h,p))_=p.D,ta(a.h,p),b=1;else return;if(a.G!=0){if(p.o)if(b==1){_=p.m?p.m.length:0,p=Date.now()-p.F;var G=a.B;b=zs(),Be(b,new wt(b,_)),zr(a)}else Zt(a);else if(G=p.s,G==3||G==0&&0<p.X||!(b==1&&aa(a,p)||b==2&&Hr(a)))switch(_&&0<_.length&&(p=a.h,p.i=p.i.concat(_)),G){case 1:Qn(a,5);break;case 4:Qn(a,10);break;case 3:Qn(a,6);break;default:Qn(a,2)}}}function la(a,p){let _=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(_*=2),_*p}function Qn(a,p){if(a.j.info("Error code "+p),p==2){var _=w(a.fb,a),b=a.Xa;const G=!b;b=new $n(b||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||qr(b,"https"),ss(b),G?sa(b.toString(),_):Tr(b.toString(),_)}else Ht(2);a.G=0,a.l&&a.l.sa(p),ao(a),Pu(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function ao(a){if(a.G=0,a.ka=[],a.l){const p=_t(a.h);(p.length!=0||a.i.length!=0)&&(J(a.ka,p),J(a.ka,a.i),a.h.i.length=0,K(a.i),a.i.length=0),a.l.ra()}}function Rr(a,p,_){var b=_ instanceof $n?zn(_):new $n(_);if(b.g!="")p&&(b.g=p+"."+b.g),is(b,b.s);else{var G=u.location;b=G.protocol,p=p?p+"."+G.hostname:G.hostname,G=+G.port;var Z=new $n(null);b&&qr(Z,b),p&&(Z.g=p),G&&is(Z,G),_&&(Z.l=_),b=Z}return _=a.D,p=a.ya,_&&p&&ht(b,_,p),ht(b,"VER",a.la),Gr(a,b),b}function uo(a,p,_){if(p&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=a.Ca&&!a.pa?new xt(new us({eb:_})):new xt(a.pa),p.Ha(a.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function co(){}n=co.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Yr(){}Yr.prototype.g=function(a,p){return new un(a,p)};function un(a,p){Ce.call(this),this.g=new ls(p),this.l=a,this.h=p&&p.messageUrlParams||null,a=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(a?a["X-WebChannel-Content-Type"]=p.messageContentType:a={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(a?a["X-WebChannel-Client-Profile"]=p.va:a={"X-WebChannel-Client-Profile":p.va}),this.g.S=a,(a=p&&p.Sb)&&!oe(a)&&(this.g.m=a),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!oe(p)&&(this.g.D=p,a=this.h,a!==null&&p in a&&(a=this.h,p in a&&delete a[p])),this.j=new Pr(this)}L(un,Ce),un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},un.prototype.close=function(){Ei(this.g)},un.prototype.o=function(a){var p=this.g;if(typeof a=="string"){var _={};_.__data__=a,a=_}else this.u&&(_={},_.__data__=ke(a),a=_);p.i.push(new bu(p.Ya++,a)),p.G==3&&zr(p)},un.prototype.N=function(){this.g.l=null,delete this.j,Ei(this.g),delete this.g,un.aa.N.call(this)};function ha(a){Ji.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var p=a.__sm__;if(p){e:{for(const _ in p){a=_;break e}a=void 0}(this.i=a)&&(a=this.i,p=p!==null&&a in p?p[a]:void 0),this.data=p}else this.data=a}L(ha,Ji);function xu(){$s.call(this),this.status=1}L(xu,$s);function Pr(a){this.g=a}L(Pr,co),Pr.prototype.ua=function(){Be(this.g,"a")},Pr.prototype.ta=function(a){Be(this.g,new ha(a))},Pr.prototype.sa=function(a){Be(this.g,new xu)},Pr.prototype.ra=function(){Be(this.g,"b")},Yr.prototype.createWebChannel=Yr.prototype.g,un.prototype.send=un.prototype.o,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,gy=function(){return new Yr},my=function(){return zs()},py=cr,gh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},hr.NO_ERROR=0,hr.TIMEOUT=8,hr.HTTP_ERROR=6,Yu=hr,fr.COMPLETE="complete",dy=fr,Ks.EventType=pi,pi.OPEN="a",pi.CLOSE="b",pi.ERROR="c",pi.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,ba=Ks,xt.prototype.listenOnce=xt.prototype.L,xt.prototype.getLastError=xt.prototype.Ka,xt.prototype.getLastErrorCode=xt.prototype.Ba,xt.prototype.getStatus=xt.prototype.Z,xt.prototype.getResponseJson=xt.prototype.Oa,xt.prototype.getResponseText=xt.prototype.oa,xt.prototype.send=xt.prototype.ea,xt.prototype.setWithCredentials=xt.prototype.Ha,fy=xt}).apply(typeof Lu<"u"?Lu:typeof self<"u"?self:typeof window<"u"?window:{});const fp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qo="11.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new iy("@firebase/firestore");function To(){return ks.logLevel}function de(n,...e){if(ks.logLevel<=ut.DEBUG){const t=e.map(hf);ks.debug(`Firestore (${Qo}): ${n}`,...t)}}function Pn(n,...e){if(ks.logLevel<=ut.ERROR){const t=e.map(hf);ks.error(`Firestore (${Qo}): ${n}`,...t)}}function Os(n,...e){if(ks.logLevel<=ut.WARN){const t=e.map(hf);ks.warn(`Firestore (${Qo}): ${n}`,...t)}}function hf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(n="Unexpected state"){const e=`FIRESTORE (${Qo}) INTERNAL ASSERTION FAILED: `+n;throw Pn(e),new Error(e)}function Fe(n,e){n||Ne()}function $e(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Wo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(cn.UNAUTHENTICATED))}shutdown(){}}class K0{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class $0{constructor(e){this.t=e,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fe(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new ai;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ai,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},u=l=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ai)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string"),new yy(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string"),new cn(e)}}class z0{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class G0{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new z0(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W0{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Fe(this.o===void 0);const r=s=>{s.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Fe(typeof t.token=="string"),this.R=t.token,new H0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Q0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function He(n,e){return n<e?-1:n>e?1:0}function Bo(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function vy(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return St.fromMillis(Date.now())}static fromDate(e){return St.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new St(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.timestamp=e}static fromTimestamp(e){return new je(e)}static min(){return new je(new St(0,0))}static max(){return new je(new St(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ne(),r===void 0?r=e.length-t:r>e.length-t&&Ne(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ja.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ja?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class mt extends Ja{construct(e,t,r){return new mt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new we(ne.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new mt(t)}static emptyPath(){return new mt([])}}const Y0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kt extends Ja{construct(e,t,r){return new kt(e,t,r)}static isValidIdentifier(e){return Y0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new kt(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new we(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new we(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new we(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new we(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kt(t)}static emptyPath(){return new kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.path=e}static fromPath(e){return new Re(mt.fromString(e))}static fromName(e){return new Re(mt.fromString(e).popFirst(5))}static empty(){return new Re(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Re(new mt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function yh(n){return n.fields.find(e=>e.kind===2)}function Es(n){return n.fields.filter(e=>e.kind!==2)}_c.UNKNOWN_ID=-1;class Ju{constructor(e,t){this.fieldPath=e,this.kind=t}}class Xa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Xa(0,qn.min())}}function J0(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=je.fromTimestamp(r===1e9?new St(t+1,0):new St(t,r));return new qn(i,Re.empty(),e)}function wy(n){return new qn(n.readTime,n.key,-1)}class qn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new qn(je.min(),Re.empty(),-1)}static max(){return new qn(je.max(),Re.empty(),-1)}}function ff(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Re.comparator(n.documentKey,e.documentKey),t!==0?t:He(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class by{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function js(n){if(n.code!==ne.FAILED_PRECONDITION||n.message!==Ey)throw n;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new H((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof H?t:H.resolve(t)}catch(t){return H.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):H.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):H.reject(t)}static resolve(e){return new H((t,r)=>{t(e)})}static reject(e){return new H((t,r)=>{r(e)})}static waitFor(e){return new H((t,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=H.resolve(!1);for(const r of e)t=t.next(i=>i?H.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new H((r,i)=>{const s=e.length,o=new Array(s);let u=0;for(let l=0;l<s;l++){const f=l;t(e[f]).next(m=>{o[f]=m,++u,u===s&&r(o)},m=>i(m))}})}static doWhile(e,t){return new H((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ai,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Na(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=df(r.target.error);this.V.reject(new Na(e,i))}}static open(e,t,r,i){try{return new zc(t,e.transaction(i,r))}catch(s){throw new Na(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(de("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Z0(t)}}class Bi{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Bi.S(pc())===12.2&&Pn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return de("SimpleDb","Removing database:",e),Is(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ny())return!1;if(Bi.v())return!0;const e=pc(),t=Bi.S(e),r=0<t&&t<10,i=Iy(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(de("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new Na(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new we(ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new we(ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Na(e,o))},i.onupgradeneeded=s=>{de("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{de("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const u=zc.open(this.db,e,s?"readonly":"readwrite",r),l=i(u).next(f=>(u.g(),f)).catch(f=>(u.abort(f),H.reject(f))).toPromise();return l.catch(()=>{}),await u.m,l}catch(u){const l=u,f=l.name!=="FirebaseError"&&o<3;if(de("SimpleDb","Transaction failed with error:",l.message,"Retrying:",f),this.close(),!f)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Iy(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class X0{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Is(this.B.delete())}}class Na extends we{constructor(e,t){super(ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Qi(n){return n.name==="IndexedDbTransactionError"}class Z0{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(de("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(de("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Is(r)}add(e){return de("SimpleDb","ADD",this.store.name,e,e),Is(this.store.add(e))}get(e){return Is(this.store.get(e)).next(t=>(t===void 0&&(t=null),de("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return de("SimpleDb","DELETE",this.store.name,e),Is(this.store.delete(e))}count(){return de("SimpleDb","COUNT",this.store.name),Is(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new H((o,u)=>{s.onerror=l=>{u(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(u,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new H((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){de("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,u)=>u.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new H((r,i)=>{t.onerror=s=>{const o=df(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(u=>{u?o.continue():r()}):r()}})}W(e,t){const r=[];return new H((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const u=o.target.result;if(!u)return void i();const l=new X0(u),f=t(u.primaryKey,u.value,l);if(f instanceof H){const m=f.catch(g=>(l.done(),H.reject(g)));r.push(m)}l.isDone?i():l.K===null?u.continue():u.continue(l.K)}}).next(()=>H.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Is(n){return new H((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=df(r.target.error);t(i)}})}let dp=!1;function df(n){const e=Bi.S(pc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new we("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dp||(dp=!0,setTimeout(()=>{throw r},0)),r}}return n}class eT{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){de("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{de("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Qi(t)?de("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await js(t)}await this.X(6e4)})}}class tT{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,s=!0;return H.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return de("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(u=>{i-=u,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(u=>(de("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=wy(s);ff(o,r)>0&&(r=o)}),new qn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}er.oe=-1;function Gc(n){return n==null}function Za(n){return n===0&&1/n==-1/0}function nT(n){return typeof n=="number"&&Number.isInteger(n)&&!Za(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pp(e)),e=rT(n.get(t),e);return pp(e)}function rT(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function pp(n){return n+""}function kr(n){const e=n.length;if(Fe(e>=2),e===2)return Fe(n.charAt(0)===""&&n.charAt(1)===""),mt.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&Ne(),n.charAt(o+1)){case"":const u=n.substring(s,o);let l;i.length===0?l=u:(i+=u,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Ne()}s=o+2}return new mt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(n,e){return[n,wn(e)]}function Ty(n,e,t){return[n,wn(e),t]}const iT={},sT=["prefixPath","collectionGroup","readTime","documentId"],oT=["prefixPath","collectionGroup","documentId"],aT=["collectionGroup","readTime","prefixPath","documentId"],uT=["canonicalId","targetId"],cT=["targetId","path"],lT=["path","targetId"],hT=["collectionId","parent"],fT=["indexId","uid"],dT=["uid","sequenceNumber"],pT=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],mT=["indexId","uid","orderedDocumentKey"],gT=["userId","collectionPath","documentId"],yT=["userId","collectionPath","largestBatchId"],_T=["userId","collectionGroup","largestBatchId"],Ay=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vT=[...Ay,"documentOverlays"],Sy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ry=Sy,pf=[...Ry,"indexConfiguration","indexState","indexEntries"],wT=pf,ET=[...pf,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends by{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function rn(n,e){const t=$e(n);return Bi.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Py(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new Dt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new Dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bu(this.root,e,this.comparator,!0)}}class Bu{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ln.RED,this.left=i??ln.EMPTY,this.right=s??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ln(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ln.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ne();const e=this.left.check();if(e!==this.right.check())throw Ne();return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne()}get value(){throw Ne()}get color(){throw Ne()}get left(){throw Ne()}get right(){throw Ne()}copy(e,t,r,i,s){return this}insert(e,t,r){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new Dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yp(this.data.getIterator())}getIteratorFrom(e){return new yp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new vt(this.comparator);return t.data=e,t}}class yp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function mo(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.fields=e,e.sort(kt.comparator)}static empty(){return new Nn([])}unionWith(e){let t=new vt(kt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Nn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bo(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xy("Invalid base64 string: "+s):s}}(e);return new Xt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Xt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xt.EMPTY_BYTE_STRING=new Xt("");const bT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ci(n){if(Fe(!!n),typeof n=="string"){let e=0;const t=bT.exec(n);if(Fe(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ct(n.seconds),nanos:Ct(n.nanos)}}function Ct(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function li(n){return typeof n=="string"?Xt.fromBase64String(n):Xt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Hc(n){const e=n.mapValue.fields.__previous_value__;return mf(e)?Hc(e):e}function eu(n){const e=ci(n.mapValue.fields.__local_write_time__.timestampValue);return new St(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,t,r,i,s,o,u,l,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=f}}class Ns{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ns("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ns&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Zu={nullValue:"NULL_VALUE"};function qi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?mf(n)?4:Cy(n)?9007199254740991:Wc(n)?10:11:Ne()}function Fr(n,e){if(n===e)return!0;const t=qi(n);if(t!==qi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return eu(n).isEqual(eu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ci(i.timestampValue),u=ci(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return li(i.bytesValue).isEqual(li(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ct(i.geoPointValue.latitude)===Ct(s.geoPointValue.latitude)&&Ct(i.geoPointValue.longitude)===Ct(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ct(i.integerValue)===Ct(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Ct(i.doubleValue),u=Ct(s.doubleValue);return o===u?Za(o)===Za(u):isNaN(o)&&isNaN(u)}return!1}(n,e);case 9:return Bo(n.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(gp(o)!==gp(u))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(u[l]===void 0||!Fr(o[l],u[l])))return!1;return!0}(n,e);default:return Ne()}}function tu(n,e){return(n.values||[]).find(t=>Fr(t,e))!==void 0}function Ki(n,e){if(n===e)return 0;const t=qi(n),r=qi(e);if(t!==r)return He(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return He(n.booleanValue,e.booleanValue);case 2:return function(s,o){const u=Ct(s.integerValue||s.doubleValue),l=Ct(o.integerValue||o.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return _p(n.timestampValue,e.timestampValue);case 4:return _p(eu(n),eu(e));case 5:return He(n.stringValue,e.stringValue);case 6:return function(s,o){const u=li(s),l=li(o);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const u=s.split("/"),l=o.split("/");for(let f=0;f<u.length&&f<l.length;f++){const m=He(u[f],l[f]);if(m!==0)return m}return He(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const u=He(Ct(s.latitude),Ct(o.latitude));return u!==0?u:He(Ct(s.longitude),Ct(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vp(n.arrayValue,e.arrayValue);case 10:return function(s,o){var u,l,f,m;const g=s.fields||{},w=o.fields||{},I=(u=g.value)===null||u===void 0?void 0:u.arrayValue,L=(l=w.value)===null||l===void 0?void 0:l.arrayValue,K=He(((f=I==null?void 0:I.values)===null||f===void 0?void 0:f.length)||0,((m=L==null?void 0:L.values)===null||m===void 0?void 0:m.length)||0);return K!==0?K:vp(I,L)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ni.mapValue&&o===Ni.mapValue)return 0;if(s===Ni.mapValue)return 1;if(o===Ni.mapValue)return-1;const u=s.fields||{},l=Object.keys(u),f=o.fields||{},m=Object.keys(f);l.sort(),m.sort();for(let g=0;g<l.length&&g<m.length;++g){const w=He(l[g],m[g]);if(w!==0)return w;const I=Ki(u[l[g]],f[m[g]]);if(I!==0)return I}return He(l.length,m.length)}(n.mapValue,e.mapValue);default:throw Ne()}}function _p(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return He(n,e);const t=ci(n),r=ci(e),i=He(t.seconds,r.seconds);return i!==0?i:He(t.nanos,r.nanos)}function vp(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Ki(t[i],r[i]);if(s)return s}return He(t.length,r.length)}function jo(n){return vh(n)}function vh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ci(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return li(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Re.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=vh(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${vh(t.fields[o])}`;return i+"}"}(n.mapValue):Ne()}function ec(n){switch(qi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hc(n);return e?16+ec(e):16;case 5:return 2*n.stringValue.length;case 6:return li(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+ec(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Yi(r.fields,(s,o)=>{i+=s.length+ec(o)}),i}(n.mapValue);default:throw Ne()}}function nu(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wh(n){return!!n&&"integerValue"in n}function ru(n){return!!n&&"arrayValue"in n}function wp(n){return!!n&&"nullValue"in n}function Ep(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tc(n){return!!n&&"mapValue"in n}function Wc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ma(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Yi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ma(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ma(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Cy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Dy={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function TT(n){return"nullValue"in n?Zu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?nu(Ns.empty(),Re.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Wc(n)?Dy:{mapValue:{}}:Ne()}function AT(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?nu(Ns.empty(),Re.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Dy:"mapValue"in n?Wc(n)?{mapValue:{}}:Ni:Ne()}function bp(n,e){const t=Ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Ip(n,e){const t=Ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.value=e}static empty(){return new vn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!tc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ma(t)}setAll(e){let t=kt.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}o?r[u.lastSegment()]=Ma(o):i.push(u.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());tc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];tc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Yi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new vn(Ma(this.value))}}function Vy(n){const e=[];return Yi(n.fields,(t,r)=>{const i=new kt([t]);if(tc(r)){const s=Vy(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t,r,i,s,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Mt(e,0,je.min(),je.min(),je.min(),vn.empty(),0)}static newFoundDocument(e,t,r,i){return new Mt(e,1,t,je.min(),r,i,0)}static newNoDocument(e,t){return new Mt(e,2,t,je.min(),je.min(),vn.empty(),0)}static newUnknownDocument(e,t){return new Mt(e,3,t,je.min(),je.min(),vn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t){this.position=e,this.inclusive=t}}function Tp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Re.comparator(Re.fromName(o.referenceValue),t.key):r=Ki(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ap(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t="asc"){this.field=e,this.dir=t}}function ST(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{}class rt extends ky{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new RT(e,t,r):t==="array-contains"?new CT(e,r):t==="in"?new By(e,r):t==="not-in"?new DT(e,r):t==="array-contains-any"?new VT(e,r):new rt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new PT(e,r):new xT(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ki(t,this.value)):t!==null&&qi(this.value)===qi(t)&&this.matchesComparison(Ki(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yt extends ky{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new yt(e,t)}matches(e){return qo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function qo(n){return n.op==="and"}function Eh(n){return n.op==="or"}function gf(n){return Oy(n)&&qo(n)}function Oy(n){for(const e of n.filters)if(e instanceof yt)return!1;return!0}function bh(n){if(n instanceof rt)return n.field.canonicalString()+n.op.toString()+jo(n.value);if(gf(n))return n.filters.map(e=>bh(e)).join(",");{const e=n.filters.map(t=>bh(t)).join(",");return`${n.op}(${e})`}}function Ny(n,e){return n instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.field.isEqual(i.field)&&Fr(r.value,i.value)}(n,e):n instanceof yt?function(r,i){return i instanceof yt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&Ny(o,i.filters[u]),!0):!1}(n,e):void Ne()}function My(n,e){const t=n.filters.concat(e);return yt.create(t,n.op)}function Fy(n){return n instanceof rt?function(t){return`${t.field.canonicalString()} ${t.op} ${jo(t.value)}`}(n):n instanceof yt?function(t){return t.op.toString()+" {"+t.getFilters().map(Fy).join(" ,")+"}"}(n):"Filter"}class RT extends rt{constructor(e,t,r){super(e,t,r),this.key=Re.fromName(r.referenceValue)}matches(e){const t=Re.comparator(e.key,this.key);return this.matchesComparison(t)}}class PT extends rt{constructor(e,t){super(e,"in",t),this.keys=Ly("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class xT extends rt{constructor(e,t){super(e,"not-in",t),this.keys=Ly("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ly(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Re.fromName(r.referenceValue))}class CT extends rt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ru(t)&&tu(t.arrayValue,this.value)}}class By extends rt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&tu(this.value.arrayValue,t)}}class DT extends rt{constructor(e,t){super(e,"not-in",t)}matches(e){if(tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!tu(this.value.arrayValue,t)}}class VT extends rt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ru(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>tu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e,t=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}}function Ih(n,e=null,t=[],r=[],i=null,s=null,o=null){return new kT(n,e,t,r,i,s,o)}function Ms(n){const e=$e(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>bh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>jo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>jo(r)).join(",")),e.ue=t}return e.ue}function pu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ST(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ny(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ap(n.startAt,e.startAt)&&Ap(n.endAt,e.endAt)}function vc(n){return Re.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function wc(n,e){return n.filters.filter(t=>t instanceof rt&&t.field.isEqual(e))}function Sp(n,e,t){let r=Zu,i=!0;for(const s of wc(n,e)){let o=Zu,u=!0;switch(s.op){case"<":case"<=":o=TT(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,u=!1;break;case"!=":case"not-in":o=Zu}bp({value:r,inclusive:i},{value:o,inclusive:u})<0&&(r=o,i=u)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];bp({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function Rp(n,e,t){let r=Ni,i=!0;for(const s of wc(n,e)){let o=Ni,u=!0;switch(s.op){case">=":case">":o=AT(s.value),u=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,u=!1;break;case"!=":case"not-in":o=Ni}Ip({value:r,inclusive:i},{value:o,inclusive:u})>0&&(r=o,i=u)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Ip({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,t=null,r=[],i=[],s=null,o="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function OT(n,e,t,r,i,s,o,u){return new Yo(n,e,t,r,i,s,o,u)}function yf(n){return new Yo(n)}function Pp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function jy(n){return n.collectionGroup!==null}function Fa(n){const e=$e(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new vt(kt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(f=>{f.isInequality()&&(u=u.add(f.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new iu(s,r))}),t.has(kt.keyField().canonicalString())||e.ce.push(new iu(kt.keyField(),r))}return e.ce}function ir(n){const e=$e(n);return e.le||(e.le=NT(e,Fa(n))),e.le}function NT(n,e){if(n.limitType==="F")return Ih(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new iu(i.field,s)});const t=n.endAt?new Uo(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Uo(n.startAt.position,n.startAt.inclusive):null;return Ih(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Th(n,e){const t=n.filters.concat([e]);return new Yo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ah(n,e,t){return new Yo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qc(n,e){return pu(ir(n),ir(e))&&n.limitType===e.limitType}function Uy(n){return`${Ms(ir(n))}|lt:${n.limitType}`}function Ao(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Fy(i)).join(", ")}]`),Gc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>jo(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>jo(i)).join(",")),`Target(${r})`}(ir(n))}; limitType=${n.limitType})`}function mu(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Re.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Fa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,u,l){const f=Tp(o,u,l);return o.inclusive?f<=0:f<0}(r.startAt,Fa(r),i)||r.endAt&&!function(o,u,l){const f=Tp(o,u,l);return o.inclusive?f>=0:f>0}(r.endAt,Fa(r),i))}(n,e)}function MT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function qy(n){return(e,t)=>{let r=!1;for(const i of Fa(n)){const s=FT(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function FT(n,e,t){const r=n.field.isKeyField()?Re.comparator(e.key,t.key):function(s,o,u){const l=o.data.field(s),f=u.data.field(s);return l!==null&&f!==null?Ki(l,f):Ne()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Py(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=new Dt(Re.comparator);function Un(){return LT}const Ky=new Dt(Re.comparator);function Ia(...n){let e=Ky;for(const t of n)e=e.insert(t.key,t);return e}function $y(n){let e=Ky;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Or(){return La()}function zy(){return La()}function La(){return new fi(n=>n.toString(),(n,e)=>n.isEqual(e))}const BT=new Dt(Re.comparator),jT=new vt(Re.comparator);function Ye(...n){let e=jT;for(const t of n)e=e.add(t);return e}const UT=new vt(He);function qT(){return UT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Za(e)?"-0":e}}function Gy(n){return{integerValue:""+n}}function KT(n,e){return nT(e)?Gy(e):_f(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(){this._=void 0}}function $T(n,e,t){return n instanceof su?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&mf(s)&&(s=Hc(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ko?Wy(n,e):n instanceof $o?Qy(n,e):function(i,s){const o=Hy(i,s),u=xp(o)+xp(i.Pe);return wh(o)&&wh(i.Pe)?Gy(u):_f(i.serializer,u)}(n,e)}function zT(n,e,t){return n instanceof Ko?Wy(n,e):n instanceof $o?Qy(n,e):t}function Hy(n,e){return n instanceof ou?function(r){return wh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class su extends Yc{}class Ko extends Yc{constructor(e){super(),this.elements=e}}function Wy(n,e){const t=Yy(e);for(const r of n.elements)t.some(i=>Fr(i,r))||t.push(r);return{arrayValue:{values:t}}}class $o extends Yc{constructor(e){super(),this.elements=e}}function Qy(n,e){let t=Yy(e);for(const r of n.elements)t=t.filter(i=>!Fr(i,r));return{arrayValue:{values:t}}}class ou extends Yc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function xp(n){return Ct(n.integerValue||n.doubleValue)}function Yy(n){return ru(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,t){this.field=e,this.transform=t}}function HT(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ko&&i instanceof Ko||r instanceof $o&&i instanceof $o?Bo(r.elements,i.elements,Fr):r instanceof ou&&i instanceof ou?Fr(r.Pe,i.Pe):r instanceof su&&i instanceof su}(n.transform,e.transform)}class WT{constructor(e,t){this.version=e,this.transformResults=t}}class Cn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Jc{}function Jy(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xc(n.key,Cn.none()):new Jo(n.key,n.data,Cn.none());{const t=n.data,r=vn.empty();let i=new vt(kt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new di(n.key,r,new Nn(i.toArray()),Cn.none())}}function QT(n,e,t){n instanceof Jo?function(i,s,o){const u=i.value.clone(),l=Dp(i.fieldTransforms,s,o.transformResults);u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):n instanceof di?function(i,s,o){if(!nc(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=Dp(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Xy(i)),l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ba(n,e,t,r){return n instanceof Jo?function(s,o,u,l){if(!nc(s.precondition,o))return u;const f=s.value.clone(),m=Vp(s.fieldTransforms,l,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof di?function(s,o,u,l){if(!nc(s.precondition,o))return u;const f=Vp(s.fieldTransforms,l,o),m=o.data;return m.setAll(Xy(s)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,r):function(s,o,u){return nc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(n,e,t)}function YT(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Hy(r.transform,i||null);s!=null&&(t===null&&(t=vn.empty()),t.set(r.field,s))}return t||null}function Cp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Bo(r,i,(s,o)=>HT(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Jo extends Jc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class di extends Jc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Xy(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Dp(n,e,t){const r=new Map;Fe(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,zT(o,u,t[i]))}return r}function Vp(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,$T(s,o,e))}return r}class Xc extends Jc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zy extends Jc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&QT(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ba(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ba(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=zy();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;const l=Jy(o,u);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(je.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Bo(this.mutations,e.mutations,(t,r)=>Cp(t,r))&&Bo(this.baseMutations,e.baseMutations,(t,r)=>Cp(t,r))}}class wf{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Fe(e.mutations.length===r.length);let i=function(){return BT}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new wf(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt,st;function XT(n){switch(n){default:return Ne();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0}}function e_(n){if(n===void 0)return Pn("GRPC error has no .code"),ne.UNKNOWN;switch(n){case Yt.OK:return ne.OK;case Yt.CANCELLED:return ne.CANCELLED;case Yt.UNKNOWN:return ne.UNKNOWN;case Yt.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Yt.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Yt.INTERNAL:return ne.INTERNAL;case Yt.UNAVAILABLE:return ne.UNAVAILABLE;case Yt.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Yt.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Yt.NOT_FOUND:return ne.NOT_FOUND;case Yt.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Yt.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Yt.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Yt.ABORTED:return ne.ABORTED;case Yt.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Yt.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Yt.DATA_LOSS:return ne.DATA_LOSS;default:return Ne()}}(st=Yt||(Yt={}))[st.OK=0]="OK",st[st.CANCELLED=1]="CANCELLED",st[st.UNKNOWN=2]="UNKNOWN",st[st.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",st[st.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",st[st.NOT_FOUND=5]="NOT_FOUND",st[st.ALREADY_EXISTS=6]="ALREADY_EXISTS",st[st.PERMISSION_DENIED=7]="PERMISSION_DENIED",st[st.UNAUTHENTICATED=16]="UNAUTHENTICATED",st[st.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",st[st.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",st[st.ABORTED=10]="ABORTED",st[st.OUT_OF_RANGE=11]="OUT_OF_RANGE",st[st.UNIMPLEMENTED=12]="UNIMPLEMENTED",st[st.INTERNAL=13]="INTERNAL",st[st.UNAVAILABLE=14]="UNAVAILABLE",st[st.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=new Cs([4294967295,4294967295],0);function kp(n){const e=ZT().encode(n),t=new hy;return t.update(e),new Uint8Array(t.digest())}function Op(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Cs([t,r],0),new Cs([i,s],0)]}class bf{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ta(`Invalid padding: ${t}`);if(r<0)throw new Ta(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ta(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ta(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Cs.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Cs.fromNumber(r)));return i.compare(eA)===1&&(i=new Cs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=kp(e),[r,i]=Op(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new bf(s,i,t);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;const t=kp(e),[r,i]=Op(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ta extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Zc(je.min(),i,new Dt(He),Un(),Ye())}}class gu{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new gu(r,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class t_{constructor(e,t){this.targetId=e,this.me=t}}class n_{constructor(e,t,r=Xt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Np{constructor(){this.fe=0,this.ge=Fp(),this.pe=Xt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ye(),t=Ye(),r=Ye();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ne()}}),new gu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Fp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Fe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class tA{constructor(e){this.Le=e,this.Be=new Map,this.ke=Un(),this.qe=Mp(),this.Qe=new Dt(He)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ne()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(vc(s))if(r===0){const o=new Re(s.path);this.Ue(t,o,Mt.newNoDocument(o,je.min()))}else Fe(r===1);else{const o=this.Ye(t);if(o!==r){const u=this.Ze(e),l=u?this.Xe(u,e,o):1;if(l!==0){this.je(t);const f=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,f)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,u;try{o=li(r).toUint8Array()}catch(l){if(l instanceof xy)return Os("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new bf(o,i,s)}catch(l){return Os(l instanceof Ta?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const u=this.Je(o);if(u){if(s.current&&vc(u.target)){const l=new Re(u.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Mt.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=Ye();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(l=>{const f=this.Je(l);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Zc(e,t,this.Qe,this.ke,r);return this.ke=Un(),this.qe=Mp(),this.Qe=new Dt(He),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Np,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new vt(He),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Np),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Mp(){return new Dt(Re.comparator)}function Fp(){return new Dt(Re.comparator)}const nA={asc:"ASCENDING",desc:"DESCENDING"},rA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iA={and:"AND",or:"OR"};class sA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sh(n,e){return n.useProto3Json||Gc(e)?e:{value:e}}function zo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function r_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function oA(n,e){return zo(n,e.toTimestamp())}function Dn(n){return Fe(!!n),je.fromTimestamp(function(t){const r=ci(t);return new St(r.seconds,r.nanos)}(n))}function If(n,e){return Rh(n,e).canonicalString()}function Rh(n,e){const t=function(i){return new mt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function i_(n){const e=mt.fromString(n);return Fe(d_(e)),e}function Ec(n,e){return If(n.databaseId,e.path)}function Ds(n,e){const t=i_(e);if(t.get(1)!==n.databaseId.projectId)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Re(a_(t))}function s_(n,e){return If(n.databaseId,e)}function o_(n){const e=i_(n);return e.length===4?mt.emptyPath():a_(e)}function Ph(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function a_(n){return Fe(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Lp(n,e,t){return{name:Ec(n,e),fields:t.value.mapValue.fields}}function aA(n,e,t){const r=Ds(n,e.name),i=Dn(e.updateTime),s=e.createTime?Dn(e.createTime):je.min(),o=new vn({mapValue:{fields:e.fields}}),u=Mt.newFoundDocument(r,i,s,o);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function uA(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ne()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(Fe(m===void 0||typeof m=="string"),Xt.fromBase64String(m||"")):(Fe(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Xt.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(f){const m=f.code===void 0?ne.UNKNOWN:e_(f.code);return new we(m,f.message||"")}(o);t=new n_(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ds(n,r.document.name),s=Dn(r.document.updateTime),o=r.document.createTime?Dn(r.document.createTime):je.min(),u=new vn({mapValue:{fields:r.document.fields}}),l=Mt.newFoundDocument(i,s,o,u),f=r.targetIds||[],m=r.removedTargetIds||[];t=new rc(f,m,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ds(n,r.document),s=r.readTime?Dn(r.readTime):je.min(),o=Mt.newNoDocument(i,s),u=r.removedTargetIds||[];t=new rc([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ds(n,r.document),s=r.removedTargetIds||[];t=new rc([],s,i,null)}else{if(!("filter"in e))return Ne();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new JT(i,s),u=r.targetId;t=new t_(u,o)}}return t}function bc(n,e){let t;if(e instanceof Jo)t={update:Lp(n,e.key,e.value)};else if(e instanceof Xc)t={delete:Ec(n,e.key)};else if(e instanceof di)t={update:Lp(n,e.key,e.data),updateMask:pA(e.fieldMask)};else{if(!(e instanceof Zy))return Ne();t={verify:Ec(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof su)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ko)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof $o)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ou)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw Ne()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oA(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne()}(n,e.precondition)),t}function xh(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Cn.updateTime(Dn(s.updateTime)):s.exists!==void 0?Cn.exists(s.exists):Cn.none()}(e.currentDocument):Cn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,u){let l=null;if("setToServerValue"in u)Fe(u.setToServerValue==="REQUEST_TIME"),l=new su;else if("appendMissingElements"in u){const m=u.appendMissingElements.values||[];l=new Ko(m)}else if("removeAllFromArray"in u){const m=u.removeAllFromArray.values||[];l=new $o(m)}else"increment"in u?l=new ou(o,u.increment):Ne();const f=kt.fromServerFormat(u.fieldPath);return new GT(f,l)}(n,i)):[];if(e.update){e.update.name;const i=Ds(n,e.update.name),s=new vn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const f=l.fieldPaths||[];return new Nn(f.map(m=>kt.fromServerFormat(m)))}(e.updateMask);return new di(i,s,o,t,r)}return new Jo(i,s,t,r)}if(e.delete){const i=Ds(n,e.delete);return new Xc(i,t)}if(e.verify){const i=Ds(n,e.verify);return new Zy(i,t)}return Ne()}function cA(n,e){return n&&n.length>0?(Fe(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Dn(i.updateTime):Dn(s);return o.isEqual(je.min())&&(o=Dn(s)),new WT(o,i.transformResults||[])}(t,e))):[]}function u_(n,e){return{documents:[s_(n,e.path)]}}function c_(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=s_(n,i);const s=function(f){if(f.length!==0)return f_(yt.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(f){if(f.length!==0)return f.map(m=>function(w){return{field:So(w.field),direction:hA(w.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=Sh(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{_t:t,parent:i}}function l_(n){let e=o_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Fe(r===1);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(g){const w=h_(g);return w instanceof yt&&gf(w)?w.getFilters():[w]}(t.where));let o=[];t.orderBy&&(o=function(g){return g.map(w=>function(L){return new iu(Ro(L.field),function(J){switch(J){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(w))}(t.orderBy));let u=null;t.limit&&(u=function(g){let w;return w=typeof g=="object"?g.value:g,Gc(w)?null:w}(t.limit));let l=null;t.startAt&&(l=function(g){const w=!!g.before,I=g.values||[];return new Uo(I,w)}(t.startAt));let f=null;return t.endAt&&(f=function(g){const w=!g.before,I=g.values||[];return new Uo(I,w)}(t.endAt)),OT(e,i,o,s,u,"F",l,f)}function lA(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function h_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ro(t.unaryFilter.field);return rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ro(t.unaryFilter.field);return rt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ro(t.unaryFilter.field);return rt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ro(t.unaryFilter.field);return rt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ne()}}(n):n.fieldFilter!==void 0?function(t){return rt.create(Ro(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ne()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return yt.create(t.compositeFilter.filters.map(r=>h_(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ne()}}(t.compositeFilter.op))}(n):Ne()}function hA(n){return nA[n]}function fA(n){return rA[n]}function dA(n){return iA[n]}function So(n){return{fieldPath:n.canonicalString()}}function Ro(n){return kt.fromServerFormat(n.fieldPath)}function f_(n){return n instanceof rt?function(t){if(t.op==="=="){if(Ep(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NAN"}};if(wp(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ep(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NAN"}};if(wp(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:So(t.field),op:fA(t.op),value:t.value}}}(n):n instanceof yt?function(t){const r=t.getFilters().map(i=>f_(i));return r.length===1?r[0]:{compositeFilter:{op:dA(t.op),filters:r}}}(n):Ne()}function pA(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function d_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t,r,i,s=je.min(),o=je.min(),u=Xt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e){this.ct=e}}function mA(n,e){let t;if(e.document)t=aA(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Re.fromSegments(e.noDocument.path),i=Ls(e.noDocument.readTime);t=Mt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ne();{const r=Re.fromSegments(e.unknownDocument.path),i=Ls(e.unknownDocument.version);t=Mt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new St(i[0],i[1]);return je.fromTimestamp(s)}(e.readTime)),t}function Bp(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Ic(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ec(s,o.key),fields:o.data.value.mapValue.fields,updateTime:zo(s,o.version.toTimestamp()),createTime:zo(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Fs(e.version)};else{if(!e.isUnknownDocument())return Ne();r.unknownDocument={path:t.path.toArray(),version:Fs(e.version)}}return r}function Ic(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Fs(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ls(n){const e=new St(n.seconds,n.nanoseconds);return je.fromTimestamp(e)}function Ts(n,e){const t=(e.baseMutations||[]).map(s=>xh(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];o.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>xh(n.ct,s)),i=St.fromMillis(e.localWriteTimeMs);return new vf(e.batchId,i,t,r)}function Aa(n){const e=Ls(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ls(n.lastLimboFreeSnapshotVersion):je.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Fe(s.documents.length===1),ir(yf(o_(s.documents[0])))}(n.query):function(s){return ir(l_(s))}(n.query),new si(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xt.fromBase64String(n.resumeToken))}function m_(n,e){const t=Fs(e.snapshotVersion),r=Fs(e.lastLimboFreeSnapshotVersion);let i;i=vc(e.target)?u_(n.ct,e.target):c_(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ms(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function g_(n){const e=l_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ah(e,e.limit,"L"):e}function jl(n,e){return new Ef(e.largestBatchId,xh(n.ct,e.overlayMutation))}function jp(n,e){const t=e.path.lastSegment();return[n,wn(e.path.popLast()),t]}function Up(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Fs(r.readTime),documentKey:wn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{getBundleMetadata(e,t){return qp(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ls(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return qp(e).put(function(i){return{bundleId:i.id,createTime:Fs(Dn(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Kp(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:g_(s.bundledQuery),readTime:Ls(s.readTime)}}(r)})}saveNamedQuery(e,t){return Kp(e).put(function(i){return{name:i.name,readTime:Fs(Dn(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function qp(n){return rn(n,"bundles")}function Kp(n){return rn(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new el(e,r)}getOverlay(e,t){return ga(e).get(jp(this.userId,t)).next(r=>r?jl(this.serializer,r):null)}getOverlays(e,t){const r=Or();return H.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const u=new Ef(t,o);i.push(this.ht(e,u))}),H.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(wn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const u=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ga(e).j("collectionPathOverlayIndex",u))}),H.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Or(),s=wn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ga(e).U("collectionPathOverlayIndex",o).next(u=>{for(const l of u){const f=jl(this.serializer,l);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Or();let o;const u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ga(e).J({index:"collectionGroupOverlayIndex",range:u},(l,f,m)=>{const g=jl(this.serializer,f);s.size()<i||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):m.done()}).next(()=>s)}ht(e,t){return ga(e).put(function(i,s,o){const[u,l,f]=jp(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:bc(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function ga(n){return rn(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{Pt(e){return rn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Xt.fromUint8Array(r):Xt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ct(e.integerValue));else if("doubleValue"in e){const r=Ct(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Za(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=ci(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(li(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Cy(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Wc(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ne()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const s=e.fields||{};this.dt(t,53);const o="value",u=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Ct(u)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),Re.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}As.vt=new As;function _A(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function $p(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=_A(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class vA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=$p(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=$p(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class wA{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class EA{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ya{constructor(){this.jt=new vA,this.Ht=new wA(this.jt),this.Jt=new EA(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ss(this.indexId,this.documentKey,this.arrayValue,r)}}function Si(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=zp(n.arrayValue,e.arrayValue),t!==0?t:(t=zp(n.directionalValue,e.directionalValue),t!==0?t:Re.comparator(n.documentKey,e.documentKey)))}function zp(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e){this.Xt=new vt((t,r)=>kt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Fe(e.collectionGroup===this.collectionId),this.nn)return!1;const t=yh(e);if(t!==void 0&&!this.sn(t))return!1;const r=Es(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const l=r[s];if(!this.on(u,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const u=r[s];if(o>=this.en.length||!this._n(this.en[o++],u))return!1}return!0}an(){if(this.nn)return null;let e=new vt(kt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ju(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ju(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ju(r.field,r.dir==="asc"?0:1)));return new _c(_c.UNKNOWN_ID,this.collectionId,t,Xa.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(n){var e,t;if(Fe(n instanceof rt||n instanceof yt),n instanceof rt){if(n instanceof By){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>rt.create(n.field,"==",s)))||[];return yt.create(i,"or")}return n}const r=n.filters.map(i=>y_(i));return yt.create(r,n.op)}function bA(n){if(n.getFilters().length===0)return[];const e=Vh(y_(n));return Fe(__(e)),Ch(e)||Dh(e)?[e]:e.getFilters()}function Ch(n){return n instanceof rt}function Dh(n){return n instanceof yt&&gf(n)}function __(n){return Ch(n)||Dh(n)||function(t){if(t instanceof yt&&Eh(t)){for(const r of t.getFilters())if(!Ch(r)&&!Dh(r))return!1;return!0}return!1}(n)}function Vh(n){if(Fe(n instanceof rt||n instanceof yt),n instanceof rt)return n;if(n.filters.length===1)return Vh(n.filters[0]);const e=n.filters.map(r=>Vh(r));let t=yt.create(e,n.op);return t=Tc(t),__(t)?t:(Fe(t instanceof yt),Fe(qo(t)),Fe(t.filters.length>1),t.filters.reduce((r,i)=>Tf(r,i)))}function Tf(n,e){let t;return Fe(n instanceof rt||n instanceof yt),Fe(e instanceof rt||e instanceof yt),t=n instanceof rt?e instanceof rt?function(i,s){return yt.create([i,s],"and")}(n,e):Hp(n,e):e instanceof rt?Hp(e,n):function(i,s){if(Fe(i.filters.length>0&&s.filters.length>0),qo(i)&&qo(s))return My(i,s.getFilters());const o=Eh(i)?i:s,u=Eh(i)?s:i,l=o.filters.map(f=>Tf(f,u));return yt.create(l,"or")}(n,e),Tc(t)}function Hp(n,e){if(qo(e))return My(e,n.getFilters());{const t=e.filters.map(r=>Tf(n,r));return yt.create(t,"or")}}function Tc(n){if(Fe(n instanceof rt||n instanceof yt),n instanceof rt)return n;const e=n.getFilters();if(e.length===1)return Tc(e[0]);if(Oy(n))return n;const t=e.map(i=>Tc(i)),r=[];return t.forEach(i=>{i instanceof rt?r.push(i):i instanceof yt&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:yt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.un=new Af}addToCollectionParentIndex(e,t){return this.un.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(qn.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(qn.min())}updateCollectionGroup(e,t,r){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}}class Af{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new vt(mt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new vt(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ju=new Uint8Array(0);class TA{constructor(e,t){this.databaseId=t,this.cn=new Af,this.ln=new fi(r=>Ms(r),(r,i)=>pu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:r,parent:wn(i)};return Wp(e).put(s)}return H.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[vy(t),""],!1,!0);return Wp(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(kr(o.parent))}return r})}addFieldIndex(e,t){const r=_a(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=yo(e);return s.next(u=>{o.put(Up(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=_a(e),i=yo(e),s=go(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=_a(e),r=go(e),i=yo(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return H.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new Gp(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=go(e);let i=!0;const s=new Map;return H.forEach(this.hn(t),o=>this.Pn(e,o).next(u=>{i&&(i=!!u),s.set(o,u)})).next(()=>{if(i){let o=Ye();const u=[];return H.forEach(s,(l,f)=>{de("IndexedDbIndexManager",`Using index ${function(te){return`id=${te.indexId}|cg=${te.collectionGroup}|f=${te.fields.map(ce=>`${ce.fieldPath}:${ce.kind}`).join(",")}`}(l)} to execute ${Ms(t)}`);const m=function(te,ce){const Se=yh(ce);if(Se===void 0)return null;for(const Pe of wc(te,Se.fieldPath))switch(Pe.op){case"array-contains-any":return Pe.value.arrayValue.values||[];case"array-contains":return[Pe.value]}return null}(f,l),g=function(te,ce){const Se=new Map;for(const Pe of Es(ce))for(const D of wc(te,Pe.fieldPath))switch(D.op){case"==":case"in":Se.set(Pe.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return Se.set(Pe.fieldPath.canonicalString(),D.value),Array.from(Se.values())}return null}(f,l),w=function(te,ce){const Se=[];let Pe=!0;for(const D of Es(ce)){const S=D.kind===0?Sp(te,D.fieldPath,te.startAt):Rp(te,D.fieldPath,te.startAt);Se.push(S.value),Pe&&(Pe=S.inclusive)}return new Uo(Se,Pe)}(f,l),I=function(te,ce){const Se=[];let Pe=!0;for(const D of Es(ce)){const S=D.kind===0?Rp(te,D.fieldPath,te.endAt):Sp(te,D.fieldPath,te.endAt);Se.push(S.value),Pe&&(Pe=S.inclusive)}return new Uo(Se,Pe)}(f,l),L=this.In(l,f,w),K=this.In(l,f,I),J=this.Tn(l,f,g),ae=this.En(l.indexId,m,L,w.inclusive,K,I.inclusive,J);return H.forEach(ae,oe=>r.G(oe,t.limit).next(te=>{te.forEach(ce=>{const Se=Re.fromSegments(ce.documentKey);o.has(Se)||(o=o.add(Se),u.push(Se))})}))}).next(()=>u)}return H.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=bA(yt.create(e.filters,"and")).map(r=>Ih(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,u){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),f=l/(t!=null?t.length:1),m=[];for(let g=0;g<l;++g){const w=t?this.dn(t[g/f]):ju,I=this.An(e,w,r[g%f],i),L=this.Rn(e,w,s[g%f],o),K=u.map(J=>this.An(e,w,J,!0));m.push(...this.createRange(I,L,K))}return m}An(e,t,r,i){const s=new Ss(e,Re.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){const s=new Ss(e,Re.empty(),t,r);return i?s.Zt():s}Pn(e,t){const r=new Gp(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const u of s)r.rn(u)&&(!o||u.fields.length>o.fields.length)&&(o=u);return o})}getIndexType(e,t){let r=2;const i=this.hn(t);return H.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let f=new vt(kt.comparator),m=!1;for(const g of l.filters)for(const w of g.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?m=!0:f=f.add(w.field));for(const g of l.orderBy)g.field.isKeyField()||(f=f.add(g.field));return f.size+(m?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){const r=new ya;for(const i of Es(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);As.vt.It(s,o)}return r.zt()}dn(e){const t=new ya;return As.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new ya;return As.vt.It(nu(this.databaseId,t),r.Yt(function(s){const o=Es(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new ya);let s=0;for(const o of Es(e)){const u=r[s++];for(const l of i)if(this.fn(t,o.fieldPath)&&ru(u))i=this.gn(i,o,u);else{const f=l.Yt(o.kind);As.vt.It(u,f)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const u of i){const l=new ya;l.seed(u.zt()),As.vt.It(o,l.Yt(t.kind)),s.push(l)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof rt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=_a(e),i=yo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return H.forEach(s,u=>i.get([u.indexId,this.uid]).next(l=>{o.push(function(m,g){const w=g?new Xa(g.sequenceNumber,new qn(Ls(g.readTime),new Re(kr(g.documentKey)),g.largestBatchId)):Xa.empty(),I=m.fields.map(([L,K])=>new Ju(kt.fromServerFormat(L),K));return new _c(m.indexId,m.collectionGroup,I,w)}(u,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:He(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=_a(e),s=yo(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(u=>H.forEach(u,l=>s.put(Up(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return H.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?H.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),H.forEach(u,l=>this.wn(e,i,l).next(f=>{const m=this.Sn(s,l);return f.isEqual(m)?H.resolve():this.bn(e,s,l,f,m)}))))})}Dn(e,t,r,i){return go(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return go(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=go(e);let s=new vt(Si);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,u)=>{s=s.add(new Ss(r.indexId,t,u.arrayValue,u.directionalValue))}).next(()=>s)}Sn(e,t){let r=new vt(Si);const i=this.Vn(t,e);if(i==null)return r;const s=yh(t);if(s!=null){const o=e.data.field(s.fieldPath);if(ru(o))for(const u of o.arrayValue.values||[])r=r.add(new Ss(t.indexId,e.key,this.dn(u),i))}else r=r.add(new Ss(t.indexId,e.key,ju,i));return r}bn(e,t,r,i,s){de("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,f,m,g,w){const I=l.getIterator(),L=f.getIterator();let K=mo(I),J=mo(L);for(;K||J;){let ae=!1,oe=!1;if(K&&J){const te=m(K,J);te<0?oe=!0:te>0&&(ae=!0)}else K!=null?oe=!0:ae=!0;ae?(g(J),J=mo(L)):oe?(w(K),K=mo(I)):(K=mo(I),J=mo(L))}}(i,s,Si,u=>{o.push(this.Dn(e,t,r,u))},u=>{o.push(this.vn(e,t,r,u))}),H.waitFor(o)}yn(e){let t=1;return yo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,u)=>Si(o,u)).filter((o,u,l)=>!u||Si(o,l[u-1])!==0);const i=[];i.push(e);for(const o of r){const u=Si(o,e),l=Si(o,t);if(u===0)i[0]=e.Zt();else if(u>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const u=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,ju,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,ju,[]];s.push(IDBKeyRange.bound(u,l))}return s}Cn(e,t){return Si(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Qp)}getMinOffset(e,t){return H.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Ne())).next(Qp)}}function Wp(n){return rn(n,"collectionParents")}function go(n){return rn(n,"indexEntries")}function _a(n){return rn(n,"indexConfiguration")}function yo(n){return rn(n,"indexState")}function Qp(n){Fe(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;ff(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new qn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class gn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let u=0;const l=r.J({range:o},(m,g,w)=>(u++,w.delete()));s.push(l.next(()=>{Fe(u===1)}));const f=[];for(const m of t.mutations){const g=Ty(e,m.key.path,t.batchId);s.push(i.delete(g)),f.push(m.key)}return H.waitFor(s).next(()=>f)}function Ac(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ne();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(41943040,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class tl{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){Fe(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new tl(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ri(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Po(e),o=Ri(e);return o.add({}).next(u=>{Fe(typeof u=="number");const l=new vf(u,t,r,i),f=function(I,L,K){const J=K.baseMutations.map(oe=>bc(I.ct,oe)),ae=K.mutations.map(oe=>bc(I.ct,oe));return{userId:L,batchId:K.batchId,localWriteTimeMs:K.localWriteTime.toMillis(),baseMutations:J,mutations:ae}}(this.serializer,this.userId,l),m=[];let g=new vt((w,I)=>He(w.canonicalString(),I.canonicalString()));for(const w of i){const I=Ty(this.userId,w.key.path,u);g=g.add(w.key.path.popLast()),m.push(o.put(f)),m.push(s.put(I,iT))}return g.forEach(w=>{m.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Fn[u]=l.keys()}),H.waitFor(m).next(()=>l)})}lookupMutationBatch(e,t){return Ri(e).get(t).next(r=>r?(Fe(r.userId===this.userId),Ts(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?H.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ri(e).J({index:"userMutationsIndex",range:i},(o,u,l)=>{u.userId===this.userId&&(Fe(u.batchId>=r),s=Ts(this.serializer,u)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ri(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ri(e).U("userMutationsIndex",t).next(r=>r.map(i=>Ts(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Xu(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Po(e).J({range:i},(o,u,l)=>{const[f,m,g]=o,w=kr(m);if(f===this.userId&&t.path.isEqual(w))return Ri(e).get(g).next(I=>{if(!I)throw Ne();Fe(I.userId===this.userId),s.push(Ts(this.serializer,I))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt(He);const i=[];return t.forEach(s=>{const o=Xu(this.userId,s.path),u=IDBKeyRange.lowerBound(o),l=Po(e).J({range:u},(f,m,g)=>{const[w,I,L]=f,K=kr(I);w===this.userId&&s.path.isEqual(K)?r=r.add(L):g.done()});i.push(l)}),H.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Xu(this.userId,r),o=IDBKeyRange.lowerBound(s);let u=new vt(He);return Po(e).J({range:o},(l,f,m)=>{const[g,w,I]=l,L=kr(w);g===this.userId&&r.isPrefixOf(L)?L.length===i&&(u=u.add(I)):m.done()}).next(()=>this.xn(e,u))}xn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Ri(e).get(s).next(o=>{if(o===null)throw Ne();Fe(o.userId===this.userId),r.push(Ts(this.serializer,o))}))}),H.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return v_(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),H.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return H.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Po(e).J({range:r},(s,o,u)=>{if(s[0]===this.userId){const l=kr(s[1]);i.push(l)}else u.done()}).next(()=>{Fe(i.length===0)})})}containsKey(e,t){return w_(e,this.userId,t)}Nn(e){return E_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function w_(n,e,t){const r=Xu(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Po(n).J({range:s,H:!0},(u,l,f)=>{const[m,g,w]=u;m===e&&g===i&&(o=!0),f.done()}).next(()=>o)}function Ri(n){return rn(n,"mutations")}function Po(n){return rn(n,"documentMutations")}function E_(n){return rn(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Bs(0)}static kn(){return new Bs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new Bs(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>je.fromTimestamp(new St(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>_o(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Fe(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return _o(e).J((o,u)=>{const l=Aa(u);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>H.waitFor(s)).next(()=>i)}forEachTarget(e,t){return _o(e).J((r,i)=>{const s=Aa(i);t(s)})}qn(e){return Jp(e).get("targetGlobalKey").next(t=>(Fe(t!==null),t))}Qn(e,t){return Jp(e).put("targetGlobalKey",t)}Kn(e,t){return _o(e).put(m_(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ms(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return _o(e).J({range:i,index:"queryTargetsIndex"},(o,u,l)=>{const f=Aa(u);pu(t,f.target)&&(s=f,l.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Oi(e);return t.forEach(o=>{const u=wn(o.path);i.push(s.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,o))}),H.waitFor(i)}removeMatchingKeys(e,t,r){const i=Oi(e);return H.forEach(t,s=>{const o=wn(s.path);return H.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Oi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Oi(e);let s=Ye();return i.J({range:r,H:!0},(o,u,l)=>{const f=kr(o[1]),m=new Re(f);s=s.add(m)}).next(()=>s)}containsKey(e,t){const r=wn(t.path),i=IDBKeyRange.bound([r],[vy(r)],!1,!0);let s=0;return Oi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,u],l,f)=>{o!==0&&(s++,f.done())}).next(()=>s>0)}ot(e,t){return _o(e).get(t).next(r=>r?Aa(r):null)}}function _o(n){return rn(n,"targets")}function Jp(n){return rn(n,"targetGlobal")}function Oi(n){return rn(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp([n,e],[t,r]){const i=He(n,t);return i===0?He(e,r):i}class SA{constructor(e){this.Un=e,this.buffer=new vt(Xp),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Xp(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class b_{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){de("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qi(t)?de("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await js(t)}await this.Hn(3e5)})}}class RA{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return H.resolve(er.oe);const r=new SA(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(Yp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yp):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,u,l,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,u=Date.now(),this.removeTargets(e,r,t))).next(g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(f=Date.now(),To()<=ut.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${g} documents in `+(f-l)+`ms
Total Duration: ${f-m}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}}function I_(n,e){return new RA(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t){this.db=e,this.garbageCollector=I_(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Uu(e,r)}removeReference(e,t,r){return Uu(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Uu(e,t)}nr(e,t){return function(i,s){let o=!1;return E_(i).Y(u=>w_(i,u,s).next(l=>(l&&(o=!0),H.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,u)=>{if(u<=t){const l=this.nr(e,o).next(f=>{if(!f)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,je.min()),Oi(e).delete(function(g){return[0,wn(g.path)]}(o))))});i.push(l)}}).next(()=>H.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Uu(e,t)}tr(e,t){const r=Oi(e);let i,s=er.oe;return r.J({index:"documentTargetsIndex"},([o,u],{path:l,sequenceNumber:f})=>{o===0?(s!==er.oe&&t(new Re(kr(i)),s),s=f,i=l):s=er.oe}).next(()=>{s!==er.oe&&t(new Re(kr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Uu(n,e){return Oi(n).put(function(r,i){return{targetId:0,path:wn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.changes=new fi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?H.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return _s(e).put(r)}removeEntry(e,t,r){return _s(e).delete(function(s,o){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Ic(o),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Mt.newInvalidDocument(t);return _s(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(va(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:Mt.newInvalidDocument(t)};return _s(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(va(t))},(i,s)=>{r={document:this.ir(t,s),size:Ac(s)}}).next(()=>r)}getEntries(e,t){let r=Un();return this._r(e,t,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=Un(),i=new Dt(Re.comparator);return this._r(e,t,(s,o)=>{const u=this.ir(s,o);r=r.insert(s,u),i=i.insert(s,Ac(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return H.resolve();let i=new vt(tm);t.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(va(i.first()),va(i.last())),o=i.getIterator();let u=o.getNext();return _s(e).J({index:"documentKeyIndex",range:s},(l,f,m)=>{const g=Re.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;u&&tm(u,g)<0;)r(u,null),u=o.getNext();u&&u.isEqual(g)&&(r(u,f),u=o.hasNext()?o.getNext():null),u?m.$(va(u)):m.done()}).next(()=>{for(;u;)r(u,null),u=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,u=[o.popLast().toArray(),o.lastSegment(),Ic(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _s(e).U(IDBKeyRange.bound(u,l,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let m=Un();for(const g of f){const w=this.ir(Re.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);w.isFoundDocument()&&(mu(t,w)||i.has(w.key))&&(m=m.insert(w.key,w))}return m})}getAllFromCollectionGroup(e,t,r,i){let s=Un();const o=em(t,r),u=em(t,qn.max());return _s(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(l,f,m)=>{const g=this.ir(Re.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(g.key,g),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new CA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Zp(e).get("remoteDocumentGlobalKey").next(t=>(Fe(!!t),t))}rr(e,t){return Zp(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=mA(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(je.min())))return r}return Mt.newInvalidDocument(e)}}function A_(n){return new xA(n)}class CA extends T_{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new fi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new vt((s,o)=>He(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const u=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,u.readTime)),o.isValidDocument()){const l=Bp(this.cr.serializer,o);i=i.add(s.path.popLast());const f=Ac(l);r+=f-u.size,t.push(this.cr.addEntry(e,s,l))}else if(r-=u.size,this.trackRemovals){const l=Bp(this.cr.serializer,o.convertToNoDocument(je.min()));t.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),H.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Zp(n){return rn(n,"remoteDocumentGlobal")}function _s(n){return rn(n,"remoteDocumentsV14")}function va(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function em(n,e){const t=e.documentKey.path.toArray();return[n,Ic(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tm(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=He(t[s],r[s]),i)return i;return i=He(t.length,r.length),i||(i=He(t[t.length-2],r[r.length-2]),i||He(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ba(r.mutation,i,Nn.empty(),St.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ye()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ye()){const i=Or();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ia();return s.forEach((u,l)=>{o=o.insert(u,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Or();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ye()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,r,i){let s=Un();const o=La(),u=function(){return La()}();return t.forEach((l,f)=>{const m=r.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof di)?s=s.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),Ba(m.mutation,f,m.mutation.getFieldMask(),St.now())):o.set(f.key,Nn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((f,m)=>o.set(f,m)),t.forEach((f,m)=>{var g;return u.set(f,new DA(m,(g=o.get(f))!==null&&g!==void 0?g:null))}),u))}recalculateAndSaveOverlays(e,t){const r=La();let i=new Dt((o,u)=>o-u),s=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const u of o)u.keys().forEach(l=>{const f=t.get(l);if(f===null)return;let m=r.get(l)||Nn.empty();m=u.applyToLocalView(f,m),r.set(l,m);const g=(i.get(u.batchId)||Ye()).add(l);i=i.insert(u.batchId,g)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),f=l.key,m=l.value,g=zy();m.forEach(w=>{if(!s.has(w)){const I=Jy(t.get(w),r.get(w));I!==null&&g.set(w,I),s=s.add(w)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,g))}return H.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return Re.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):jy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):H.resolve(Or());let u=-1,l=s;return o.next(f=>H.forEach(f,(m,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),s.get(m)?H.resolve():this.remoteDocumentCache.getEntry(e,m).next(w=>{l=l.insert(m,w)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,l,f,Ye())).next(m=>({batchId:u,changes:$y(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Re(t)).next(r=>{let i=Ia();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ia();return this.indexManager.getCollectionParents(e,s).next(u=>H.forEach(u,l=>{const f=function(g,w){return new Yo(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(m=>{m.forEach((g,w)=>{o=o.insert(g,w)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,f)=>{const m=f.getKey();o.get(m)===null&&(o=o.insert(m,Mt.newInvalidDocument(m)))});let u=Ia();return o.forEach((l,f)=>{const m=s.get(l);m!==void 0&&Ba(m.mutation,f,Nn.empty(),St.now()),mu(t,f)&&(u=u.insert(l,f))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return H.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Dn(i.createTime)}}(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:g_(i.bundledQuery),readTime:Dn(i.readTime)}}(t)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(){this.overlays=new Dt(Re.comparator),this.Ir=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Or();return H.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),H.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,t,r){const i=Or(),s=t.length+1,o=new Re(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const l=u.getNext().value,f=l.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return H.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Dt((f,m)=>f-m);const o=this.overlays.getIterator();for(;o.hasNext();){const f=o.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let m=s.get(f.largestBatchId);m===null&&(m=Or(),s=s.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const u=Or(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((f,m)=>u.set(f,m)),!(u.size()>=i)););return H.resolve(u)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ef(t,r));let s=this.Ir.get(t);s===void 0&&(s=Ye(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(){this.sessionToken=Xt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this.Tr=new vt(sn.Er),this.dr=new vt(sn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new sn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new sn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Re(new mt([])),r=new sn(t,e),i=new sn(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Re(new mt([])),r=new sn(t,e),i=new sn(t,e+1);let s=Ye();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new sn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class sn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Re.comparator(e.key,t.key)||He(e.wr,t.wr)}static Ar(e,t){return He(e.wr,t.wr)||Re.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new vt(sn.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vf(s,t,r,i);this.mutationQueue.push(o);for(const u of i)this.br=this.br.add(new sn(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,t){return H.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return H.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new sn(t,0),i=new sn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const u=this.Dr(o.wr);s.push(u)}),H.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vt(He);return t.forEach(i=>{const s=new sn(i,0),o=new sn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],u=>{r=r.add(u.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Re.isDocumentKey(s)||(s=s.child(""));const o=new sn(new Re(s),0);let u=new vt(He);return this.br.forEachWhile(l=>{const f=l.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(u=u.add(l.wr)),!0)},o),H.resolve(this.Cr(u))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Fe(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(t.mutations,i=>{const s=new sn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new sn(t,0),i=this.br.firstAfterOrEqual(r);return H.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e){this.Mr=e,this.docs=function(){return new Dt(Re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return H.resolve(r?r.document.mutableCopy():Mt.newInvalidDocument(t))}getEntries(e,t){let r=Un();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Mt.newInvalidDocument(i))}),H.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Un();const o=t.path,u=new Re(o.child("")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:f,value:{document:m}}=l.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||ff(wy(m),r)<=0||(i.has(m.key)||mu(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return H.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ne()}Or(e,t){return H.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new FA(this)}getSize(e){return H.resolve(this.size)}}class FA extends T_{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),H.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e){this.persistence=e,this.Nr=new fi(t=>Ms(t),pu),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Sf,this.targetCount=0,this.kr=Bs.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),H.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Bs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.Kn(t),H.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),H.waitFor(s).next(()=>i)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return H.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),H.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),H.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),H.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return H.resolve(r)}containsKey(e,t){return H.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this.qr={},this.overlays={},this.Qr=new er(0),this.Kr=!1,this.Kr=!0,this.$r=new OA,this.referenceDelegate=e(this),this.Ur=new LA(this),this.indexManager=new IA,this.remoteDocumentCache=function(i){return new MA(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new p_(t),this.Gr=new VA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new NA(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){de("MemoryPersistence","Starting transaction:",e);const i=new BA(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class BA extends by{constructor(e){super(),this.currentSequenceNumber=e}}class nl{constructor(e){this.persistence=e,this.Jr=new Sf,this.Yr=null}static Zr(e){return new nl(e)}get Xr(){if(this.Yr)return this.Yr;throw Ne()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),H.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const i=Re.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,je.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return H.or([()=>H.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Sc{constructor(e,t){this.persistence=e,this.ti=new fi(r=>wn(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=I_(this,t)}static Zr(e,t){return new Sc(e,t)}zr(){}jr(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}Zn(e,t){return H.forEach(this.ti,(r,i)=>this.nr(e,r,i).next(s=>s?H.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Or(e,o=>this.nr(e,o,t).next(u=>{u||(r++,s.removeEntry(o,je.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),H.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),H.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ec(e.data.value)),t}nr(e,t,r){return H.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.ti.get(t);return H.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.serializer=e}O(e,t,r,i){const s=new zc("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mp,{unique:!0}),l.createObjectStore("documentMutations")}(e),nm(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=H.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),nm(e)),o=o.next(()=>function(l){const f=l.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:je.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",m)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,f){return f.store("mutations").U().next(m=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mp,{unique:!0});const g=f.store("mutations"),w=m.map(I=>g.put(I));return H.waitFor(w)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const f=l.createObjectStore("documentOverlays",{keyPath:gT});f.createIndex("collectionPathOverlayIndex",yT,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",_T,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const f=l.createObjectStore("remoteDocumentsV14",{keyPath:sT});f.createIndex("documentKeyIndex",oT),f.createIndex("collectionGroupIndex",aT)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:fT}).createIndex("sequenceNumberIndex",dT,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:pT}).createIndex("documentKeyIndex",mT,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Ac(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>H.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(u=>H.forEach(u,l=>{Fe(l.userId===s.userId);const f=Ts(this.serializer,l);return v_(e,s.userId,f).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,u)=>{const l=new mt(o),f=function(g){return[0,wn(g)]}(l);s.push(t.get(f).next(m=>m?H.resolve():(g=>t.put({targetId:0,path:wn(g),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>H.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:hT});const r=t.store("collectionParents"),i=new Af,s=o=>{if(i.add(o)){const u=o.lastSegment(),l=o.popLast();return r.put({collectionId:u,parent:wn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,u)=>{const l=new mt(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,u,l],f)=>{const m=kr(u);return s(m.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const s=Aa(i),o=m_(this.serializer,s);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const u=t.store("remoteDocumentsV14"),l=function(g){return g.document?new Re(mt.fromString(g.document.name).popFirst(5)):g.noDocument?Re.fromSegments(g.noDocument.path):g.unknownDocument?Re.fromSegments(g.unknownDocument.path):Ne()}(o).path.toArray(),f={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(u.put(f))}).next(()=>H.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=A_(this.serializer),s=new Rf(nl.Zr,this.serializer.ct);return r.U().next(o=>{const u=new Map;return o.forEach(l=>{var f;let m=(f=u.get(l.userId))!==null&&f!==void 0?f:Ye();Ts(this.serializer,l).keys().forEach(g=>m=m.add(g)),u.set(l.userId,m)}),H.forEach(u,(l,f)=>{const m=new cn(f),g=el.lt(this.serializer,m),w=s.getIndexManager(m),I=tl.lt(m,this.serializer,w,s.referenceDelegate);return new S_(i,I,g,w).recalculateAndSaveOverlaysForDocumentKeys(new _h(t,er.oe),l).next()})})}}function nm(n){n.createObjectStore("targetDocuments",{keyPath:cT}).createIndex("documentTargetsIndex",lT,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",uT,{unique:!0}),n.createObjectStore("targetGlobal")}const Ul="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Pf{constructor(e,t,r,i,s,o,u,l,f,m,g=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=u,this.ci=f,this.li=m,this.hi=g,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=w=>Promise.resolve(),!Pf.D())throw new we(ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new PA(this,i),this.Ai=t+"main",this.serializer=new p_(l),this.Ri=new Bi(this.Ai,this.hi,new jA(this.serializer)),this.$r=new yA,this.Ur=new AA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=A_(this.serializer),this.Gr=new gA,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,m===!1&&Pn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new we(ne.FAILED_PRECONDITION,Ul);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new er(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>qu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Qi(e))return de("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return wa(e).get("owner").next(t=>H.resolve(this.vi(t)))}Ci(e){return qu(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=rn(t,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(u=>s.indexOf(u)===-1);return H.forEach(o,u=>r.delete(u.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?H.resolve(!0):wa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new we(ne.FAILED_PRECONDITION,Ul);return!1}}return!(!this.networkEnabled||!this.inForeground)||qu(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||o&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&de("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new _h(e,er.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>qu(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return tl.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new TA(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return el.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){de("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(l){return l===17?ET:l===16?wT:l===15?pf:l===14?Ry:l===13?Sy:l===12?vT:l===11?Ay:void Ne()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,u=>(o=new _h(u,this.Qr?this.Qr.next():er.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Pn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new we(ne.FAILED_PRECONDITION,Ey);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(u=>(o.raiseOnCommittedEvent(),u))}Ki(e){return wa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new we(ne.FAILED_PRECONDITION,Ul)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wa(e).put("owner",t)}static D(){return Bi.D()}bi(e){const t=wa(e);return t.get("owner").next(r=>this.vi(r)?(de("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):H.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Pn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;ty()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return de("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Pn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Pn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function wa(n){return rn(n,"owner")}function qu(n){return rn(n,"clientMetadata")}function UA(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Ye(),i=Ye();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new xf(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ty()?8:Iy(pc())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new qA;return this.Xi(e,t,o).next(u=>{if(s.result=u,this.zi)return this.es(e,t,o,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(To()<=ut.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",Ao(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(To()<=ut.DEBUG&&de("QueryEngine","Query:",Ao(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(To()<=ut.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",Ao(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(t))):H.resolve())}Yi(e,t){if(Pp(t))return H.resolve(null);let r=ir(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ah(t,null,"F"),r=ir(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ye(...s);return this.Ji.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{const f=this.ts(t,u);return this.ns(t,f,o,l.readTime)?this.Yi(e,Ah(t,null,"F")):this.rs(e,f,t,l)}))})))}Zi(e,t,r,i){return Pp(t)||i.isEqual(je.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?H.resolve(null):(To()<=ut.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ao(t)),this.rs(e,o,t,J0(i,-1)).next(u=>u))})}ts(e,t){let r=new vt(qy(e));return t.forEach((i,s)=>{mu(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return To()<=ut.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",Ao(t)),this.Ji.getDocumentsMatchingQuery(e,t,qn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Dt(He),this._s=new fi(s=>Ms(s),pu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new S_(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function P_(n,e,t,r){return new KA(n,e,t,r)}async function x_(n,e){const t=$e(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let l=Ye();for(const f of i){o.push(f.batchId);for(const m of f.mutations)l=l.add(m.key)}for(const f of s){u.push(f.batchId);for(const m of f.mutations)l=l.add(m.key)}return t.localDocuments.getDocuments(r,l).next(f=>({hs:f,removedBatchIds:o,addedBatchIds:u}))})})}function $A(n,e){const t=$e(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,l,f,m){const g=f.batch,w=g.keys();let I=H.resolve();return w.forEach(L=>{I=I.next(()=>m.getEntry(l,L)).next(K=>{const J=f.docVersions.get(L);Fe(J!==null),K.version.compareTo(J)<0&&(g.applyToRemoteDocument(K,f),K.isValidDocument()&&(K.setReadTime(f.commitVersion),m.addEntry(K)))})}),I.next(()=>u.mutationQueue.removeMutationBatch(l,g))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=Ye();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(l=l.add(u.batch.mutations[f].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function C_(n){const e=$e(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function zA(n,e){const t=$e(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const u=[];e.targetChanges.forEach((m,g)=>{const w=i.get(g);if(!w)return;u.push(t.Ur.removeMatchingKeys(s,m.removedDocuments,g).next(()=>t.Ur.addMatchingKeys(s,m.addedDocuments,g)));let I=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?I=I.withResumeToken(Xt.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):m.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(m.resumeToken,r)),i=i.insert(g,I),function(K,J,ae){return K.resumeToken.approximateByteSize()===0||J.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=3e8?!0:ae.addedDocuments.size+ae.modifiedDocuments.size+ae.removedDocuments.size>0}(w,I,m)&&u.push(t.Ur.updateTargetData(s,I))});let l=Un(),f=Ye();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),u.push(GA(s,o,e.documentUpdates).next(m=>{l=m.Ps,f=m.Is})),!r.isEqual(je.min())){const m=t.Ur.getLastRemoteSnapshotVersion(s).next(g=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(m)}return H.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,f)).next(()=>l)}).then(s=>(t.os=i,s))}function GA(n,e,t){let r=Ye(),i=Ye();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Un();return t.forEach((u,l)=>{const f=s.get(u);l.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(je.min())?(e.removeEntry(u,l.readTime),o=o.insert(u,l)):!f.isValidDocument()||l.version.compareTo(f.version)>0||l.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(l),o=o.insert(u,l)):de("LocalStore","Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function HA(n,e){const t=$e(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function WA(n,e){const t=$e(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,H.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new si(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function kh(n,e,t){const r=$e(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Qi(o))throw o;de("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function rm(n,e,t){const r=$e(n);let i=je.min(),s=Ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,f,m){const g=$e(l),w=g._s.get(m);return w!==void 0?H.resolve(g.os.get(w)):g.Ur.getTargetData(f,m)}(r,o,ir(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,u.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:je.min(),t?s:Ye())).next(u=>(QA(r,MT(e),u),{documents:u,Ts:s})))}function QA(n,e,t){let r=n.us.get(e)||je.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class im{constructor(){this.activeTargetIds=qT()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class D_{constructor(){this.so=new im,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new im,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){de("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){de("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ku=null;function ql(){return Ku===null?Ku=function(){return 268435456+Math.round(2147483648*Math.random())}():Ku++,"0x"+Ku.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class ZA extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const u=ql(),l=this.xo(t,r.toUriEncodedString());de("RestConnection",`Sending RPC '${t}' ${u}:`,l,i);const f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,s,o),this.No(t,l,f,i).then(m=>(de("RestConnection",`Received RPC '${t}' ${u}: `,m),m),m=>{throw Os("RestConnection",`RPC '${t}' ${u} failed with error: `,m,"url: ",l,"request:",i),m})}Lo(t,r,i,s,o,u){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=JA[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=ql();return new Promise((o,u)=>{const l=new fy;l.setWithCredentials(!0),l.listenOnce(dy.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Yu.NO_ERROR:const m=l.getResponseJson();de(pn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),o(m);break;case Yu.TIMEOUT:de(pn,`RPC '${e}' ${s} timed out`),u(new we(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Yu.HTTP_ERROR:const g=l.getStatus();if(de(pn,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let w=l.getResponseJson();Array.isArray(w)&&(w=w[0]);const I=w==null?void 0:w.error;if(I&&I.status&&I.message){const L=function(J){const ae=J.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(ae)>=0?ae:ne.UNKNOWN}(I.status);u(new we(L,I.message))}else u(new we(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new we(ne.UNAVAILABLE,"Connection failed."));break;default:Ne()}}finally{de(pn,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);de(pn,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",f,r,15)})}Bo(e,t,r){const i=ql(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=gy(),u=my(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(l.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const m=s.join("");de(pn,`Creating RPC '${e}' stream ${i}: ${m}`,l);const g=o.createWebChannel(m,l);let w=!1,I=!1;const L=new XA({Io:J=>{I?de(pn,`Not sending because RPC '${e}' stream ${i} is closed:`,J):(w||(de(pn,`Opening RPC '${e}' stream ${i} transport.`),g.open(),w=!0),de(pn,`RPC '${e}' stream ${i} sending:`,J),g.send(J))},To:()=>g.close()}),K=(J,ae,oe)=>{J.listen(ae,te=>{try{oe(te)}catch(ce){setTimeout(()=>{throw ce},0)}})};return K(g,ba.EventType.OPEN,()=>{I||(de(pn,`RPC '${e}' stream ${i} transport opened.`),L.yo())}),K(g,ba.EventType.CLOSE,()=>{I||(I=!0,de(pn,`RPC '${e}' stream ${i} transport closed`),L.So())}),K(g,ba.EventType.ERROR,J=>{I||(I=!0,Os(pn,`RPC '${e}' stream ${i} transport errored:`,J),L.So(new we(ne.UNAVAILABLE,"The operation could not be completed")))}),K(g,ba.EventType.MESSAGE,J=>{var ae;if(!I){const oe=J.data[0];Fe(!!oe);const te=oe,ce=te.error||((ae=te[0])===null||ae===void 0?void 0:ae.error);if(ce){de(pn,`RPC '${e}' stream ${i} received error:`,ce);const Se=ce.status;let Pe=function(A){const V=Yt[A];if(V!==void 0)return e_(V)}(Se),D=ce.message;Pe===void 0&&(Pe=ne.INTERNAL,D="Unknown error status: "+Se+" with message "+ce.message),I=!0,L.So(new we(Pe,D)),g.close()}else de(pn,`RPC '${e}' stream ${i} received:`,oe),L.bo(oe)}}),K(u,py.STAT_EVENT,J=>{J.stat===gh.PROXY?de(pn,`RPC '${e}' stream ${i} detected buffering proxy`):J.stat===gh.NOPROXY&&de(pn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.wo()},0),L}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(){return typeof window<"u"?window:null}function ic(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(n){return new sA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&de("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,t,r,i,s,o,u,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new V_(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?(Pn(t.toString()),Pn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new we(ne.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return de("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(de("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tS extends k_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=uA(this.serializer,e),r=function(s){if(!("targetChange"in s))return je.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?je.min():o.readTime?Dn(o.readTime):je.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Ph(this.serializer),t.addTarget=function(s,o){let u;const l=o.target;if(u=vc(l)?{documents:u_(s,l)}:{query:c_(s,l)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=r_(s,o.resumeToken);const f=Sh(s,o.expectedCount);f!==null&&(u.expectedCount=f)}else if(o.snapshotVersion.compareTo(je.min())>0){u.readTime=zo(s,o.snapshotVersion.toTimestamp());const f=Sh(s,o.expectedCount);f!==null&&(u.expectedCount=f)}return u}(this.serializer,e);const r=lA(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Ph(this.serializer),t.removeTarget=e,this.a_(t)}}class nS extends k_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=cA(e.writeResults,e.commitTime),r=Dn(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Ph(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>bc(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Rh(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new we(ne.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Lo(e,Rh(t,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new we(ne.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class iS{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Pn(t),this.D_=!1):de("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Us(this)&&(de("RemoteStore","Restarting streams for network reachability change."),await async function(l){const f=$e(l);f.L_.add(4),await yu(f),f.q_.set("Unknown"),f.L_.delete(4),await il(f)}(this))})}),this.q_=new iS(r,i)}}async function il(n){if(Us(n))for(const e of n.B_)await e(!0)}async function yu(n){for(const e of n.B_)await e(!1)}function O_(n,e){const t=$e(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),kf(t)?Vf(t):Xo(t).r_()&&Df(t,e))}function Cf(n,e){const t=$e(n),r=Xo(t);t.N_.delete(e),r.r_()&&N_(t,e),t.N_.size===0&&(r.r_()?r.o_():Us(t)&&t.q_.set("Unknown"))}function Df(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xo(n).A_(e)}function N_(n,e){n.Q_.xe(e),Xo(n).R_(e)}function Vf(n){n.Q_=new tA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Xo(n).start(),n.q_.v_()}function kf(n){return Us(n)&&!Xo(n).n_()&&n.N_.size>0}function Us(n){return $e(n).L_.size===0}function M_(n){n.Q_=void 0}async function oS(n){n.q_.set("Online")}async function aS(n){n.N_.forEach((e,t)=>{Df(n,e)})}async function uS(n,e){M_(n),kf(n)?(n.q_.M_(e),Vf(n)):n.q_.set("Unknown")}async function cS(n,e,t){if(n.q_.set("Online"),e instanceof n_&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.N_.delete(u),i.Q_.removeTarget(u))}(n,e)}catch(r){de("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Rc(n,r)}else if(e instanceof rc?n.Q_.Ke(e):e instanceof t_?n.Q_.He(e):n.Q_.We(e),!t.isEqual(je.min()))try{const r=await C_(n.localStore);t.compareTo(r)>=0&&await function(s,o){const u=s.Q_.rt(o);return u.targetChanges.forEach((l,f)=>{if(l.resumeToken.approximateByteSize()>0){const m=s.N_.get(f);m&&s.N_.set(f,m.withResumeToken(l.resumeToken,o))}}),u.targetMismatches.forEach((l,f)=>{const m=s.N_.get(l);if(!m)return;s.N_.set(l,m.withResumeToken(Xt.EMPTY_BYTE_STRING,m.snapshotVersion)),N_(s,l);const g=new si(m.target,l,f,m.sequenceNumber);Df(s,g)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t)}catch(r){de("RemoteStore","Failed to raise snapshot:",r),await Rc(n,r)}}async function Rc(n,e,t){if(!Qi(e))throw e;n.L_.add(1),await yu(n),n.q_.set("Offline"),t||(t=()=>C_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{de("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await il(n)})}function F_(n,e){return e().catch(t=>Rc(n,t,e))}async function _u(n){const e=$e(n),t=$i(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;lS(e);)try{const i=await HA(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,hS(e,i)}catch(i){await Rc(e,i)}L_(e)&&B_(e)}function lS(n){return Us(n)&&n.O_.length<10}function hS(n,e){n.O_.push(e);const t=$i(n);t.r_()&&t.V_&&t.m_(e.mutations)}function L_(n){return Us(n)&&!$i(n).n_()&&n.O_.length>0}function B_(n){$i(n).start()}async function fS(n){$i(n).p_()}async function dS(n){const e=$i(n);for(const t of n.O_)e.m_(t.mutations)}async function pS(n,e,t){const r=n.O_.shift(),i=wf.from(r,e,t);await F_(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await _u(n)}async function mS(n,e){e&&$i(n).V_&&await async function(r,i){if(function(o){return XT(o)&&o!==ne.ABORTED}(i.code)){const s=r.O_.shift();$i(r).s_(),await F_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await _u(r)}}(n,e),L_(n)&&B_(n)}async function om(n,e){const t=$e(n);t.asyncQueue.verifyOperationInProgress(),de("RemoteStore","RemoteStore received new credentials");const r=Us(t);t.L_.add(3),await yu(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await il(t)}async function gS(n,e){const t=$e(n);e?(t.L_.delete(2),await il(t)):e||(t.L_.add(2),await yu(t),t.q_.set("Unknown"))}function Xo(n){return n.K_||(n.K_=function(t,r,i){const s=$e(t);return s.w_(),new tS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:oS.bind(null,n),Ro:aS.bind(null,n),mo:uS.bind(null,n),d_:cS.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),kf(n)?Vf(n):n.q_.set("Unknown")):(await n.K_.stop(),M_(n))})),n.K_}function $i(n){return n.U_||(n.U_=function(t,r,i){const s=$e(t);return s.w_(),new nS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fS.bind(null,n),mo:mS.bind(null,n),f_:dS.bind(null,n),g_:pS.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await _u(n)):(await n.U_.stop(),n.O_.length>0&&(de("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ai,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,u=new Of(e,t,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nf(n,e){if(Pn("AsyncQueue",`${e}: ${n}`),Qi(n))return new we(ne.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Re.comparator(t.key,r.key):(t,r)=>Re.comparator(t.key,r.key),this.keyedMap=Ia(),this.sortedSet=new Dt(this.comparator)}static emptySet(e){return new Oo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Oo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Oo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(){this.W_=new Dt(Re.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ne():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Go{constructor(e,t,r,i,s,o,u,l,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new Go(e,t,Oo.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _S{constructor(){this.queries=um(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=$e(t),s=i.queries;i.queries=um(),s.forEach((o,u)=>{for(const l of u.j_)l.onError(r)})})(this,new we(ne.ABORTED,"Firestore shutting down"))}}function um(){return new fi(n=>Uy(n),Qc)}async function vS(n,e){const t=$e(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new yS,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const u=Nf(o,`Initialization of query '${Ao(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Mf(t)}async function wS(n,e){const t=$e(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function ES(n,e){const t=$e(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const u of o.j_)u.X_(i)&&(r=!0);o.z_=i}}r&&Mf(t)}function bS(n,e,t){const r=$e(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function Mf(n){n.Y_.forEach(e=>{e.next()})}var Oh,cm;(cm=Oh||(Oh={})).ea="default",cm.Cache="cache";class IS{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Go(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Go.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Oh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e){this.key=e}}class U_{constructor(e){this.key=e}}class TS{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ye(),this.mutatedKeys=Ye(),this.Aa=qy(e),this.Ra=new Oo(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new am,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,g)=>{const w=i.get(m),I=mu(this.query,g)?g:null,L=!!w&&this.mutatedKeys.has(w.key),K=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let J=!1;w&&I?w.data.isEqual(I.data)?L!==K&&(r.track({type:3,doc:I}),J=!0):this.ga(w,I)||(r.track({type:2,doc:I}),J=!0,(l&&this.Aa(I,l)>0||f&&this.Aa(I,f)<0)&&(u=!0)):!w&&I?(r.track({type:0,doc:I}),J=!0):w&&!I&&(r.track({type:1,doc:w}),J=!0,(l||f)&&(u=!0)),J&&(I?(o=o.add(I),s=K?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,g)=>function(I,L){const K=J=>{switch(J){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne()}};return K(I)-K(L)}(m.type,g.type)||this.Aa(m.doc,g.doc)),this.pa(r),i=i!=null&&i;const u=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,f=l!==this.Ea;return this.Ea=l,o.length!==0||f?{snapshot:new Go(this.query,e.Ra,s,o,e.mutatedKeys,l===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new am,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ye(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new U_(r))}),this.da.forEach(r=>{e.has(r)||t.push(new j_(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ye();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Go.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class AS{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class SS{constructor(e){this.key=e,this.va=!1}}class RS{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new fi(u=>Uy(u),Qc),this.Ma=new Map,this.xa=new Set,this.Oa=new Dt(Re.comparator),this.Na=new Map,this.La=new Sf,this.Ba={},this.ka=new Map,this.qa=Bs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function PS(n,e,t=!0){const r=H_(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await q_(r,e,t,!0),i}async function xS(n,e){const t=H_(n);await q_(t,e,!0,!1)}async function q_(n,e,t,r){const i=await WA(n.localStore,ir(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let u;return r&&(u=await CS(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&O_(n.remoteStore,i),u}async function CS(n,e,t,r,i){n.Ka=(g,w,I)=>async function(K,J,ae,oe){let te=J.view.ma(ae);te.ns&&(te=await rm(K.localStore,J.query,!1).then(({documents:D})=>J.view.ma(D,te)));const ce=oe&&oe.targetChanges.get(J.targetId),Se=oe&&oe.targetMismatches.get(J.targetId)!=null,Pe=J.view.applyChanges(te,K.isPrimaryClient,ce,Se);return hm(K,J.targetId,Pe.wa),Pe.snapshot}(n,g,w,I);const s=await rm(n.localStore,e,!0),o=new TS(e,s.Ts),u=o.ma(s.documents),l=gu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=o.applyChanges(u,n.isPrimaryClient,l);hm(n,t,f.wa);const m=new AS(e,t,o);return n.Fa.set(e,m),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),f.snapshot}async function DS(n,e,t){const r=$e(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Qc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await kh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Cf(r.remoteStore,i.targetId),Nh(r,i.targetId)}).catch(js)):(Nh(r,i.targetId),await kh(r.localStore,i.targetId,!0))}async function VS(n,e){const t=$e(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Cf(t.remoteStore,r.targetId))}async function kS(n,e,t){const r=W_(n);try{const i=await function(o,u){const l=$e(o),f=St.now(),m=u.reduce((I,L)=>I.add(L.key),Ye());let g,w;return l.persistence.runTransaction("Locally write mutations","readwrite",I=>{let L=Un(),K=Ye();return l.cs.getEntries(I,m).next(J=>{L=J,L.forEach((ae,oe)=>{oe.isValidDocument()||(K=K.add(ae))})}).next(()=>l.localDocuments.getOverlayedDocuments(I,L)).next(J=>{g=J;const ae=[];for(const oe of u){const te=YT(oe,g.get(oe.key).overlayedDocument);te!=null&&ae.push(new di(oe.key,te,Vy(te.value.mapValue),Cn.exists(!0)))}return l.mutationQueue.addMutationBatch(I,f,ae,u)}).next(J=>{w=J;const ae=J.applyToLocalDocumentSet(g,K);return l.documentOverlayCache.saveOverlays(I,J.batchId,ae)})}).then(()=>({batchId:w.batchId,changes:$y(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,l){let f=o.Ba[o.currentUser.toKey()];f||(f=new Dt(He)),f=f.insert(u,l),o.Ba[o.currentUser.toKey()]=f}(r,i.batchId,t),await vu(r,i.changes),await _u(r.remoteStore)}catch(i){const s=Nf(i,"Failed to persist write");t.reject(s)}}async function K_(n,e){const t=$e(n);try{const r=await zA(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Fe(o.va):i.removedDocuments.size>0&&(Fe(o.va),o.va=!1))}),await vu(t,r,e)}catch(r){await js(r)}}function lm(n,e,t){const r=$e(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const u=o.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){const l=$e(o);l.onlineState=u;let f=!1;l.queries.forEach((m,g)=>{for(const w of g.j_)w.Z_(u)&&(f=!0)}),f&&Mf(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function OS(n,e,t){const r=$e(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Dt(Re.comparator);o=o.insert(s,Mt.newNoDocument(s,je.min()));const u=Ye().add(s),l=new Zc(je.min(),new Map,new Dt(He),o,u);await K_(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),Ff(r)}else await kh(r.localStore,e,!1).then(()=>Nh(r,e,t)).catch(js)}async function NS(n,e){const t=$e(n),r=e.batch.batchId;try{const i=await $A(t.localStore,e);z_(t,r,null),$_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await vu(t,i)}catch(i){await js(i)}}async function MS(n,e,t){const r=$e(n);try{const i=await function(o,u){const l=$e(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return l.mutationQueue.lookupMutationBatch(f,u).next(g=>(Fe(g!==null),m=g.keys(),l.mutationQueue.removeMutationBatch(f,g))).next(()=>l.mutationQueue.performConsistencyCheck(f)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(f,m,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>l.localDocuments.getDocuments(f,m))})}(r.localStore,e);z_(r,e,t),$_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await vu(r,i)}catch(i){await js(i)}}function $_(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function z_(n,e,t){const r=$e(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Nh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||G_(n,r)})}function G_(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Cf(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Ff(n))}function hm(n,e,t){for(const r of t)r instanceof j_?(n.La.addReference(r.key,e),FS(n,r)):r instanceof U_?(de("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||G_(n,r.key)):Ne()}function FS(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(de("SyncEngine","New document in limbo: "+t),n.xa.add(r),Ff(n))}function Ff(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Re(mt.fromString(e)),r=n.qa.next();n.Na.set(r,new SS(t)),n.Oa=n.Oa.insert(t,r),O_(n.remoteStore,new si(ir(yf(t.path)),r,"TargetPurposeLimboResolution",er.oe))}}async function vu(n,e,t){const r=$e(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((u,l)=>{o.push(r.Ka(l,e,t).then(f=>{var m;if((f||t)&&r.isPrimaryClient){const g=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(l.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(l.targetId,g?"current":"not-current")}if(f){i.push(f);const g=xf.Wi(l.targetId,f);s.push(g)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,f){const m=$e(l);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>H.forEach(f,w=>H.forEach(w.$i,I=>m.persistence.referenceDelegate.addReference(g,w.targetId,I)).next(()=>H.forEach(w.Ui,I=>m.persistence.referenceDelegate.removeReference(g,w.targetId,I)))))}catch(g){if(!Qi(g))throw g;de("LocalStore","Failed to update sequence numbers: "+g)}for(const g of f){const w=g.targetId;if(!g.fromCache){const I=m.os.get(w),L=I.snapshotVersion,K=I.withLastLimboFreeSnapshotVersion(L);m.os=m.os.insert(w,K)}}}(r.localStore,s))}async function LS(n,e){const t=$e(n);if(!t.currentUser.isEqual(e)){de("SyncEngine","User change. New user:",e.toKey());const r=await x_(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(u=>{u.forEach(l=>{l.reject(new we(ne.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await vu(t,r.hs)}}function BS(n,e){const t=$e(n),r=t.Na.get(e);if(r&&r.va)return Ye().add(r.key);{let i=Ye();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const u=t.Fa.get(o);i=i.unionWith(u.view.Va)}return i}}function H_(n){const e=$e(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=K_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OS.bind(null,e),e.Ca.d_=ES.bind(null,e.eventManager),e.Ca.$a=bS.bind(null,e.eventManager),e}function W_(n){const e=$e(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=MS.bind(null,e),e}class au{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return P_(this.persistence,new R_,e.initialUser,this.serializer)}Ga(e){return new Rf(nl.Zr,this.serializer)}Wa(e){return new D_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}au.provider={build:()=>new au};class jS extends au{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){Fe(this.persistence.referenceDelegate instanceof Sc);const r=this.persistence.referenceDelegate.garbageCollector;return new b_(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Rf(r=>Sc.Zr(r,t),this.serializer)}}class US extends au{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await W_(this.Ja.syncEngine),await _u(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return P_(this.persistence,new R_,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new b_(r,e.asyncQueue,t)}Ha(e,t){const r=new tT(t,this.persistence);return new eT(e.asyncQueue,r)}Ga(e){const t=UA(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Pf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,eS(),ic(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new D_}}class Pc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LS.bind(null,this.syncEngine),await gS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _S}()}createDatastore(e){const t=rl(e.databaseInfo.databaseId),r=function(s){return new ZA(s)}(e.databaseInfo);return function(s,o,u,l){return new rS(s,o,u,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,u){return new sS(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,t=>lm(this.syncEngine,t,0),function(){return sm.D()?new sm:new YA}())}createSyncEngine(e,t){return function(i,s,o,u,l,f,m){const g=new RS(i,s,o,u,l,f);return m&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=$e(i);de("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await yu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Pc.provider={build:()=>new Pc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Pn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=cn.UNAUTHENTICATED,this.clientId=_y.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{de("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(de("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ai;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Nf(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Kl(n,e){n.asyncQueue.verifyOperationInProgress(),de("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await x_(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function fm(n,e){n.asyncQueue.verifyOperationInProgress();const t=await $S(n);de("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>om(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>om(e.remoteStore,i)),n._onlineComponents=e}async function $S(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){de("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kl(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ne.FAILED_PRECONDITION||i.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Os("Error using user provided cache. Falling back to memory cache: "+t),await Kl(n,new au)}}else de("FirestoreClient","Using default OfflineComponentProvider"),await Kl(n,new jS(void 0));return n._offlineComponents}async function Q_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(de("FirestoreClient","Using user provided OnlineComponentProvider"),await fm(n,n._uninitializedComponentsProvider._online)):(de("FirestoreClient","Using default OnlineComponentProvider"),await fm(n,new Pc))),n._onlineComponents}function zS(n){return Q_(n).then(e=>e.syncEngine)}async function GS(n){const e=await Q_(n),t=e.eventManager;return t.onListen=PS.bind(null,e.syncEngine),t.onUnlisten=DS.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xS.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=VS.bind(null,e.syncEngine),t}function HS(n,e,t={}){const r=new ai;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,u,l,f){const m=new qS({next:w=>{m.Za(),o.enqueueAndForget(()=>wS(s,g)),w.fromCache&&l.source==="server"?f.reject(new we(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(w)},error:w=>f.reject(w)}),g=new IS(u,m,{includeMetadataChanges:!0,_a:!0});return vS(s,g)}(await GS(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(n,e,t){if(!t)throw new we(ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function WS(n,e,t,r){if(e===!0&&r===!0)throw new we(ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pm(n){if(!Re.isDocumentKey(n))throw new we(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mm(n){if(Re.isDocumentKey(n))throw new we(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ne()}function uu(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new we(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sl(n);throw new we(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new we(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new we(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Y_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ol{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new q0;switch(r.type){case"firstParty":return new G0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new we(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=dm.get(t);r&&(de("ComponentProvider","Removing Datastore"),dm.delete(t),r.terminate())}(this),Promise.resolve()}}function QS(n,e,t,r={}){var i;const s=(n=uu(n,ol))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Os("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,l;if(typeof r.mockUserToken=="string")u=r.mockUserToken,l=cn.MOCK_USER;else{u=RI(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new we(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new cn(f)}n._authCredentials=new K0(new yy(u,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qs(this.firestore,e,this._query)}}class sr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sr(this.firestore,e,this._key)}}class ji extends qs{constructor(e,t,r){super(e,t,yf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sr(this.firestore,null,new Re(e))}withConverter(e){return new ji(this.firestore,e,this._path)}}function YS(n,e,...t){if(n=Mr(n),J_("collection","path",e),n instanceof ol){const r=mt.fromString(e,...t);return mm(r),new ji(n,null,r)}{if(!(n instanceof sr||n instanceof ji))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(mt.fromString(e,...t));return mm(r),new ji(n.firestore,null,r)}}function Pi(n,e,...t){if(n=Mr(n),arguments.length===1&&(e=_y.newId()),J_("doc","path",e),n instanceof ol){const r=mt.fromString(e,...t);return pm(r),new sr(n,null,new Re(r))}{if(!(n instanceof sr||n instanceof ji))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(mt.fromString(e,...t));return pm(r),new sr(n.firestore,n instanceof ji?n.converter:null,new Re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new V_(this,"async_queue_retry"),this.Vu=()=>{const r=ic();r&&de("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=ic();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=ic();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new ai;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qi(e))throw e;de("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Pn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=Of.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ne()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS=-1;class al extends ol{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ym,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ym(e),this._firestoreClient=void 0,await e}}}function XS(n,e,t){t||(t="(default)");const r=ay(n,"firestore");if(r.isInitialized(t)){const i=r.getImmediate({identifier:t}),s=r.getOptions(t);if(mc(s,e))return i;throw new we(ne.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new we(ne.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new we(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function ZS(n,e){const t=typeof n=="object"?n:V0(),r=typeof n=="string"?n:"(default)",i=ay(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=AI("firestore");s&&QS(i,...s)}return i}function Lf(n){if(n._terminated)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||X_(n),n._firestoreClient}function X_(n){var e,t,r;const i=n._freezeSettings(),s=function(u,l,f,m){return new IT(u,l,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,Y_(m.experimentalLongPollingOptions),m.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new KS(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){const l=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(l),_online:l}}(n._componentsProvider))}function eR(n,e){Os("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return tR(n,Pc.provider,{build:r=>new US(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function tR(n,e,t){if((n=uu(n,al))._firestoreClient||n._terminated)throw new we(ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new we(ne.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},X_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ho(Xt.fromBase64String(e))}catch(t){throw new we(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ho(Xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new we(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new we(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new we(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=/^__.*__$/;class rR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new di(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jo(e,this.data,t,this.fieldTransforms)}}class Z_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new di(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ev(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne()}}class qf{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new qf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return xc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ev(this.Cu)&&nR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class iR{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rl(e)}Qu(e,t,r,i=!1){return new qf({Cu:e,methodName:t,qu:r,path:kt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tv(n){const e=n._freezeSettings(),t=rl(n._databaseId);return new iR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sR(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);Kf("Data must be an object, but it was:",o,r);const u=nv(r,o);let l,f;if(s.merge)l=new Nn(o.fieldMask),f=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const g of s.mergeFields){const w=Mh(e,g,t);if(!o.contains(w))throw new we(ne.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);iv(m,w)||m.push(w)}l=new Nn(m),f=o.fieldTransforms.filter(g=>l.covers(g.field))}else l=null,f=o.fieldTransforms;return new rR(new vn(u),l,f)}class cl extends Bf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cl}}function oR(n,e,t,r){const i=n.Qu(1,e,t);Kf("Data must be an object, but it was:",i,r);const s=[],o=vn.empty();Yi(r,(l,f)=>{const m=$f(e,l,t);f=Mr(f);const g=i.Nu(m);if(f instanceof cl)s.push(m);else{const w=wu(f,g);w!=null&&(s.push(m),o.set(m,w))}});const u=new Nn(s);return new Z_(o,u,i.fieldTransforms)}function aR(n,e,t,r,i,s){const o=n.Qu(1,e,t),u=[Mh(e,r,t)],l=[i];if(s.length%2!=0)throw new we(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)u.push(Mh(e,s[w])),l.push(s[w+1]);const f=[],m=vn.empty();for(let w=u.length-1;w>=0;--w)if(!iv(f,u[w])){const I=u[w];let L=l[w];L=Mr(L);const K=o.Nu(I);if(L instanceof cl)f.push(I);else{const J=wu(L,K);J!=null&&(f.push(I),m.set(I,J))}}const g=new Nn(f);return new Z_(m,g,o.fieldTransforms)}function uR(n,e,t,r=!1){return wu(t,n.Qu(r?4:3,e))}function wu(n,e){if(rv(n=Mr(n)))return Kf("Unsupported field value:",e,n),nv(n,e);if(n instanceof Bf)return function(r,i){if(!ev(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let l=wu(u,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Mr(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return KT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=St.fromDate(r);return{timestampValue:zo(i.serializer,s)}}if(r instanceof St){const s=new St(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zo(i.serializer,s)}}if(r instanceof jf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ho)return{bytesValue:r_(i.serializer,r._byteString)};if(r instanceof sr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:If(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Uf)return function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.Bu("VectorValues must only contain numeric values.");return _f(u.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${sl(r)}`)}(n,e)}function nv(n,e){const t={};return Py(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yi(n,(r,i)=>{const s=wu(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function rv(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof St||n instanceof jf||n instanceof Ho||n instanceof sr||n instanceof Bf||n instanceof Uf)}function Kf(n,e,t){if(!rv(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=sl(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Mh(n,e,t){if((e=Mr(e))instanceof ul)return e._internalPath;if(typeof e=="string")return $f(n,e);throw xc("Field path arguments must be of type string or ",n,!1,void 0,t)}const cR=new RegExp("[~\\*/\\[\\]]");function $f(n,e,t){if(e.search(cR)>=0)throw xc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ul(...e.split("."))._internalPath}catch{throw xc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xc(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new we(ne.INVALID_ARGUMENT,u+n+l)}function iv(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new sr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ll("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lR extends sv{data(){return super.data()}}function ll(n,e){return typeof e=="string"?$f(n,e):e instanceof ul?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new we(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zf{}class ov extends zf{}function fR(n,e,...t){let r=[];e instanceof zf&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof Gf).length,u=s.filter(l=>l instanceof hl).length;if(o>1||o>0&&u>0)throw new we(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class hl extends ov{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new hl(e,t,r)}_apply(e){const t=this._parse(e);return av(e._query,t),new qs(e.firestore,e.converter,Th(e._query,t))}_parse(e){const t=tv(e.firestore);return function(s,o,u,l,f,m,g){let w;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new we(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){vm(g,m);const I=[];for(const L of g)I.push(_m(l,s,L));w={arrayValue:{values:I}}}else w=_m(l,s,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||vm(g,m),w=uR(u,o,g,m==="in"||m==="not-in");return rt.create(f,m,w)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dR(n,e,t){const r=e,i=ll("where",n);return hl._create(i,r,t)}class Gf extends zf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Gf(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:yt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const l of u)av(o,l),o=Th(o,l)}(e._query,t),new qs(e.firestore,e.converter,Th(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hf extends ov{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hf(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new we(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new we(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new iu(s,o)}(e._query,this._field,this._direction);return new qs(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Yo(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function pR(n,e="asc"){const t=e,r=ll("orderBy",n);return Hf._create(r,t)}function _m(n,e,t){if(typeof(t=Mr(t))=="string"){if(t==="")throw new we(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jy(e)&&t.indexOf("/")!==-1)throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(mt.fromString(t));if(!Re.isDocumentKey(r))throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return nu(n,new Re(r))}if(t instanceof sr)return nu(n,t._key);throw new we(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sl(t)}.`)}function vm(n,e){if(!Array.isArray(n)||n.length===0)throw new we(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function av(n,e){const t=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new we(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class mR{convertValue(e,t="none"){switch(qi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Yi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ct(o.doubleValue));return new Uf(s)}convertGeoPoint(e){return new jf(Ct(e.latitude),Ct(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(eu(e));default:return null}}convertTimestamp(e){const t=ci(e);return new St(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=mt.fromString(e);Fe(d_(r));const i=new Ns(r.get(1),r.get(3)),s=new Re(r.popFirst(5));return i.isEqual(t)||Pn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yR extends sv{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ll("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class sc extends yR{data(e={}){return super.data(e)}}class _R{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new $u(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sc(this._firestore,this._userDataWriter,r.key,r,new $u(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new we(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const l=new sc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new $u(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const l=new sc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new $u(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return u.type!==0&&(f=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),m=o.indexOf(u.doc.key)),{type:vR(u.type),doc:l,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function vR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne()}}class wR extends mR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ho(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sr(this.firestore,null,t)}}function ER(n){n=uu(n,qs);const e=uu(n.firestore,al),t=Lf(e),r=new wR(e);return hR(n._query),HS(t,n._query).then(i=>new _R(e,r,n,i))}function bR(n,e){return function(r,i){const s=new ai;return r.asyncQueue.enqueueAndForget(async()=>kS(await zS(r),i,s)),s.promise}(Lf(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=tv(e)}set(e,t,r){this._verifyNotCommitted();const i=$l(e,this._firestore),s=gR(i.converter,t,r),o=sR(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Cn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=$l(e,this._firestore);let o;return o=typeof(t=Mr(t))=="string"||t instanceof ul?aR(this._dataReader,"WriteBatch.update",s._key,t,r,i):oR(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Cn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=$l(e,this._firestore);return this._mutations=this._mutations.concat(new Xc(t._key,Cn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new we(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $l(n,e){if((n=Mr(n)).firestore!==e)throw new we(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(n){return Lf(n=uu(n,al)),new IR(n,e=>bR(n,e))}(function(e,t=!0){(function(i){Qo=i})(D0),yc(new Qa("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new al(new $0(r.getProvider("auth-internal")),new W0(r.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new we(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ns(f.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),ko(fp,"4.7.4",e),ko(fp,"4.7.4","esm2017")})();var AR="firebase",SR="11.0.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ko(AR,SR,"app");const RR={apiKey:"AIzaSyDAjkmkmixb-HR-Gyh5K6QYWXo6Kc2S8Q0",authDomain:"nekay-b4b50.firebaseapp.com",projectId:"nekay-b4b50",storageBucket:"nekay-b4b50.firebasestorage.app",messagingSenderId:"833816673115",appId:"1:833816673115:web:2b51df86efd3f4bfeb787e",measurementId:"G-YJHYN5NKJ1"},uv=uy(RR),PR=XS(uv,{cacheSizeBytes:JS});eR(PR).then(()=>{console.log("Offline persistence enabled")}).catch(n=>{n.code=="failed-precondition"?console.warn("Multiple tabs open, offline persistence can only be enabled in one tab at a time."):n.code=="unimplemented"&&console.warn("Current browser doesn't support offline persistence")});window.addEventListener("online",()=>{console.log("App is online")});window.addEventListener("offline",()=>{console.log("App is offline")});const cv=ZS(uv);function ti(n){return YS(cv,n)}function xR(n,e){var r;return{...n,id:e,lastModified:((r=n.lastModified)==null?void 0:r.toMillis())||Date.now()}}const No=async(n,e)=>{try{const t=ti(n),r=fR(t,dR("lastModified",">",St.fromMillis(e)),pR("lastModified","asc")),i=await ER(r),s=[];return i.forEach(o=>{const u=o.data();s.push(xR(u,o.id))}),s}catch(t){throw console.error(`Error fetching changed ${n}:`,t),t}},CR=async n=>{var r,i,s,o,u,l,f,m;const e=TR(cv),t=St.now();try{(r=n.tasks)==null||r.forEach(g=>{if(!g.id){console.warn("Skipping task without id:",g);return}const w=Pi(ti("tasks"),g.id);e.set(w,{...g,lastModified:t},{merge:!0})}),(i=n.journalEntries)==null||i.forEach(g=>{if(!g.id){console.warn("Skipping journal entry without id:",g);return}const w=Pi(ti("journalEntries"),g.id);e.set(w,{...g,lastModified:t},{merge:!0})}),(s=n.folders)==null||s.forEach(g=>{if(!g.id){console.warn("Skipping folder without id:",g);return}const w=Pi(ti("folders"),g.id);e.set(w,{...g,lastModified:t},{merge:!0})}),(o=n.pomodoroStats)==null||o.forEach(g=>{if(!g.id){console.warn("Skipping pomodoro stats without id:",g);return}const w=Pi(ti("pomodoroStats"),g.id);e.set(w,{...g,lastModified:t},{merge:!0})}),(u=n.deletedTaskIds)==null||u.forEach(g=>{const w=Pi(ti("tasks"),g);e.update(w,{deleted:!0,lastModified:t})}),(l=n.deletedJournalEntryIds)==null||l.forEach(g=>{const w=Pi(ti("journalEntries"),g);e.update(w,{deleted:!0,lastModified:t})}),(f=n.deletedFolderIds)==null||f.forEach(g=>{const w=Pi(ti("folders"),g);e.update(w,{deleted:!0,lastModified:t})}),(m=n.deletedPomodoroStatsIds)==null||m.forEach(g=>{const w=Pi(ti("pomodoroStats"),g);e.update(w,{deleted:!0,lastModified:t})}),await e.commit(),console.log("Batch update completed successfully")}catch(g){throw console.error("Error in batch update:",g),g}};function DR(){const n=nr(!1),e=nr(null),t=nr(0),r=5,i=5e3,s=()=>{const l=n.value;n.value=!navigator.onLine,!n.value&&l?(e.value=new Date,t.value=0,window.dispatchEvent(new CustomEvent("app-online"))):n.value&&!l&&window.dispatchEvent(new CustomEvent("app-offline"))},o=async()=>{try{(await fetch("/manifest.json",{method:"HEAD",cache:"no-cache"})).ok&&(n.value=!1,e.value=new Date,t.value=0,window.dispatchEvent(new CustomEvent("app-online")))}catch{n.value=!0,t.value++,t.value<r&&setTimeout(o,i),window.dispatchEvent(new CustomEvent("app-offline"))}},u=()=>{t.value=0,o()};return Lc(()=>{window.addEventListener("online",s),window.addEventListener("offline",s),s(),o();const l=setInterval(()=>{n.value&&o()},i);ef(()=>{window.removeEventListener("online",s),window.removeEventListener("offline",s),clearInterval(l)})}),{isOffline:n,lastOnlineTime:e,reconnectionAttempts:t,forceCheck:u}}const VR=3e4,kR=3,OR=5e3;async function mn(n,e=kR){try{return await n()}catch(t){if(e>0)return console.warn(`Retrying after error: ${t}`),await new Promise(r=>setTimeout(r,OR)),mn(n,e-1);throw console.error(`Failed after multiple retries: ${t}`),t}}class NR{constructor(){Tn(this,"isSyncing",!1);Tn(this,"lastSyncTime",0);Tn(this,"syncInterval",null);Tn(this,"offlineState",DR());Tn(this,"syncDebounceTimeout",null);Tn(this,"syncQueue",new Map);this.setupAutoSync(),this.setupOnlineListener()}get isOnline(){return!this.offlineState.isOffline.value}clearTimeouts(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null),this.syncDebounceTimeout&&(clearTimeout(this.syncDebounceTimeout),this.syncDebounceTimeout=null)}setupAutoSync(){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval(()=>{this.isOnline&&!this.isSyncing&&this.syncData()},VR)}setupOnlineListener(){Vo(this.offlineState.isOffline,e=>{e||this.debouncedSync()}),window.addEventListener("app-online",()=>{this.debouncedSync()})}debouncedSync(){this.syncDebounceTimeout&&clearTimeout(this.syncDebounceTimeout);try{this.syncDebounceTimeout=setTimeout(()=>{this.syncData().catch(e=>{console.error("Debounced sync failed:",e)})},1e3)}catch(e){console.error("Failed to schedule debounced sync:",e)}}async queueSync(e,t){const r=this.syncQueue.get(e);if(r)return r;const i=t().finally(()=>{this.syncQueue.delete(e)});return this.syncQueue.set(e,i),i}async syncData(){return this.isSyncing?(console.log("Sync already in progress, queuing..."),this.queueSync("main",()=>this._syncData())):this._syncData()}async _syncData(){try{this.isSyncing=!0,console.log("Starting sync process...");const e=Date.now(),t=50;let r=0;for(;;){const[u,l,f]=await mn(()=>Promise.all([ot.getPendingSyncItems("tasks",t,r),ot.getPendingSyncItems("journal",t,r),ot.getPendingSyncItems("folders",t,r)]));if(!u.length&&!l.length&&!f.length)break;await this.processBatch({tasks:u,journalEntries:l,folders:f}),r+=t}const[i,s,o]=await mn(()=>Promise.all([No("tasks",this.lastSyncTime),No("journalEntries",this.lastSyncTime),No("folders",this.lastSyncTime)]));console.log("Processing remote changes..."),await mn(()=>this.processRemoteChanges(i,s,o)),this.lastSyncTime=e,console.log("Sync completed successfully")}catch(e){throw console.error("Sync failed:",e),e}finally{this.isSyncing=!1}}async processBatch(e){const{tasks:t,journalEntries:r,folders:i}=e,s=10,o=[];for(let u=0;u<Math.max(t.length,r.length,i.length);u+=s)o.push({tasks:t.slice(u,u+s),journalEntries:r.slice(u,u+s),folders:i.slice(u,u+s)});for(const u of o)await mn(()=>this.processChunk(u))}async processChunk(e){const t=e.tasks.filter(l=>l.deleted).map(l=>l.id),r=e.journalEntries.filter(l=>l.deleted).map(l=>l.id),i=e.folders.filter(l=>l.deleted).map(l=>l.id),s=e.tasks.filter(l=>!l.deleted),o=e.journalEntries.filter(l=>!l.deleted),u=e.folders.filter(l=>!l.deleted);await mn(()=>CR({tasks:s,journalEntries:o,folders:u,deletedTaskIds:t,deletedJournalEntryIds:r,deletedFolderIds:i})),await mn(()=>Promise.all([...s.map(l=>ot.updateItem("tasks",l.id,{...l,syncStatus:"synced"})),...o.map(l=>ot.updateItem("journal",l.id,{...l,syncStatus:"synced"})),...u.map(l=>ot.updateItem("folders",l.id,{...l,syncStatus:"synced"})),...t.map(l=>ot.deleteItem("tasks",l)),...r.map(l=>ot.deleteItem("journal",l)),...i.map(l=>ot.deleteItem("folders",l))]))}async processRemoteChanges(e,t,r){console.log("Processing remote changes...");for(const i of e){if(!i.id){console.warn("Skipping task without id:",i);continue}if(i.deleted)await mn(()=>ot.deleteItem("tasks",i.id));else{const s=await mn(()=>ot.getItem("tasks",i.id));(!s||s.lastModified<i.lastModified)&&await mn(()=>ot.updateItem("tasks",i.id,i))}}for(const i of t){if(!i.id){console.warn("Skipping journal entry without id:",i);continue}if(i.deleted)await mn(()=>ot.deleteItem("journal",i.id));else{const s=await mn(()=>ot.getItem("journal",i.id));(!s||s.lastModified<i.lastModified)&&await mn(()=>ot.updateItem("journal",i.id,i))}}for(const i of r){if(!i.id){console.warn("Skipping folder without id:",i);continue}if(i.deleted)await mn(()=>ot.deleteItem("folders",i.id));else{const s=await mn(()=>ot.getItem("folders",i.id));(!s||s.lastModified<i.lastModified)&&await mn(()=>ot.updateItem("folders",i.id,i))}}}destroy(){this.clearTimeouts(),this.syncQueue.clear()}}const Cr=new NR;function zl(){return crypto.randomUUID()}const MR=ob("notes",{state:()=>({tasks:[],journalEntries:[],folders:[],loading:!1,error:null,lastSync:null,initialized:!1,tasksLoading:!1}),getters:{tasksByFolder:n=>e=>n.tasks.filter(t=>t.folderId===e),entriesByFolder:n=>e=>n.journalEntries.filter(t=>t.folderId===e&&!t.deleted),pendingChanges:n=>{const e=n.tasks.filter(i=>i.syncStatus==="pending"),t=n.journalEntries.filter(i=>i.syncStatus==="pending"),r=n.folders.filter(i=>i.syncStatus==="pending");return e.length+t.length+r.length}},actions:{setError(n){this.error=n instanceof Error?n.message:String(n),console.error("Store error:",n)},async fetchTasks(){try{this.loading=!0;const n=await ot.getAllItems("tasks");this.tasks=n.sort((e,t)=>(t.lastModified||0)-(e.lastModified||0)).filter((e,t,r)=>t===r.findIndex(i=>i.id===e.id)),this.error=null}catch(n){console.error("Error fetching tasks:",n),this.setError(n)}finally{this.loading=!1}},async fetchJournalEntries(){try{this.loading=!0;const n=await ot.getAllItems("journal");this.journalEntries=n.filter(e=>!e.deleted),this.error=null}catch(n){console.error("Error fetching journal entries:",n),this.setError(n)}finally{this.loading=!1}},async fetchFolders(){try{this.loading=!0;const n=await ot.getAllItems("folders");this.folders=n.sort((e,t)=>(t.lastModified||0)-(e.lastModified||0)).filter((e,t,r)=>t===r.findIndex(i=>i.id===e.id)),this.error=null}catch(n){console.error("Error fetching folders:",n),this.setError(n)}finally{this.loading=!1}},async initialise(){if(!this.initialized)try{console.log("Initializing store..."),await ot.init(),await Promise.all([this.fetchTasks(),this.fetchJournalEntries(),this.fetchFolders()]),this.initialized=!0}catch(n){throw console.error("Failed to initialize store:",n),this.setError(n),n}},async fetchFromFirebase(){try{console.log("Fetching data from Firebase...");const[n,e,t]=await Promise.all([No("tasks",0),No("journalEntries",0),No("folders",0)]),r=async(i,s,o)=>{console.log(`Processing ${i.length} items for ${s}`),await ot.clearStore(s),o.length=0;for(const u of i)if(!u.deleted&&u.id)try{await ot.addItem(s,{...u,syncStatus:"synced"}),o.push({...u,syncStatus:"synced"})}catch(l){console.error(`Failed to process item ${u.id}:`,l)}};await r(n,"tasks",this.tasks),await r(e,"journal",this.journalEntries),await r(t,"folders",this.folders),console.log("Firebase data fetched and stored:",{tasks:this.tasks.length,entries:this.journalEntries.length,folders:this.folders.length})}catch(n){throw console.error("Error fetching from Firebase:",n),this.setError(n),n}},async syncWithServer(){if(!navigator.onLine){console.log("Offline, skipping sync");return}await Cr.syncData()},async addTask(n,e=null){try{const t=Date.now(),r={id:zl(),title:n,completed:!1,folderId:e,syncStatus:"pending",lastModified:t,timestamp:t};await ot.addItem("tasks",r),this.tasks.push(r),await Cr.syncData(),this.error=null}catch(t){this.setError(t)}},async editTask(n,e){try{const t=Date.now(),r=this.tasks.findIndex(s=>s.id===n);if(r===-1)throw new Error("Task not found");const i={...this.tasks[r],...e,syncStatus:"pending",lastModified:t};await ot.updateItem("tasks",n,i),this.tasks[r]=i,await Cr.syncData(),this.error=null}catch(t){this.setError(t)}},async deleteTask(n){try{const e=Date.now(),t=this.tasks.findIndex(i=>i.id===n);if(t===-1)throw new Error("Task not found");const r={...this.tasks[t],deleted:!0,syncStatus:"pending",lastModified:e};await ot.updateItem("tasks",n,r),this.tasks.splice(t,1),await Cr.syncData(),this.error=null}catch(e){this.setError(e);const t=this.tasks.find(r=>r.id===n);throw t&&this.tasks.push(t),e}},async addFolder(n,e){try{const t=Date.now(),r={id:zl(),name:n,type:e,syncStatus:"pending",lastModified:t,timestamp:t};await ot.addItem("folders",r),this.folders.push(r),await Cr.syncData(),this.error=null}catch(t){this.setError(t)}},async editFolder(n,e){try{const t=this.folders.findIndex(s=>s.id===n);if(t===-1)throw new Error("Folder not found");const r=Date.now(),i={...this.folders[t],...e,syncStatus:"pending",lastModified:r};await ot.updateItem("folders",n,i),this.folders[t]=i,await Cr.syncData(),this.error=null}catch(t){this.setError(t)}},async deleteFolder(n){try{const e=this.folders.findIndex(r=>r.id===n);if(e===-1)throw new Error("Folder not found");const t={...this.folders[e],deleted:!0,syncStatus:"pending",lastModified:Date.now()};await ot.updateItem("folders",n,t),this.folders.splice(e,1),await Cr.syncData(),this.error=null}catch(e){this.setError(e);const t=this.folders.find(r=>r.id===n);throw t&&this.folders.push(t),e}},async addJournalEntry(n,e,t=null){const r=Date.now(),i={id:zl(),title:n,content:e,date:new Date().toISOString(),folderId:t,syncStatus:"pending",lastModified:r,timestamp:r};this.journalEntries.push(i);try{await ot.addItem("journal",i),await Cr.syncData()}catch(s){this.setError(s)}},async editJournalEntry(n,e){try{const t=this.journalEntries.findIndex(s=>s.id===n);if(t===-1)throw new Error("Journal entry not found");const r=Date.now(),i={...this.journalEntries[t],...e,syncStatus:"pending",lastModified:r};await ot.updateItem("journal",n,i),this.journalEntries[t]=i,await Cr.syncData(),this.error=null}catch(t){this.setError(t)}},async deleteJournalEntry(n){try{const e=this.journalEntries.findIndex(r=>r.id===n);if(e===-1)throw new Error("Journal entry not found");const t={...this.journalEntries[e],deleted:!0,syncStatus:"pending",lastModified:Date.now()};await ot.updateItem("journal",n,t),this.journalEntries.splice(e,1),await Cr.syncData(),this.error=null}catch(e){this.setError(e)}}}}),FR={class:"app-container"},LR={key:0,class:"error-message"},BR={key:1,class:"loading"},jR=Mc({__name:"App",setup(n){const e=fw(()=>bo(()=>import("./BottomNav-WBoUsA8z.js"),__vite__mapDeps([11,1,12]))),t=MR(),{initialized:r}=ab(t),i=nr(!0),s=nr(null);return Lc(async()=>{try{r.value||await t.initialise(),await t.fetchFromFirebase()}catch(o){console.error("Failed to initialize app:",o),s.value=o}finally{i.value=!1}}),(o,u)=>{const l=Tw("router-view");return wo(),Fu("div",FR,[s.value?(wo(),Fu("div",LR,Rm(s.value.message),1)):i.value?(wo(),Fu("div",BR," Loading... ")):(wo(),Fu(yr,{key:2},[nn(l),o.$route.path!=="/login"?(wo(),Rg(Ps(e),{key:0})):oE("v-if",!0)],64))])}}});function UR(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(n=>{console.log("ServiceWorker registration successful:",n.scope)}).catch(n=>{console.error("ServiceWorker registration failed:",n)})})}const qR=async()=>{const n=YE(jR),e=eb();n.use(e),n.use(Yg);try{await ot.init(),await UR(),n.mount("#app")}catch(t){const r=t;console.error("App initialization failed:",r),r.code==="INDEXEDDB_INIT_ERROR"?alert(`Unable to start offline storage: ${r.message}`):r.code==="INDEXEDDB_BLOCKED"?alert(r.message):alert("Unable to initialize app storage. Some features may be unavailable."),n.mount("#app")}};qR().catch(n=>{console.error("Critical initialization error:",n),document.body.innerHTML=`
    <div style="padding: 20px; text-align: center;">
      <h1>Unable to Start App</h1>
      <p>Please try refreshing the page. If the problem persists, clear your browser data.</p>
      <pre style="color: red;">${n.message}</pre>
    </div>
  `});export{Ps as A,JR as B,zR as C,ZR as D,Tw as E,yr as F,WR as T,xg as a,HR as b,Fu as c,Mc as d,YR as e,$R as f,oE as g,Zn as h,GR as i,Lc as j,MR as k,nn as l,ow as m,qh as n,wo as o,Uh as p,sE as q,nr as r,ob as s,Rm as t,XR as u,QR as v,Vo as w,ot as x,ab as y,ef as z};
